{
  "hash": "c806819ef32026f34ee6ffcacbf8cca8",
  "result": {
    "engine": "knitr",
    "markdown": "# A Post-Keynesian Macro Model with Endogenous Money {#sec-PK-endog-money}\n\n## Overview\n\nPost-Keynesian Economics is an economic paradigm that was developed in the 1930s and 1940s by Joan Robinson, Nicholas Kaldor and others.^[See @Lavoie2006, chap.1 and [Exploring Economics](https://www.exploring-economics.org/en/orientation/post-keynesian-economics/) for introductions. @lavoie_post-keynesian_2014 and @hein_distribution_2014 provide more advanced treatments.] The early post-Keynesian economists sought to develop further key ideas of John Maynard Keynes. They were critical of the [Neoclassical Synthesis](@neoclassical_synth_chapter) that introduced neoclassical elements into the Keynesian framework. Among many other points, post-Keynesians argued that money is created by commercial banks. Money creation is determined by the demand for credit rather than being under the control of the central bank, and should thus be considered endogenous. Post-Keynesians further assigned a key role to financial factors in the determination of economic activity, but also considered finance as a source of instability. They abandoned the neoclassical approach of deriving labour demand and supply from optimising behaviour and instead assumed oligopolistic market structures. Firms set prices by charging a mark-up on costs and workers set nominal wages based on their bargaining power.\n\n@fontana_simple_2009 present a simple model that could be regarded as a post-Keynesian alternative to the Neoclassical Synthesis. The model highlights the endogenous money creation process. Money is being created when commercial banks make loans to accommodate the demand for credit by creditworthy borrowers. The demand for credit is driven by aggregate demand. The interest rate on loans is determined by the base rate, set by the central bank, on which commercial banks charge a mark-up. Although credit creation is demand-driven, some borrowers will be credit constrained. In times of financial crises, banks tighten credit constraints, which can depress economic activity.  \n\nIn this short-run model, prices are flexible but the capital stock is fixed. The focus is thus on goods market equilibrium rather than economic growth. As all endogenous variables adjust instantaneously, the model is static. We consider a version of the model due to @fontana_simple_2009 with linear functions.\n\n## The Model\n\n$$\nY=ND+cD\n$$ {#eq-Y-PK}\n\n$$\nND=bY, \\quad b \\in (0,1)\n$$ {#eq-ND-PK}\n\n$$\nD= d_0 - d_1r, \\quad d_1 > 0\n$$ {#eq-D-PK}\n\n$$\ni=i_0 + i_1P, \\quad i_1 > 0\n$$ {#eq-i-PK}\n\n$$\nr=(1+m)i, \\quad m > 0\n$$ {#eq-r-PK}\n\n$$\ndL=cD\n$$ {#eq-dL-PK}\n\n$$\ndM=dL\n$$ {#eq-dM-PK}\n\n$$\ndR=kdM, \\quad k \\in (0,1)\n$$ {#eq-dR-PK}\n\n$$\nP=(1+n)aW, \\quad a,n > 0\n$$ {#eq-P-PK}\n\n$$\nW=W_0 - hU, \\quad h > 0\n$$ {#eq-W-PK}\n\n$$\nw=\\frac{1}{(1+n)a}\n$$ {#eq-w-PK}\n\n$$\nN=aY\n$$ {#eq-N-PK}\n\n$$\nU=1-\\frac{N}{N^f}\n$$ {#eq-U-PK}\n\nwhere $Y$, $ND$, $D$, $r$, $i$, $P$, $dL$, $dM$, $dR$, $W$, $w$, $N$, $U$, and $N^f$ are output, the not debt-financed component of aggregate demand, the desired debt-financed component of aggregate demand, the lending rate, the policy rate, the price level, the change in loans, the change in money (bank deposits), the change in bank reserves, the nominal wage, the real wage, employment, the unemployment rate, and full employment (or total labour supply), respectively.\n\n@eq-Y-PK is the goods market equilibrium condition. Aggregate supply ($Y$) accommodates to the level of aggregate demand which is the sum of a not debt-financed component ($ND$) and a (desired) debt-financed component ($D$). The coefficient $c$ is the proportion of loan applications that are deemed creditworthy and thus captures credit rationing by banks. By @eq-ND-PK, the not debt-financed component of aggregate demand is a function of current income. In @eq-D-PK, the debt-financed component of aggregate demand has an autonomous component ($d_0$)^[For simplicity, it is assumed that all autonomous demand is debt-financed, i.e. there is no spending out of wealth.] and is otherwise negatively related to the lending rate $r$. @eq-i-PK specifies the monetary policy rule, where it is assumed that the central bank raises the policy rate $i$ when the price level increases.^[This specification is somewhat unrealistic given that most modern central banks target a positive rate of inflation. However, it allows for an AS-AD representation of the model, which facilitates the comparison with the Neoclassical Synthesis model (@sec-neoclassical-synthesis) The lending rate in @eq-r-PK is given by a mark-up $m$ that banks charge on the policy rate (which is the rate at which they can borrow reserves). The change in loans in @eq-dL-PK is equal to the creditworthy demand for loans ($cD$). This captures the demand-driven nature of credit creation. The changes in loans translates one-to-one into a change in money, which are bank deposits in this model (@eq-dM-PK). This reflects the endogenous money creation process where commercial banks create new deposits when they make new loans. By @eq-dR-PK, banks obtain new reserves from the central bank to maintain a constant reserve-to-deposit ratio $k$. Thus, the causality in this model runs from debt-financed demand to loans, to deposits, and finally to reserves. \n\nBy @eq-P-PK, the price level is set by firms based on a mark-up ($n$) on unit labour cost (which are the product of the nominal wage $W$ and the labour coefficient $a$). Nominal wages are set by workers based on their bargaining power, which is declining in the unemployment rate (@eq-U-PK). The real wage in @eq-w-PK is derived from the pricing @eq-P-PK, i.e. through their price setting power, firms ultimately determine the real wage. The level of employment in @eq-N-PK is determined residually based on economic activity and a constant-coefficient production function $(Y=\\frac{N}{a})$. Finally, the level of employment in conjunction with an exogenously given labour force $N^f$ (or total available labour time) can be used to obtain an unemployment rate in @eq-U-PK.\n\n## Simulation\n\n### Parameterisation\n\nTable 1 reports the parameterisation used in the simulation. Besides a baseline (labelled as scenario 1), five further scenarios will be considered. Scenario 2 is a rise in credit rationing in the form of a fall in $c$. In scenario 3, autonomous credit-financed demand ($d_0$) increases. Scenarios 4 and 5 consider a rise in the interest rate (or bank) mark-up ($m$) and in the price (or firm) mark-up ($n$), respectively. Scenario 6 considers a rise in productivity reflected in a fall of the labour coefficient $a$.\n\n**Table 1: Parameterisation**\n\n| Scenario                                | $b$ | $c$ | $d_0$ | $d_1$ | $i_0$ | $i1$ | $m$ | $k$ | $n$ | $W_0$ | $h$ | $a$ | $N^f$ |\n|:---------------------------------------:|:---:|:---:|:-----:|:-----:|:-----:|:----:|:---:|:---:|:---:|:-----:|:---:|:---:|:-----:|\n| 1: baseline                             | 0.5 | 0.8 | 5     | 0.8   | 0.01  | 0.5  | 0.15| 0.3 | 0.15| 2     | 0.8 | 0.8 | 12    |\n| 2: rise in credit rationing ($c$)       | 0.5 | 0.4 | 5     | 0.8   | 0.01  | 0.5  | 0.15| 0.3 | 0.15| 2     | 0.8 | 0.8 | 12    |\n| 3: rise in autonomous demand ($d_0$)    | 0.5 | 0.8 | 10    | 0.8   | 0.01  | 0.5  | 0.15| 0.3 | 0.15| 2     | 0.8 | 0.8 | 12    |\n| 4: rise in bank mark-up ($m$)           | 0.5 | 0.8 | 5     | 0.8   | 0.01  | 0.5  | 0.3 | 0.3 | 0.15| 2     | 0.8 | 0.8 | 12    |\n| 5: rise in firm mark-up ($n$)           | 0.5 | 0.8 | 5     | 0.8   | 0.01  | 0.5  | 0.15| 0.3 | 0.3 | 2     | 0.8 | 0.8 | 12    |\n| 6: rise in productivity ($a$)           | 0.5 | 0.8 | 5     | 0.8   | 0.01  | 0.5  | 0.15| 0.3 | 0.15| 2     | 0.8 | 0.4 | 12    |\n\n### Simulation code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Clear the environment\nrm(list=ls(all=TRUE))\n\n# Set number of scenarios (including baseline)\nS=6\n\n#Create vector in which equilibrium solutions from different parameterisations will be stored\nY_star=vector(length=S)  # income/output\nD_star=vector(length=S)  # (notional) credit-financed aggregate demand\nND_star=vector(length=S) # income-financed aggregate demand\nr_star=vector(length=S)  # lending rate\nN_star=vector(length=S)  # employment\nU_star=vector(length=S)  # unemployment\nP_star=vector(length=S)  # price level\nw_star=vector(length=S)  # real wage\nW_star=vector(length=S)  # nominal wage\ni_star=vector(length=S)  # central bank rate\ndL_star=vector(length=S) # change in loans\ndM_star=vector(length=S) # change in bank deposits \ndR_star=vector(length=S) # change in bank reserves\n\n# Set exogenous variables that will be shifted\nc=vector(length=S) # share of credit demand that is accommodated\nd0=vector(length=S)# autonomous component of debt-financed aggregate demand\nm=vector(length=S) # mark-up on lending rate\nn=vector(length=S) # mark-up on prices\na=vector(length=S) # productivity\n\n# Baseline parameterisation\nc[]=0.8 \nd0[]=5\nm[]=0.15\nn[]=0.15  \na[]=0.8 \n\n## Construct scenarios\n\n# scenario 2: increase in credit rationing\nc[2]=0.4\n\n# scenario 3: increase in autonomous demand\nd0[3]=10\n\n# scenario 4: increase in interest rate mark-up\nm[4]=0.3\n\n# scenario 5: increase in price mark-up\nn[5]=0.3\n\n# scenario 6: increase in productivity\na[6]=0.4\n\n\n#Set constant parameter values\nb=0.5   # propensity to spend out of income\nd1=0.8  # sensitivity of demand with respect to the interest rate\ni0=0.01 # discretionary component of central bank rate\ni1=0.5  # sensitivity of central bank rate with respect to price level\nNf=12   # full employment/labour force\nh=0.8   # sensitivity of nominal wage with respect to unemployment\nk=0.3   # desired reserve ratio\nW0=2    # exogenous component of nominal wage\n\n# Initialise endogenous variables at some arbitrary positive value \nY = D = ND = r = N = U = P = w = W = i = dL = dR = dM = 1\n\n#Solve this system numerically through 1000 iterations based on the initialisation\nfor (j in 1:S){\n  \n  for (iterations in 1:1000){\n    \n    #Model equations\n    \n    # (1) Goods market\n    Y = ND + c[j]*D\n    \n    # (2) Not-debt financed component of aggregate demand\n    ND = b*Y\n    \n    # (3) Debt-financed component of aggregate demand\n    D= d0[j] - d1*r\n    \n    # (4) Policy rate\n    i = i0 + i1*P\n    \n    # (5) Lending rate\n    r = (1+m[j])*i\n    \n    # (6) Change in loans\n    dL = c[j]*D\n    \n    # (7) Change in deposits\n    dM = dL\n    \n    # (8) Change in reserves\n    dR = k*dM\n    \n    # (9) Price level\n    P = (1+n[j])*a[j]*W\n    \n    # (10) Nominal wage\n    W = W0 - h*(U)\n    \n    # (11) Real wage\n    w = 1/((1+n[j])*a[j])\n    \n    # (12) Employment\n    N = a[j]*Y\n    \n    # (13) Unemployment rate\n    U = (Nf - N)/Nf\n    \n  }\n\n  #Save results for different parameterisations in vector\n  Y_star[j]=Y\n  D_star[j]=D\n  ND_star[j]=ND\n  r_star[j]=r\n  N_star[j]=N\n  U_star[j]=U\n  P_star[j]=P\n  w_star[j]=w\n  W_star[j]=W\n  i_star[j]=i\n  dL_star[j]=dL\n  dM_star[j]=dM\n  dR_star[j]=dR  \n}\n```\n:::\n\n\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\n# Load NumPy library\nimport numpy as np\n\n# Set the number of scenarios (including baseline)\nS = 6\n\n# Create arrays to store equilibrium solutions\nY_star = np.zeros(S)  # income/output\nD_star = np.zeros(S)  # (notional) credit-financed aggregate demand\nND_star = np.zeros(S)  # income-financed aggregate demand\nr_star = np.zeros(S)  # lending rate\nN_star = np.zeros(S)  # employment\nU_star = np.zeros(S)  # unemployment\nP_star = np.zeros(S)  # price level\nw_star = np.zeros(S)  # real wage\nW_star = np.zeros(S)  # nominal wage\ni_star = np.zeros(S)  # central bank rate\ndL_star = np.zeros(S)  # change in loans\ndM_star = np.zeros(S)  # change in bank deposits\ndR_star = np.zeros(S)  # change in bank reserves\n\n# Set exogenous variables that will be shifted\nc = np.zeros(S)  # share of credit demand that is accommodated\nd0 = np.zeros(S)  # autonomous component of debt-financed aggregate demand\nm = np.zeros(S)  # mark-up on lending rate\nn = np.zeros(S)  # mark-up on prices\na = np.zeros(S)  # productivity\n\n# Baseline parameterisation\nc[:] = 0.8\nd0[:] = 5\nm[:] = 0.15\nn[:] = 0.15\na[:] = 0.8\n\n# Construct scenarios\n# Scenario 2: increase in credit rationing\nc[1] = 0.4\n\n# Scenario 3: increase in autonomous demand\nd0[2] = 10\n\n# Scenario 4: increase in interest rate mark-up\nm[3] = 0.3\n\n# Scenario 5: increase in price mark-up\nn[4] = 0.3\n\n# Scenario 6: increase in productivity\na[5] = 0.4\n\n# Set constant parameter values\nb = 0.5  # propensity to spend out of income\nd1 = 0.8  # sensitivity of demand with respect to the interest rate\ni0 = 0.01  # discretionary component of central bank rate\ni1 = 0.5  # sensitivity of central bank rate with respect to the price level\nNf = 12  # full employment/labour force\nh = 0.8  # sensitivity of nominal wage with respect to unemployment\nk = 0.3  # desired reserve ratio\nW0 = 2  # exogenous component of nominal wage\n\n# Initialize endogenous variables at some arbitrary positive value\nY = D = ND = r = N = U = P = w = W = i = dL = dR = dM = 1\n\n# Iterate through the system\nfor j in range(S):\n    for iteration in range(1000):\n        # Model equations\n        Y = ND + c[j] * D\n        ND = b * Y\n        D = d0[j] - d1 * r\n        i = i0 + i1 * P\n        r = (1 + m[j]) * i\n        dL = c[j] * D\n        dM = dL\n        dR = k * dM\n        P = (1 + n[j]) * a[j] * W\n        W = W0 - h * U\n        w = 1 / ((1 + n[j]) * a[j])\n        N = a[j] * Y\n        U = (Nf - N) / Nf\n\n    # Save results for different parameterizations in the vectors\n    Y_star[j] = Y\n    D_star[j] = D\n    ND_star[j] = ND\n    r_star[j] = r\n    N_star[j] = N\n    U_star[j] = U\n    P_star[j] = P\n    w_star[j] = w\n    W_star[j] = W\n    i_star[j] = i\n    dL_star[j] = dL\n    dM_star[j] = dM\n    dR_star[j] = dR\n```\n:::\n\n\n:::\n\n### Plots\n\nFigures @fig-output-pkmacro - @fig-real-wage-pkmacro depict the response of the model's key endogenous variables to various shifts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(Y_star, ylab=\"Y\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                      \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Output](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-output-pkmacro-1.png){#fig-output-pkmacro width=672}\n:::\n:::\n\n\nAn increase in credit rationing (scenario 2) reduces deposit money creation as well as actual (as opposed to desired) aggregate demand. This drags down output and employment. The rise in unemployment reduces workers' nominal wage demands and thus the price level. The lending rate falls as the central bank reduces the policy rate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(P_star, ylab=\"P\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                      \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Price level](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-price-level-pkmacro-1.png){#fig-price-level-pkmacro width=672}\n:::\n:::\n\n\nAn increase in (debt-financed) autonomous demand (scenario 3) has expansionary effects on output and employment. The money stock accommodates through increased loan creation. The increase in workers' bargaining power leads to higher nominal wages and prices. The central bank reacts by raising the policy rate but this does not completely offset the expansionary effect.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(r_star, ylab=\"r\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                      \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Lending rate](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-lending-rate-pkmacro-1.png){#fig-lending-rate-pkmacro width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(dM_star, ylab=\"dM\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                        \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Deposit money creation](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-money-pkmacro-1.png){#fig-money-pkmacro width=672}\n:::\n:::\n\n\nIn scenarios 4 and 5, the interest rate (or bank) mark-up and the price (or firm) mark-up increase, respectively. The increase in the bank mark-up raises the lending rate, which has a contractionary effect. The increase in the firm mark-up raises the price level, which has a contractionary effect through the monetary policy response. Notably, the rise in the price mark-up reduces the real wage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(U_star*100, ylab=\"U (%)\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                              \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Unemployment rate](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-unemployment-pkmacro-1.png){#fig-unemployment-pkmacro width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(W_star, ylab=\"W\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                      \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Nominal wage](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-nominal-wage-pkmacro-1.png){#fig-nominal-wage-pkmacro width=672}\n:::\n:::\n\n\nFinally, an increase in productivity (scenario 6) reduces the price level, which induces a lower policy rate, leading to a small expansionary effect. However, it increases the unemployment rate as fewer workers are needed to produce the same level of output. This reduces the nominal wage, but raises the real wage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(w_star, ylab=\"w\", names.arg=c(\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\",\n                                      \"4:rise bank markup\",\"5:rise firm markup\", \"6:rise product.\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Real wage](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-real-wage-pkmacro-1.png){#fig-real-wage-pkmacro width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Plot results (here for output only)\nimport matplotlib.pyplot as plt\n\nscenario_names = [\"1:baseline\", \"2:rise credit rat.\", \"3:rise AD\", \"4:rise bank markup\", \"5:rise firm markup\", \"6:rise product\"]\n\n# Create a bar plot\nplt.bar(scenario_names, Y_star)\nplt.ylabel(\"Y\")\nplt.xticks(rotation=45, ha=\"right\")  # Rotate x-axis labels for better readability\nplt.tight_layout()  # Ensure the labels fit within the plot area\n\n# Show the plot\nplt.show()\n```\n:::\n\n\n:::\n\n## Directed graph\n\nAnother perspective on the model's properties is provided by its directed graph. A directed graph consists of a set of nodes that represent the variables of the model. Nodes are connected by directed edges. An edge directed from a node $x_1$ to node $x_2$ indicates a causal impact of $x_1$ on $x_2$. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create directed graph \n# Construct auxiliary Jacobian matrix for 18 variables: \n# r, Y, ND, D, i, P, W, w, N, U, dl, dM, dR, d0, c, m, a, n \n\nM_mat=matrix(c(0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,\n               0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,\n               0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,\n               0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,\n               0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,\n               0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,\n               0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,\n               0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0), 18, 18, byrow=TRUE)\n\n# Create adjacency matrix from transpose of auxiliary Jacobian \nA_mat=t(M_mat)\n\n# Create directed graph from adjacency matrix\nlibrary(igraph)\ndg= graph_from_adjacency_matrix(A_mat, mode=\"directed\", weighted= NULL)\n\n# Define node labels\nV(dg)$name=c(\"r\", \"Y\", \"ND\", \"D\", \"i\", \"P\", \"W\", \"w\", \"N\", \"U\", \"dL\", \"dM\", \"dR\", expression(d[0]), \"c\", \"m\", \"a\", \"n\")\n\n# Plot directed graph\nplot(dg, main=\"\", vertex.size=20, vertex.color=\"lightblue\", \n     vertex.label.color=\"black\", edge.arrow.size=0.3, edge.width=1.1, edge.size=1.2,\n     edge.arrow.width=1.2, edge.color=\"black\", vertex.label.cex=1.2, \n     vertex.frame.color=\"NA\", margin=-0.08)\n```\n\n::: {.cell-output-display}\n![Directed graph of post-Keynesian endogenous money model](a_post_keynesian_macro_model_with_endogenous_money_files/figure-html/fig-dg-pkmacro-2.png){#fig-dg-pkmacro width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n```{.python .cell-code}\n#Load relevant libraries\nimport networkx as nx\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Construct auxiliary Jacobian matrix for 18 variables\n#    r  Y ND  D  i  P  W  w  N  U  dL dM dR d0 c  m  a  n\n\nM_mat = np.array([[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0],\n               [0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0],\n               [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n               [1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],\n               [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1],\n               [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],\n               [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],\n               [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],\n               [0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n               [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]])\n\n    \n# Create adjacency matrix from transpose of auxiliary Jacobian and add column names\nA_mat = M_mat.transpose()\n\n# Create the graph from the adjacency matrix\nG = nx.DiGraph(A_mat)\n\n# Define node labels\nnodelabs = {0: \"r\", 1: \"Y\", 2: \"ND\", 3: \"D\", 4: \"i\", 5:\"P\", 6: \"W\", 7: \"w\", \n            8: \"N\", 9: \"U\", 10: \"dL\", 11: \"dM\", 12: \"dR\", 13: \"d0\", 14: \"c\", \n            15: \"m\", 16: \"a\", 17: \"n\"}\n\n# Plot the directed graph\npos = nx.spring_layout(G, seed=42)  \nnx.draw(G, pos, with_labels=True, labels=nodelabs, node_size=300, node_color='lightblue', \n        font_size=10)\nedge_labels = {(u, v): '' for u, v in G.edges}\nnx.draw_networkx_edge_labels(G, pos, edge_labels=edge_labels, font_color='black')\nplt.axis('off')\nplt.show()\n```\n:::\n\n\n:::\n\nIn Figure @fig-dg-pkmacro, it can be seen that credit rationing ($c$), productivity ($a$), the price mark-up ($n$), the interest rate mark-up ($m$), and autonomous demand ($d_0$), are the key exogenous variables of the model. All other variables are endogenous, and many of them form a closed loop (or cycle) within the system. The lower-right part of the graph captures the goods market: debt- and not debt-financed aggregate demand determine output. The outer right part depicts the endogenous money creation process: creditworthy debt-financed demand determines credit creation, which translates into deposit money creation. Bank reserves are a residual. The lower-left part of the graph represents the labour market. The goods market feeds into the labour market via employment, which determines nominal wages and the price level. The real wage is a residual. The price level feeds into interest rate determination in the upper part of the model, which establishes a causal feedback link from the labour market to the goods market. \n\n## Analytical discussion\n\nLike the Neoclassical Synthesis model, the post-Keynesian macro model can be represented as an AS-AD model. First, we will derive an IS and an interest-rate (IR) curve in the $(Y, r)$-space, the latter representing monetary policy and bank lending instead of the money market (the conventional LM curve). Then we obtain the AS-AD representation of the model in the $(Y,P)$-space. Finally, we obtain equilibrium solutions for $Y$ and $P$.\n\nTo obtain the IS-curve, substitute @eq-ND-PK and @eq-D-PK into @eq-Y-PK and solve for $Y$:\n\\begin{align}\\label{eq:IS}\\tag{IS}\nY&=\\left(\\frac{1}{1-b}\\right)\\Bigl[c(d_0 -d_1r)\\Bigr].\n\\end{align}\t\n\nTo obtain the IR-curve, substitute @eq-i-PK, @eq-P-PK, @eq-W-PK, @eq-N-PK, and @eq-U-PK into @eq-r-PK :\n\\begin{align}\\label{eq:IR}\\tag{IR}\nr&=\\left(1+m\\right)\\Bigl[i_0+i_1(1+n)a[W_0-h\\bigl(1-\\frac{aY}{N^f}\\bigr)]\\Bigr].\n\\end{align}\t\n\nIt can readily be seen that the IS-curve is downward-sloping and the IR-curve is upward-sloping in the $(Y, r)$-space\n\nTo obtain the AD-curve, substitute @eq-r-PK and @eq-i-PK into the IS-curve:\n\n\\begin{align}\\label{eq:AD}\\tag{AD}\nY&=\\left(\\frac{1}{1-b}\\right)\\Bigl[c(d_0 -d_1(1+m)(i_0+i_1P))\\Bigr].\n\\end{align}\t\n\nFinally, to obtain the AS-curve, substitute @eq-W-PK and @eq-U-PK into @eq-P-PK:\n\n\\begin{align}\\label{eq:AS}\\tag{AS}\nP&=\\left(1+n\\right)a\\Bigl[W_0-h\\bigl(1-\\frac{aY}{N^f}\\bigr)\\Bigr].\n\\end{align}\t\n\nIt can readily be seen that the AD-curve is downward-sloping in the $(Y, P)$-space, whereas the AS-curve is upward-sloping.\n\nFinally, by substituting the AS and AD curves into each other, we obtain the following equilibrium solutions for output and the price level:\n\n\\begin{align*}\nY^*&=\\frac{c\\{d_0-d_1(1+m)[i_0+i_1(1+n)a(W_0-h)]\\}}{1-b+cd_1(1+m)i_1(1+n)a^2h(N^f)^{-1}} \\\\\nP^*&=\\frac{(1+n)a[(1-b)(W_0-h)+ha(N^f)^{-1}c(d_0-d_1(1+m)i_0)]}{1-b+cd_1(1+m)i_1(1+n)a^2h(N^f)^{-1}}.\n\\end{align*}\n\n\n### Confirm analytical solutions numerically\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### Confirm equilibrium solution for Y*  (baseline)\n# Analytical solution\n(c[1]*(d0[1] -d1*(1+m[1])*(i0+i1*(1+n[1])*a[1]*(W0-h))))/(1-b +c[1]*d1*(1+m[1])*i1*(1+n[1])*(a[1]^2)*h*(Nf^-1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.922735\n```\n\n\n:::\n\n```{.r .cell-code}\n# Numerical solution\nY_star[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.922735\n```\n\n\n:::\n\n```{.r .cell-code}\n### Confirm equilibrium solution for P*  (baseline)\n# Analytical solution\n((1+n[1])*a[1]*((W0-h)*(1-b)+(Nf^-1)*h*a[1]*c[1]*(d0[1]-d1*(1+m[1])*i0[1])))/(1-b +c[1]*d1*(1+m[1])*i1*(1+n[1])*(a[1]^2)*h*(Nf^-1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.443676\n```\n\n\n:::\n\n```{.r .cell-code}\n# Numerical solution\nP_star[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.443676\n```\n\n\n:::\n:::\n\n\n\n## References {-}\n",
    "supporting": [
      "a_post_keynesian_macro_model_with_endogenous_money_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}