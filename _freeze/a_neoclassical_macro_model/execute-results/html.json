{
  "hash": "82c51090776c6d0f409120e191c8f274",
  "result": {
    "engine": "knitr",
    "markdown": "# A Neoclassical Macro Model {#sec-neoclassical-model}\n\n## Overview\n\nThis model captures some key features of neoclassical macroeconomics. The model is based on the optimising behaviour of firms and households that interact in perfect markets. Households choose between labour and leisure as well as current and future consumption. They form (rational) expectations about their future income that impact their consumption decisions today. Firms are owned by households and maximise profits using a constant returns to scale technology (with diminishing marginal returns to factors of production). Markets are competitive and clear instantaneously through flexible prices. The most important market is the labour market, in which the equilibrium between firms' demand and households' supply of labour is established by a flexible real wage. The level of employment established on the labour market then determines aggregate supply via the production function. Aggregate demand always accommodates to aggregate supply via a flexible real interest rate that establishes an equilibrium between investment and saving (often interpreted as the market for loanable funds). The money supply is exogenous in this model and only impacts the price level but not the real economy -- the so-called _Classical Dichotomy_ (or neutrality of money). Government expenditures do influence the real economy but they crowd out private expenditures (through a mechanism called _Ricardian Equivalence_).\n\nIn this short- to medium-run version of the model, prices are flexible but the capital stock is fixed. The focus is thus on goods market equilibrium rather than economic growth. As all endogenous variables adjust instantaneously, the model is thus static. However, expectations about future income and government spending will impact current consumption of households that intertemporally maximise utility. The model is adapted from @Garin2021.\n\n## The Model\n\n$$\nY=AK^aN^{1-a}, \\quad a\\in (0,1)\n$$ {#eq-Y_NC}\n\n$$\nw=(1-a)AK^aN^{-a}\n$$ {#eq-w_NC}\n\n$$\nN= 1-\\frac{b_1}{w}, \\quad b_1>0\n$$ {#eq-N_NC} \n\n$$\nC=c_1\\left[Y- G +\\frac{Y^f-G^f}{1+r} -c_2\\ln\\left(\\frac{b_1}{w}\\right)\\right]\n$$ {#eq-C_NC}  \n\n$$\nI =\\left(\\frac{aAN^{1-a}}{r}\\right)^{\\frac{1}{1-a}}\n$$ {#eq-I_NC}\n\n$$\nG= G_0\n$$ {#eq-G_NC}\n\n$$\nY= C(r) + I(r) + G\n$$ {#eq-Y_eq_NC}\n\n$$\nr_n= r + \\pi^f\n$$ {#eq-rn_NC}\n\n$$\nM_s=M_0\n$$ {#eq-MS_NC}\n\n$$\nM_d=\\frac{b_3(1+r_n)PC}{r_n}\n$$ {#eq-MD_NC}\n\n$$\nM = M_d(P)= M_s\n$$ {#eq-M_eq_NC} \n\n\nwhere $Y$, $K$, $N$, $w$, $C$, $G$, $r$, $I$, $r_n$, $\\pi$, $M_s$, $M_d$, and $P_t$ are real output, the capital stock, employment, the real wage, consumption, government expenditures, the real interest rate, investment, the nominal interest rate, inflation, the money supply, money demand, and the price level, respectively. The $f$-superscript denotes (expected) future values. For simplicity, expected future variables will be treated as exogenous.\n\nBy @eq-Y_NC, output is determined by a Cobb-Douglass production function with constant returns to scale and diminishing marginal returns to each factor (capital and labour). @eq-w_NC is the labour demand of firms solved for the real wage. Profit maximising firms will hire workers until the real wage is equal to the marginal product of labour $\\left(\\frac{\\partial Y}{\\partial N}=(1-a)AK^aN^{-a}\\right)$.^[See the analytical discussion below for a derivation of equations @eq-w_NC -@eq-I_NC and @eq-MD_NC from optimising microfoundations.] @eq-N_NC specifies households' labour supply, which is positively related to the real wage. By @eq-C_NC, consumption is positively related to the real wage, current and (expected) future income,^[Households are assumed to form rational expectations. In a deterministic setting, this implies perfect foresight so that expected and actual future income coincide.] and negatively related to the real interest rate. The composite parameters $c_1= \\left(\\frac{1}{1+b_2+b_3}\\right)$ and $c_2= b_1(b_2+b_3)$ stem from the weights in the household's utility function (see analytical discussion below). The consumption function implies that for a higher real interest rate, households increase their saving (the supply of loanable funds). Furthermore, consumption is negatively related to current and future government expenditures. This is an implication of consumption smoothing: as households know that governments will have to repay its debts in the future through higher taxes, an increase in government expenditures today is perceived as an increase in taxes (regardless of whether the government finances its current expenditures through taxes or debt, a result that is also called 'Ricardian Equivalence').^[See the analytical discussion below for more details on Ricardian Equivalence.] @eq-I_NC specifies investment as a negative function of the real interest rate and a positive function of productivity. By @eq-G_NC, government expenditures are exogenous. @eq-Y_eq_NC is the goods market equilibrium condition, which pins down the equilibrium real interest rate through the market for loanable funds. @eq-rn_NC specifies the nominal interest rate using the well-known Fisher equation. @eq-MS_NC says that the money supply is exogenous. By @eq-MD_NC, households' money demand is negatively related to the nominal interest rate and positively related to consumption (capturing the transaction demand for money). Finally, @eq-M_eq_NC is the equilibrium condition for the money market, which pins down the price level.\n\n## Simulation\n\n### Parameterisation\n\nTable 1 reports the parameterisation used in the simulation. Besides a baseline (labelled as scenario 1), five further scenarios will be considered. Scenarios 2 and 3 are a monetary expansion (increase in the exogenous money supply $M_0$) and fiscal expansion (increase in $G_0$), respectively. Scenario 4 is an improvement in total factor productivity ($A$) and scenario 5 a fall in expected future income ($Y^f$). Finally, scenario 6 is a shift in household preferences towards more leisure ($b_1$). \n\n**Table 1: Parameterisation**\n\n| Scenario | $A$ | $a$ | $b_{1}$ | $b_{2}$ | $b_{3}$ | $G_{0}$ | $Y^{f}$ | $M_{0}$ | $K$ | $\\pi_{f}$ |\n| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |\n| 1: baseline | 2 | 0.3 | 0.4 | 0.9 | 0.6 | 1 | 1 | 5 | 5 | 0.02 |\n| 2: monetary expansion ($M_{0}$) | 2 | 0.3 | 0.4 | 0.9 | 0.6 | 1 | 1 | 6 | 5 | 0.02 |\n| 3: fiscal expansion ($G_{0}$) | 2 | 0.3 | 0.4 | 0.9 | 0.6 | 2 | 1 | 6 | 5 | 0.02 |\n| 4: productivity boost ($A$) | 2.5 | 0.3 | 0.4 | 0.9 | 0.6 | 1 | 1 | 5 | 5 | 0.02 |\n| 5: lower expected future income ($Y^{f}$) | 2 | 0.3 | 0.4 | 0.9 | 0.6 | 1 | 0.2 | 5 | 5 | 0.02 |\n| 6: increased preference for leisure ($b_{1}$) | 2 | 0.3 | 0.8 | 0.9 | 0.6 | 1 | 1 | 5 | 5 | 0.02 |\n\n\n### Simulation code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clear the environment\nrm(list=ls(all=TRUE))\n\n# Set number of scenarios (including baseline)\nS=6\n\n#Create vector in which equilibrium solutions from different parameterisations will be stored\nY_star=vector(length=S) # Income/output\nw_star=vector(length=S) # Real wage\nC_star=vector(length=S) # Consumption\nI_star=vector(length=S) # Investment\nr_star=vector(length=S) # Real interest rate\nrn_star=vector(length=S) # Nominal interest rate\nN_star=vector(length=S) # Employment\nP_star=vector(length=S) # Price level\n\n# Create and parameterise exogenous variables/parameters that will be shifted\nM0=vector(length=S) # money supply\nG0=vector(length=S) # government expenditures\nA=vector(length=S)  # productivity\nYf=vector(length=S) # expected future income\nb1=vector(length=S) # household preference for leisure\nM0[]=5\nG0[]=1\nA[]=2\nYf[]=1\nb1[]=0.4\n\n# Set parameter values for different scenarios\nM0[2]=6   # scenario 2: monetary expansion \nG0[3]=2   # scenario 3: fiscal expansion\nA[4]=2.5  # scenario 4: productivity boost\nYf[5]=0.2 # scenario 5: lower expected future income\nb1[6]=0.8 # scenario 6: increased preference for leisure\n\n#Set constant parameter values\na=0.3  # Capital elasticity of output\nb2=0.9 # discount rate\nb3=0.6 # household preference for money\nK=5    # Exogenous capital stock\npe=0.02 # Expected rate of inflation\nGf=1  # Future government spending\n\n# Initialise endogenous variables at arbitrary positive value\nw = C = I = Y = r = N = P = 1 \n\n#Solve this system numerically through 1000 iterations based on the initialisation\nfor (i in 1:S){\n  \nfor (iterations in 1:1000){\n  \n  #Model equations\n  \n  #(1) Cobb-Douglass production function  \n  Y = A[i]*(K^a)*N^(1-a)\n  \n  #(2) Labour demand \n  w = A[i]*(1-a)*(K^a)*N^(-a) \n  \n  #(3) Labour supply\n  N = 1 - (b1[i])/w\n  \n  #(4) Consumption demand\n  C = (1/(1+b2+b3))*(Y - G0[i] + (Yf[i]-Gf)/(1+r) -b1[i]*(b2+b3)*log(b1[i]/w))\n   \n  #(5) Investment demand, solved for r\n  r=(I^(a-1))*a*A[i]*N^(1-a) \n   \n  #(6) Goods market equilibrium condition, solved for I\n  I = Y - C - G0[i]\n  \n  #(7) Nominal interest rate\n  rn = r + pe\n  \n  #(8) Price level\n  P = (M0[i]*rn)/((1+rn)*b3*C) \n\n}\n  \n#Save results for different parameterisations in vector\nY_star[i]=Y\nw_star[i]=w\nC_star[i]=C\nI_star[i]=I\nr_star[i]=r\nN_star[i]=N\nP_star[i]=P\nrn_star[i]=rn\n}\n```\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\n\n# Set the number of scenarios (including baseline)\nS = 6\n\n# Create arrays to store equilibrium solutions from different parameterizations\nY_star = np.empty(S)  # Income/output\nw_star = np.empty(S)  # Real wage\nC_star = np.empty(S)  # Consumption\nI_star = np.empty(S)  # Investment\nr_star = np.empty(S)  # Real interest rate\nrn_star = np.empty(S)  # Nominal interest rate\nN_star = np.empty(S)  # Employment\nP_star = np.empty(S)  # Price level\n\n# Create and parameterize exogenous variables/parameters that will be shifted\nM0 = np.zeros(S)  # Money supply\nG0 = np.zeros(S)  # Government expenditures\nA = np.zeros(S)   # Productivity\nYf = np.zeros(S)  # Expected future income\nb1 = np.zeros(S)  # Household preference for leisure\n\n# Baseline parameterisation\nM0[:] = 5\nG0[:] = 1\nA[:] = 2\nYf[:] = 1\nb1[:] = 0.4\n\n# Set parameter values for different scenarios\nM0[1] = 6   # Scenario 2: monetary expansion\nG0[2] = 2   # Scenario 3: fiscal expansion\nA[3] = 2.5  # Scenario 4: productivity boost\nYf[4] = 0.2  # Scenario 5: lower expected future income\nb1[5] = 0.8  # Scenario 6: increased preference for leisure\n\n# Set constant parameter values\na = 0.3  # Capital elasticity of output\nb2 = 0.9  # Discount rate\nb3 = 0.6  # Household preference for money\nK = 5  # Exogenous capital stock\npe = 0.02  # Expected rate of inflation\nGf = 1  # Future government spending\n\n# Initialize endogenous variables at arbitrary positive values\nw = C = I = Y = r = N = P = 1 \n\n# Solve this system numerically through 1000 iterations based on the initialization\nfor i in range(S):\n    for iterations in range(1000):\n        # Model equations\n\n        # (1) Cobb-Douglas production function\n        Y = A[i] * (K**a) * N**(1-a)\n\n        # (2) Labour demand\n        w = A[i] * (1-a) * (K**a) * N**(-a)\n\n        # (3) Labour supply\n        N = 1 - (b1[i]) / w\n\n        # (4) Consumption demand\n        C = (1 / (1 + b2 + b3)) * (Y - G0[i] + (Yf[i] - Gf) / (1 + r) - b1[i] * (b2 + b3) * np.log(b1[i] / w))\n\n        # (5) Investment demand, solved for r\n        r = (I**(a-1)) * a * A[i] * N**(1-a)\n\n        # (6) Goods market equilibrium condition, solved for I\n        I = Y - C - G0[i]\n\n        # (7) Nominal interest rate\n        rn = r + pe\n\n        # (8) Price level\n        P = (M0[i] * rn) / ((1 + rn) * b3 * C)\n\n    # Save results for different parameterizations in the arrays\n    Y_star[i] = Y\n    w_star[i] = w\n    C_star[i] = C\n    I_star[i] = I\n    r_star[i] = r\n    N_star[i] = N\n    P_star[i] = P\n    rn_star[i] = rn\n```\n:::\n\n\n:::\n\n### Plots\n\nFigures @fig-output-neocl - @fig-employment-neocl depicts the model economy's real activity under different scenarios. Monetary expansions (scenario 2) have no effects on output and employment, capturing the idea of money neutrality (Classical Dichotomy). However, the monetary expansion does  raise the price level (see @fig-price_level ), capturing the key idea of the Quantity Theory of Money that inflation is driven by a growing money supply.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(Y_star, ylab=\"Y\", names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Output](a_neoclassical_macro_model_files/figure-html/fig-output-neocl-1.png){#fig-output-neocl width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(P_star, ylab=\"P\",  names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Price level](a_neoclassical_macro_model_files/figure-html/fig-price_level-1.png){#fig-price_level width=672}\n:::\n:::\n\n\nAn increase in government spending (by one unit) in scenario 3 does *not* raise employment and real output as these are fully determined by the supply side rather than aggregate demand.^[This result is partly driven by the use of a non-separable utility function, see analytical discussion below. With a separable utility function, the increase in government spending would increase labour supply and thereby have effects on employment and output.] Looking at Figures @fig-consumption and @fig-investment, it can be seen that government spending crowds out private spending (consumption and investment). The decrease in consumption is a result of consumption smoothing via the Euler equation: the household anticipates higher taxes in the future and reduces current consumption somewhat to smooth out the impact. The increase in government expenditures also raises demand for loanable funds, which pushes up the real interest rate (see @fig-interest_rate) and reduces investment (@fig-investment) and consumption. There is also an inflationary effect linked to the higher real interest rate, which raises the nominal interest rate and reduces the demand for money. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(N_star, ylab=\"N\",  names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Employment](a_neoclassical_macro_model_files/figure-html/fig-employment-neocl-1.png){#fig-employment-neocl width=672}\n:::\n:::\n\n\nImprovements to the supply-side are captured by an increase in productivity (scenario 4), which raises real output, employment, and aggregate demand. In contrast to expansionary government policy, the price level falls.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(C_star, ylab=\"C\",  names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Consumption](a_neoclassical_macro_model_files/figure-html/fig-consumption-1.png){#fig-consumption width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(I_star, ylab=\"I\",  names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Investment](a_neoclassical_macro_model_files/figure-html/fig-investment-1.png){#fig-investment width=672}\n:::\n:::\n\n\nA decrease in expected future income (scenario 5) has a small expansionary effect on aggregate output. This is because households will reduce some of their current consumption (see @fig-consumption ) and supply more labour to smooth their consumption over time. The increase in saving reduces the real interest rate (see @fig-interest_rate ) and is compensated by an increase in investment (see @fig-investment ). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarplot(r_star, ylab=\"r\", names.arg=c(\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\",\"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"), cex.names = 0.6)\n```\n\n::: {.cell-output-display}\n![Interest rate](a_neoclassical_macro_model_files/figure-html/fig-interest_rate-1.png){#fig-interest_rate width=672}\n:::\n:::\n\n\nFinally, an increase in the preference for leisure (scenario 6) reduces labour supply and thereby output.\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Plot results (here for output only)\nimport matplotlib.pyplot as plt\n\nscenario_names = [\"1: Baseline\", \"2: Increase in M0\", \"3: Increase in G0\", \n                  \"4: Increase in A\", \"5: Decrease in Yf\", \"6: Increase in b1\"]\n\n# Output\nplt.bar(scenario_names , Y_star)\nplt.ylabel('Y')\nplt.xticks(rotation=45, ha=\"right\")  # Rotate x-axis labels for better readability\nplt.tight_layout()  # Ensure the labels fit within the plot area\nplt.show()\n```\n:::\n\n\n:::\n\n\n## Directed graph\n\nAnother perspective on the model's properties is provided by its directed graph. A directed graph consists of a set of nodes that represent the variables of the model. Nodes are connected by directed edges. An edge directed from a node $x_1$ to node $x_2$ indicates a causal impact of $x_1$ on $x_2$. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create directed graph\n# Construct auxiliary Jacobian matrix for 13 variables: \n# Y\tw\tN\tC\tI\tr\tP\trn M0\tG0 A Yf Md\n# where non-zero elements in regular Jacobian are set to 1 and zero elements are unchanged\n\nM_mat=matrix(c(0,0,1,0,0,0,0,0,0,0,1,0,0,\n              0,0,1,0,0,0,0,0,0,0,1,0,0,\n              0,1,0,0,0,0,0,0,0,0,0,0,0,\n              1,1,0,0,0,1,0,0,0,1,0,1,0,\n              0,0,1,0,0,1,0,0,0,0,0,0,0,\n              1,0,0,1,1,0,0,0,0,1,0,0,0,\n              0,0,0,0,0,0,0,0,1,0,0,0,1,\n              0,0,0,0,0,1,0,0,0,0,0,0,0,\n              0,0,0,0,0,0,0,0,0,0,0,0,0,\n              0,0,0,0,0,0,0,0,0,0,0,0,0,\n              0,0,0,0,0,0,0,0,0,0,0,0,0,\n              0,0,0,0,0,0,0,0,0,0,0,0,0,\n              0,0,0,1,0,0,1,1,0,0,0,0,0), 13, 13, byrow=TRUE)\n\n# Create adjacency matrix from transpose of auxiliary Jacobian \nA_mat=t(M_mat)\n\n# Create directed graph from adjacency matrix\nlibrary(igraph)\ndg= graph_from_adjacency_matrix(A_mat, mode=\"directed\", weighted= NULL)\n\n# Define node labels\nV(dg)$name=c(\"Y\",\"w\",\"N\",\"C\",\"I\",\"r\",\"P\", expression(r[n]), expression(M[0]),expression(G[0]),\"A\",expression(Y^f), expression(M[d]))\n\n# Plot directed graph\nplot(dg, main=\"\", vertex.size=20, vertex.color=\"lightblue\", \n     vertex.label.color=\"black\", edge.arrow.size=0.3, edge.width=1.1, edge.size=1.2,\n     edge.arrow.width=1.2, edge.color=\"black\", vertex.label.cex=1.2, \n     vertex.frame.color=\"NA\", margin=-0.08)\n```\n\n::: {.cell-output-display}\n![Directed graph](a_neoclassical_macro_model_files/figure-html/fig-dg-2.png){#fig-dg width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Python code\"}\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Load relevant libraries\nimport networkx as nx\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Construct the auxiliary Jacobian matrix\nM_mat = np.array([\n    [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],\n    [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],\n    [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0],\n    [0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],\n    [1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1],\n    [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0]\n])\n\n# Create adjacency matrix from transpose of auxiliary Jacobian and add column names\nA_mat = M_mat.transpose()\n\n# Create the graph from the adjacency matrix\nG = nx.DiGraph(A_mat)\n\n# Define node labels\nnodelabs = {\n    0: \"Y\",\n    1: \"w\",\n    2: \"N\",\n    3: \"C\",\n    4: \"I\",\n    5: \"r\",\n    6: \"P\",\n    7: r\"$r_n$\",\n    8: r\"$M_0$\",\n    9: r\"$G_0$\",\n    10: \"A\",\n    11: r\"$Y^f$\",\n    12: r\"$M_d$\"\n}\n\n# Plot the directed graph\npos = nx.spring_layout(G, seed=42)  \nnx.draw(G, pos, with_labels=True, labels=nodelabs, node_size=300, node_color='lightblue', \n        font_size=10)\nedge_labels = {(u, v): '' for u, v in G.edges}\nnx.draw_networkx_edge_labels(G, pos, edge_labels=edge_labels, font_color='black')\nplt.axis('off')\nplt.show()\n```\n:::\n\n\n:::\n\nIn @fig-dg , it can be seen that productivity ($A$), future income ($Y^f$), the money supply ($M_0$), and government spending ($G_0$) are the key exogenous variables of the model. All other variables are endogenous, and many of them form a closed loop (or cycle) within the system. The left part of the graph captures the supply side: the labour market simultaneously pins down the real wage and employment, which together with the exogenously level of productivity determine output. The part in the middle embodies the demand side: aggregate demand (consumption, investment, and government spending) together with a given level of output determine the real interest rate. The right part captures the nominal side of the model given by the money market, which determines the price level. Notably, while the real side of the model feeds into the money market via the nominal interest rate ($r_n$), there is not causal effect from the money market to the real side reflecting the Classical Dichotomy. \n\n## Analytical discussion: derivation of behavioural functions\n\n### The firm's problem: profit maximisation\n\nThe firm's profit equation is given by:\n\n$$\n\\Pi=Y-w N-r k\n$$ {#eq-Pi}\n\n$$\n=A K^a N^{1-a}-w N-r k .\n$$ {#eq-Pi2}\n\nThe firm's optimisation problem is to maximise profits using employment and capital as choice variables:^[See @Garin2021[chap. 12] for a more elaborate version where the firm maximises its lifetime value. The resulting investment function is very similar.]\n\n$$\n\\max _{N, K} \\Pi=A K^a N^{1-a}-w N-r k .\n$$ {#eq-Pi3}\n\nThe first-order conditions are given by:\n\n$$\n(1-a) A K^a N^{-a}-w=0\n$$ {#eq-FOC_Nd}\n\n$$\na A K^{a-1} N^{1-a}-r=0 .\n$$ {#eq-FOC_I}\n\nFrom @eq-FOC_Nd, @eq-w_NC for labour demand can be derived. While the capital stock is pre-determined in every period, the firm can adjust the capital stock through investment. We thus use the first-order condition for capital @eq-FOC_I to derive @eq-I_NC for investment demand.\n\n### The government's budget constraint\n\nThe government's current and future budget constraints are given by:\n\n$$\nG=T+B\n$$ {#eq-Gbc}\n\n$$\nG^f=T^f-(1+r) B\n$$ {#eq-Gf}\nwhere $T$ is tax revenues and $B$ is government debt. \n\nA crucial assumption here is that the government must repay its debts in the future (it cannot permanently roll over its debts). The underlying assumption is that the government will eventually 'die' and will do so without savings nor debt. \n\nCombining the two budget constraints to an intertemporal budget constraint yields:\n\n$$\nG+\\frac{G^f}{1+r}=T+\\frac{T^f}{1+r}\n$$ {#eq-Gitbc}\n\nThus, while the government's budget need not be balanced in every period, it will be balanced over time (in a present value sense).^[See @Garin2021[chap. 13] for a more detailed discussion of the government's budget constraints.]\n\n### The household's problem: intertemporal utility maximisation\tand Ricardian Equivalence\t\n\nThe household derives utility from current consumption, leisure ($1-N$), future consumption $C^f$, and from holding real money balances $\\left(\\frac{M}{P}\\right)$. We use the following log utility function that is non-separable in consumption and leisure:^[See @Garin2021, pp.280-289), on the differences between a separable and a non-separable preference specification. Note also that for simplicity, the utility function omits the utility from future leisure.]\n\n$$\nU=\\ln [C+ b_1 \\ln (1-N)]+b_2 \\ln \\left(C^f\\right)+b_3 \\ln \\left(\\frac{M}{P}\\right), \\quad b_2\\in (0,1); b_1, b_3>0\n$$ {#eq-U}\n\nThe household's current budget constraint is given by:^[See @Garin2021[chap. 14] for a more detailed discussion of the household's budget constraints.]\n\n$$\nC=Y-T-S-\\frac{M}{P}\n$$ {#eq-Hbc}\n\nThe income that is not consumed can either be saved ($S$) at nominal interest rate ($r_n$) or held as money on which no return is earned.\n\nThe future budget constraint (assuming that households do not save in the future) is given by:\n\n$$\nC^f = Y^f - T^f + (1+r_n)\\frac{PS}{P^f} + \\frac{M}{P^f}.\n$$ {#eq-Cf}\n\nUsing the Fisher equation $(1+r)=(1+r_n)\\frac{P}{P^f}$, the future budget constraint can be rewritten as:\n\n$$\nC^f = Y^f  - T^f + (1+r)S + \\frac{(1+r)M}{(1+r_n)P}\n$$ {#eq-Cf2}\n\nFinally, the two budget constraints can be combined to yield an intertemporal budget constraint:\n\n$$\nC^f = (Y-C-T)(1+r)+Y^f -T^f - (1+r)\\frac{r_nM}{(1+r_n)P}.\n$$ {#eq-Hbcit}\n\nSubstituting the government's intertemporal budget constraint, the household's intertemporal budget constraint can also be written as: \n\n$$\nC^f = (Y-C-G)(1+r)+Y^f -G^f - (1+r)\\frac{r_nM}{(1+r_n)P}\n$$ {#eq-ibc}\n\nThe fact that current and future tax payments are now replaced by current and future government spending means that it does not matter for the real economy how government spending is financed: the private sector will react to expenditures that are financed out of debt in the same way it reacts to expenditures financed out of taxation. This result is also known as _Ricardian Equivalence_. Put differently, Ricardian Equivalence means the household behaves as if the government balances its budget in every period. \n\nWith these ingredients, the household's optimisation problem can be written as:\n\n$$\n\\begin{array}{ll}\n\\max _{C, N, M} & U=\\ln (C+b_1 \\ln (1-N))+b_2 \\ln \\left(C^f\\right)+b_3 \\ln \\left(\\frac{M}{P}\\right), \\\\\n\\text { s.t. } & C^f= (Y-C-G)(1+r)+Y^f -G^f - (1+r)\\frac{r_nM}{(1+r_n)P} .\n\\end{array}\n$$\n\nSubstituting the constraint @eq-ibc for $C^f$ in the utility function, and making use of the identity $Y=\\Pi+rK+Nw$, allows to obtain the following first-order conditions:\n\n$$\nC=\\frac{C^f}{b_2(1+r)} - b_1\\ln(1-N)\n$$ {#eq-FOC_C}\n\n$$\n\\left(\\frac{b_1}{1-N}\\right)\\left(\\frac{1}{C+b_1\\ln(1-N)} \\right)=\\frac{b_2(1+r)w}{C^f}\n$$ {#eq-FOC_Ns}\n\n$$\nM=\\frac{b_3PC^f(1+r_n)}{b_2(1+r)r_n} .\n$$ {#eq-FOC_M}\n\nSubstituting @eq-FOC_C, which is often also called the _Euler equation_, into @eq-FOC_Ns and @eq-FOC_M yields @eq-N_NC for labour supply and @eq-MD_NC for money demand, respectively. Finally, using @eq-ibc and @eq-FOC_M in the Euler @eq-FOC_C yields the consumption function @eq-C_NC.\n\n\n## References {-}\n",
    "supporting": [
      "a_neoclassical_macro_model_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}