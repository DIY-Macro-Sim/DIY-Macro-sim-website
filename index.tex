% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={DIY Macroeconomic Model Simulation},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{DIY Macroeconomic Model Simulation}
\author{}
\date{}

\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\chapter*{Welcome}\label{welcome}
\addcontentsline{toc}{chapter}{Welcome}

\markboth{Welcome}{Welcome}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-warning-color!10!white, colframe=quarto-callout-warning-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-warning-color}{\faExclamationTriangle}\hspace{0.5em}{Warning}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

This website is under construction and will be regularly updated and
extended.

\end{tcolorbox}

This platform provides an open source code repository and online script
for macroeconomic model simulation. It follows a ``do-it-yourself''
(DIY) approach, empowering users to numerically simulate key
macroeconomic models on their own using the open-source programming
languages \emph{R} and \emph{Python}. Whether you are a university
teacher, student, researcher, or an economics enthusiast, our platform
offers resources to deepen your understanding of both macroeconomic
modelling and coding.

The platform covers an array of macroeconomic models, including
canonical textbook models, models from different economic paradigms, and
seminal models from the history of economic thought. It bridges a gap
between intermediate and advanced level macroeconomics by providing
detailed yet accessible treatments of seminal macroeconomic models. Most
intermediate macroeconomics textbooks focus on graphical analysis, while
advanced level materials are often more mathematical and less
accessible. Our platform offers a hands-on and approachable resource for
users to build both a solid foundation in modelling and macroeconomic
intuition.

The platform's DIY-approach aims to foster reproducibility and
open-source principles in macroeconomic research and education by
providing learning materials that are freely available and modifiable by
everyone. The platform's content will expand over time through new
entries added by the project team.

\section*{Project team}\label{project-team}
\addcontentsline{toc}{section}{Project team}

\markright{Project team}

\begin{figure}

\begin{minipage}{0.50\linewidth}

\includegraphics[width=0.5\textwidth,height=\textheight]{franz.jpeg}

\subcaption{\label{}Franz Prante}
\end{minipage}%
%
\begin{minipage}{0.50\linewidth}

\includegraphics[width=0.61\textwidth,height=\textheight]{karsten.png}

\subcaption{\label{}Karsten Kohler}
\end{minipage}%

\end{figure}%

\begin{figure}

\begin{minipage}{0.50\linewidth}
\href{https://fprante.me/}{Franz} is a research associate at Chemnitz
University of Technology, where he is currently working on the
macroeconomic effects of monetary policy and price effects on energy
demand. He is also a PhD student at Université Sorbonne Paris
Nord.\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\href{https://karstenkohler.com/}{Karsten} is an Associate Professor in
Economics at Leeds University Business School, where he does research on
the interaction between finance and the real economy, especially sources
of cyclical dynamics, instability, and rising inequality.\end{minipage}%

\end{figure}%

\section*{Contact}\label{contact}
\addcontentsline{toc}{section}{Contact}

\markright{Contact}

We welcome any feedback. If you encounter any issues, find typos or
mistakes, or have questions/thoughts on the content, please do get in
touch.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  If you are Github user, you can
  \href{https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new}{report
  an issue} in our repository
\item
  You can also email us directly:
  \texttt{franz.prante@wiwi.tu.chemnitz.de} and
  \texttt{k.kohler@leeds.ac.uk}
\end{enumerate}

\section*{License}\label{license}
\addcontentsline{toc}{section}{License}

\markright{License}

The material on this page is licensed under
\href{https://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1}{CC
BY-NC 4.0}, thus feel free to use the material for non-commercial
purposes but please give credit.

\section*{Acknowledgements}\label{acknowledgements}
\addcontentsline{toc}{section}{Acknowledgements}

\markright{Acknowledgements}

We are grateful for helpful comments from Adam Aboobaker, Chandni
Dwarkasing, Giuseppe Fontana, Alex Guschanski, Eckhard Hein, Grégoire
Noël, and Rafael Wildauer on various sections of this website. All
errors are ours.

\bookmarksetup{startatroot}

\chapter{Getting Started}\label{sec-how-to-use}

\section{Structure of platform}\label{structure-of-platform}

The platform starts off with a general introduction the numerical
simulation of economic models (Chapter~\ref{sec-how-to-simulate}). After
that, it jumps right into a series of macroeconomic models. These models
are grouped into static and dynamic models. In static models, time plays
no role and all variables adjust instantaneously. By contrast, dynamic
models characterise the adjustment of variables over time.

The model entries are largely self-contained and can be read
independently of each other. For each model, the chapters provide three
main components:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Model descriptions} that concisely explain the key ideas,
  assumptions, and equations of each model. This helps users grasp the
  underlying concepts and intuition behind the models.
\item
  \textbf{Annotated code} that allows users to numerically simulate the
  models, examine their results under different scenarios, and produce
  visualisations to better understand the models' structure and output.
  This hands-on approach enables users to gain practical coding skills
  while exploring different macroeconomic theories.
\item
  \textbf{Analytical discussions} for users who are interested in
  delving deeper into the mathematical properties of the models.
\end{enumerate}

To further facilitate the understanding of dynamic models,
Chapter~\ref{sec-stab_analysis} of the section on dynamic models begins
with a general introduction into the mathematical analysis of dynamic
models (this is mostly relevant for the analytical discussions of
dynamic models).

All simulation codes are written in the open-source programming
languages \emph{R} and \emph{Python}. \emph{R} codes are presented in
the main text (and images and results in the text are the output of the
shown \emph{R} codes), while the corresponding \emph{Python} codes are
available by clicking on the callout blocks underneath the \emph{R}
codes.

\section{\texorpdfstring{Access and introduction to \emph{R} and
\emph{Python}}{Access and introduction to R and Python}}\label{access-and-introduction-to-r-and-python}

To be able to manipulate the codes on this platform on your own machine,
you first need to
\href{https://rstudio-education.github.io/hopr/starting.html}{download
and install \emph{R} and \emph{RStudio}}. For Python, there are
different options. One of them is to download and install \emph{Spyder}
via the \href{https://www.anaconda.com/download}{Anaconda Python
distribution}. \emph{Spyder} provides an interface for \emph{Python}
(like \emph{RStudio} for \emph{R}). If you install it via
\emph{Anaconda}, it will install \emph{Python} automatically.

Besides being free, a key advantage of both \emph{R} and \emph{Python}
is their huge and growing functionality due to new user-written
libraries and packages continuously being added. In addition, a large
amount of learning material is freely available on the web,
e.g.~\href{https://education.rstudio.com/learn/beginner/}{here} and
\href{https://www.w3schools.com/r/default.asp}{here} for \emph{R} and
\href{https://www.python.org/about/gettingstarted/}{here}, and
\href{https://www.w3schools.com/python/python_intro.asp}{here} for
\emph{Python}. However, to get started in can be best to directly delve
into some of the codes on this platform and learn by doing. To this end,
the following ``cheatsheets'' that provide a concise overview of key
functions are useful:

\begin{itemize}
\item
  \href{https://posit.co/wp-content/uploads/2022/10/rstudio-ide-1.pdf}{R
  Studio Cheatsheet}
\item
  \href{https://iqss.github.io/dss-workshops/R/Rintro/base-r-cheat-sheet.pdf}{Base
  R Cheatsheet}
\item
  \href{https://posit.co/resources/cheatsheets/}{more R cheatsheets
  here}
\item
  \href{https://res.cloudinary.com/dyd911kmh/image/upload/v1694526244/Marketing/Blog/Python_Basics_Cheat_Sheet-updated.pdf}{Python
  Basics Cheatsheet}
\item
  \href{https://s3.amazonaws.com/assets.datacamp.com/blog_assets/PythonForDataScience.pdf}{Python
  for Data Science Cheatsheet}
\item
  \href{https://assets.datacamp.com/blog_assets/Numpy_Python_Cheat_Sheet.pdf}{Python
  Cheatsheet for NumPy library}
\end{itemize}

Once you have installed \emph{R} or \emph{Python}, you can play with the
codes on this platform yourself by copy and pasting them into the script
panel of your local interface (IDE) and hitting CTRL + Enter to execute
them. Don't forget to always comment your code using the ``\#'' symbol
and to save your scripts to make sure your future self can seamlessness
continue working on it.

The codes below covers some basic operations.\footnote{We are grateful
  to Rafael Wildauer for permission to reproduce a slightly modified
  version of his learning materials. In addition, some of the material
  below is taken from
  \href{https://www.w3schools.com/r/default.asp}{here}.} If you are new
to \emph{R} or \emph{Python} and keen to get started, do the following:

\begin{itemize}
\tightlist
\item
  copy the codes below into the script panel of \emph{RStudio} or
  \emph{Spyder} on your machine
\item
  adjust the working directory to your personal folder
\item
  then run the code
\item
  make sure you understand what it does
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# R Basics \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\#In the R script you write code and comments}
  \CommentTok{\#any line starting with \# is a comment and it is NOT executed}

\DocumentationTok{\#\# First things first: set the working directory to the the folder in which your R files are stored using: setwd("C:/")}
\CommentTok{\# note that you need to separate folders by slashes /}

\CommentTok{\#Let\textquotesingle{}s define some variables}
\NormalTok{s }\OtherTok{=} \FloatTok{0.05}
\NormalTok{Y }\OtherTok{=} \DecValTok{10}

\CommentTok{\#We can also assign several variables the same value at once}
\NormalTok{C }\OtherTok{=}\NormalTok{ I }\OtherTok{=}\NormalTok{ R }\OtherTok{=} \DecValTok{2}

\CommentTok{\#For displaying them we simply call the name of the object and execute the relevant line}
\NormalTok{Y}
\NormalTok{C}

\CommentTok{\#We can define new variables using existing ones}
\NormalTok{W }\OtherTok{=}\NormalTok{ Y }\SpecialCharTok{{-}}\NormalTok{ R}
\NormalTok{W}

\CommentTok{\#R has a vast amount of built in functions, for example}
\FunctionTok{max}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{100}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{)}
\FunctionTok{sqrt}\NormalTok{(}\DecValTok{9}\NormalTok{)}
\FunctionTok{abs}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{13}\NormalTok{)}

\CommentTok{\#you can find out more about these by using the help function, e.g.:?max()}

\CommentTok{\#How can you delete stuff? Use the remove function rm()}
\CommentTok{\#for individual objects}
\FunctionTok{rm}\NormalTok{(Y)}
\CommentTok{\#if you want to remove everything}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\#You can also assign text (a string) to a variable}
\NormalTok{text1 }\OtherTok{=} \StringTok{\textquotesingle{}Reggaeton\textquotesingle{}}
\NormalTok{text2 }\OtherTok{=} \StringTok{"Bad Bunny"}
\CommentTok{\#note "text" is the same as \textquotesingle{}text\textquotesingle{} and a string can contain spaces}
\CommentTok{\#You use the paste function to combine strings}
\FunctionTok{paste}\NormalTok{(text1, text2)}

\CommentTok{\#R uses standard operators like +, {-}, *}
\CommentTok{\#for exponents use \^{}}
\DecValTok{3}\SpecialCharTok{\^{}}\DecValTok{2}


\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# if statements and loops \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\#sometimes we need to introduce if conditions into our code}
\CommentTok{\#The syntax is}
\CommentTok{\#if condition \{ do something \}}
\NormalTok{a }\OtherTok{=} \DecValTok{10}
\NormalTok{b }\OtherTok{=} \DecValTok{13}
\ControlFlowTok{if}\NormalTok{ (b}\SpecialCharTok{\textgreater{}}\NormalTok{a) \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"b is bigger"}\NormalTok{)}
\NormalTok{\}}
\CommentTok{\#we can also tell R what to do in case the condition is not fulfilled}
\NormalTok{b}\OtherTok{=}\DecValTok{10}
\ControlFlowTok{if}\NormalTok{ (b}\SpecialCharTok{\textgreater{}}\NormalTok{a) \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"b is bigger"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"b not bigger"}\NormalTok{)}
\NormalTok{\}}


\CommentTok{\#Next we will look at loops which are a key tool to repeat tasks such as solving}
\CommentTok{\#a theoretical model again and again to find its equilibrium.}
\CommentTok{\#The basic structure is:}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(i)}
\NormalTok{\}}

\CommentTok{\#Let\textquotesingle{}s use it to solve a simple Keynesian cross model of the form}
\CommentTok{\#Y=C+I}
\CommentTok{\#C=c0+c1Y}
\CommentTok{\#Define exogenous parameters}
\NormalTok{c0}\OtherTok{=}\DecValTok{2}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.8}
\NormalTok{I}\OtherTok{=}\DecValTok{10}
\CommentTok{\#set initial values for two endogenous variable}
\NormalTok{Y}\OtherTok{=}\NormalTok{C}\OtherTok{=}\DecValTok{1}
\CommentTok{\#Use a for loop to solve it}
\NormalTok{C}
\NormalTok{Y}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{)\{}
\NormalTok{  Y }\OtherTok{=}\NormalTok{ C}\SpecialCharTok{+}\NormalTok{I}
\NormalTok{  C }\OtherTok{=}\NormalTok{ c0}\SpecialCharTok{+}\NormalTok{c1}\SpecialCharTok{*}\NormalTok{Y}
\NormalTok{\}}
\NormalTok{C}
\NormalTok{Y}
\CommentTok{\#solution is Y=(I+c0)/(1{-}c1)=60}

\CommentTok{\#What is special about this loop is that it uses the values from the previous iteration}
\CommentTok{\#to define the values of the next, because it starts with assigning a value to Y}
\CommentTok{\#and then uses that value to assign a new value to C and in the next iteration it}
\CommentTok{\#uses this new value for C to define a new value for Y etc.}


\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Data structures \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#In most applications we produce outputs which do not consist of a single number.}
\CommentTok{\#Often we have an entire stream of results, or we want to analyse data and have to store larger amounts of data}
\CommentTok{\#R has a variety of data structures for this purpose.}
\CommentTok{\#let\textquotesingle{}s clean up first}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\DocumentationTok{\#\#\#\#Vectors }
\CommentTok{\#We can create an empty vector and fill it later (with results of our model for example)}
\NormalTok{vec1 }\OtherTok{=} \FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\DecValTok{3}\NormalTok{)}
\CommentTok{\#we can define vectors explicitly using the c() function (c for column?)}
\NormalTok{vec2 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\NormalTok{vec3 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\CommentTok{\#we can also use the sequence operator}
\NormalTok{vec4 }\OtherTok{=} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\CommentTok{\#and we can define the step size}
\NormalTok{vec5 }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\FloatTok{0.1}\NormalTok{)}
\NormalTok{vec5}
\CommentTok{\#we can call specific entries using square brackets}
\NormalTok{vec5[}\DecValTok{4}\NormalTok{]}
\CommentTok{\#if we want to access more elements at once}
\NormalTok{vec5[}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{1}\NormalTok{)]}

\DocumentationTok{\#\#\#\#Matrices}
\CommentTok{\#define a matrix: 3 rows and 2 columns, all elements equal to 0}
\NormalTok{mat1 }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{2}\NormalTok{)}
\NormalTok{mat1}
\CommentTok{\#we can also fill it with specific values}
\NormalTok{mat2 }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{mat2}
\CommentTok{\#access specific elements (columns,rows)}
\NormalTok{mat2[}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\CommentTok{\#access entire rows or columns}
\NormalTok{mat2[,}\DecValTok{1}\NormalTok{]}
\NormalTok{mat2[}\DecValTok{1}\NormalTok{,]}
\CommentTok{\#access sub matrices}
\NormalTok{mat2[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{),]}
\DocumentationTok{\#\# Combine two column vectors in a matrix}
\NormalTok{mat3}\OtherTok{=}\FunctionTok{cbind}\NormalTok{(vec1, vec2)}
\NormalTok{mat3}
\DocumentationTok{\#\# Combine two row vectors in a matrix}
\NormalTok{mat4}\OtherTok{=}\FunctionTok{rbind}\NormalTok{(vec1, vec2)}
\NormalTok{mat4}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Python Basics \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\#In the Python script you write code and comments}
\CommentTok{\#any line starting with \# is a comment and it is NOT executed}

\CommentTok{\#\# First things first: set the working directory to the the folder }
\CommentTok{\# in which your Python files are stored using: }
\CommentTok{\# import os}
\CommentTok{\# os.setcwd("C:/yourworkingdirectory")}
\CommentTok{\# note that you need to separate folders by slashes /}

\CommentTok{\# Most of what we will do relies on the library NumPy}
\CommentTok{\# Let\textquotesingle{}s load NumPy and call its commands by the prefix .np}

\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np }

\CommentTok{\#Let\textquotesingle{}s define some variables}
\NormalTok{s }\OperatorTok{=} \FloatTok{0.05}
\NormalTok{Y }\OperatorTok{=} \DecValTok{10}

\CommentTok{\#We can also assign several variables the same value at once}
\NormalTok{C }\OperatorTok{=}\NormalTok{ I }\OperatorTok{=}\NormalTok{ R }\OperatorTok{=} \DecValTok{2}

\CommentTok{\#For displaying them we simply call the name of the object and }
\CommentTok{\# execute the relevant line}
\NormalTok{Y}
\NormalTok{C}

\CommentTok{\#We can define new variables using existing ones}
\NormalTok{W }\OperatorTok{=}\NormalTok{ Y }\OperatorTok{{-}}\NormalTok{ R}
\NormalTok{W}

\CommentTok{\#Python/Numpy has a vast amount of built in functions, for example}
\BuiltInTok{max}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{100}\NormalTok{, }\OperatorTok{{-}}\DecValTok{3}\NormalTok{)}
\NormalTok{np.sqrt(}\DecValTok{9}\NormalTok{)}
\BuiltInTok{abs}\NormalTok{(}\OperatorTok{{-}}\DecValTok{13}\NormalTok{)}

\CommentTok{\#you can find out more about these by using the help function, }
\CommentTok{\#e.g.: help(max)}

\CommentTok{\#How can you delete stuff? Use the del function}
\CommentTok{\#for individual objects}
\KeywordTok{del}\NormalTok{ Y, C, I, R}

\CommentTok{\#You can also assign text (a string) to a variable}
\NormalTok{text1 }\OperatorTok{=} \StringTok{\textquotesingle{}Reggaeton\textquotesingle{}}
\NormalTok{text2 }\OperatorTok{=} \StringTok{"Bad Bunny"}
\BuiltInTok{print}\NormalTok{(text1 }\OperatorTok{+} \StringTok{\textquotesingle{} \textquotesingle{}} \OperatorTok{+}\NormalTok{ text2)}

\CommentTok{\#Python uses standard operators like +, {-}, *}
\CommentTok{\#for exponents use **}
\DecValTok{3}\OperatorTok{**}\DecValTok{2}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# if statements and loops \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\#sometimes we need to introduce if conditions into our code}
\CommentTok{\#The syntax is}
\CommentTok{\#if condition xxx:}
    \CommentTok{\#do something    }
\NormalTok{a }\OperatorTok{=} \DecValTok{10}
\NormalTok{b }\OperatorTok{=} \DecValTok{13}
\ControlFlowTok{if}\NormalTok{ b }\OperatorTok{\textgreater{}}\NormalTok{ a:}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"b is bigger"}\NormalTok{)}
    
\CommentTok{\#we can also define what to do in case the condition is not fulfilled}
\NormalTok{b }\OperatorTok{=} \DecValTok{10}
\ControlFlowTok{if}\NormalTok{ b }\OperatorTok{\textgreater{}}\NormalTok{ a:}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"b is bigger"}\NormalTok{)}
\ControlFlowTok{else}\NormalTok{:}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"b not bigger"}\NormalTok{)}

\CommentTok{\#Next we will look at loops which are a key tool to repeat tasks such as solving}
\CommentTok{\#a theoretical model to find its equilibrium.}
\CommentTok{\#The basic structure is:}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{6}\NormalTok{):}
    \BuiltInTok{print}\NormalTok{(i)}
\CommentTok{\# Note the key role played by indentation!}

\CommentTok{\#Let\textquotesingle{}s use it to solve a simple Keynesian cross model of the form}
\CommentTok{\#Y=C+I}
\CommentTok{\#C=c0+c1Y}

\CommentTok{\#Define exogenous parameters and initialise endogenous variables}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{2}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.8}
\NormalTok{I }\OperatorTok{=} \DecValTok{10}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=} \DecValTok{1}

\CommentTok{\#Use a for loop that iterates the equations 100 times to solve them}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{100}\NormalTok{):}
\NormalTok{    Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ I}
\NormalTok{    C }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ Y}

\NormalTok{Y}
\CommentTok{\#correct solution is Y=(I+c0)/(1{-}c1)=60}

\CommentTok{\#The loop uses the values from the previous iteration}
\CommentTok{\#to calculate the values of the next, because it starts with assigning a value }
\CommentTok{\#to Y and then uses that value to assign a new value to C, and in the next}
\CommentTok{\# iteration it uses this new value for C to define a new value for Y etc.}


\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# Data structures \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#In most applications we produce outputs which do not consist of a single number.}
\CommentTok{\#Often we have an entire stream of results, or we want to analyse data and have }
\CommentTok{\# to store larger amounts of data. }
\CommentTok{\# Python/Numpy has a variety of data structures for this purpose.}


\CommentTok{\#\#\# Vectors}
\CommentTok{\#We can create an vector of size 3 with only zeros and fill it later }
\CommentTok{\# (with results of our model for example). Importantly, unlike R, Python starts}
\CommentTok{\# counting the elements in vector at 0 rather than 1}
\NormalTok{vec1 }\OperatorTok{=}\NormalTok{ np.zeros((}\DecValTok{3}\NormalTok{)) }
\CommentTok{\#we can define vectors explicitly }
\NormalTok{vec2 }\OperatorTok{=}\NormalTok{ np.array([}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{])}
\NormalTok{vec3 }\OperatorTok{=}\NormalTok{ np.array([}\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{])}
\CommentTok{\#we can also use the sequence operator}
\NormalTok{vec4 }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{1}\NormalTok{, }\DecValTok{11}\NormalTok{)}
\CommentTok{\#and we can define the step size}
\NormalTok{vec5 }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{0.1}\NormalTok{)}
\CommentTok{\#we can call specific entries using square brackets {-}{-} note how Python starts }
\CommentTok{\# counting at 0}
\NormalTok{vec2[}\DecValTok{2}\NormalTok{]}
\CommentTok{\#if we want to access more elements at once}
\NormalTok{vec2[}\DecValTok{0}\NormalTok{:}\DecValTok{3}\NormalTok{]}

\CommentTok{\#\#\# Matrices}
\CommentTok{\#define a matrix: 3 rows and 2 columns, all elements equal to 0}
\NormalTok{mat1 }\OperatorTok{=}\NormalTok{ np.zeros((}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\CommentTok{\#we can also fill it with specific values}
\NormalTok{mat2 }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{], [}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{], [}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{]])}

\CommentTok{\#access specific elements (columns,rows)}
\NormalTok{mat2[}\DecValTok{2}\NormalTok{, }\DecValTok{0}\NormalTok{]}
\CommentTok{\#access entire rows or columns}
\NormalTok{mat2[:, }\DecValTok{0}\NormalTok{]}

\CommentTok{\#\# Combine two column vectors in a matrix}
\NormalTok{mat3 }\OperatorTok{=}\NormalTok{ np.column\_stack((vec1, vec2))}
\CommentTok{\#\# Combine two row vectors in a matrix}
\NormalTok{mat4 }\OperatorTok{=}\NormalTok{ np.row\_stack((vec1, vec2))}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Simple exercise}\label{simple-exercise}

If you further want to practice your coding skills, attempt the
following exercises:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Write a loop which calculates the running sum of \(x_i=\frac{1}{i^2}\)
  by saving each element \(\sum_{i=1}^{j}x_i\) in a vector (where
  \(j=1,2,..,10\)).
\end{enumerate}

If your code is correct, you should get the solution:

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-tip-color!10!white, colframe=quarto-callout-tip-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Solution}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{verbatim}
 [1] 1.000000 1.250000 1.361111 1.423611 1.463611 1.491389 1.511797 1.527422
 [9] 1.539768 1.549768
\end{verbatim}

\end{tcolorbox}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Write a loop which calculates the running sums of
  \(x_i=\frac{1}{i^2}\) (as in exercise 1) and in addition also
  \(y_i=\frac{1}{i^3}\). Combine the results in a matrix.
\end{enumerate}

If your code is correct, you should get the solution:

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-tip-color!10!white, colframe=quarto-callout-tip-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Solution}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{verbatim}
             x        y
 [1,] 1.000000 1.000000
 [2,] 1.250000 1.125000
 [3,] 1.361111 1.162037
 [4,] 1.423611 1.177662
 [5,] 1.463611 1.185662
 [6,] 1.491389 1.190292
 [7,] 1.511797 1.193207
 [8,] 1.527422 1.195160
 [9,] 1.539768 1.196532
[10,] 1.549768 1.197532
\end{verbatim}

\end{tcolorbox}

\bookmarksetup{startatroot}

\chapter{How to Simulate Economic Models}\label{sec-how-to-simulate}

\section{Introduction: economic
models}\label{introduction-economic-models}

Why do we build formal economic models? Because they help us think
carefully about the \emph{causal mechanisms} that generate certain
economic outcomes (e.g.~unemployment). Models are especially useful when
the variables of interest are inherently quantitative (e.g.~the interest
rate and unemployment) and when several of these quantitative variables
interact with each other. More specifically, models provide a precise
formal representation of a set of \emph{interlinked} causal mechanisms
that are often difficult to analyse informally.

Every economic model essentially consist of three things:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  a set of \(N\) equations
\item
  a set of \(N\) endogenous variables
\item
  a set of exogenous or fixed coefficients (`parameters') and exogenous
  variables
\end{enumerate}

The solution to the model, its `equilibrium', will pin down values for
the endogenous variables of the model for a given set of parameters and
exogenous variables. Thus, the endogenous variables, e.g.~unemployment,
are determined within the system, while exogenous variables are
determined outside of the system and often reflect policy variables,
such as the central bank interest rate. The equations connect the
variables of the system. They typically express:

\begin{itemize}
\item
  economic (accounting) identities (e.g.~that in a closed economy
  without government, saving is income that is not consumed: \(S=Y-C\))
\item
  budget constraints (e.g.~that business investment can be financed out
  of retained profits and new debt, \(I=\Pi+\Delta D\))
\item
  behavioural functions (e.g.~that households consume a constant
  proportion of their income, \(C=c_1Y\)), which often contain key
  parameters of the model (e.g.~the marginal propensity to consume
  \(c_1\))
\item
  equilibrium conditions (e.g.~that demand must be equal to supply)
\end{itemize}

Equations may be linear or nonlinear. If a model contains nonlinear
relationships between the endogenous variables, it may admit more than
one solution (often called multiple equilibria).

Economic models can be either static or dynamic. In a static model, time
plays no role and all endogenous variables are determined
simultaneously. In a dynamic model, time matters and the endogenous
variables adjust gradually over time.

The endogenous variables are typically interrelated: e.g.~\(x\)
determines \(y\), but \(y\) also determines \(x\). These
interrelationships can be:

\begin{itemize}
\item
  simultaneous: \(x\) and \(y\) determine each other simultaneously
  (within the same period)
\item
  recursive: \(x\) affects \(y\) only in \(t+1\) (or vice versa)
\end{itemize}

Unlike static models, dynamic models describe what happens out of
equilibrium.\footnote{That raises the question of whether an equilibrium
  is stable or unstable, which is discussed in
  Chapter~\ref{sec-stab_analysis}.} Note that dynamic models may contain
both simultaneous and recursive relationships.

Whether the relationships between the variables is simultaneous or
recursive has implications for how the model can be solved. In general,
simple economic models can often be solved analytically without a
computer. If the model contains simultaneous relationships, it needs to
be solved as a simultaneous system by solving for the endogenous
variables through repeated substitution. This means going from the
so-called `structural form', i.e.~the full set of equations, to the
so-called `reduced form', where the right-hand side of the equations
only contains exogenous variables and parameters. If the system is
linear, techniques from linear algebra such as matrix inversion or
Cramer's rule can be used (see Chiang and Wainwright (2005), chaps.
4-5). If the system contains recursive relationships, the equilibrium
solution can be found by setting \(x_{t+i}=x_{t-i}=x_{t}\) for all \(x\)
and then solving the resulting simultaneous system (more on this
Chapter~\ref{sec-stab_analysis}).

However, often a complete analytical solution is difficult to come by.
Common challenges are:

\begin{itemize}
\item
  a model has more than 3 dimensions (\(N>3\)): then it's very tedious
  to compute analytical solutions
\item
  a model has nonlinearities that preclude the computation of analytical
  solutions
\item
  a model is dynamic and you want to examine the dynamic adjustment of
  the endogenous variables (which is tedious to do analytically)
\end{itemize}

In these cases, numerical solution by means of computer simulation
becomes useful. A key advantage is that it allows you to study much more
complex models than the analytical approach does. A key disadvantage is
that numerical solution requires the choice of a (possibly arbitrary)
set of numerical values for the models' parameters. It is thus less
general than analytical solution -- a limitation which should be borne
in mind. We think that both analytical and numerical approaches are
useful. Correspondingly, we supplement the numerical simulations with
analytical model solutions where possible.

\section{Solving economic models
numerically}\label{solving-economic-models-numerically}

If a (dynamic) model exclusively contains recursive relationships, it
can be solved iteratively by sequentially updating the endogenous
variables from (arbitrarily set) initial conditions. This is easy to do
with a computer. By contrast, if interrelationships are simultaneous,
solving the system for the endogenous variables as described above is
less trivial for a computer (finding the solution for \(x\) requires the
solution of \(y\), but the latter requires in turn the solution for
\(x\)). One approach is to use linear algebra: cast the system in matrix
form (\(b=Ax\)) and let the computer find \(x^*=A^{-1}b\) through some
algorithm
(e.g.~\href{https://en.wikipedia.org/wiki/Gauss\%E2\%80\%93Seidel_method}{the
Gauss-Seidel method}).

We will use an approach that is simpler and based on \emph{iteration}:

\begin{itemize}
\item
  choose a set of numerical parameter values (e.g.~\(c_1=0.8\))
\item
  choose (arbitrary but non-zero) initial values for the endogenous
  variables (e.g.~\(C_0=1)\)
\item
  then solve the system of equations many times using a \emph{for loop}
\end{itemize}

In this way, the solution gets approximated successively.

A limitation of the method of iteration is that it will only converge to
the solution of the simultaneous component of a model if the equilibrium
is stable (more on stability in Chapter~\ref{sec-stab_analysis}). For
most static models, stability is required for the model to be
economically meaningful. In that sense, if the iterative approach does
not yield a solution, this is a sign that the model and/or
parameterisation needs to be reconsidered. In dynamic models, stability
is a key question that should be addressed in any case. Therefore, this
limitation of the method of iteration may not be too restrictive in
practice.

\subsection{Solving economic models numerically:
examples}\label{solving-economic-models-numerically-examples}

\subsubsection{A static model}\label{a-static-model}

Consider a two-dimensional simultaneous system represented by a simple
Keynesian goods market model:

\[
Y= C + I_0
\] \[
C = c_0 + c_1Y
\] In a closed economy without government, aggregate demand is composed
of consumption \(C\) and investment \(I\), with the latter assumed to be
exogenous. Goods market equilibrium requires aggregate demand to be
equal to aggregate income \(Y\). Consumption is assumed to be determined
by an autonomous component \(c_0\) and a marginal propensity to consume
out of income \(c_1\).

Suppose the parameters are given by \(c_0=3\) and \(c_1=0.8\). You are
interested in how a change in investment from \(I_0=5\) to \(I_0=6\)
affects the solution of the system. Through the method of substitution,
we can easily derive that \(Y^*=\frac{c_0+I_0}{1-c_1}\). The code below
shows how to find this solution via simulation.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Simulate Keynesian goods market model via iteration}

\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of parameterisations that will be considered}
\NormalTok{S}\OtherTok{=}\DecValTok{2}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{3}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.8}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}
\NormalTok{C\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}

\CommentTok{\#Create vector with parameter that will change }
\NormalTok{I0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}
\NormalTok{I0[}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{5}
\NormalTok{I0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\DecValTok{6}

\CommentTok{\# Initialise endogenous variables at arbitrary positive value }
\NormalTok{Y}\OtherTok{=}\NormalTok{C}\OtherTok{=}\DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \ControlFlowTok{for}\NormalTok{ (iteration }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  Y }\OtherTok{=}\NormalTok{ C }\SpecialCharTok{+}\NormalTok{ I0[i]}
\NormalTok{  C }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{Y}
\NormalTok{  \} }\CommentTok{\# close iterations loop}
  
\CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{Y\_eq[i]}\OtherTok{=}\NormalTok{Y}
\NormalTok{C\_eq[i]}\OtherTok{=}\NormalTok{C}
\NormalTok{\} }\CommentTok{\# close parameterisations loop}

\CommentTok{\# Display solutions}
\NormalTok{Y\_eq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 40 45
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{C\_eq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 35 39
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Verify solutions for Y}
\NormalTok{(c0}\SpecialCharTok{+}\NormalTok{I0[])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 40 45
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Simulate Keynesian goods market model via iteration}

\CommentTok{\# Load NumPy library}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set the number of parameterisations that will be considered}
\NormalTok{S }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{3}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.8}

\CommentTok{\# Create numpy arrays in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{C\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}

\CommentTok{\# Create a numpy array with the parameter that will change}
\NormalTok{I0 }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{I0[}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{5}
\NormalTok{I0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Initialize endogenous variables at an arbitrary positive value}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iteration }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ I0[i]}
\NormalTok{        C }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ Y}

    \CommentTok{\# Save results for different parameterisations in the numpy arrays}
\NormalTok{    Y\_eq[i] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    C\_eq[i] }\OperatorTok{=}\NormalTok{ C}

\CommentTok{\# Display solutions}
\NormalTok{Y\_eq}
\NormalTok{C\_eq}

\CommentTok{\# Verify solutions for Y}
\NormalTok{(c0}\OperatorTok{+}\NormalTok{I0)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Let's break this code down a little bit:

\begin{itemize}
\item
  set the number of scenarios \(S\), define parameter values, and create
  vectors of length \(S\) in which the results for the endogenous
  variables will be stored
\item
  define changes in exogenous variables or parameters (i.e.~construct
  different scenarios)
\item
  initialise the endogenous variables
\item
  write down the equations (solved for the endogenous variables such
  that every endogenous variable of the system appears on the left-hand
  side of an equation exactly once)
\item
  place these equations inside a \emph{for loop}

  \begin{itemize}
  \tightlist
  \item
    the loop says: repeat the segment of code insights the curly
    brackets 1000 times
  \end{itemize}
\item
  nest the loop that solves the system in an outer loop that loops
  through different parameterisations (here for \(I_0\))
\item
  after the iterations loop is finished, save the results for the
  current pameterisation
\end{itemize}

What happens is the following: in the first iteration, \(Y\) and \(C\)
are calculated based on the initial values and the parameter values. In
the second iteration, the values are then overwritten based on the
results from the first iteration. This process continues 1000 times. In
this way, the correct solution is successively approximated. If you have
an analytical solution, you can compare it with the numerical one to
double-check your results.

When does the method of iteration fail to provide a solution? In the
following code, everything is the same with the only difference that the
marginal propensity to consume is now larger than unity (\(c_1=1.2\)).
Now the numerical simulation fails to find the solution. This is because
with \(c_1>0\), the so-called Keynesian equilibrium condition is
violated and the system happens to be unstable. We will discuss in
Chapter~\ref{sec-stab_analysis} the issue of stability and how to
analyse it formally. At this point, we simply note that the method of
iterations requires static models to be stable to yield equilibrium
solutions.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Parameterisation for which method of iteration fails}

\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of parameterisations that will be considered}
\NormalTok{S}\OtherTok{=}\DecValTok{2}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{3}
\NormalTok{c1}\OtherTok{=}\FloatTok{1.2}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}
\NormalTok{C\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}

\CommentTok{\#Create vector with parameter that will change }
\NormalTok{I0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}
\NormalTok{I0[}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{5}
\NormalTok{I0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\DecValTok{6}

\CommentTok{\# Initialise endogenous variables at arbitrary positive value }
\NormalTok{Y}\OtherTok{=}\NormalTok{C}\OtherTok{=}\DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \ControlFlowTok{for}\NormalTok{ (iteration }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  Y }\OtherTok{=}\NormalTok{ C }\SpecialCharTok{+}\NormalTok{ I0[i]}
\NormalTok{  C }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{Y}
\NormalTok{  \} }\CommentTok{\# close iterations loop}
  
\CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{Y\_eq[i]}\OtherTok{=}\NormalTok{Y}
\NormalTok{C\_eq[i]}\OtherTok{=}\NormalTok{C}
\NormalTok{\} }\CommentTok{\# close parameterisations loop}

\CommentTok{\# Display solutions}
\NormalTok{Y\_eq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  5.818655e+80 8.832196e+159
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Verify solutions for Y}
\NormalTok{(c0}\SpecialCharTok{+}\NormalTok{I0[])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -40 -45
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Parameterisation for which method of iteration fails}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{1.2}  

\CommentTok{\# Initialize endogenous variables at an arbitrary positive value}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iteration }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ I0[i]}
\NormalTok{        C }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ Y}

    \CommentTok{\# Save results for different parameterisations in the numpy arrays}
\NormalTok{    Y\_eq[i] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    C\_eq[i] }\OperatorTok{=}\NormalTok{ C}

\CommentTok{\# Display solutions for Y\_eq}
\NormalTok{Y\_eq}

\CommentTok{\# Verify solutions for Y}
\NormalTok{(c0}\OperatorTok{+}\NormalTok{I0)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsubsection{A dynamic model (in discrete
time)}\label{a-dynamic-model-in-discrete-time}

Consider now a dynamic version of the Keynesian goods market model that
was proposed by Paul Samuelson (1939). In this model, investment (\(I\))
becomes endogenous and reacts to the change in consumption. Aggregate
demand now also contains government spending (\(G\)), which is assumed
to be exogenous. Consumption (\(C\)) responds to changes in income
(\(Y\)) with a lag:

\[
Y_t = C_t + I_t + G_0
\] \[
I_t = \beta(C_t - C_{t-1})
\] \[
C_t=c_1Y_{t-1}.
\] This is a dynamic model, in which the endogenous variables adjust
gradually over time. However, the model is not purely recursive as
investment reacts to consumption in the same period (and output to
consumption and investment). By shifting \(Y_t=C_t + I_t + G_0\) one
period back, substitution into the consumption, and then investment
function, the system can be reduced to two equations that are fully
recursive:

\[
C_t= c_1(C_{t-1} + I_{t-1} + G_0)
\] \[
I_t= \beta[c_1(C_{t-1} + I_{t-1} + G_0) - C_{t-1}]
\] We can find the solution for output analytically by setting
\(x_t=x_{t-1}\) for all variables and then applying the method of
substitution. This yields \(Y^*=\frac{G_0}{1-c_1}\). The code below
shows how to find this solution through simulation.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Simulate Samuelson 1939}

\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods for which you want to simulate}
\NormalTok{Q}\OtherTok{=}\DecValTok{100}

\CommentTok{\# Set number of parameterisations that will be considered}
\NormalTok{S}\OtherTok{=}\DecValTok{2}

\CommentTok{\# Set period in which shock or shift in an will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{15}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.8}
\NormalTok{beta}\OtherTok{=}\FloatTok{0.6}

\CommentTok{\# Construct (S x Q) matrices in which values for different periods will be stored; initialise at 1}
\NormalTok{C}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}
\NormalTok{I}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Construct matrices for exogenous variable or parameter that will change over time to capture different scenarios}
\NormalTok{G0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{G0[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{6}     \CommentTok{\# scenario: permanent increase in government spending from I0=5 to I0=6 from period s=15 onwards}

\CommentTok{\#Solve this system recursively based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
\NormalTok{    C[i,t] }\OtherTok{=}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{(C[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ G0[i,t])}
\NormalTok{    I[i,t] }\OtherTok{=}\NormalTok{ beta}\SpecialCharTok{*}\NormalTok{(c1}\SpecialCharTok{*}\NormalTok{(C[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ G0[i,t]) }\SpecialCharTok{{-}}\NormalTok{ C[i,t}\DecValTok{{-}1}\NormalTok{])}
\NormalTok{  \} }\CommentTok{\# close time loop}
\NormalTok{\}   }\CommentTok{\# close scenarios loop}

\CommentTok{\# Calculate output}
\NormalTok{Y}\OtherTok{=}\NormalTok{C}\SpecialCharTok{+}\NormalTok{G0}\SpecialCharTok{+}\NormalTok{I}

\CommentTok{\# Display solution}
\NormalTok{Y[,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 25 30
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Verify solutions for Y}
\NormalTok{(G0[,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 25 30
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Simulate Samuelson 1939}

\CommentTok{\# Set the number of periods for which you want to simulate}
\NormalTok{Q }\OperatorTok{=} \DecValTok{100}

\CommentTok{\# Set the number of parameterisations that will be considered}
\NormalTok{S }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# Set the period in which a shock or shift in \textquotesingle{}an\textquotesingle{} will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{15}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.8}
\NormalTok{beta }\OperatorTok{=} \FloatTok{0.6}

\CommentTok{\# Construct (S x Q) matrices in which values for different periods will be stored; initialize at 1}
\NormalTok{C }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{I }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}

\CommentTok{\# Construct matrices for exogenous variables or parameters that will change }
\CommentTok{\# over time to capture different scenarios, initialise at 5}
\NormalTok{G0 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}\OperatorTok{*}\DecValTok{5} 

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{G0[}\DecValTok{1}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{6}  \CommentTok{\# scenario: permanent increase in government spending from I0=5 to I0=6 from period s=15 onwards}

\CommentTok{\# Solve this system recursively based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
\NormalTok{        C[i, t] }\OperatorTok{=}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ (C[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ G0[i, t])}
\NormalTok{        I[i, t] }\OperatorTok{=}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (c1 }\OperatorTok{*}\NormalTok{ (C[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ G0[i, t]) }\OperatorTok{{-}} 
\NormalTok{                          C[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}

\CommentTok{\# Calculate output}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ G0 }\OperatorTok{+}\NormalTok{ I}

\CommentTok{\# Display the solutions at time Q}
\NormalTok{Y[:, Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}

\CommentTok{\# Verify solutions for Y}
\NormalTok{(G0[:,Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The code solves the recursive system numerically through iteration.
Let's again break down what the code does:

\begin{itemize}
\item
  set the number of periods for which we want to simulate the model
  (here \(Q=100\)), set the number of scenarios \(S\) and the period
  \(s\) in which a change in the scenario should occur
\item
  set the parameter values and create \((S \times Q)\) matrices in which
  the results for the endogenous variables will be stored, such that the
  columns represent time and the rows represent different scenarios;
  initialise the endogenous variables
\item
  define changes in exogenous variables or parameters (i.e.~construct
  different scenarios)
\item
  write down the equations (solved for the endogenous variables such
  that every endogenous variable of the system appears on the left-hand
  side of an equation exactly once)
\item
  place these equations inside a \emph{for loop} that runs from \(t=2\)
  to \(Q\)

  \begin{itemize}
  \tightlist
  \item
    the loop says: repeat the segment of code insights the curly
    brackets, each time with the index number \(t\) shifted by \(+1\)
    until \(t=Q\)
  \end{itemize}
\item
  nest the loop that solves the system in an outer loop that loops
  through different parameterisations (here for \(G_0\))
\end{itemize}

Note that due to the exclusive presence of recursive equations, no loop
is need that iterates the equations within every period. However, many
dynamic models contain both simultaneous and recursive equations. In
this case, a third loop inside the time loop is needed that iterates the
equations within each period so as to solve the simultaneous equations.
Otherwise, the approach to solving dynamic systems is not fundamentally
different from the one for static systems.

At the end of the simulation run, we can again compare the results from
the numerical simulation with the analytical solution. However, what is
perhaps more interesting is to trace the dynamic adjustment of the
endogenous variables towards equilibrium. The best way to examine this
is by plotting the results.

\section{How to plot the results of a
model}\label{how-to-plot-the-results-of-a-model}

We will consider two main ways to plot model outputs: bar charts for
static models and time series charts for dynamic models. Bar charts
compare the equilibrium values of \(Y_t\) for different
parameterisations:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Bar chart of different equilibrium solutions of Samuelson (1939) model}
\FunctionTok{barplot}\NormalTok{(Y[,Q], }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Output"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"Baseline"}\NormalTok{, }\StringTok{"Increase in G0"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{how_to_simulate_files/figure-pdf/howto_4-1.pdf}

Next, we show a basic version of a time series chart that displays the
dynamics of \(Y_t\):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Time series chart of output dynamics in Samuelson (1939) model}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Output"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{how_to_simulate_files/figure-pdf/howto_5-1.pdf}

As you can see, there are many settings you can fiddle around with to
adjust the appearance of the graph to your liking (run `?plot' to find
information about the different options.) If we want to plot the
dynamics for the two different parameterisations, we can do the
following:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Time series chart of output dynamics for different scenarios in Samuelson (1939) model}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\FunctionTok{min}\NormalTok{(Y[}\DecValTok{1}\NormalTok{,], Y[}\DecValTok{2}\NormalTok{,]), }\FunctionTok{max}\NormalTok{(Y[}\DecValTok{1}\NormalTok{,], Y[}\DecValTok{2}\NormalTok{,]))) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Output under different scenarios"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Baseline"}\NormalTok{, }\StringTok{"Increase in G0"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{how_to_simulate_files/figure-pdf/howto_6-1.pdf}

Note that we have adjusted the range of the y-axis to make sure the
graph captures the minimum and maximum values from both
parameterisations.

Finally, consider a plot for \(C_t\) and \(I_t\) with two separate axes:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Time series chart of Samuelson (1939) model with separate axes for consumption and investment}
\FunctionTok{plot}\NormalTok{(C[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Consumption and Investment"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(I[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(I[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at=}\FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(I[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{])))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"I"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{how_to_simulate_files/figure-pdf/howto_7-1.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\#\# Plots}

\CommentTok{\# Load matplot library}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Bar chart of different equilibrium solutions of Samuelson (1939) model}
\NormalTok{scenario\_labels }\OperatorTok{=}\NormalTok{ [}\StringTok{"Baseline"}\NormalTok{, }\StringTok{"Increase in G0"}\NormalTok{]}
\NormalTok{plt.bar(scenario\_labels, Y[:, Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}
\NormalTok{plt.xlabel(}\StringTok{"Scenario"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Output"}\NormalTok{)}
\NormalTok{plt.show()}

\CommentTok{\# Time series chart of output dynamics in Samuelson (1939) model}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q), Y[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{:Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Output"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{plt.show()}

\CommentTok{\# Time series chart of output dynamics for different scenarios in Samuelson }
\CommentTok{\#(1939) model}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q), Y[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{:Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{1}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q), Y[}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{:Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{1}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Output under different scenarios"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{plt.legend([}\StringTok{"Baseline"}\NormalTok{, }\StringTok{"Increase in G0"}\NormalTok{], loc}\OperatorTok{=}\StringTok{\textquotesingle{}lower right\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}

\CommentTok{\# Time series chart of Samuelson (1939) model with separate axes for consumption }
\CommentTok{\# and investment}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots()}
\NormalTok{ax1.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q), C[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{:Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, }
\NormalTok{         label}\OperatorTok{=}\StringTok{\textquotesingle{}C\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\StringTok{"C"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.tick\_params(axis}\OperatorTok{=}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{, labelcolor}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}
\NormalTok{ax2.plot(}\BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q), I[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{:Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{,}
\NormalTok{         label}\OperatorTok{=}\StringTok{\textquotesingle{}I\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2.set\_ylabel(}\StringTok{"I"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2.tick\_params(axis}\OperatorTok{=}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{, labelcolor}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Consumption and Investment"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{lines, labels }\OperatorTok{=}\NormalTok{ ax1.get\_legend\_handles\_labels()}
\NormalTok{lines2, labels2 }\OperatorTok{=}\NormalTok{ ax2.get\_legend\_handles\_labels()}
\NormalTok{ax2.legend(lines }\OperatorTok{+}\NormalTok{ lines2, labels }\OperatorTok{+}\NormalTok{ labels2, loc}\OperatorTok{=}\StringTok{\textquotesingle{}right\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{How to create a directed graph of a
model}\label{how-to-create-a-directed-graph-of-a-model}

Another perspective on a model's properties is provided by its directed
graph. A directed graph consists of a set of nodes that represent the
variables of the model. Nodes are connected by directed edges. An edge
directed from a node \(x_1\) to node \(x_2\) indicates a causal impact
of \(x_1\) on \(x_2\).

The directed graph can be derived from the model's Jacobian
matrix.\footnote{See Fennell et al. (2015) for a neat exposition.} Let
\(x\) be the vector containing the model's endogenous variables and
\(f(x)\) the system of equations making up the model. The Jacobian
matrix is then given by \(J=\frac{\partial f()}{\partial x}\). As we
often also want to display exogenous variables in the directed graph, it
can be useful to expand the Jacobian matrix by adding rows and columns
for those exogenous variables.

Next, construct an `auxiliary' Jacobian matrix \(M\) in which all the
non-zero elements of the Jacobian are replaced by ones, whereas zero
elements remain unchanged, i.e.

\[
M_{ij} =
\begin{cases}
1 & \text{if }  J_{ij} \neq 0, \\
0 & \text{otherwise.}
\end{cases}
\]

Finally, taking the transpose of this `auxiliary' Jacobian matrix yields
the \emph{adjacency matrix} \(A=M^T\), which is a binary matrix whose
elements (\(A_{ji}\)) indicate whether there is a directed edge from a
node \(x_j\) to node \(x_i\). From the adjacency matrix, the directed
graph is constructed.

The code below shows this for the example of the Samuelson (1939)
model.\footnote{To create the directed graph, we rely on external
  libraries which you may have to install first. In \emph{R}, this can
  be accomplished with \texttt{install.packages("igraph")} and in Python
  with \texttt{pip\ install\ networkx}. Once that library is installed,
  you only need to activate it in each session before you use it. In
  \emph{R}, you can do this by executing \texttt{library(igraph)} and in
  \emph{Python} through \texttt{import\ networkx}.}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 4 variables: }
  \CommentTok{\# endogenous: (1) Y, (2) C, (3) I}
  \CommentTok{\# exogenous: (4) G0}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

              \CommentTok{\#1 2 3 4}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{, }\CommentTok{\#1}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\CommentTok{\#2}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\CommentTok{\#3}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\CommentTok{\#4 }
               \DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(G[}\DecValTok{0}\NormalTok{]))}

\CommentTok{\# Plot directed graph matrix}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Directed graph of Samuelson model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{how_to_simulate_files/figure-pdf/how_to8-5.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Construct auxiliary Jacobian matrix for 4 variables}
  \CommentTok{\# endogenous: (1) Y, (2) C, (3) I}
  \CommentTok{\# exogenous: (4) G0}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are}
\CommentTok{\# unchanged}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{         [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{         [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{         [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"C"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"I"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"$G\_0$"}\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{42}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{500}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Directed graph of Samuelson model"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Broadly speaking, three types of nodes are possible:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  nodes from which arrows only point away represent exogenous variables
  (\(G_0\))
\item
  nodes to which arrows point but from which arrows also point away
  represent endogenous variables that also have a causal impact on other
  variables (\(Y\), \(C\), and \(I\))
\item
  nodes to arrows only point towards represent endogenous variables that
  are residuals (not present in this example)
\end{enumerate}

It can thus be seen that the key exogenous variable in the Samuelson
(1939) model is government spending \(G_0\), which determines aggregate
income, which in turn feeds into consumption. Consumption then feeds
into investment, which feeds back into income yielding the
multiplier-accelerator effect.

\section{Appendix: How to simulate dynamic model in continuous
time}\label{sec-sim-continuous}

Sometimes, dynamic economic models are written in continuous time where
the time increment is assumed to be infinitesimally small. Consider, for
example, a continuous-time version of the Keynesian goods market model:

\[
\dot{Y}= k(C + I_0 - Y)
\]

\[
C = c_0 + c_1Y,
\] where \(\dot{Y}=\frac{dY}{dt}\). To simulate this model, we have to
approximate the differential equation for \(\dot{Y}\) by a difference
equation for \(Y_t\) and let the time increment \(\Delta t\) become very
small. More specifically, we write:

\[
Y(t+\Delta t)=Y_t + \dot{Y} \Delta t =Y_t + [k(C + I_0 - Y)]\Delta t.
\] This approach is also called the \emph{Euler forward method}. The
code below shows to implement that method. We use \(\Delta t = 0.01\).
Note that we need to raise the time horizon \(Q\) and set the adjustment
speed \(k\) relatively high to make sure that the system has effectively
converged to the equilibrium by \(Q\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Simulate continuous time version of Keynesian goods market model}

\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods for which you want to simulate}
\NormalTok{Q}\OtherTok{=}\DecValTok{800}

\CommentTok{\# Set number of parameterisations that will be considered}
\NormalTok{S}\OtherTok{=}\DecValTok{1}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{3}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.8}
\NormalTok{k}\OtherTok{=}\DecValTok{8}
\NormalTok{delta}\OtherTok{=}\FloatTok{0.01}

\CommentTok{\# Construct matrices in which values for different periods will be stored; initialise at 1}
\NormalTok{Y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}
\NormalTok{C}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Construct matrices for exogenous variable }
\NormalTok{I0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Solve this system recursively based on the initialisation}
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{    Y[}\DecValTok{1}\NormalTok{,t] }\OtherTok{=}\NormalTok{ Y[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ delta}\SpecialCharTok{*}\NormalTok{(k}\SpecialCharTok{*}\NormalTok{(C[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I0[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ Y[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{]))}
\NormalTok{    C[}\DecValTok{1}\NormalTok{,t] }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{Y[}\DecValTok{1}\NormalTok{,t]}
\NormalTok{    \} }\CommentTok{\# close within{-}period loop}
\NormalTok{  \} }\CommentTok{\# close time loop}


\CommentTok{\# Verify solutions for Y}
\NormalTok{(c0}\SpecialCharTok{+}\NormalTok{I0[}\DecValTok{1}\NormalTok{,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{c1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 40
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 39.9999
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Simulate continuous time version of Keynesian goods market model}

\CommentTok{\# Load NumPy}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods for which you want to simulate}
\NormalTok{Q }\OperatorTok{=} \DecValTok{800}

\CommentTok{\# Set number of parameterizations that will be considered}
\NormalTok{S }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{3}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.8}
\NormalTok{k }\OperatorTok{=} \DecValTok{8}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.01}

\CommentTok{\# Initialize matrices to store values for different periods}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{C }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}

\CommentTok{\# Initialize the matrix for the exogenous variable}
\NormalTok{I0 }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{5}\NormalTok{)}

\CommentTok{\# Solve this system recursively based on the initialization}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
\NormalTok{        Y[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ (k }\OperatorTok{*}\NormalTok{ (C[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I0[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]))}
\NormalTok{        C[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, t]}

\CommentTok{\# Verify the solution for Y at time Q}
\NormalTok{(c0 }\OperatorTok{+}\NormalTok{ I0[}\DecValTok{0}\NormalTok{, Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ c1)}

\NormalTok{Y[}\DecValTok{0}\NormalTok{,Q }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references}

\part{Static Models}

\chapter{A Neoclassical Macro Model}\label{sec-neoclassical-model}

\section{Overview}\label{overview}

This model captures some key features of neoclassical macroeconomics.
The model is based on the optimising behaviour of firms and households
that interact in perfect markets. Households choose between labour and
leisure as well as current and future consumption. They form (rational)
expectations about their future income that impact their consumption
decisions today. Firms are owned by households and maximise profits
using a constant returns to scale technology (with diminishing marginal
returns to factors of production). Markets are competitive and clear
instantaneously through flexible prices. The most important market is
the labour market, in which the equilibrium between firms' demand and
households' supply of labour is established by a flexible real wage. The
level of employment established on the labour market then determines
aggregate supply via the production function. Aggregate demand always
accommodates to aggregate supply via a flexible real interest rate that
establishes an equilibrium between investment and saving (often
interpreted as the market for loanable funds). The money supply is
exogenous in this model and only impacts the price level but not the
real economy -- the so-called \emph{Classical Dichotomy} (or neutrality
of money). Government expenditures do influence the real economy but
they crowd out private expenditures (through a mechanism called
\emph{Ricardian Equivalence}).

In this short- to medium-run version of the model, prices are flexible
but the capital stock is fixed. The focus is thus on goods market
equilibrium rather than economic growth. As all endogenous variables
adjust instantaneously, the model is thus static. However, expectations
about future income and government spending will impact current
consumption of households that intertemporally maximise utility. The
model is adapted from Garín, Lester, and Sims (2021).

\section{The Model}\label{the-model}

\begin{equation}\phantomsection\label{eq-Y_NC}{
Y=AK^aN^{1-a}, \quad a\in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-w_NC}{
w=(1-a)AK^aN^{-a}
}\end{equation}

\begin{equation}\phantomsection\label{eq-N_NC}{
N= 1-\frac{b_1}{w}, \quad b_1>0
}\end{equation}

\begin{equation}\phantomsection\label{eq-C_NC}{
C=c_1\left[Y- G +\frac{Y^f-G^f}{1+r} -c_2\ln\left(\frac{b_1}{w}\right)\right]
}\end{equation}

\begin{equation}\phantomsection\label{eq-I_NC}{
I =\left(\frac{aAN^{1-a}}{r}\right)^{\frac{1}{1-a}}
}\end{equation}

\begin{equation}\phantomsection\label{eq-G_NC}{
G= G_0
}\end{equation}

\begin{equation}\phantomsection\label{eq-Y_eq_NC}{
Y= C(r) + I(r) + G
}\end{equation}

\begin{equation}\phantomsection\label{eq-rn_NC}{
r_n= r + \pi^f
}\end{equation}

\begin{equation}\phantomsection\label{eq-MS_NC}{
M_s=M_0
}\end{equation}

\begin{equation}\phantomsection\label{eq-MD_NC}{
M_d=\frac{b_3(1+r_n)PC}{r_n}
}\end{equation}

\begin{equation}\phantomsection\label{eq-M_eq_NC}{
M = M_d(P)= M_s
}\end{equation}

where \(Y\), \(K\), \(N\), \(w\), \(C\), \(G\), \(r\), \(I\), \(r_n\),
\(\pi\), \(M_s\), \(M_d\), and \(P_t\) are real output, the capital
stock, employment, the real wage, consumption, government expenditures,
the real interest rate, investment, the nominal interest rate,
inflation, the money supply, money demand, and the price level,
respectively. The \(f\)-superscript denotes (expected) future values.
For simplicity, expected future variables will be treated as exogenous.

By Equation~\ref{eq-Y_NC}, output is determined by a Cobb-Douglass
production function with constant returns to scale and diminishing
marginal returns to each factor (capital and labour).
Equation~\ref{eq-w_NC} is the labour demand of firms solved for the real
wage. Profit maximising firms will hire workers until the real wage is
equal to the marginal product of labour
\(\left(\frac{\partial Y}{\partial N}=(1-a)AK^aN^{-a}\right)\).\footnote{See
  the analytical discussion below for a derivation of equations
  Equation~\ref{eq-w_NC} -Equation~\ref{eq-I_NC} and
  Equation~\ref{eq-MD_NC} from optimising microfoundations.}
Equation~\ref{eq-N_NC} specifies households' labour supply, which is
positively related to the real wage. By Equation~\ref{eq-C_NC},
consumption is positively related to the real wage, current and
(expected) future income,\footnote{Households are assumed to form
  rational expectations. In a deterministic setting, this implies
  perfect foresight so that expected and actual future income coincide.}
and negatively related to the real interest rate. The composite
parameters \(c_1= \left(\frac{1}{1+b_2+b_3}\right)\) and
\(c_2= b_1(b_2+b_3)\) stem from the weights in the household's utility
function (see analytical discussion below). The consumption function
implies that for a higher real interest rate, households increase their
saving (the supply of loanable funds). Furthermore, consumption is
negatively related to current and future government expenditures. This
is an implication of consumption smoothing: as households know that
governments will have to repay its debts in the future through higher
taxes, an increase in government expenditures today is perceived as an
increase in taxes (regardless of whether the government finances its
current expenditures through taxes or debt, a result that is also called
`Ricardian Equivalence').\footnote{See the analytical discussion below
  for more details on Ricardian Equivalence.} Equation~\ref{eq-I_NC}
specifies investment as a negative function of the real interest rate
and a positive function of productivity. By Equation~\ref{eq-G_NC},
government expenditures are exogenous. Equation~\ref{eq-Y_eq_NC} is the
goods market equilibrium condition, which pins down the equilibrium real
interest rate through the market for loanable funds.
Equation~\ref{eq-rn_NC} specifies the nominal interest rate using the
well-known Fisher equation. Equation~\ref{eq-MS_NC} says that the money
supply is exogenous. By Equation~\ref{eq-MD_NC}, households' money
demand is negatively related to the nominal interest rate and positively
related to consumption (capturing the transaction demand for money).
Finally, Equation~\ref{eq-M_eq_NC} is the equilibrium condition for the
money market, which pins down the price level.

\section{Simulation}\label{simulation}

\subsection{Parameterisation}\label{parameterisation}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), five further scenarios will be
considered. Scenarios 2 and 3 are a monetary expansion (increase in the
exogenous money supply \(M_0\)) and fiscal expansion (increase in
\(G_0\)), respectively. Scenario 4 is an improvement in total factor
productivity (\(A\)) and scenario 5 a fall in expected future income
(\(Y^f\)). Finally, scenario 6 is a shift in household preferences
towards more leisure (\(b_1\)).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0909}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(A\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b_{1}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b_{2}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b_{3}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(G_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(Y^{f}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(M_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(K\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\pi_{f}\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 2 & 0.3 & 0.4 & 0.9 & 0.6 & 1 & 1 & 5 & 5 & 0.02 \\
2: monetary expansion (\(M_{0}\)) & 2 & 0.3 & 0.4 & 0.9 & 0.6 & 1 & 1 &
6 & 5 & 0.02 \\
3: fiscal expansion (\(G_{0}\)) & 2 & 0.3 & 0.4 & 0.9 & 0.6 & 2 & 1 & 6
& 5 & 0.02 \\
4: productivity boost (\(A\)) & 2.5 & 0.3 & 0.4 & 0.9 & 0.6 & 1 & 1 & 5
& 5 & 0.02 \\
5: lower expected future income (\(Y^{f}\)) & 2 & 0.3 & 0.4 & 0.9 & 0.6
& 1 & 0.2 & 5 & 5 & 0.02 \\
6: increased preference for leisure (\(b_{1}\)) & 2 & 0.3 & 0.8 & 0.9 &
0.6 & 1 & 1 & 5 & 5 & 0.02 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{6}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Income/output}
\NormalTok{w\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Real wage}
\NormalTok{C\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Consumption}
\NormalTok{I\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Investment}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Real interest rate}
\NormalTok{rn\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Nominal interest rate}
\NormalTok{N\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Employment}
\NormalTok{P\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Price level}

\CommentTok{\# Create and parameterise exogenous variables/parameters that will be shifted}
\NormalTok{M0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# money supply}
\NormalTok{G0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# government expenditures}
\NormalTok{A}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# productivity}
\NormalTok{Yf}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# expected future income}
\NormalTok{b1}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# household preference for leisure}
\NormalTok{M0[]}\OtherTok{=}\DecValTok{5}
\NormalTok{G0[]}\OtherTok{=}\DecValTok{1}
\NormalTok{A[]}\OtherTok{=}\DecValTok{2}
\NormalTok{Yf[]}\OtherTok{=}\DecValTok{1}
\NormalTok{b1[]}\OtherTok{=}\FloatTok{0.4}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{M0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\DecValTok{6}   \CommentTok{\# scenario 2: monetary expansion }
\NormalTok{G0[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\DecValTok{2}   \CommentTok{\# scenario 3: fiscal expansion}
\NormalTok{A[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{2.5}  \CommentTok{\# scenario 4: productivity boost}
\NormalTok{Yf[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# scenario 5: lower expected future income}
\NormalTok{b1[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\FloatTok{0.8} \CommentTok{\# scenario 6: increased preference for leisure}

\CommentTok{\#Set constant parameter values}
\NormalTok{a}\OtherTok{=}\FloatTok{0.3}  \CommentTok{\# Capital elasticity of output}
\NormalTok{b2}\OtherTok{=}\FloatTok{0.9} \CommentTok{\# discount rate}
\NormalTok{b3}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# household preference for money}
\NormalTok{K}\OtherTok{=}\DecValTok{5}    \CommentTok{\# Exogenous capital stock}
\NormalTok{pe}\OtherTok{=}\FloatTok{0.02} \CommentTok{\# Expected rate of inflation}
\NormalTok{Gf}\OtherTok{=}\DecValTok{1}  \CommentTok{\# Future government spending}

\CommentTok{\# Initialise endogenous variables at arbitrary positive value}
\NormalTok{w }\OtherTok{=}\NormalTok{ C }\OtherTok{=}\NormalTok{ I }\OtherTok{=}\NormalTok{ Y }\OtherTok{=}\NormalTok{ r }\OtherTok{=}\NormalTok{ N }\OtherTok{=}\NormalTok{ P }\OtherTok{=} \DecValTok{1} 

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
\ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
  
  \CommentTok{\#Model equations}
  
  \CommentTok{\#(1) Cobb{-}Douglass production function  }
\NormalTok{  Y }\OtherTok{=}\NormalTok{ A[i]}\SpecialCharTok{*}\NormalTok{(K}\SpecialCharTok{\^{}}\NormalTok{a)}\SpecialCharTok{*}\NormalTok{N}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a)}
  
  \CommentTok{\#(2) Labour demand }
\NormalTok{  w }\OtherTok{=}\NormalTok{ A[i]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a)}\SpecialCharTok{*}\NormalTok{(K}\SpecialCharTok{\^{}}\NormalTok{a)}\SpecialCharTok{*}\NormalTok{N}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a) }
  
  \CommentTok{\#(3) Labour supply}
\NormalTok{  N }\OtherTok{=} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ (b1[i])}\SpecialCharTok{/}\NormalTok{w}
  
  \CommentTok{\#(4) Consumption demand}
\NormalTok{  C }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{b2}\SpecialCharTok{+}\NormalTok{b3))}\SpecialCharTok{*}\NormalTok{(Y }\SpecialCharTok{{-}}\NormalTok{ G0[i] }\SpecialCharTok{+}\NormalTok{ (Yf[i]}\SpecialCharTok{{-}}\NormalTok{Gf)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{r) }\SpecialCharTok{{-}}\NormalTok{b1[i]}\SpecialCharTok{*}\NormalTok{(b2}\SpecialCharTok{+}\NormalTok{b3)}\SpecialCharTok{*}\FunctionTok{log}\NormalTok{(b1[i]}\SpecialCharTok{/}\NormalTok{w))}
   
  \CommentTok{\#(5) Investment demand, solved for r}
\NormalTok{  r}\OtherTok{=}\NormalTok{(I}\SpecialCharTok{\^{}}\NormalTok{(a}\DecValTok{{-}1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{a}\SpecialCharTok{*}\NormalTok{A[i]}\SpecialCharTok{*}\NormalTok{N}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a) }
   
  \CommentTok{\#(6) Goods market equilibrium condition, solved for I}
\NormalTok{  I }\OtherTok{=}\NormalTok{ Y }\SpecialCharTok{{-}}\NormalTok{ C }\SpecialCharTok{{-}}\NormalTok{ G0[i]}
  
  \CommentTok{\#(7) Nominal interest rate}
\NormalTok{  rn }\OtherTok{=}\NormalTok{ r }\SpecialCharTok{+}\NormalTok{ pe}
  
  \CommentTok{\#(8) Price level}
\NormalTok{  P }\OtherTok{=}\NormalTok{ (M0[i]}\SpecialCharTok{*}\NormalTok{rn)}\SpecialCharTok{/}\NormalTok{((}\DecValTok{1}\SpecialCharTok{+}\NormalTok{rn)}\SpecialCharTok{*}\NormalTok{b3}\SpecialCharTok{*}\NormalTok{C) }

\NormalTok{\}}
  
\CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{Y\_star[i]}\OtherTok{=}\NormalTok{Y}
\NormalTok{w\_star[i]}\OtherTok{=}\NormalTok{w}
\NormalTok{C\_star[i]}\OtherTok{=}\NormalTok{C}
\NormalTok{I\_star[i]}\OtherTok{=}\NormalTok{I}
\NormalTok{r\_star[i]}\OtherTok{=}\NormalTok{r}
\NormalTok{N\_star[i]}\OtherTok{=}\NormalTok{N}
\NormalTok{P\_star[i]}\OtherTok{=}\NormalTok{P}
\NormalTok{rn\_star[i]}\OtherTok{=}\NormalTok{rn}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set the number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Create arrays to store equilibrium solutions from different parameterizations}
\NormalTok{Y\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Income/output}
\NormalTok{w\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Real wage}
\NormalTok{C\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Consumption}
\NormalTok{I\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Investment}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Real interest rate}
\NormalTok{rn\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Nominal interest rate}
\NormalTok{N\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Employment}
\NormalTok{P\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Price level}

\CommentTok{\# Create and parameterize exogenous variables/parameters that will be shifted}
\NormalTok{M0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Money supply}
\NormalTok{G0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Government expenditures}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.zeros(S)   }\CommentTok{\# Productivity}
\NormalTok{Yf }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Expected future income}
\NormalTok{b1 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Household preference for leisure}

\CommentTok{\# Baseline parameterisation}
\NormalTok{M0[:] }\OperatorTok{=} \DecValTok{5}
\NormalTok{G0[:] }\OperatorTok{=} \DecValTok{1}
\NormalTok{A[:] }\OperatorTok{=} \DecValTok{2}
\NormalTok{Yf[:] }\OperatorTok{=} \DecValTok{1}
\NormalTok{b1[:] }\OperatorTok{=} \FloatTok{0.4}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{M0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \DecValTok{6}   \CommentTok{\# Scenario 2: monetary expansion}
\NormalTok{G0[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \DecValTok{2}   \CommentTok{\# Scenario 3: fiscal expansion}
\NormalTok{A[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{2.5}  \CommentTok{\# Scenario 4: productivity boost}
\NormalTok{Yf[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Scenario 5: lower expected future income}
\NormalTok{b1[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \FloatTok{0.8}  \CommentTok{\# Scenario 6: increased preference for leisure}

\CommentTok{\# Set constant parameter values}
\NormalTok{a }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# Capital elasticity of output}
\NormalTok{b2 }\OperatorTok{=} \FloatTok{0.9}  \CommentTok{\# Discount rate}
\NormalTok{b3 }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Household preference for money}
\NormalTok{K }\OperatorTok{=} \DecValTok{5}  \CommentTok{\# Exogenous capital stock}
\NormalTok{pe }\OperatorTok{=} \FloatTok{0.02}  \CommentTok{\# Expected rate of inflation}
\NormalTok{Gf }\OperatorTok{=} \DecValTok{1}  \CommentTok{\# Future government spending}

\CommentTok{\# Initialize endogenous variables at arbitrary positive values}
\NormalTok{w }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=}\NormalTok{ I }\OperatorTok{=}\NormalTok{ Y }\OperatorTok{=}\NormalTok{ r }\OperatorTok{=}\NormalTok{ N }\OperatorTok{=}\NormalTok{ P }\OperatorTok{=} \DecValTok{1} 

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# Model equations}

        \CommentTok{\# (1) Cobb{-}Douglas production function}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ A[i] }\OperatorTok{*}\NormalTok{ (K}\OperatorTok{**}\NormalTok{a) }\OperatorTok{*}\NormalTok{ N}\OperatorTok{**}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{a)}

        \CommentTok{\# (2) Labour demand}
\NormalTok{        w }\OperatorTok{=}\NormalTok{ A[i] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1}\OperatorTok{{-}}\NormalTok{a) }\OperatorTok{*}\NormalTok{ (K}\OperatorTok{**}\NormalTok{a) }\OperatorTok{*}\NormalTok{ N}\OperatorTok{**}\NormalTok{(}\OperatorTok{{-}}\NormalTok{a)}

        \CommentTok{\# (3) Labour supply}
\NormalTok{        N }\OperatorTok{=} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ (b1[i]) }\OperatorTok{/}\NormalTok{ w}

        \CommentTok{\# (4) Consumption demand}
\NormalTok{        C }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ b2 }\OperatorTok{+}\NormalTok{ b3)) }\OperatorTok{*}\NormalTok{ (Y }\OperatorTok{{-}}\NormalTok{ G0[i] }\OperatorTok{+}\NormalTok{ (Yf[i] }\OperatorTok{{-}}\NormalTok{ Gf) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ r) }\OperatorTok{{-}}\NormalTok{ b1[i] }\OperatorTok{*}\NormalTok{ (b2 }\OperatorTok{+}\NormalTok{ b3) }\OperatorTok{*}\NormalTok{ np.log(b1[i] }\OperatorTok{/}\NormalTok{ w))}

        \CommentTok{\# (5) Investment demand, solved for r}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (I}\OperatorTok{**}\NormalTok{(a}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)) }\OperatorTok{*}\NormalTok{ a }\OperatorTok{*}\NormalTok{ A[i] }\OperatorTok{*}\NormalTok{ N}\OperatorTok{**}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{a)}

        \CommentTok{\# (6) Goods market equilibrium condition, solved for I}
\NormalTok{        I }\OperatorTok{=}\NormalTok{ Y }\OperatorTok{{-}}\NormalTok{ C }\OperatorTok{{-}}\NormalTok{ G0[i]}

        \CommentTok{\# (7) Nominal interest rate}
\NormalTok{        rn }\OperatorTok{=}\NormalTok{ r }\OperatorTok{+}\NormalTok{ pe}

        \CommentTok{\# (8) Price level}
\NormalTok{        P }\OperatorTok{=}\NormalTok{ (M0[i] }\OperatorTok{*}\NormalTok{ rn) }\OperatorTok{/}\NormalTok{ ((}\DecValTok{1} \OperatorTok{+}\NormalTok{ rn) }\OperatorTok{*}\NormalTok{ b3 }\OperatorTok{*}\NormalTok{ C)}

    \CommentTok{\# Save results for different parameterizations in the arrays}
\NormalTok{    Y\_star[i] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    w\_star[i] }\OperatorTok{=}\NormalTok{ w}
\NormalTok{    C\_star[i] }\OperatorTok{=}\NormalTok{ C}
\NormalTok{    I\_star[i] }\OperatorTok{=}\NormalTok{ I}
\NormalTok{    r\_star[i] }\OperatorTok{=}\NormalTok{ r}
\NormalTok{    N\_star[i] }\OperatorTok{=}\NormalTok{ N}
\NormalTok{    P\_star[i] }\OperatorTok{=}\NormalTok{ P}
\NormalTok{    rn\_star[i] }\OperatorTok{=}\NormalTok{ rn}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots}

Figures Figure~\ref{fig-output-neocl} -
Figure~\ref{fig-employment-neocl} depicts the model economy's real
activity under different scenarios. Monetary expansions (scenario 2)
have no effects on output and employment, capturing the idea of money
neutrality (Classical Dichotomy). However, the monetary expansion does
raise the price level (see Figure~\ref{fig-price_level} ), capturing the
key idea of the Quantity Theory of Money that inflation is driven by a
growing money supply.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(Y\_star, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-output-neocl-1.pdf}

}

\caption{\label{fig-output-neocl}Output}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(P\_star, }\AttributeTok{ylab=}\StringTok{"P"}\NormalTok{,  }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-price_level-1.pdf}

}

\caption{\label{fig-price_level}Price level}

\end{figure}%

An increase in government spending (by one unit) in scenario 3 does
\emph{not} raise employment and real output as these are fully
determined by the supply side rather than aggregate demand.\footnote{This
  result is partly driven by the use of a non-separable utility
  function, see analytical discussion below. With a separable utility
  function, the increase in government spending would increase labour
  supply and thereby have effects on employment and output.} Looking at
Figures Figure~\ref{fig-consumption} and Figure~\ref{fig-investment}, it
can be seen that government spending crowds out private spending
(consumption and investment). The decrease in consumption is a result of
consumption smoothing via the Euler equation: the household anticipates
higher taxes in the future and reduces current consumption somewhat to
smooth out the impact. The increase in government expenditures also
raises demand for loanable funds, which pushes up the real interest rate
(see Figure~\ref{fig-interest_rate}) and reduces investment
(Figure~\ref{fig-investment}) and consumption. There is also an
inflationary effect linked to the higher real interest rate, which
raises the nominal interest rate and reduces the demand for money.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(N\_star, }\AttributeTok{ylab=}\StringTok{"N"}\NormalTok{,  }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-employment-neocl-1.pdf}

}

\caption{\label{fig-employment-neocl}Employment}

\end{figure}%

Improvements to the supply-side are captured by an increase in
productivity (scenario 4), which raises real output, employment, and
aggregate demand. In contrast to expansionary government policy, the
price level falls.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(C\_star, }\AttributeTok{ylab=}\StringTok{"C"}\NormalTok{,  }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-consumption-1.pdf}

}

\caption{\label{fig-consumption}Consumption}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(I\_star, }\AttributeTok{ylab=}\StringTok{"I"}\NormalTok{,  }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-investment-1.pdf}

}

\caption{\label{fig-investment}Investment}

\end{figure}%

A decrease in expected future income (scenario 5) has a small
expansionary effect on aggregate output. This is because households will
reduce some of their current consumption (see
Figure~\ref{fig-consumption} ) and supply more labour to smooth their
consumption over time. The increase in saving reduces the real interest
rate (see Figure~\ref{fig-interest_rate} ) and is compensated by an
increase in investment (see Figure~\ref{fig-investment} ).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(r\_star, }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{,}\StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-interest_rate-1.pdf}

}

\caption{\label{fig-interest_rate}Interest rate}

\end{figure}%

Finally, an increase in the preference for leisure (scenario 6) reduces
labour supply and thereby output.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here for output only)}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1: Baseline"}\NormalTok{, }\StringTok{"2: Increase in M0"}\NormalTok{, }\StringTok{"3: Increase in G0"}\NormalTok{, }
                  \StringTok{"4: Increase in A"}\NormalTok{, }\StringTok{"5: Decrease in Yf"}\NormalTok{, }\StringTok{"6: Increase in b1"}\NormalTok{]}

\CommentTok{\# Output}
\NormalTok{plt.bar(scenario\_names , Y\_star)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xticks(rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, ha}\OperatorTok{=}\StringTok{"right"}\NormalTok{)  }\CommentTok{\# Rotate x{-}axis labels for better readability}
\NormalTok{plt.tight\_layout()  }\CommentTok{\# Ensure the labels fit within the plot area}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 13 variables: }
\CommentTok{\# Y w   N   C   I   r   P   rn M0   G0 A Yf Md}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{13}\NormalTok{, }\DecValTok{13}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{,}\StringTok{"w"}\NormalTok{,}\StringTok{"N"}\NormalTok{,}\StringTok{"C"}\NormalTok{,}\StringTok{"I"}\NormalTok{,}\StringTok{"r"}\NormalTok{,}\StringTok{"P"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(r[n]), }\FunctionTok{expression}\NormalTok{(M[}\DecValTok{0}\NormalTok{]),}\FunctionTok{expression}\NormalTok{(G[}\DecValTok{0}\NormalTok{]),}\StringTok{"A"}\NormalTok{,}\FunctionTok{expression}\NormalTok{(Y}\SpecialCharTok{\^{}}\NormalTok{f), }\FunctionTok{expression}\NormalTok{(M[d]))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_macro_model_files/figure-pdf/fig-dg-2.pdf}

}

\caption{\label{fig-dg}Directed graph}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Construct the auxiliary Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]}
\NormalTok{])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}
    \DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{,}
    \DecValTok{1}\NormalTok{: }\StringTok{"w"}\NormalTok{,}
    \DecValTok{2}\NormalTok{: }\StringTok{"N"}\NormalTok{,}
    \DecValTok{3}\NormalTok{: }\StringTok{"C"}\NormalTok{,}
    \DecValTok{4}\NormalTok{: }\StringTok{"I"}\NormalTok{,}
    \DecValTok{5}\NormalTok{: }\StringTok{"r"}\NormalTok{,}
    \DecValTok{6}\NormalTok{: }\StringTok{"P"}\NormalTok{,}
    \DecValTok{7}\NormalTok{: }\VerbatimStringTok{r"$r\_n$"}\NormalTok{,}
    \DecValTok{8}\NormalTok{: }\VerbatimStringTok{r"$M\_0$"}\NormalTok{,}
    \DecValTok{9}\NormalTok{: }\VerbatimStringTok{r"$G\_0$"}\NormalTok{,}
    \DecValTok{10}\NormalTok{: }\StringTok{"A"}\NormalTok{,}
    \DecValTok{11}\NormalTok{: }\VerbatimStringTok{r"$Y\^{}f$"}\NormalTok{,}
    \DecValTok{12}\NormalTok{: }\VerbatimStringTok{r"$M\_d$"}
\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{42}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure~\ref{fig-dg} , it can be seen that productivity (\(A\)),
future income (\(Y^f\)), the money supply (\(M_0\)), and government
spending (\(G_0\)) are the key exogenous variables of the model. All
other variables are endogenous, and many of them form a closed loop (or
cycle) within the system. The left part of the graph captures the supply
side: the labour market simultaneously pins down the real wage and
employment, which together with the exogenously level of productivity
determine output. The part in the middle embodies the demand side:
aggregate demand (consumption, investment, and government spending)
together with a given level of output determine the real interest rate.
The right part captures the nominal side of the model given by the money
market, which determines the price level. Notably, while the real side
of the model feeds into the money market via the nominal interest rate
(\(r_n\)), there is not causal effect from the money market to the real
side reflecting the Classical Dichotomy.

\section{Analytical discussion: derivation of behavioural
functions}\label{analytical-discussion-derivation-of-behavioural-functions}

\subsection{The firm's problem: profit
maximisation}\label{the-firms-problem-profit-maximisation}

The firm's profit equation is given by:

\begin{equation}\phantomsection\label{eq-Pi}{
\Pi=Y-w N-r k
}\end{equation}

\begin{equation}\phantomsection\label{eq-Pi2}{
=A K^a N^{1-a}-w N-r k .
}\end{equation}

The firm's optimisation problem is to maximise profits using employment
and capital as choice variables:\footnote{See Garín, Lester, and Sims
  (2021, chap. 12) for a more elaborate version where the firm maximises
  its lifetime value. The resulting investment function is very similar.}

\begin{equation}\phantomsection\label{eq-Pi3}{
\max _{N, K} \Pi=A K^a N^{1-a}-w N-r k .
}\end{equation}

The first-order conditions are given by:

\begin{equation}\phantomsection\label{eq-FOC_Nd}{
(1-a) A K^a N^{-a}-w=0
}\end{equation}

\begin{equation}\phantomsection\label{eq-FOC_I}{
a A K^{a-1} N^{1-a}-r=0 .
}\end{equation}

From Equation~\ref{eq-FOC_Nd}, Equation~\ref{eq-w_NC} for labour demand
can be derived. While the capital stock is pre-determined in every
period, the firm can adjust the capital stock through investment. We
thus use the first-order condition for capital Equation~\ref{eq-FOC_I}
to derive Equation~\ref{eq-I_NC} for investment demand.

\subsection{The government's budget
constraint}\label{the-governments-budget-constraint}

The government's current and future budget constraints are given by:

\begin{equation}\phantomsection\label{eq-Gbc}{
G=T+B
}\end{equation}

\begin{equation}\phantomsection\label{eq-Gf}{
G^f=T^f-(1+r) B
}\end{equation} where \(T\) is tax revenues and \(B\) is government
debt.

A crucial assumption here is that the government must repay its debts in
the future (it cannot permanently roll over its debts). The underlying
assumption is that the government will eventually `die' and will do so
without savings nor debt.

Combining the two budget constraints to an intertemporal budget
constraint yields:

\begin{equation}\phantomsection\label{eq-Gitbc}{
G+\frac{G^f}{1+r}=T+\frac{T^f}{1+r}
}\end{equation}

Thus, while the government's budget need not be balanced in every
period, it will be balanced over time (in a present value
sense).\footnote{See Garín, Lester, and Sims (2021, chap. 13) for a more
  detailed discussion of the government's budget constraints.}

\subsection{The household's problem: intertemporal utility maximisation
and Ricardian
Equivalence}\label{the-households-problem-intertemporal-utility-maximisation-and-ricardian-equivalence}

The household derives utility from current consumption, leisure
(\(1-N\)), future consumption \(C^f\), and from holding real money
balances \(\left(\frac{M}{P}\right)\). We use the following log utility
function that is non-separable in consumption and leisure:\footnote{See
  Garín, Lester, and Sims (2021), pp.280-289), on the differences
  between a separable and a non-separable preference specification. Note
  also that for simplicity, the utility function omits the utility from
  future leisure.}

\begin{equation}\phantomsection\label{eq-U}{
U=\ln [C+ b_1 \ln (1-N)]+b_2 \ln \left(C^f\right)+b_3 \ln \left(\frac{M}{P}\right), \quad b_2\in (0,1); b_1, b_3>0
}\end{equation}

The household's current budget constraint is given by:\footnote{See
  Garín, Lester, and Sims (2021, chap. 14) for a more detailed
  discussion of the household's budget constraints.}

\begin{equation}\phantomsection\label{eq-Hbc}{
C=Y-T-S-\frac{M}{P}
}\end{equation}

The income that is not consumed can either be saved (\(S\)) at nominal
interest rate (\(r_n\)) or held as money on which no return is earned.

The future budget constraint (assuming that households do not save in
the future) is given by:

\begin{equation}\phantomsection\label{eq-Cf}{
C^f = Y^f - T^f + (1+r_n)\frac{PS}{P^f} + \frac{M}{P^f}.
}\end{equation}

Using the Fisher equation \((1+r)=(1+r_n)\frac{P}{P^f}\), the future
budget constraint can be rewritten as:

\begin{equation}\phantomsection\label{eq-Cf2}{
C^f = Y^f  - T^f + (1+r)S + \frac{(1+r)M}{(1+r_n)P}
}\end{equation}

Finally, the two budget constraints can be combined to yield an
intertemporal budget constraint:

\begin{equation}\phantomsection\label{eq-Hbcit}{
C^f = (Y-C-T)(1+r)+Y^f -T^f - (1+r)\frac{r_nM}{(1+r_n)P}.
}\end{equation}

Substituting the government's intertemporal budget constraint, the
household's intertemporal budget constraint can also be written as:

\begin{equation}\phantomsection\label{eq-ibc}{
C^f = (Y-C-G)(1+r)+Y^f -G^f - (1+r)\frac{r_nM}{(1+r_n)P}
}\end{equation}

The fact that current and future tax payments are now replaced by
current and future government spending means that it does not matter for
the real economy how government spending is financed: the private sector
will react to expenditures that are financed out of debt in the same way
it reacts to expenditures financed out of taxation. This result is also
known as \emph{Ricardian Equivalence}. Put differently, Ricardian
Equivalence means the household behaves as if the government balances
its budget in every period.

With these ingredients, the household's optimisation problem can be
written as:

\[
\begin{array}{ll}
\max _{C, N, M} & U=\ln (C+b_1 \ln (1-N))+b_2 \ln \left(C^f\right)+b_3 \ln \left(\frac{M}{P}\right), \\
\text { s.t. } & C^f= (Y-C-G)(1+r)+Y^f -G^f - (1+r)\frac{r_nM}{(1+r_n)P} .
\end{array}
\]

Substituting the constraint Equation~\ref{eq-ibc} for \(C^f\) in the
utility function, and making use of the identity \(Y=\Pi+rK+Nw\), allows
to obtain the following first-order conditions:

\begin{equation}\phantomsection\label{eq-FOC_C}{
C=\frac{C^f}{b_2(1+r)} - b_1\ln(1-N)
}\end{equation}

\begin{equation}\phantomsection\label{eq-FOC_Ns}{
\left(\frac{b_1}{1-N}\right)\left(\frac{1}{C+b_1\ln(1-N)} \right)=\frac{b_2(1+r)w}{C^f}
}\end{equation}

\begin{equation}\phantomsection\label{eq-FOC_M}{
M=\frac{b_3PC^f(1+r_n)}{b_2(1+r)r_n} .
}\end{equation}

Substituting Equation~\ref{eq-FOC_C}, which is often also called the
\emph{Euler equation}, into Equation~\ref{eq-FOC_Ns} and
Equation~\ref{eq-FOC_M} yields Equation~\ref{eq-N_NC} for labour supply
and Equation~\ref{eq-MD_NC} for money demand, respectively. Finally,
using Equation~\ref{eq-ibc} and Equation~\ref{eq-FOC_M} in the Euler
Equation~\ref{eq-FOC_C} yields the consumption function
Equation~\ref{eq-C_NC}.

\section*{References}\label{references-1}
\addcontentsline{toc}{section}{References}

\markright{References}

\chapter{An IS-LM Model}\label{sec-islm-model}

\section{Overview}\label{overview-1}

The IS-LM model was developed by John R. Hicks (1937) to formalise some
key ideas of John Maynard Keynes' 1936 book
\href{https://en.wikipedia.org/wiki/The_General_Theory_of_Employment,_Interest_and_Money}{The
General Theory of Employment, Interest and Money}. The model contains
two equilibrium relationships: a goods market equilibrium between
investment and saving (IS) and a money market equilibrium between money
demand and money supply (LM). In the goods market, aggregate supply
adjusts to the level of aggregate demand given by the expenditure
decisions of households, firms, and the government. Households form
their consumption demand based on a constant marginal propensity to
consume out of income. Firms take investment decisions based on the rate
of interest. Money demand is determined by aggregate income
(transactions demand) and the interest rate on bonds (speculative
demand). The money supply is assumed to be exogenous and under the
control of the central bank. The two markets pin down equilibrium output
and the interest rate. The goods market equilibrium may well coincide
with involuntary unemployment. Adverse shocks to autonomous investment
(`animal spirits') or autonomous money demand (`liquidity preference')
reduce output and raise unemployment. The government can use monetary
policy, fiscal spending, and income taxes to stimulate economic activity
and achieve full employment.

In this short-run model, prices and the capital stock are fixed. The
focus is thus on goods market equilibrium rather than economic growth.
As all endogenous variables adjust instantaneously, the model is static.
We consider a version with linear functions, adapted from Blanchard and
Johnson (2013, chap. 5).

\section{The Model}\label{the-model-1}

\begin{equation}\phantomsection\label{eq-islmY}{
Y=C+I+G
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmC}{
C=c_{0}+c_{1}(Y-T), \quad c_{1} \in(0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmI}{
I=i_{0}-i_{1} r, \quad i_{1}>0
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmG}{
G=G_{0}
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmT}{
T=T_{0}
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmMs}{
M_{s}=M_{0}
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmMd}{
M_{d}=m_{0}+m_{1} Y-m_{2} r, \quad m_{1}>0
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmM}{
M=M_{d}=M_{s}
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmN}{
N=a Y, \quad a>0
}\end{equation}

\begin{equation}\phantomsection\label{eq-islmU}{
U=1-\frac{N}{N^{f}}
}\end{equation}

where \(Y\), \(C\), \(I\), \(G\), \(T\), \(r\), \(M_{d}\), \(M_{s}\),
\(N\), \(U\) and \(N^{f}\) are output, consumption, investment,
government spending, taxes, the interest rate on bonds, money demand,
money supply, employment, the unemployment rate, and the labour force,
respectively. The constant price level has been normalised to unity.

Equation~\ref{eq-islmY} is the goods market equilibrium condition.
Aggregate supply \((Y)\) accommodates to the level of aggregate demand
which is the sum of consumption, investment, and government spending.
Equation~\ref{eq-islmC} is the consumption function consisting of
autonomous consumption demand \(\left(c_{0}\right)\) and a marginal
propensity to consume \(\left(c_{1}\right)\) out of disposable income
\((Y-T)\). Investment demand in Equation~\ref{eq-islmI} has an
autonomous component \(\left(i_{0}\right)\) capturing Keynesian animal
spirits and a component that is negatively related to the rate of
interest on bonds. By equations Equation~\ref{eq-islmG} and
Equation~\ref{eq-islmT}, government spending and taxation are exogenous.
Similarly, the money supply in Equation~\ref{eq-islmMs} is assumed to be
exogenous. By Equation~\ref{eq-islmMd}, households' money demand is
positively related to income (capturing the transaction demand for
money) and negatively related to the interest rate on bonds (capturing
speculative demand). There is also an autonomous term
\(\left(m_{0}\right)\) capturing Keynesian liquidity preference.
Equation~\ref{eq-islmN} is a fixed-coefficient production function
through which employment is determined. In conjunction with an
exogenously given labour force \(\left(N^{f}\right)\), the level of
employment can be used to obtain an unemployment rate in
Equation~\ref{eq-islmU}.

\section{Simulation}\label{simulation-1}

\subsection{Parameterisation}\label{parameterisation-1}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), five further scenarios will be
considered. Scenarios 2 and 3 model a switch towards pessimistic
sentiments: a fall in animal spirits \(\left(i_{0}\right)\) and an
increase in liquidity preference \(\left(m_{0}\right)\). Scenarios 4 to
6 consider three different government policies to stimulate the economy:
a monetary expansion \(\left(M_{0}\right)\), a tax cut
\(\left(T_{0}\right)\), and a fiscal expansion \(\left(G_{0}\right)\).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 24\tabcolsep) * \real{0.0769}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_{1}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(i_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(i_{1}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_{1}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_{2}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(M_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(T_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(G_{0}\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(N^{f}\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 2 & 0.6 & 2 & 0.1 & 6 & 0.2 & 0.4 & 5 & 1 & 1 & 1.5 &
18 \\
2: fall in animal spirits (\(i_{0}\)) & 2 & 0.6 & 1 & 0.1 & 6 & 0.2 &
0.4 & 5 & 1 & 1 & 1.5 & 18 \\
3: increased liquidity preference (\(m_{0}\)) & 2 & 0.6 & 2 & 0.1 & 7 &
0.2 & 0.4 & 5 & 1 & 1 & 1.5 & 18 \\
4: monetary expansion (\(M_{0}\)) & 2 & 0.6 & 2 & 0.1 & 6 & 0.2 & 0.4 &
6 & 1 & 1 & 1.5 & 18 \\
5: tax cut (\(T_{0}\)) & 2 & 0.6 & 2 & 0.1 & 6 & 0.2 & 0.4 & 5 & 0 & 1 &
1.5 & 18 \\
6: fiscal expansion (\(G_{0}\)) & 2 & 0.6 & 2 & 0.1 & 6 & 0.2 & 0.4 & 5
& 1 & 2 & 1.5 & 18 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-1}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{6}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Income/output}
\NormalTok{C\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Consumption}
\NormalTok{I\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Investment}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Real interest rate}
\NormalTok{N\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Employment}
\NormalTok{U\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Unemployment rate}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{i0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# autonomous investment}
\NormalTok{m0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Autonomous demand for money}
\NormalTok{M0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# money supply}
\NormalTok{G0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# government spending}
\NormalTok{T0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# taxes}
\NormalTok{i0[]}\OtherTok{=}\DecValTok{2}
\NormalTok{m0[]}\OtherTok{=}\DecValTok{6}
\NormalTok{M0[]}\OtherTok{=}\DecValTok{5}   
\NormalTok{G0[]}\OtherTok{=}\DecValTok{1}   
\NormalTok{T0[]}\OtherTok{=}\DecValTok{1}

\DocumentationTok{\#\# Construct scenarios}
\CommentTok{\# scenario 2: fall in animal spirits}
\NormalTok{i0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\DecValTok{1}
 
\CommentTok{\#scenario 3: increase in liquidity preference}
\NormalTok{m0[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\DecValTok{7}

\CommentTok{\# scenario 4: monetary expansion }
\NormalTok{M0[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\DecValTok{6}

\CommentTok{\# scenario 5: reduction in tax rate}
\NormalTok{T0[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\DecValTok{0}  

\CommentTok{\# scenario 6: fiscal expansion}
\NormalTok{G0[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\DecValTok{2} 

\CommentTok{\#Set constant parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{2}   \CommentTok{\# Autonomous consumption}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# Sensitivity of consumption with respect to the income (marginal propensity to consume)}
\NormalTok{i1}\OtherTok{=}\FloatTok{0.1} \CommentTok{\# Sensitivity of investment with respect to the interest rate}
\NormalTok{m1}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# Sensitivity of money demand with respect to income}
\NormalTok{m2}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# Sensitivity of money demand with respect to interest rate}
\NormalTok{a}\OtherTok{=}\FloatTok{1.5}  \CommentTok{\# labour coefficient}
\NormalTok{Nf}\OtherTok{=}\DecValTok{18}  \CommentTok{\# Full employment/labour force}

\CommentTok{\# Initialise endogenous variables at some arbitrary positive value }
\NormalTok{Y }\OtherTok{=}\NormalTok{ C }\OtherTok{=}\NormalTok{ I }\OtherTok{=}\NormalTok{r }\OtherTok{=}\NormalTok{ N }\OtherTok{=}\NormalTok{ U }\OtherTok{=} \DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
    
    \CommentTok{\#Model equations}
    
    \CommentTok{\# Goods market equilibrium}
\NormalTok{    Y }\OtherTok{=}\NormalTok{ C }\SpecialCharTok{+}\NormalTok{ I }\SpecialCharTok{+}\NormalTok{ G0[i]}
    
    \CommentTok{\# Consumption demand}
\NormalTok{    C }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{(Y}\SpecialCharTok{{-}}\NormalTok{T0[i])}
    
    \CommentTok{\# Investment demand}
\NormalTok{    I }\OtherTok{=}\NormalTok{ i0[i] }\SpecialCharTok{{-}}\NormalTok{ i1}\SpecialCharTok{*}\NormalTok{r}
    
    \CommentTok{\# Money market, solved for interest rate}
\NormalTok{    r }\OtherTok{=}\NormalTok{ (m0[i] }\SpecialCharTok{{-}}\NormalTok{ M0[i])}\SpecialCharTok{/}\NormalTok{m2 }\SpecialCharTok{+}\NormalTok{ m1}\SpecialCharTok{*}\NormalTok{Y}\SpecialCharTok{/}\NormalTok{m2}
    
    \CommentTok{\# Employment}
\NormalTok{    N }\OtherTok{=}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{Y }
    
    \CommentTok{\#Unemployment rate}
\NormalTok{    U }\OtherTok{=}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ N}\SpecialCharTok{/}\NormalTok{Nf)}
    
\NormalTok{  \}}
  \CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{  Y\_star[i]}\OtherTok{=}\NormalTok{Y}
\NormalTok{  C\_star[i]}\OtherTok{=}\NormalTok{C}
\NormalTok{  I\_star[i]}\OtherTok{=}\NormalTok{I}
\NormalTok{  r\_star[i]}\OtherTok{=}\NormalTok{r}
\NormalTok{  N\_star[i]}\OtherTok{=}\NormalTok{N}
\NormalTok{  U\_star[i]}\OtherTok{=}\NormalTok{U}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set the number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Create arrays to store equilibrium solutions from different parameterizations}
\NormalTok{Y\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Income/output}
\NormalTok{C\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Consumption}
\NormalTok{I\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Investment}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Real interest rate}
\NormalTok{N\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Employment}
\NormalTok{U\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Unemployment rate}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{i0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Autonomous investment}
\NormalTok{m0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Autonomous demand for money}
\NormalTok{M0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Money supply}
\NormalTok{G0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Government spending}
\NormalTok{T0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Taxes}

\CommentTok{\# Baseline parameterisation}
\NormalTok{i0[:] }\OperatorTok{=} \DecValTok{2}
\NormalTok{m0[:] }\OperatorTok{=} \DecValTok{6}
\NormalTok{M0[:] }\OperatorTok{=} \DecValTok{5}
\NormalTok{G0[:] }\OperatorTok{=} \DecValTok{1}
\NormalTok{T0[:] }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Construct scenarios}
\CommentTok{\# scenario 2: fall in animal spirits}
\NormalTok{i0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# scenario 3: increase in liquidity preference}
\NormalTok{m0[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \DecValTok{7}

\CommentTok{\# scenario 4: monetary expansion}
\NormalTok{M0[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# scenario 5: reduction in tax rate}
\NormalTok{T0[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \DecValTok{0}

\CommentTok{\# scenario 6: fiscal expansion}
\NormalTok{G0[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# Set constant parameter values}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{2}  \CommentTok{\# Autonomous consumption}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of consumption with respect to income (marginal propensity to consume)}
\NormalTok{i1 }\OperatorTok{=} \FloatTok{0.1}  \CommentTok{\# Sensitivity of investment with respect to the interest rate}
\NormalTok{m1 }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Sensitivity of money demand with respect to income}
\NormalTok{m2 }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# Sensitivity of money demand with respect to the interest rate}
\NormalTok{a }\OperatorTok{=} \FloatTok{1.5}  \CommentTok{\# labor coefficient}
\NormalTok{Nf }\OperatorTok{=} \DecValTok{18}  \CommentTok{\# Full employment/labor force}

\CommentTok{\# Initialize endogenous variables at some arbitrary positive value}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=}\NormalTok{ I }\OperatorTok{=}\NormalTok{r }\OperatorTok{=}\NormalTok{ N }\OperatorTok{=}\NormalTok{ U }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# Model equations}

        \CommentTok{\# Goods market equilibrium}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ I }\OperatorTok{+}\NormalTok{ G0[i]}

        \CommentTok{\# Consumption demand}
\NormalTok{        C }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ (Y }\OperatorTok{{-}}\NormalTok{ T0[i])}

        \CommentTok{\# Investment demand}
\NormalTok{        I }\OperatorTok{=}\NormalTok{ i0[i] }\OperatorTok{{-}}\NormalTok{ i1 }\OperatorTok{*}\NormalTok{ r}

        \CommentTok{\# Money market, solved for interest rate}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (m0[i] }\OperatorTok{{-}}\NormalTok{ M0[i]) }\OperatorTok{/}\NormalTok{ m2 }\OperatorTok{+}\NormalTok{ m1 }\OperatorTok{*}\NormalTok{ Y }\OperatorTok{/}\NormalTok{ m2}

        \CommentTok{\# Employment}
\NormalTok{        N }\OperatorTok{=}\NormalTok{ a }\OperatorTok{*}\NormalTok{ Y}

        \CommentTok{\# Unemployment rate}
\NormalTok{        U }\OperatorTok{=} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ N }\OperatorTok{/}\NormalTok{ Nf}

    \CommentTok{\# Save results for different parameterizations in the arrays}
\NormalTok{    Y\_star[i] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    C\_star[i] }\OperatorTok{=}\NormalTok{ C}
\NormalTok{    I\_star[i] }\OperatorTok{=}\NormalTok{ I}
\NormalTok{    r\_star[i] }\OperatorTok{=}\NormalTok{ r}
\NormalTok{    N\_star[i] }\OperatorTok{=}\NormalTok{ N}
\NormalTok{    U\_star[i] }\OperatorTok{=}\NormalTok{ U}
    
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-1}

Figure~\ref{fig-output} and Figure~\ref{fig-r} depict the response of
the model's key endogenous variables, output and the interest rate, to
various shifts. A fall in animal spirits (scenario 2) and an increase in
liquidity preference (scenario 3) both have contractionary effects.
While the fall in animal spirits directly reduces aggregate demand and
thereby output (despite a fall in the interest rate), the rise in
liquidity preference depresses output through its positive effect on the
interest rate. Both scenarios raise the unemployment rate
(Figure~\ref{fig-U}). Scenarios 4 to 6 assess three different
macroeconomic policy tools to stimulate output. It can be seen in
Figure~\ref{fig-output} that fiscal policy is more effective than
monetary policy for the parameterisation in Table 1.\footnote{The
  analytical discussion below shows formally that fiscal policy is more
  effective than monetary policy if \(m_{2}>i_{2}\).} Direct fiscal
stimulus is more effective than tax cuts due to the constant marginal
propensity to consume. The effect on output is a multiple of the
one-unit stimulus thanks to the multiplier effect. However, it can also
be seen that fiscal policy raises the interest rate, which crowds out
some of the expansionary effect.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(Y\_star, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                                      \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-output-1.pdf}

}

\caption{\label{fig-output}Output}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(r\_star, }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                                      \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-r-1.pdf}

}

\caption{\label{fig-r}Interest rate}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(U\_star}\SpecialCharTok{*}\DecValTok{100}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"U (\%)"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                                              \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-U-1.pdf}

}

\caption{\label{fig-U}Unemployment}

\end{figure}%

Figure~\ref{fig-I} and Figure~\ref{fig-C} further show that monetary
policy mostly stimulates investment, whereas fiscal policy boost
consumption.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(I\_star, }\AttributeTok{ylab=}\StringTok{"I"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                                      \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-I-1.pdf}

}

\caption{\label{fig-I}Investment}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(C\_star, }\AttributeTok{ylab=}\StringTok{"C"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                                      \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-C-1.pdf}

}

\caption{\label{fig-C}Consumption}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(N\_star, }\AttributeTok{ylab=}\StringTok{"N"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{, }\StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-N-1.pdf}

}

\caption{\label{fig-N}Employment}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here only for output)    }
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise liq. pref."}\NormalTok{,}
                  \StringTok{"4:Monetary exp."}\NormalTok{, }\StringTok{"5:Tax cut"}\NormalTok{, }\StringTok{"6:Fiscal exp."}\NormalTok{]}

\NormalTok{plt.bar(scenario\_names, Y\_star)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xticks( scenario\_names, rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-1}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_{1}\) to node \(x_{2}\)
indicates a causal impact of \(x_{1}\) on \(x_{2}\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct auxiliary Jacobian matrix for 11 variables: Y, C, I, G, T, r, M0, N, i0, m0, Md}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{11}\NormalTok{, }\DecValTok{11}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(G[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(T[}\DecValTok{0}\NormalTok{]), }\StringTok{"r"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(M[}\DecValTok{0}\NormalTok{]), }\StringTok{"N"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(i[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(m[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(M[d]))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{an_IS_LM_model_files/figure-pdf/fig-DAG-2.pdf}

}

\caption{\label{fig-DAG}Directed graph of IS-LM model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}


\CommentTok{\# Define the auxiliary Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{]}
\NormalTok{])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}


\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}
    \DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{,}
    \DecValTok{1}\NormalTok{: }\StringTok{"C"}\NormalTok{,}
    \DecValTok{2}\NormalTok{: }\StringTok{"I"}\NormalTok{,}
    \DecValTok{3}\NormalTok{: }\VerbatimStringTok{r"$G\_0$"}\NormalTok{,}
    \DecValTok{4}\NormalTok{: }\VerbatimStringTok{r"$T\_0$"}\NormalTok{,}
    \DecValTok{5}\NormalTok{: }\StringTok{"r"}\NormalTok{,}
    \DecValTok{6}\NormalTok{: }\VerbatimStringTok{r"$M\_0$"}\NormalTok{,}
    \DecValTok{7}\NormalTok{: }\StringTok{"N"}\NormalTok{,}
    \DecValTok{8}\NormalTok{: }\VerbatimStringTok{r"$i\_0$"}\NormalTok{,}
    \DecValTok{9}\NormalTok{: }\VerbatimStringTok{r"$m\_0$"}\NormalTok{,}
    \DecValTok{10}\NormalTok{: }\VerbatimStringTok{r"$M\_d$"}
\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Analytical discussion}\label{analytical-discussion}

To obtain the IS-curve, substitute Equation~\ref{eq-islmC} -
Equation~\ref{eq-islmT} into Equation~\ref{eq-islmY} and solve for
\(Y\):

\begin{equation}\phantomsection\label{eq-IS}{
Y=\left(\frac{1}{1-c_1}\right)(c_0 + i_0 + G_0 - i_1r - c_1 T_0).
}\end{equation}

To obtain the LM-curve, substitute Equation~\ref{eq-islmMs} -
Equation~\ref{eq-islmMd} into Equation~\ref{eq-islmM} and solve for
\(r\):

\begin{equation}\phantomsection\label{eq-LM}{
r=\left(\frac{1}{m_2}\right)(m_0 - M_0 + m_1Y).
}\end{equation}

Finally, to obtain equilibrium solutions for \(Y\) and \(r\), substitute
Equation~\ref{eq-LM} into Equation~\ref{eq-IS} and vice versa:

\[
Y^*=\left[\frac{m_2}{(1-c_1)m_2+i_1m_1}\right](c_0 + i_0 + G_0 - c_1 T_0) + \left[\frac{i_1}{(1-c_1)m_2+i_1m_1}\right](M_0-m_0)
\]

\[
r^*= \left[\frac{1-c_1}{(1-c_1)m_2+i_1m_1}\right](m_0-M_0)+\left[\frac{m_1}{(1-c_1)m_2+i_1m_1}\right](c_0+i_0+G_0-c_1T_0).
\]

From this, the following results can be obtained:

\begin{itemize}
\item
  The equilibrium effects of a change in taxes are smaller than those
  from a change in government spending (since \(c_1\) is smaller than
  one).
\item
  Government spending is more effective than monetary expansion if
  \(m_2 > i_1\) (which is the case for the parameterisation in Table 1.
\item
  The equilibrium multiplier
  \(\left[\frac{m_2}{(1-c_1)m_2+i_1m_1}\right]\) is smaller than the
  aggregate demand multiplier \(\left(\frac{1}{1-c_1}\right)\) due to
  the positive effect on the interest rate and the corresponding
  negative effect investment (\(i_1m_1\)). This is the crowding out
  mechanism.
\end{itemize}

\subsection{Calculate equilibrium fiscal
multiplier}\label{calculate-equilibrium-fiscal-multiplier}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y\_star[}\DecValTok{6}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{Y\_star[}\DecValTok{1}\NormalTok{] }\CommentTok{\# numerical approach}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.222222
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m2}\SpecialCharTok{/}\NormalTok{((}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{c1)}\SpecialCharTok{*}\NormalTok{m2}\SpecialCharTok{+}\NormalTok{i1}\SpecialCharTok{*}\NormalTok{m1) }\CommentTok{\# analytical approach}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.222222
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y\_star[}\DecValTok{5}\NormalTok{]}\OperatorTok{{-}}\NormalTok{Y\_star[}\DecValTok{0}\NormalTok{] }\CommentTok{\# numerical approach}

\NormalTok{m2}\OperatorTok{/}\NormalTok{((}\DecValTok{1}\OperatorTok{{-}}\NormalTok{c1)}\OperatorTok{*}\NormalTok{m2}\OperatorTok{+}\NormalTok{i1}\OperatorTok{*}\NormalTok{m1) }\CommentTok{\# analytical approach}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section*{References}\label{references-2}
\addcontentsline{toc}{section}{References}

\markright{References}

\chapter{A Neoclassical Synthesis Model
(IS-LM-AS-AD)}\label{sec-neoclassical-synthesis}

\section{Overview}\label{overview-2}

The Neoclassical Synthesis was developed in the 1940s and 1950s by
Franco Modigliani, Paul Samuelson and others. It introduced neoclassical
components into the Keynesian IS-LM model that had been proposed by John
R. A. R. Hicks (1937) to formalise some key ideas of John Maynard
Keynes' 1936 book
\href{https://en.wikipedia.org/wiki/The_General_Theory_of_Employment,_Interest_and_Money}{The
General Theory of Employment, Interest and Money}. The IS-LM model,
which is analysed in detail in Chapter~\ref{sec-islm-model}, contains
two equilibrium relationships: a goods market equilibrium between
investment and saving (IS) and a money market equilibrium between money
demand and money supply (LM). In the goods market, aggregate supply
adjusts to the level of aggregate demand given by the expenditure
decisions of households, firms, and the government. Money demand is
determined by aggregate income and the interest rate on bonds. The money
supply is assumed to be exogenous. The two markets pin down equilibrium
output and the interest rate.

The Neoclassical Synthesis adds a neoclassical labour market with
Keynesian frictions to the IS-LM model. Following the discussion in
Froyen (2005), chap.~9, we consider a labour market in which firms have
perfect information about the real wage, whereas workers need to form
expectations about the price level. Price expectations are assumed to be
exogenous in the short run. Workers thus suffer from `money illusion':
an increase in the actual price levels reduces the real wage but leaves
their labour supply unchanged. This gives rise to an upward-sloping
aggregate supply (AS) (or Phillips) curve. By contrast, the aggregate
demand (AD) curve is downward-sloping as a higher price level increases
the demand for real money balances, which pushes up the interest rate.

In this short-run model, prices are flexible but the capital stock is
fixed. The focus is thus on goods market equilibrium rather than
economic growth. As all endogenous variables adjust instantaneously, the
model is static. We consider a version with a Cobb-Douglass production
function and otherwise linear behavioural functions, based on the
graphical analysis in Froyen (2005), chap.~9.

\section{The Model}\label{the-model-2}

\begin{equation}\phantomsection\label{eq-Y-AS_AD}{
Y=C+I+G_0
}\end{equation}

\begin{equation}\phantomsection\label{eq-C-AS_AD}{
C=c_0+c_1(Y-T_0), \quad c_1 \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-I-AS_AD}{
I= i_0 - i_1r,  \quad i_1 > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-Ms-AS_AD}{
M_s=M_0
}\end{equation}

\begin{equation}\phantomsection\label{eq-Md-AS_AD}{
\frac{M_d}{P}=m_0 + m_1Y -m_2r, \quad m_1, m_2 > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-M_eq-AS_AD}{
M_d(r)=M_s 
}\end{equation}

\begin{equation}\phantomsection\label{eq-w-AS_AD}{
w=(1-a)AK^aN^{-a} ,\quad a\in (0,1) 
}\end{equation}

\begin{equation}\phantomsection\label{eq-W-AS_AD}{
W=\frac{P^ebC}{1-\frac{N}{N^f}},  \quad b \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-P-AS_AD}{
P=\frac{W}{w} 
}\end{equation}

\begin{equation}\phantomsection\label{eq-N-AS_AD}{
N=\left( \frac{Y}{AK^{a}}\right)^{\frac{1}{1-a}}
}\end{equation}

\begin{equation}\phantomsection\label{eq-U-AS_AD}{
U=1-\frac{N}{N^f} 
}\end{equation}

where \(Y\), \(C\), \(I\), \(G_0\), \(T_0\), \(r\), \(M_s\), \(M_d\),
\(w\), \(A\), \(K\), \(N\), \(W\), \(P^e\) \(N^f\), \(P\), and \(U\) are
output, consumption, investment, (exogenous) government spending,
(exogenous) taxes, the real interest rate on bonds, nominal money
supply, nominal money demand, the real wage, productivity, the capital
stock, employment, the nominal wage, the price level expected by
workers, the labour force (or total available time for work), the actual
price level, and the unemployment rate, respectively.

Equation~\ref{eq-Y-AS_AD} is the goods market equilibrium condition.
Aggregate supply (\(Y\)) accommodates to the level of aggregate demand
which is the sum of consumption, investment, and government spending.
Equation~\ref{eq-C-AS_AD} is the consumption function consisting of
autonomous consumption demand (\(c_0\)) and a marginal propensity to
consume (\(c_1\)) out of disposable income (\(Y-T_0\)). Investment
demand in Equation~\ref{eq-I-AS_AD} has an autonomous component
(\(i_0\)) capturing Keynesian animal spirits and a component that is
negatively related to the rate of interest on bonds. Government spending
and taxation are exogenous. Similarly, the nominal money supply
(\(M_0\)) in Equation~\ref{eq-Ms-AS_AD} is assumed to be exogenous. By
Equation~\ref{eq-Md-AS_AD}, households' real money demand is positively
related to income (capturing the transaction demand for money) and
negatively related to the interest rate on bonds (capturing speculative
demand). There is also an autonomous term (\(m_0\)) capturing Keynesian
liquidity preference. Equilibrium in the money market
Equation~\ref{eq-M_eq-AS_AD} yields an equation for the interest rate.

In Equation~\ref{eq-w-AS_AD}, the real wage is determined by the
marginal product of labour implied by a Cobb-Douglass production
function (\(Y=AK^aN^{1-a}\)). This means the real wage is always
consistent with firms' demand for labour based on
profit-maximisation.\footnote{See the notes on the Classical Model
  \href{https://karstenkohlercom.files.wordpress.com/2022/03/neoclassical_model.pdf}{(\underline{here})}
  for a formal derivation of the labour demand and supply curves from
  optimisation. A minor modification is that here we work with a
  normalisation of the term for leisure in the household's log-utility
  function, \(\ln(1-\frac{N}{N^f})\), to allow \(N\) to be larger than
  unity.} Equation~\ref{eq-W-AS_AD} specifies the nominal wage as
implied by households' labour supply curve. Optimising households supply
labour based on their work-leisure trade-off (with the parameter \(b\)
capturing their preference for leisure, \(1-\frac{N}{N^f}\)). Since they
don't have knowledge of the current real wage, they base their decisions
on the expected price level \(P^e\), which is exogenous in the short
run. The actual price level is then given by the ratio of the nominal
wage to the real wage Equation~\ref{eq-P-AS_AD}. In other words, firms
set prices such that the nominal wage they pay to workers are consistent
with their own desired real wage. Equation~\ref{eq-N-AS_AD} pins down
employment as implied by the Cobb-Douglass production function. In
conjunction with an exogenously given labour force \(N^f\) (or total
available labour time), the level of employment can be used to obtain an
unemployment rate in Equation~\ref{eq-U-AS_AD}.

\section{Simulation}\label{simulation-2}

\subsection{Parameterisation}\label{parameterisation-2}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), five further scenarios will be
considered. Scenario 2 is a switch towards pessimistic sentiments in the
form of a fall in animal spirits (\(i_0\)). In scenario 3, productivity
(\(A\)) increases. Scenario 4 considers a rise in the price level
expected by workers (\(P^e\)). Scenarios 5 and 6 consider two different
government policies to stimulate the economy: a monetary expansion
(\(M_0\)) and a fiscal expansion (\(G_0\)).

\textbf{Table 1: Parameterisation}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.2979}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0355}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0496}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0355}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 30\tabcolsep) * \real{0.0355}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(i_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(i_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(A\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(P^e\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(m_2\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(M_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(G_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(T_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(N^f\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 2 & 0.6 & 2 & 0.1 & 2 & 1 & 6 & 0.2 & 0.4 & 5 & 1 & 1 & 7
& 0.3 & 0.4 \\
2: fall in animal spirits (\(i_0\)) & 2 & 0.6 & 1.5 & 0.1 & 2 & 1 & 6 &
0.2 & 0.4 & 5 & 1 & 1 & 7 & 0.3 & 0.4 \\
3: rise in productivity (\(A\)) & 2 & 0.6 & 2 & 0.1 & 3 & 1 & 6 & 0.2 &
0.4 & 5 & 1 & 1 & 7 & 0.3 & 0.4 \\
4: rise in expected price level (\(P^e\)) & 2 & 0.6 & 2 & 0.1 & 2 & 1.5
& 6 & 0.2 & 0.4 & 5 & 1 & 1 & 7 & 0.3 & 0.4 \\
5: monetary expansion (\(M_0\)) & 2 & 0.6 & 2 & 0.1 & 2 & 1 & 6 & 0.2 &
0.4 & 6 & 1 & 1 & 7 & 0.3 & 0.4 \\
6: fiscal expansion (\(G_0\)) & 2 & 0.6 & 2 & 0.1 & 2 & 1 & 6 & 0.2 &
0.4 & 5 & 2 & 1 & 7 & 0.3 & 0.4 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-2}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{6}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Income/output}
\NormalTok{C\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Consumption}
\NormalTok{I\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Investment}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Real interest rate}
\NormalTok{N\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Employment}
\NormalTok{U\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Unemployment rate}
\NormalTok{P\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Price level}
\NormalTok{w\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Real wage}
\NormalTok{W\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# Nominal wage}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{i0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# autonomous investment (animal spirits)}
\NormalTok{M0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# money supply}
\NormalTok{G0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# government spending}
\NormalTok{P0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# expected price level}
\NormalTok{A}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# Exogenous productivity}

\DocumentationTok{\#\#\# Construct different scenarios}
\CommentTok{\# baseline }
\NormalTok{A[]}\OtherTok{=}\DecValTok{2}  
\NormalTok{i0[]}\OtherTok{=}\DecValTok{2}
\NormalTok{M0[]}\OtherTok{=}\DecValTok{5}   
\NormalTok{G0[]}\OtherTok{=}\DecValTok{1}   
\NormalTok{P0[]}\OtherTok{=}\DecValTok{1}

\CommentTok{\# scenario 2: fall in animal spirits}
\NormalTok{i0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{1.5}

\CommentTok{\# scenario 3: increase in productivity}
\NormalTok{A[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\DecValTok{3}

\CommentTok{\# scenario 4: increase in expected price level}
\NormalTok{P0[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{1.5}  
   
\CommentTok{\# scenario 5: monetary expansion }
\NormalTok{M0[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\DecValTok{6}

\CommentTok{\# scenario 6: fiscal expansion}
\NormalTok{G0[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\DecValTok{2}  
    
\CommentTok{\#Set constant parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{2}   \CommentTok{\# Autonomous consumption}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# Sensitivity of consumption with respect to the income (marginal propensity to consume)}
\NormalTok{i1}\OtherTok{=}\FloatTok{0.1} \CommentTok{\# Sensitivity of investment with respect to the interest rate}
\NormalTok{m1}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# Sensitivity of money demand with respect to income}
\NormalTok{m2}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# Sensitivity of money demand with respect to interest rate}
\NormalTok{Nf}\OtherTok{=}\DecValTok{5}   \CommentTok{\# Full employment/labour force}
\NormalTok{K}\OtherTok{=}\DecValTok{4}    \CommentTok{\# Exogenous capital stock}
\NormalTok{a}\OtherTok{=}\FloatTok{0.3}  \CommentTok{\# Capital elasticity of output}
\NormalTok{b}\OtherTok{=}\FloatTok{0.4}  \CommentTok{\# household preference for leisure}
\NormalTok{T0}\OtherTok{=}\DecValTok{1}   \CommentTok{\# tax revenues}
\NormalTok{m0}\OtherTok{=}\DecValTok{6}   \CommentTok{\# liquidity preference}

\CommentTok{\# Initialise endogenous variables at some arbitrary positive value }
\NormalTok{Y }\OtherTok{=}\NormalTok{ C }\OtherTok{=}\NormalTok{ I }\OtherTok{=}\NormalTok{ r }\OtherTok{=}\NormalTok{ P }\OtherTok{=}\NormalTok{ w }\OtherTok{=}\NormalTok{ N }\OtherTok{=}\NormalTok{ W }\OtherTok{=} \DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
    
    \CommentTok{\#Model equations}
    
    \CommentTok{\# Goods market equilibrium}
\NormalTok{    Y }\OtherTok{=}\NormalTok{ C }\SpecialCharTok{+}\NormalTok{ I }\SpecialCharTok{+}\NormalTok{ G0[i]}
    
    \CommentTok{\# Consumption demand}
\NormalTok{    C }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{(Y}\SpecialCharTok{{-}}\NormalTok{T0)}
    
    \CommentTok{\# Investment demand}
\NormalTok{    I }\OtherTok{=}\NormalTok{ i0[i] }\SpecialCharTok{{-}}\NormalTok{ i1}\SpecialCharTok{*}\NormalTok{r}
    
    \CommentTok{\# Money market, solved for interest rate}
\NormalTok{    r }\OtherTok{=}\NormalTok{ (m0 }\SpecialCharTok{{-}}\NormalTok{ (M0[i]}\SpecialCharTok{/}\NormalTok{P))}\SpecialCharTok{/}\NormalTok{m2 }\SpecialCharTok{+}\NormalTok{ m1}\SpecialCharTok{*}\NormalTok{Y}\SpecialCharTok{/}\NormalTok{m2}
    
    \CommentTok{\#Unemployment rate}
\NormalTok{    U }\OtherTok{=}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ N}\SpecialCharTok{/}\NormalTok{Nf)}
    
    \CommentTok{\#Real wage }
\NormalTok{    w }\OtherTok{=}\NormalTok{ A[i]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a)}\SpecialCharTok{*}\NormalTok{(K}\SpecialCharTok{\^{}}\NormalTok{a)}\SpecialCharTok{*}\NormalTok{N}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a)}
    
    \CommentTok{\#Nominal wage }
\NormalTok{    W}\OtherTok{=}\NormalTok{ (P0[i]}\SpecialCharTok{*}\NormalTok{b}\SpecialCharTok{*}\NormalTok{C)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{ (N}\SpecialCharTok{/}\NormalTok{Nf))}
    
    \CommentTok{\#Price level }
\NormalTok{    P }\OtherTok{=}\NormalTok{ W}\SpecialCharTok{/}\NormalTok{w}
    
    \CommentTok{\#Employment }
\NormalTok{    N }\OtherTok{=}\NormalTok{ (Y}\SpecialCharTok{/}\NormalTok{(A[i]}\SpecialCharTok{*}\NormalTok{(K}\SpecialCharTok{\^{}}\NormalTok{a)))}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a))}

\NormalTok{\}}
  
  \CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{  Y\_star[i]}\OtherTok{=}\NormalTok{Y}
\NormalTok{  C\_star[i]}\OtherTok{=}\NormalTok{C}
\NormalTok{  I\_star[i]}\OtherTok{=}\NormalTok{I}
\NormalTok{  r\_star[i]}\OtherTok{=}\NormalTok{r}
\NormalTok{  N\_star[i]}\OtherTok{=}\NormalTok{N}
\NormalTok{  U\_star[i]}\OtherTok{=}\NormalTok{U}
\NormalTok{  P\_star[i]}\OtherTok{=}\NormalTok{P}
\NormalTok{  w\_star[i]}\OtherTok{=}\NormalTok{w}
\NormalTok{  W\_star[i]}\OtherTok{=}\NormalTok{W}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set the number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Create arrays to store equilibrium solutions from different parameterizations}
\NormalTok{Y\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Income/output}
\NormalTok{C\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Consumption}
\NormalTok{I\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Investment}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Real interest rate}
\NormalTok{N\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Employment}
\NormalTok{U\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Unemployment rate}
\NormalTok{P\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Price level}
\NormalTok{w\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Real wage}
\NormalTok{W\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Nominal wage}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{i0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Autonomous investment (animal spirits)}
\NormalTok{M0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Money supply}
\NormalTok{G0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Government spending}
\NormalTok{P0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# Expected price level}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# Exogenous productivity}

\CommentTok{\# Construct different scenarios}
\CommentTok{\# baseline}
\NormalTok{A[:] }\OperatorTok{=} \DecValTok{2}
\NormalTok{i0[:] }\OperatorTok{=} \DecValTok{2}
\NormalTok{M0[:] }\OperatorTok{=} \DecValTok{5}
\NormalTok{G0[:] }\OperatorTok{=} \DecValTok{1}
\NormalTok{P0[:] }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# scenario 2: fall in animal spirits}
\NormalTok{i0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}

\CommentTok{\# scenario 3: increase in productivity}
\NormalTok{A[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \DecValTok{3}

\CommentTok{\# scenario 4: increase in expected price level}
\NormalTok{P0[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}

\CommentTok{\# scenario 5: monetary expansion}
\NormalTok{M0[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# scenario 6: fiscal expansion}
\NormalTok{G0[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# Set constant parameter values}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{2}  \CommentTok{\# Autonomous consumption}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of consumption with respect to income (marginal propensity to consume)}
\NormalTok{i1 }\OperatorTok{=} \FloatTok{0.1}  \CommentTok{\# Sensitivity of investment with respect to the interest rate}
\NormalTok{m1 }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Sensitivity of money demand with respect to income}
\NormalTok{m2 }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# Sensitivity of money demand with respect to interest rate}
\NormalTok{Nf }\OperatorTok{=} \DecValTok{5}  \CommentTok{\# Full employment/labor force}
\NormalTok{K }\OperatorTok{=} \DecValTok{4}  \CommentTok{\# Exogenous capital stock}
\NormalTok{a }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# Capital elasticity of output}
\NormalTok{b }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# Household preference for leisure}
\NormalTok{T0 }\OperatorTok{=} \DecValTok{1}  \CommentTok{\# Tax revenues}
\NormalTok{m0 }\OperatorTok{=} \DecValTok{6}  \CommentTok{\# Liquidity preference}

\CommentTok{\# Initialize endogenous variables at some arbitrary positive value}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{=}\NormalTok{ I }\OperatorTok{=}\NormalTok{ r }\OperatorTok{=}\NormalTok{ P }\OperatorTok{=}\NormalTok{ w }\OperatorTok{=}\NormalTok{ N }\OperatorTok{=}\NormalTok{ W }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# Model equations}

        \CommentTok{\# Goods market equilibrium}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ I }\OperatorTok{+}\NormalTok{ G0[i]}

        \CommentTok{\# Consumption demand}
\NormalTok{        C }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ (Y }\OperatorTok{{-}}\NormalTok{ T0)}

        \CommentTok{\# Investment demand}
\NormalTok{        I }\OperatorTok{=}\NormalTok{ i0[i] }\OperatorTok{{-}}\NormalTok{ i1 }\OperatorTok{*}\NormalTok{ r}

        \CommentTok{\# Money market, solved for interest rate}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (m0 }\OperatorTok{{-}}\NormalTok{ (M0[i] }\OperatorTok{/}\NormalTok{ P)) }\OperatorTok{/}\NormalTok{ m2 }\OperatorTok{+}\NormalTok{ m1 }\OperatorTok{*}\NormalTok{ Y }\OperatorTok{/}\NormalTok{ m2}

        \CommentTok{\# Unemployment rate}
\NormalTok{        U }\OperatorTok{=} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ N }\OperatorTok{/}\NormalTok{ Nf}

        \CommentTok{\# Real wage}
\NormalTok{        w }\OperatorTok{=}\NormalTok{ A[i] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a) }\OperatorTok{*}\NormalTok{ (K }\OperatorTok{**}\NormalTok{ a) }\OperatorTok{*}\NormalTok{ (N }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\NormalTok{a))}

        \CommentTok{\# Nominal wage}
\NormalTok{        W }\OperatorTok{=}\NormalTok{ (P0[i] }\OperatorTok{*}\NormalTok{ b }\OperatorTok{*}\NormalTok{ C) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ (N }\OperatorTok{/}\NormalTok{ Nf))}

        \CommentTok{\# Price level}
\NormalTok{        P }\OperatorTok{=}\NormalTok{ W }\OperatorTok{/}\NormalTok{ w}

        \CommentTok{\# Employment}
\NormalTok{        N }\OperatorTok{=}\NormalTok{ (Y }\OperatorTok{/}\NormalTok{ (A[i] }\OperatorTok{*}\NormalTok{ (K }\OperatorTok{**}\NormalTok{ a))) }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a))}

    \CommentTok{\# Save results for different parameterizations in the arrays}
\NormalTok{    Y\_star[i] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    C\_star[i] }\OperatorTok{=}\NormalTok{ C}
\NormalTok{    I\_star[i] }\OperatorTok{=}\NormalTok{ I}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-2}

Figures Figure~\ref{fig-output} -
Figure~\ref{fig-nominal-wage-neocl-macro} depict the response of the
model's key endogenous variables to various shifts. A fall in animal
spirits (scenario 2) reduces aggregate demand and thereby output and
employment (despite a fall in the interest rate). This reduces workers'
nominal wage demands and thus the price level. An increase in
productivity (scenario 3) has expansionary effects on output but adverse
effects on employment. Higher productivity means that fewer workers need
to be hired to produce the same level of output. However, the
corresponding reduction in employment also reduces the price level,
which lowers the (real) demand for money and thus lowers the interest
rate. This has expansionary effects on output.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(Y\_star, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                      \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-output-neocl-macro-1.pdf}

}

\caption{\label{fig-output-neocl-macro}Output}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(P\_star, }\AttributeTok{ylab=}\StringTok{"P"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                      \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-price-level-neocl-macro-1.pdf}

}

\caption{\label{fig-price-level-neocl-macro}Price level}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(r\_star, }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                      \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-interest_rate-neocl-macro-1.pdf}

}

\caption{\label{fig-interest_rate-neocl-macro}Interest rate}

\end{figure}%

A rise in the expected price level (scenario 4) raises nominal wages and
thereby the actual price level. This raises the interest rate, which
exerts a (small) contractionary effect on output and employment.
Scenarios 5 and 6 assess two different macroeconomic policy tools to
stimulate output. A monetary expansion lowers the interest rate and
increases output but also the price level. Similar results arise for a
fiscal expansion. The main difference is that the monetary expansion
lowers the interest rate, whereas the fiscal expansion increases it.
\textbackslash{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(U\_star}\SpecialCharTok{*}\DecValTok{100}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"U (\%)"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                              \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-unemployment-neocl-macro-1.pdf}

}

\caption{\label{fig-unemployment-neocl-macro}Unemployment rate}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(W\_star, }\AttributeTok{ylab=}\StringTok{"W"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                      \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-nominal-wage-neocl-macro-1.pdf}

}

\caption{\label{fig-nominal-wage-neocl-macro}Nominal wage}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(w\_star, }\AttributeTok{ylab=}\StringTok{"w"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                                      \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-real-wage-neocl-macro-1.pdf}

}

\caption{\label{fig-real-wage-neocl-macro}Real wage}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here only for output) }
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
   
\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1:Baseline"}\NormalTok{, }\StringTok{"2:Fall animal spirits"}\NormalTok{, }\StringTok{"3:Rise product."}\NormalTok{,}
                  \StringTok{"4:Rise exp. price"}\NormalTok{, }\StringTok{"5:Monetary expan."}\NormalTok{, }\StringTok{"6:Fiscal expan."}\NormalTok{]}

\NormalTok{plt.bar(scenario\_names, Y\_star)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xticks(scenario\_names, rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-2}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 15 variables: Y, C, I, G, T, r, w, W, P, M0, N, i0, A, P0, Md}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{15}\NormalTok{, }\DecValTok{15}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(G[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(T[}\DecValTok{0}\NormalTok{]), }\StringTok{"r"}\NormalTok{, }\StringTok{"w"}\NormalTok{, }\StringTok{"W"}\NormalTok{, }\StringTok{"P"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(M[}\DecValTok{0}\NormalTok{]), }\StringTok{"N"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(i[}\DecValTok{0}\NormalTok{]), }\StringTok{"A"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(P[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(M[d]))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_neoclassical_synthesis_model_IS_LM_AS_AD_files/figure-pdf/fig-dg-neoclmacro-2.pdf}

}

\caption{\label{fig-dg-neoclmacro}Directed graph of Neoclassical
Synthesis model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}


\CommentTok{\# Define the Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}


\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}
    \DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{,}
    \DecValTok{1}\NormalTok{: }\StringTok{"C"}\NormalTok{,}
    \DecValTok{2}\NormalTok{: }\StringTok{"I"}\NormalTok{,}
    \DecValTok{3}\NormalTok{: }\VerbatimStringTok{r"$G\_0$"}\NormalTok{,}
    \DecValTok{4}\NormalTok{: }\VerbatimStringTok{r"$T\_0$"}\NormalTok{,}
    \DecValTok{5}\NormalTok{: }\StringTok{"r"}\NormalTok{,}
    \DecValTok{6}\NormalTok{: }\StringTok{"w"}\NormalTok{,}
    \DecValTok{7}\NormalTok{: }\StringTok{"W"}\NormalTok{,}
    \DecValTok{8}\NormalTok{: }\StringTok{"P"}\NormalTok{,}
    \DecValTok{9}\NormalTok{: }\VerbatimStringTok{r"$M\_0$"}\NormalTok{,}
    \DecValTok{10}\NormalTok{: }\StringTok{"N"}\NormalTok{,}
    \DecValTok{11}\NormalTok{: }\VerbatimStringTok{r"$i\_0$"}\NormalTok{,}
    \DecValTok{12}\NormalTok{: }\StringTok{"A"}\NormalTok{,}
    \DecValTok{13}\NormalTok{: }\VerbatimStringTok{r"$P\_0$"}\NormalTok{,}
    \DecValTok{14}\NormalTok{: }\VerbatimStringTok{r"$M\_d$"}\NormalTok{,}
\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure~\ref{fig-dg-neoclmacro}, it can be seen that productivity
(\(A\)), taxes (\(T_0\)), government spending (\(G_0\)), animal spirits
(\(i_0\)), the money supply (\(M_0\)), and the expected price level
(\(P_0\)) are the key exogenous variables of the model. All other
variables are endogenous and form a closed loop (or cycle) within the
system. The lower-left part of the graph captures the goods market (IS):
aggregate demand (consumption, investment, and government spending)
determines output. The upper part of the graph contains the labour
market, which determines the price level. Finally, the lower-right part
of the graph represents the money market (LM), which determines the
interest rate. There is a two-way feedback between the goods market and
the money market as output impacts the demand for money, and the
interest rate affects investment. There is also a feedback from output
into the labour market through employment. The labour market feeds into
the money market via its effect on prices and thus money demand, which
then also feeds into the goods market through the interest rate.

\section{Analytical discussion}\label{analytical-discussion-1}

In the first step, we will reduce the system to three equations: an
IS-curve, an LM-curve, and an AS-curve (or Phillips curve). In the
second step, the IS-curve and the LM-curve are combined to yield an
AD-curve.

To obtain the IS-curve, substitute Equation~\ref{eq-C-AS_AD}
-Equation~\ref{eq-I-AS_AD} into Equation~\ref{eq-Y-AS_AD} and solve for
\(Y\): \begin{align}\label{eq:IS-AS_AD}\tag{IS}
Y&=\left(\frac{1}{1-c_1}\right)(c_0 + i_0 + G_0 - i_1r - c_1 T_0).
\end{align}

To obtain the LM-curve, substitute Equation~\ref{eq-Ms-AS_AD} -
Equation~\ref{eq-Md-AS_AD} into Equation~\ref{eq-M_eq-AS_AD} and solve
for \(r\):

\begin{align}\label{eq:LM-AS_AD}\tag{LM}
r&=\left(\frac{1}{m_2}\right)(m_0 - \frac{M_0}{P} + m_1Y).
\end{align}

To obtain the AS-curve, substitute Equation~\ref{eq-w-AS_AD},
Equation~\ref{eq-W-AS_AD}, Equation~\ref{eq-N-AS_AD}, and
Equation~\ref{eq-C-AS_AD} into Equation~\ref{eq-P-AS_AD}:

\begin{align}\label{eq:AS}\tag{AS}
P&=\frac{b(c_0-c_1T_0)+ P^ebc_1Y}{(1-a)\left[\left(AK^aY^{-a}\right)^{\frac{1}{1-a}} - \frac{Y}{N^f}\right]}.
\end{align}

It can readily be seen that the AS-curve is upward-sloping in the
\((Y, P)\)-space (recall that \(a \in (0,1)\)).

Finally, to obtain the AD-curve, substitute the LM-equation into the
IS-equation:

\begin{align}\tag{AD}
Y&=\left[\frac{m_2(c_0 + i_0 + G_0 - c_1 T_0) + i_1(\frac{M_0}{P}-m_0)}{(1-c_1)m_2+i_1m_1}\right]
\end{align}

It can readily be seen that the AD-curve is downward-sloping in the
\((Y, P)\)-space.

\section*{References}\label{references-3}
\addcontentsline{toc}{section}{References}

\markright{References}

\chapter{A Post-Keynesian Macro Model with Endogenous
Money}\label{a-post-keynesian-macro-model-with-endogenous-money}

\section{Overview}\label{overview-3}

Post-Keynesian Economics is an economic paradigm that was developed in
the 1930s and 1940s by Joan Robinson, Nicholas Kaldor and
others.\footnote{See Lavoie (2006), chap.1 and
  \href{https://www.exploring-economics.org/en/orientation/post-keynesian-economics/}{Exploring
  Economics} for introductions. Lavoie (2014) and Hein (2014) provide
  more advanced treatments.} The early post-Keynesian economists sought
to develop further key ideas of John Maynard Keynes. They were critical
of the \href{@neoclassical_synth_chapter}{Neoclassical Synthesis} that
introduced neoclassical elements into the Keynesian framework. Among
many other points, post-Keynesians argued that money is created by
commercial banks. Money creation is determined by the demand for credit
rather than being under the control of the central bank, and should thus
be considered endogenous. Post-Keynesians further assigned a key role to
financial factors in the determination of economic activity, but also
considered finance as a source of instability. They abandoned the
neoclassical approach of deriving labour demand and supply from
optimising behaviour and instead assumed oligopolistic market
structures. Firms set prices by charging a mark-up on costs and workers
set nominal wages based on their bargaining power.

Fontana and Setterfield (2009) present a simple model that could be
regarded as a post-Keynesian alternative to the Neoclassical Synthesis.
The model highlights the endogenous money creation process. Money is
being created when commercial banks make loans to accommodate the demand
for credit by creditworthy borrowers. The demand for credit is driven by
aggregate demand. The interest rate on loans is determined by the base
rate, set by the central bank, on which commercial banks charge a
mark-up. Although credit creation is demand-driven, some borrowers will
be credit constrained. In times of financial crises, banks tighten
credit constraints, which can depress economic activity.

In this short-run model, prices are flexible but the capital stock is
fixed. The focus is thus on goods market equilibrium rather than
economic growth. As all endogenous variables adjust instantaneously, the
model is static. We consider a version of the model due to Fontana and
Setterfield (2009) with linear functions.

\section{The Model}\label{the-model-3}

\begin{equation}\phantomsection\label{eq-Y-PK}{
Y=ND+cD
}\end{equation}

\begin{equation}\phantomsection\label{eq-ND-PK}{
ND=bY, \quad b \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-D-PK}{
D= d_0 - d_1r, \quad d_1 > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-i-PK}{
i=i_0 + i_1P, \quad i_1 > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-r-PK}{
r=(1+m)i, \quad m > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-dL-PK}{
dL=cD
}\end{equation}

\begin{equation}\phantomsection\label{eq-dM-PK}{
dM=dL
}\end{equation}

\begin{equation}\phantomsection\label{eq-dR-PK}{
dR=kdM, \quad k \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-P-PK}{
P=(1+n)aW, \quad a,n > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-W-PK}{
W=W_0 - hU, \quad h > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-w-PK}{
w=\frac{1}{(1+n)a}
}\end{equation}

\begin{equation}\phantomsection\label{eq-N-PK}{
N=aY
}\end{equation}

\begin{equation}\phantomsection\label{eq-U-PK}{
U=1-\frac{N}{N^f}
}\end{equation}

where \(Y\), \(ND\), \(D\), \(r\), \(i\), \(P\), \(dL\), \(dM\), \(dR\),
\(W\), \(w\), \(N\), \(U\), and \(N^f\) are output, the not
debt-financed component of aggregate demand, the desired debt-financed
component of aggregate demand, the lending rate, the policy rate, the
price level, the change in loans, the change in money (bank deposits),
the change in bank reserves, the nominal wage, the real wage,
employment, the unemployment rate, and full employment (or total labour
supply), respectively.

Equation~\ref{eq-Y-PK} is the goods market equilibrium condition.
Aggregate supply (\(Y\)) accommodates to the level of aggregate demand
which is the sum of a not debt-financed component (\(ND\)) and a
(desired) debt-financed component (\(D\)). The coefficient \(c\) is the
proportion of loan applications that are deemed creditworthy and thus
captures credit rationing by banks. By Equation~\ref{eq-ND-PK}, the not
debt-financed component of aggregate demand is a function of current
income. In Equation~\ref{eq-D-PK}, the debt-financed component of
aggregate demand has an autonomous component (\(d_0\))\footnote{For
  simplicity, it is assumed that all autonomous demand is debt-financed,
  i.e.~there is no spending out of wealth.} and is otherwise negatively
related to the lending rate \(r\). Equation~\ref{eq-i-PK} specifies the
monetary policy rule, where it is assumed that the central bank raises
the policy rate \(i\) when the price level increases.\^{}{[}This
specification is somewhat unrealistic given that most modern central
banks target a positive rate of inflation. However, it allows for an
AS-AD representation of the model, which facilitates the comparison with
the Neoclassical Synthesis model
(Chapter~\ref{sec-neoclassical-synthesis}) The lending rate in
Equation~\ref{eq-r-PK} is given by a mark-up \(m\) that banks charge on
the policy rate (which is the rate at which they can borrow reserves).
The change in loans in Equation~\ref{eq-dL-PK} is equal to the
creditworthy demand for loans (\(cD\)). This captures the demand-driven
nature of credit creation. The changes in loans translates one-to-one
into a change in money, which are bank deposits in this model
(Equation~\ref{eq-dM-PK}). This reflects the endogenous money creation
process where commercial banks create new deposits when they make new
loans. By Equation~\ref{eq-dR-PK}, banks obtain new reserves from the
central bank to maintain a constant reserve-to-deposit ratio \(k\).
Thus, the causality in this model runs from debt-financed demand to
loans, to deposits, and finally to reserves.

By Equation~\ref{eq-P-PK}, the price level is set by firms based on a
mark-up (\(n\)) on unit labour cost (which are the product of the
nominal wage \(W\) and the labour coefficient \(a\)). Nominal wages are
set by workers based on their bargaining power, which is declining in
the unemployment rate (Equation~\ref{eq-U-PK}). The real wage in
Equation~\ref{eq-w-PK} is derived from the pricing
Equation~\ref{eq-P-PK}, i.e.~through their price setting power, firms
ultimately determine the real wage. The level of employment in
Equation~\ref{eq-N-PK} is determined residually based on economic
activity and a constant-coefficient production function
\((Y=\frac{N}{a})\). Finally, the level of employment in conjunction
with an exogenously given labour force \(N^f\) (or total available
labour time) can be used to obtain an unemployment rate in
Equation~\ref{eq-U-PK}.

\section{Simulation}\label{simulation-3}

\subsection{Parameterisation}\label{parameterisation-3}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), five further scenarios will be
considered. Scenario 2 is a rise in credit rationing in the form of a
fall in \(c\). In scenario 3, autonomous credit-financed demand
(\(d_0\)) increases. Scenarios 4 and 5 consider a rise in the interest
rate (or bank) mark-up (\(m\)) and in the price (or firm) mark-up
(\(n\)), respectively. Scenario 6 considers a rise in productivity
reflected in a fall of the labour coefficient \(a\).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.3504}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0598}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0598}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0598}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0513}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0598}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0427}}
  >{\centering\arraybackslash}p{(\columnwidth - 26\tabcolsep) * \real{0.0598}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(b\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(c\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(d_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(d_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(i_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(i1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(m\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(k\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(n\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(W_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(h\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(a\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(N^f\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 0.5 & 0.8 & 5 & 0.8 & 0.01 & 0.5 & 0.15 & 0.3 & 0.15 & 2 &
0.8 & 0.8 & 12 \\
2: rise in credit rationing (\(c\)) & 0.5 & 0.4 & 5 & 0.8 & 0.01 & 0.5 &
0.15 & 0.3 & 0.15 & 2 & 0.8 & 0.8 & 12 \\
3: rise in autonomous demand (\(d_0\)) & 0.5 & 0.8 & 10 & 0.8 & 0.01 &
0.5 & 0.15 & 0.3 & 0.15 & 2 & 0.8 & 0.8 & 12 \\
4: rise in bank mark-up (\(m\)) & 0.5 & 0.8 & 5 & 0.8 & 0.01 & 0.5 & 0.3
& 0.3 & 0.15 & 2 & 0.8 & 0.8 & 12 \\
5: rise in firm mark-up (\(n\)) & 0.5 & 0.8 & 5 & 0.8 & 0.01 & 0.5 &
0.15 & 0.3 & 0.3 & 2 & 0.8 & 0.8 & 12 \\
6: rise in productivity (\(a\)) & 0.5 & 0.8 & 5 & 0.8 & 0.01 & 0.5 &
0.15 & 0.3 & 0.15 & 2 & 0.8 & 0.4 & 12 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-3}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{6}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{Y\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# income/output}
\NormalTok{D\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# (notional) credit{-}financed aggregate demand}
\NormalTok{ND\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# income{-}financed aggregate demand}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# lending rate}
\NormalTok{N\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# employment}
\NormalTok{U\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# unemployment}
\NormalTok{P\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# price level}
\NormalTok{w\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# real wage}
\NormalTok{W\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# nominal wage}
\NormalTok{i\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# central bank rate}
\NormalTok{dL\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# change in loans}
\NormalTok{dM\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# change in bank deposits }
\NormalTok{dR\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# change in bank reserves}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{c}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# share of credit demand that is accommodated}
\NormalTok{d0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)}\CommentTok{\# autonomous component of debt{-}financed aggregate demand}
\NormalTok{m}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# mark{-}up on lending rate}
\NormalTok{n}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# mark{-}up on prices}
\NormalTok{a}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# productivity}

\CommentTok{\# Baseline parameterisation}
\NormalTok{c[]}\OtherTok{=}\FloatTok{0.8} 
\NormalTok{d0[]}\OtherTok{=}\DecValTok{5}
\NormalTok{m[]}\OtherTok{=}\FloatTok{0.15}
\NormalTok{n[]}\OtherTok{=}\FloatTok{0.15}  
\NormalTok{a[]}\OtherTok{=}\FloatTok{0.8} 

\DocumentationTok{\#\# Construct scenarios}

\CommentTok{\# scenario 2: increase in credit rationing}
\NormalTok{c[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{0.4}

\CommentTok{\# scenario 3: increase in autonomous demand}
\NormalTok{d0[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\DecValTok{10}

\CommentTok{\# scenario 4: increase in interest rate mark{-}up}
\NormalTok{m[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{0.3}

\CommentTok{\# scenario 5: increase in price mark{-}up}
\NormalTok{n[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\FloatTok{0.3}

\CommentTok{\# scenario 6: increase in productivity}
\NormalTok{a[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\FloatTok{0.4}


\CommentTok{\#Set constant parameter values}
\NormalTok{b}\OtherTok{=}\FloatTok{0.5}   \CommentTok{\# propensity to spend out of income}
\NormalTok{d1}\OtherTok{=}\FloatTok{0.8}  \CommentTok{\# sensitivity of demand with respect to the interest rate}
\NormalTok{i0}\OtherTok{=}\FloatTok{0.01} \CommentTok{\# discretionary component of central bank rate}
\NormalTok{i1}\OtherTok{=}\FloatTok{0.5}  \CommentTok{\# sensitivity of central bank rate with respect to price level}
\NormalTok{Nf}\OtherTok{=}\DecValTok{12}   \CommentTok{\# full employment/labour force}
\NormalTok{h}\OtherTok{=}\FloatTok{0.8}   \CommentTok{\# sensitivity of nominal wage with respect to unemployment}
\NormalTok{k}\OtherTok{=}\FloatTok{0.3}   \CommentTok{\# desired reserve ratio}
\NormalTok{W0}\OtherTok{=}\DecValTok{2}    \CommentTok{\# exogenous component of nominal wage}

\CommentTok{\# Initialise endogenous variables at some arbitrary positive value }
\NormalTok{Y }\OtherTok{=}\NormalTok{ D }\OtherTok{=}\NormalTok{ ND }\OtherTok{=}\NormalTok{ r }\OtherTok{=}\NormalTok{ N }\OtherTok{=}\NormalTok{ U }\OtherTok{=}\NormalTok{ P }\OtherTok{=}\NormalTok{ w }\OtherTok{=}\NormalTok{ W }\OtherTok{=}\NormalTok{ i }\OtherTok{=}\NormalTok{ dL }\OtherTok{=}\NormalTok{ dR }\OtherTok{=}\NormalTok{ dM }\OtherTok{=} \DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
    
    \CommentTok{\#Model equations}
    
    \CommentTok{\# (1) Goods market}
\NormalTok{    Y }\OtherTok{=}\NormalTok{ ND }\SpecialCharTok{+}\NormalTok{ c[j]}\SpecialCharTok{*}\NormalTok{D}
    
    \CommentTok{\# (2) Not{-}debt financed component of aggregate demand}
\NormalTok{    ND }\OtherTok{=}\NormalTok{ b}\SpecialCharTok{*}\NormalTok{Y}
    
    \CommentTok{\# (3) Debt{-}financed component of aggregate demand}
\NormalTok{    D}\OtherTok{=}\NormalTok{ d0[j] }\SpecialCharTok{{-}}\NormalTok{ d1}\SpecialCharTok{*}\NormalTok{r}
    
    \CommentTok{\# (4) Policy rate}
\NormalTok{    i }\OtherTok{=}\NormalTok{ i0 }\SpecialCharTok{+}\NormalTok{ i1}\SpecialCharTok{*}\NormalTok{P}
    
    \CommentTok{\# (5) Lending rate}
\NormalTok{    r }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{+}\NormalTok{m[j])}\SpecialCharTok{*}\NormalTok{i}
    
    \CommentTok{\# (6) Change in loans}
\NormalTok{    dL }\OtherTok{=}\NormalTok{ c[j]}\SpecialCharTok{*}\NormalTok{D}
    
    \CommentTok{\# (7) Change in deposits}
\NormalTok{    dM }\OtherTok{=}\NormalTok{ dL}
    
    \CommentTok{\# (8) Change in reserves}
\NormalTok{    dR }\OtherTok{=}\NormalTok{ k}\SpecialCharTok{*}\NormalTok{dM}
    
    \CommentTok{\# (9) Price level}
\NormalTok{    P }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[j])}\SpecialCharTok{*}\NormalTok{a[j]}\SpecialCharTok{*}\NormalTok{W}
    
    \CommentTok{\# (10) Nominal wage}
\NormalTok{    W }\OtherTok{=}\NormalTok{ W0 }\SpecialCharTok{{-}}\NormalTok{ h}\SpecialCharTok{*}\NormalTok{(U)}
    
    \CommentTok{\# (11) Real wage}
\NormalTok{    w }\OtherTok{=} \DecValTok{1}\SpecialCharTok{/}\NormalTok{((}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[j])}\SpecialCharTok{*}\NormalTok{a[j])}
    
    \CommentTok{\# (12) Employment}
\NormalTok{    N }\OtherTok{=}\NormalTok{ a[j]}\SpecialCharTok{*}\NormalTok{Y}
    
    \CommentTok{\# (13) Unemployment rate}
\NormalTok{    U }\OtherTok{=}\NormalTok{ (Nf }\SpecialCharTok{{-}}\NormalTok{ N)}\SpecialCharTok{/}\NormalTok{Nf}
    
\NormalTok{  \}}

  \CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{  Y\_star[j]}\OtherTok{=}\NormalTok{Y}
\NormalTok{  D\_star[j]}\OtherTok{=}\NormalTok{D}
\NormalTok{  ND\_star[j]}\OtherTok{=}\NormalTok{ND}
\NormalTok{  r\_star[j]}\OtherTok{=}\NormalTok{r}
\NormalTok{  N\_star[j]}\OtherTok{=}\NormalTok{N}
\NormalTok{  U\_star[j]}\OtherTok{=}\NormalTok{U}
\NormalTok{  P\_star[j]}\OtherTok{=}\NormalTok{P}
\NormalTok{  w\_star[j]}\OtherTok{=}\NormalTok{w}
\NormalTok{  W\_star[j]}\OtherTok{=}\NormalTok{W}
\NormalTok{  i\_star[j]}\OtherTok{=}\NormalTok{i}
\NormalTok{  dL\_star[j]}\OtherTok{=}\NormalTok{dL}
\NormalTok{  dM\_star[j]}\OtherTok{=}\NormalTok{dM}
\NormalTok{  dR\_star[j]}\OtherTok{=}\NormalTok{dR  }
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load NumPy library}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set the number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Create arrays to store equilibrium solutions}
\NormalTok{Y\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# income/output}
\NormalTok{D\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# (notional) credit{-}financed aggregate demand}
\NormalTok{ND\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# income{-}financed aggregate demand}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# lending rate}
\NormalTok{N\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# employment}
\NormalTok{U\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# unemployment}
\NormalTok{P\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# price level}
\NormalTok{w\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# real wage}
\NormalTok{W\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# nominal wage}
\NormalTok{i\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# central bank rate}
\NormalTok{dL\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# change in loans}
\NormalTok{dM\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# change in bank deposits}
\NormalTok{dR\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# change in bank reserves}

\CommentTok{\# Set exogenous variables that will be shifted}
\NormalTok{c }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# share of credit demand that is accommodated}
\NormalTok{d0 }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# autonomous component of debt{-}financed aggregate demand}
\NormalTok{m }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# mark{-}up on lending rate}
\NormalTok{n }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# mark{-}up on prices}
\NormalTok{a }\OperatorTok{=}\NormalTok{ np.zeros(S)  }\CommentTok{\# productivity}

\CommentTok{\# Baseline parameterisation}
\NormalTok{c[:] }\OperatorTok{=} \FloatTok{0.8}
\NormalTok{d0[:] }\OperatorTok{=} \DecValTok{5}
\NormalTok{m[:] }\OperatorTok{=} \FloatTok{0.15}
\NormalTok{n[:] }\OperatorTok{=} \FloatTok{0.15}
\NormalTok{a[:] }\OperatorTok{=} \FloatTok{0.8}

\CommentTok{\# Construct scenarios}
\CommentTok{\# Scenario 2: increase in credit rationing}
\NormalTok{c[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{0.4}

\CommentTok{\# Scenario 3: increase in autonomous demand}
\NormalTok{d0[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Scenario 4: increase in interest rate mark{-}up}
\NormalTok{m[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{0.3}

\CommentTok{\# Scenario 5: increase in price mark{-}up}
\NormalTok{n[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \FloatTok{0.3}

\CommentTok{\# Scenario 6: increase in productivity}
\NormalTok{a[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \FloatTok{0.4}

\CommentTok{\# Set constant parameter values}
\NormalTok{b }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# propensity to spend out of income}
\NormalTok{d1 }\OperatorTok{=} \FloatTok{0.8}  \CommentTok{\# sensitivity of demand with respect to the interest rate}
\NormalTok{i0 }\OperatorTok{=} \FloatTok{0.01}  \CommentTok{\# discretionary component of central bank rate}
\NormalTok{i1 }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# sensitivity of central bank rate with respect to the price level}
\NormalTok{Nf }\OperatorTok{=} \DecValTok{12}  \CommentTok{\# full employment/labour force}
\NormalTok{h }\OperatorTok{=} \FloatTok{0.8}  \CommentTok{\# sensitivity of nominal wage with respect to unemployment}
\NormalTok{k }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# desired reserve ratio}
\NormalTok{W0 }\OperatorTok{=} \DecValTok{2}  \CommentTok{\# exogenous component of nominal wage}

\CommentTok{\# Initialize endogenous variables at some arbitrary positive value}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ D }\OperatorTok{=}\NormalTok{ ND }\OperatorTok{=}\NormalTok{ r }\OperatorTok{=}\NormalTok{ N }\OperatorTok{=}\NormalTok{ U }\OperatorTok{=}\NormalTok{ P }\OperatorTok{=}\NormalTok{ w }\OperatorTok{=}\NormalTok{ W }\OperatorTok{=}\NormalTok{ i }\OperatorTok{=}\NormalTok{ dL }\OperatorTok{=}\NormalTok{ dR }\OperatorTok{=}\NormalTok{ dM }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Iterate through the system}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iteration }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# Model equations}
\NormalTok{        Y }\OperatorTok{=}\NormalTok{ ND }\OperatorTok{+}\NormalTok{ c[j] }\OperatorTok{*}\NormalTok{ D}
\NormalTok{        ND }\OperatorTok{=}\NormalTok{ b }\OperatorTok{*}\NormalTok{ Y}
\NormalTok{        D }\OperatorTok{=}\NormalTok{ d0[j] }\OperatorTok{{-}}\NormalTok{ d1 }\OperatorTok{*}\NormalTok{ r}
\NormalTok{        i }\OperatorTok{=}\NormalTok{ i0 }\OperatorTok{+}\NormalTok{ i1 }\OperatorTok{*}\NormalTok{ P}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ m[j]) }\OperatorTok{*}\NormalTok{ i}
\NormalTok{        dL }\OperatorTok{=}\NormalTok{ c[j] }\OperatorTok{*}\NormalTok{ D}
\NormalTok{        dM }\OperatorTok{=}\NormalTok{ dL}
\NormalTok{        dR }\OperatorTok{=}\NormalTok{ k }\OperatorTok{*}\NormalTok{ dM}
\NormalTok{        P }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ n[j]) }\OperatorTok{*}\NormalTok{ a[j] }\OperatorTok{*}\NormalTok{ W}
\NormalTok{        W }\OperatorTok{=}\NormalTok{ W0 }\OperatorTok{{-}}\NormalTok{ h }\OperatorTok{*}\NormalTok{ U}
\NormalTok{        w }\OperatorTok{=} \DecValTok{1} \OperatorTok{/}\NormalTok{ ((}\DecValTok{1} \OperatorTok{+}\NormalTok{ n[j]) }\OperatorTok{*}\NormalTok{ a[j])}
\NormalTok{        N }\OperatorTok{=}\NormalTok{ a[j] }\OperatorTok{*}\NormalTok{ Y}
\NormalTok{        U }\OperatorTok{=}\NormalTok{ (Nf }\OperatorTok{{-}}\NormalTok{ N) }\OperatorTok{/}\NormalTok{ Nf}

    \CommentTok{\# Save results for different parameterizations in the vectors}
\NormalTok{    Y\_star[j] }\OperatorTok{=}\NormalTok{ Y}
\NormalTok{    D\_star[j] }\OperatorTok{=}\NormalTok{ D}
\NormalTok{    ND\_star[j] }\OperatorTok{=}\NormalTok{ ND}
\NormalTok{    r\_star[j] }\OperatorTok{=}\NormalTok{ r}
\NormalTok{    N\_star[j] }\OperatorTok{=}\NormalTok{ N}
\NormalTok{    U\_star[j] }\OperatorTok{=}\NormalTok{ U}
\NormalTok{    P\_star[j] }\OperatorTok{=}\NormalTok{ P}
\NormalTok{    w\_star[j] }\OperatorTok{=}\NormalTok{ w}
\NormalTok{    W\_star[j] }\OperatorTok{=}\NormalTok{ W}
\NormalTok{    i\_star[j] }\OperatorTok{=}\NormalTok{ i}
\NormalTok{    dL\_star[j] }\OperatorTok{=}\NormalTok{ dL}
\NormalTok{    dM\_star[j] }\OperatorTok{=}\NormalTok{ dM}
\NormalTok{    dR\_star[j] }\OperatorTok{=}\NormalTok{ dR}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-3}

Figures Figure~\ref{fig-output-pkmacro} -
Figure~\ref{fig-real-wage-pkmacro} depict the response of the model's
key endogenous variables to various shifts.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(Y\_star, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                      \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-output-pkmacro-1.pdf}

}

\caption{\label{fig-output-pkmacro}Output}

\end{figure}%

An increase in credit rationing (scenario 2) reduces deposit money
creation as well as actual (as opposed to desired) aggregate demand.
This drags down output and employment. The rise in unemployment reduces
workers' nominal wage demands and thus the price level. The lending rate
falls as the central bank reduces the policy rate.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(P\_star, }\AttributeTok{ylab=}\StringTok{"P"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                      \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-price-level-pkmacro-1.pdf}

}

\caption{\label{fig-price-level-pkmacro}Price level}

\end{figure}%

An increase in (debt-financed) autonomous demand (scenario 3) has
expansionary effects on output and employment. The money stock
accommodates through increased loan creation. The increase in workers'
bargaining power leads to higher nominal wages and prices. The central
bank reacts by raising the policy rate but this does not completely
offset the expansionary effect.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(r\_star, }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                      \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-lending-rate-pkmacro-1.pdf}

}

\caption{\label{fig-lending-rate-pkmacro}Lending rate}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(dM\_star, }\AttributeTok{ylab=}\StringTok{"dM"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                        \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-money-pkmacro-1.pdf}

}

\caption{\label{fig-money-pkmacro}Deposit money creation}

\end{figure}%

In scenarios 4 and 5, the interest rate (or bank) mark-up and the price
(or firm) mark-up increase, respectively. The increase in the bank
mark-up raises the lending rate, which has a contractionary effect. The
increase in the firm mark-up raises the price level, which has a
contractionary effect through the monetary policy response. Notably, the
rise in the price mark-up reduces the real wage.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(U\_star}\SpecialCharTok{*}\DecValTok{100}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"U (\%)"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                              \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-unemployment-pkmacro-1.pdf}

}

\caption{\label{fig-unemployment-pkmacro}Unemployment rate}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(W\_star, }\AttributeTok{ylab=}\StringTok{"W"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                      \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-nominal-wage-pkmacro-1.pdf}

}

\caption{\label{fig-nominal-wage-pkmacro}Nominal wage}

\end{figure}%

Finally, an increase in productivity (scenario 6) reduces the price
level, which induces a lower policy rate, leading to a small
expansionary effect. However, it increases the unemployment rate as
fewer workers are needed to produce the same level of output. This
reduces the nominal wage, but raises the real wage.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(w\_star, }\AttributeTok{ylab=}\StringTok{"w"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{,}
                                      \StringTok{"4:rise bank markup"}\NormalTok{,}\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product."}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-real-wage-pkmacro-1.pdf}

}

\caption{\label{fig-real-wage-pkmacro}Real wage}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here for output only)}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1:baseline"}\NormalTok{, }\StringTok{"2:rise credit rat."}\NormalTok{, }\StringTok{"3:rise AD"}\NormalTok{, }\StringTok{"4:rise bank markup"}\NormalTok{, }\StringTok{"5:rise firm markup"}\NormalTok{, }\StringTok{"6:rise product"}\NormalTok{]}

\CommentTok{\# Create a bar plot}
\NormalTok{plt.bar(scenario\_names, Y\_star)}
\NormalTok{plt.ylabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.xticks(rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, ha}\OperatorTok{=}\StringTok{"right"}\NormalTok{)  }\CommentTok{\# Rotate x{-}axis labels for better readability}
\NormalTok{plt.tight\_layout()  }\CommentTok{\# Ensure the labels fit within the plot area}

\CommentTok{\# Show the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-3}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph }
\CommentTok{\# Construct auxiliary Jacobian matrix for 18 variables: }
\CommentTok{\# r, Y, ND, D, i, P, W, w, N, U, dl, dM, dR, d0, c, m, a, n }

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{18}\NormalTok{, }\DecValTok{18}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"r"}\NormalTok{, }\StringTok{"Y"}\NormalTok{, }\StringTok{"ND"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"i"}\NormalTok{, }\StringTok{"P"}\NormalTok{, }\StringTok{"W"}\NormalTok{, }\StringTok{"w"}\NormalTok{, }\StringTok{"N"}\NormalTok{, }\StringTok{"U"}\NormalTok{, }\StringTok{"dL"}\NormalTok{, }\StringTok{"dM"}\NormalTok{, }\StringTok{"dR"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(d[}\DecValTok{0}\NormalTok{]), }\StringTok{"c"}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"n"}\NormalTok{)}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_keynesian_macro_model_with_endogenous_money_files/figure-pdf/fig-dg-pkmacro-2.pdf}

}

\caption{\label{fig-dg-pkmacro}Directed graph of post-Keynesian
endogenous money model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Construct auxiliary Jacobian matrix for 18 variables}
\CommentTok{\#    r  Y ND  D  i  P  W  w  N  U  dL dM dR d0 c  m  a  n}

\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{               [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{]])}

    
\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"r"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"Y"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"ND"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"D"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{"i"}\NormalTok{, }\DecValTok{5}\NormalTok{:}\StringTok{"P"}\NormalTok{, }\DecValTok{6}\NormalTok{: }\StringTok{"W"}\NormalTok{, }\DecValTok{7}\NormalTok{: }\StringTok{"w"}\NormalTok{, }
            \DecValTok{8}\NormalTok{: }\StringTok{"N"}\NormalTok{, }\DecValTok{9}\NormalTok{: }\StringTok{"U"}\NormalTok{, }\DecValTok{10}\NormalTok{: }\StringTok{"dL"}\NormalTok{, }\DecValTok{11}\NormalTok{: }\StringTok{"dM"}\NormalTok{, }\DecValTok{12}\NormalTok{: }\StringTok{"dR"}\NormalTok{, }\DecValTok{13}\NormalTok{: }\StringTok{"d0"}\NormalTok{, }\DecValTok{14}\NormalTok{: }\StringTok{"c"}\NormalTok{, }
            \DecValTok{15}\NormalTok{: }\StringTok{"m"}\NormalTok{, }\DecValTok{16}\NormalTok{: }\StringTok{"a"}\NormalTok{, }\DecValTok{17}\NormalTok{: }\StringTok{"n"}\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{42}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure Figure~\ref{fig-dg-pkmacro}, it can be seen that credit
rationing (\(c\)), productivity (\(a\)), the price mark-up (\(n\)), the
interest rate mark-up (\(m\)), and autonomous demand (\(d_0\)), are the
key exogenous variables of the model. All other variables are
endogenous, and many of them form a closed loop (or cycle) within the
system. The lower-right part of the graph captures the goods market:
debt- and not debt-financed aggregate demand determine output. The outer
right part depicts the endogenous money creation process: creditworthy
debt-financed demand determines credit creation, which translates into
deposit money creation. Bank reserves are a residual. The lower-left
part of the graph represents the labour market. The goods market feeds
into the labour market via employment, which determines nominal wages
and the price level. The real wage is a residual. The price level feeds
into interest rate determination in the upper part of the model, which
establishes a causal feedback link from the labour market to the goods
market.

\section{Analytical discussion}\label{analytical-discussion-2}

Like the Neoclassical Synthesis model, the post-Keynesian macro model
can be represented as an AS-AD model. First, we will derive an IS and an
interest-rate (IR) curve in the \((Y, r)\)-space, the latter
representing monetary policy and bank lending instead of the money
market (the conventional LM curve). Then we obtain the AS-AD
representation of the model in the \((Y,P)\)-space. Finally, we obtain
equilibrium solutions for \(Y\) and \(P\).

To obtain the IS-curve, substitute Equation~\ref{eq-ND-PK} and
Equation~\ref{eq-D-PK} into Equation~\ref{eq-Y-PK} and solve for \(Y\):
\begin{align}\label{eq:IS}\tag{IS}
Y&=\left(\frac{1}{1-b}\right)\Bigl[c(d_0 -d_1r)\Bigr].
\end{align}

To obtain the IR-curve, substitute Equation~\ref{eq-i-PK},
Equation~\ref{eq-P-PK}, Equation~\ref{eq-W-PK}, Equation~\ref{eq-N-PK},
and Equation~\ref{eq-U-PK} into Equation~\ref{eq-r-PK} :
\begin{align}\label{eq:IR}\tag{IR}
r&=\left(1+m\right)\Bigl[i_0+i_1(1+n)a[W_0-h\bigl(1-\frac{aY}{N^f}\bigr)]\Bigr].
\end{align}

It can readily be seen that the IS-curve is downward-sloping and the
IR-curve is upward-sloping in the \((Y, r)\)-space

To obtain the AD-curve, substitute Equation~\ref{eq-r-PK} and
Equation~\ref{eq-i-PK} into the IS-curve:

\begin{align}\label{eq:AD}\tag{AD}
Y&=\left(\frac{1}{1-b}\right)\Bigl[c(d_0 -d_1(1+m)(i_0+i_1P))\Bigr].
\end{align}

Finally, to obtain the AS-curve, substitute Equation~\ref{eq-W-PK} and
Equation~\ref{eq-U-PK} into Equation~\ref{eq-P-PK}:

\begin{align}\label{eq:AS}\tag{AS}
P&=\left(1+n\right)a\Bigl[W_0-h\bigl(1-\frac{aY}{N^f}\bigr)\Bigr].
\end{align}

It can readily be seen that the AD-curve is downward-sloping in the
\((Y, P)\)-space, whereas the AS-curve is upward-sloping.

Finally, by substituting the AS and AD curves into each other, we obtain
the following equilibrium solutions for output and the price level:

\begin{align*}
Y^*&=\frac{c\{d_0-d_1(1+m)[i_0+i_1(1+n)a(W_0-h)]\}}{1-b+cd_1(1+m)i_1(1+n)a^2h(N^f)^{-1}} \\
P^*&=\frac{(1+n)a[(1-b)(W_0-h)+ha(N^f)^{-1}c(d_0-d_1(1+m)i_0)]}{1-b+cd_1(1+m)i_1(1+n)a^2h(N^f)^{-1}}.
\end{align*}

\subsection{Confirm analytical solutions
numerically}\label{confirm-analytical-solutions-numerically}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Confirm equilibrium solution for Y*  (baseline)}
\CommentTok{\# Analytical solution}
\NormalTok{(c[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(d0[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{d1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{m[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{(i0}\SpecialCharTok{+}\NormalTok{i1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{a[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(W0}\SpecialCharTok{{-}}\NormalTok{h))))}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{b }\SpecialCharTok{+}\NormalTok{c[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{d1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{m[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{i1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{(a[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}\SpecialCharTok{*}\NormalTok{h}\SpecialCharTok{*}\NormalTok{(Nf}\SpecialCharTok{\^{}{-}}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6.922735
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Numerical solution}
\NormalTok{Y\_star[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6.922735
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Confirm equilibrium solution for P*  (baseline)}
\CommentTok{\# Analytical solution}
\NormalTok{((}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{a[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{((W0}\SpecialCharTok{{-}}\NormalTok{h)}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{b)}\SpecialCharTok{+}\NormalTok{(Nf}\SpecialCharTok{\^{}{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{h}\SpecialCharTok{*}\NormalTok{a[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{c[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(d0[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{d1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{m[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{i0[}\DecValTok{1}\NormalTok{])))}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{b }\SpecialCharTok{+}\NormalTok{c[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{d1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{m[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{i1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{n[}\DecValTok{1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{(a[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}\SpecialCharTok{*}\NormalTok{h}\SpecialCharTok{*}\NormalTok{(Nf}\SpecialCharTok{\^{}{-}}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.443676
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Numerical solution}
\NormalTok{P\_star[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.443676
\end{verbatim}

\section*{References}\label{references-4}
\addcontentsline{toc}{section}{References}

\markright{References}

\chapter{A Kaldor-Robinson Distribution and Growth
Model}\label{a-kaldor-robinson-distribution-and-growth-model}

\section{Overview}\label{overview-4}

In the 1950s and 1960s in Cambridge UK, Nicholas Kaldor and Joan
Robinson developed a theory of growth that aimed to apply John Maynard
Keynes' principle of effective demand to the long run.\footnote{See Hein
  (2014), chap.~4 for a detailed treatment.} The main Keynesian
assumption retained by Kaldor and Robinson was that investment and
saving are independent, and that a change in investment may lead to an
adjustment in saving. However, unlike Keynes, Kaldor and Robinson
assumed a fixed level of capacity utilisation, which they considered a
key feature of a long-run equilibrium. As a result, goods market
clearing cannot be established via output adjustment. Instead, Kaldor
and Robinson assumed price adjustment, which would translate into a
change in income distribution. Changes in the distribution of income
then affect consumption (and saving), as workers tend to have a higher
marginal propensity to consume than capital owners. For example, an
increase in investment demand due to improved animal spirits would then
lead to excess demand, which raises the price level. For a given level
of nominal wages, the rise in the price level lowers real wages, leading
to a redistribution of income towards profits. The resulting rise in the
profit share increases aggregate saving, thereby leading to an
adjustment of saving to investment. Taken together, the Kaldor-Robinson
approach highlights the relevance of supply constraints in the long run
that can lead to inflationary outcomes of demand shocks.

We consider a simple version of the model proposed in Hein (2014),
chap.~4.4. This is a model of long-run steady state growth. In the
steady state, all endogenous variables grow at the same rate.\footnote{All
  variables are normalised by the capital stock and thus rendered
  stationary.} Changes in parameters or exogenous variables lead to an
instantaneous adjustment of the model's variables, so that the model can
be analysed like a static one. The key question addressed by this model
is a how changes in aggregate demand affects income distribution and the
rate of growth.

\section{The Model}\label{the-model-4}

\begin{equation}\phantomsection\label{eq-r-kr}{
r=h \frac{u_n}{v}
}\end{equation}

\begin{equation}\phantomsection\label{eq-s-kr}{
s=s_\Pi r,  \quad  s_\Pi \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-c-kr}{
c= \frac{u_n}{v}-s
}\end{equation}

\begin{equation}\phantomsection\label{eq-g-kr}{
g=g_0+g_1r, \quad g_1 > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-h-kr}{
h=\frac{vg_0}{u_n(s_\Pi-g_1)}
}\end{equation}

where \(r\), \(s\), \(c\), \(g\), and \(h\) are the profit rate, the
saving rate, the consumption rate, the investment rate, and the profit
share, respectively.

Equation~\ref{eq-r-kr} decomposes the profit rate into the product of
the profit share \(h\) (total profits over total output), the normal
rate of capacity utilisation (\(u_n\)), and the inverse of \(v\) (the
capital-potential output ratio). Let \(Y\) be output, \(K\) be the
capital stock, and \(Y^P\) be potential output, then the decomposition
can also be written as
\(r=\frac{\Pi}{K}=\frac{\Pi}{Y}\frac{Y}{Y^P}\frac{Y^P}{K}\). The normal
rate of capacity utilisation and the capital-potential output ratio are
taken to be exogenous in this model. Note also that the wage share is
given by \(1-h\). By Equation~\ref{eq-s-kr}, the economy-wide saving
rate is given by saving out of profits (\(s_\Pi r\)). It is assumed that
workers don't save, i.e.~have a higher marginal propensity to consume
than capital owners. Equation~\ref{eq-c-kr} simply states that
consumption is income not saved. According to Equation~\ref{eq-c-kr},
investment is determined by an autonomous component \(g_0\) that may
capture Keynesian `animal spirits' and by the profit rate. The profit
rate may stimulate investment if firms use adaptive expectations and
predict higher future profits in response to an increase in the current
profit rate. Finally, Equation~\ref{eq-h-kr} is the goods market
equilibrium condition \(g=s\) solved for the profit share, reflecting
the fact that prices are assumed to clear the goods market which
translates into an adjustment of the profit share.

\section{Simulation}\label{simulation-4}

\subsection{Parameterisation}\label{parameterisation-4}

Table 1 reports the parameterisation used in the simulation. We will
consider three different parameterisations. Besides a baseline scenario
(labelled as scenario 1), we will consider an increase in animal spirits
(\(g_0\)) and an increase in the propensity to save out of profits
(\(s_\Pi\)).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.0857}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1143}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(v\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(s_\Pi\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(g_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(g_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(u_n\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 3 & 0.6 & 0.02 & 0.3 & 0.9 \\
2: rise in animal spirits (\(g_0\)) & 3 & 0.6 & 0.04 & 0.3 & 0.9 \\
3: rise in saving propensity (\(s_\Pi\)) & 3 & 0.9 & 0.02 & 0.3 & 0.9 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-4}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S}\OtherTok{=}\DecValTok{3}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{h\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# profit share}
\NormalTok{g\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# growth rate of capital stock}
\NormalTok{s\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# saving rate}
\NormalTok{c\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# consumption rate}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# profit rate}

\CommentTok{\# Set constant parameter values}
\NormalTok{v}\OtherTok{=}\DecValTok{3}    \CommentTok{\# capital{-}to{-}potential output ratio}
\NormalTok{g1}\OtherTok{=}\FloatTok{0.3} \CommentTok{\# sensitivity of investment with respect to profit rate }
\NormalTok{un}\OtherTok{=}\FloatTok{0.9} \CommentTok{\# normal rate of capacity utilisation}

\CommentTok{\# Set exogenous variables whose parameterisation changes across regimes }
\NormalTok{g0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# animal spirits}
\NormalTok{sp}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# propensity to save out of profits}

\DocumentationTok{\#\#\# Construct different scenarios }

\CommentTok{\# scenario 1: baseline }
\NormalTok{g0[]}\OtherTok{=}\FloatTok{0.02}
\NormalTok{sp[]}\OtherTok{=}\FloatTok{0.6}

\CommentTok{\#scenario 2: increase in animal spirits}
\NormalTok{g0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{0.04}

\CommentTok{\# scenario 3: increase in propensity to save out of profits}
\NormalTok{sp[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\FloatTok{0.9}

\CommentTok{\#Check  stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \FunctionTok{print}\NormalTok{(sp[i]}\SpecialCharTok{\textgreater{}}\NormalTok{g1)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
[1] TRUE
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialise endogenous variables at some arbitrary positive value }
\NormalTok{g }\OtherTok{=}\NormalTok{ r }\OtherTok{=}\NormalTok{ s }\OtherTok{=}\NormalTok{ c }\OtherTok{=}\NormalTok{ h }\OtherTok{=} \DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
    
    \CommentTok{\#(1) Profit rate}
\NormalTok{    r}\OtherTok{=}\NormalTok{(h}\SpecialCharTok{*}\NormalTok{un)}\SpecialCharTok{/}\NormalTok{v}
    
    \CommentTok{\#(2) Saving}
\NormalTok{    s }\OtherTok{=}\NormalTok{ sp[i]}\SpecialCharTok{*}\NormalTok{r}
    
    \CommentTok{\#(3) Consumption}
\NormalTok{    c}\OtherTok{=}\NormalTok{ un}\SpecialCharTok{/}\NormalTok{v }\SpecialCharTok{{-}}\NormalTok{ s}
    
    \CommentTok{\#(4) Investment}
\NormalTok{    g }\OtherTok{=}\NormalTok{ g0[i]}\SpecialCharTok{+}\NormalTok{g1}\SpecialCharTok{*}\NormalTok{r}
    
    \CommentTok{\#(5) Goods market equilibrium profit share}
\NormalTok{    h}\OtherTok{=}\NormalTok{(v}\SpecialCharTok{/}\NormalTok{un)}\SpecialCharTok{*}\NormalTok{(g0[i]}\SpecialCharTok{/}\NormalTok{(sp[i]}\SpecialCharTok{{-}}\NormalTok{g1))}
    
\NormalTok{  \}}
  
  \CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{  h\_star[i]}\OtherTok{=}\NormalTok{h}
\NormalTok{  g\_star[i]}\OtherTok{=}\NormalTok{g}
\NormalTok{  r\_star[i]}\OtherTok{=}\NormalTok{r}
\NormalTok{  s\_star[i]}\OtherTok{=}\NormalTok{s}
\NormalTok{  c\_star[i]}\OtherTok{=}\NormalTok{c}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Clear the environment (not necessary in Python)}
\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S }\OperatorTok{=} \DecValTok{3}

\CommentTok{\# Create arrays to store equilibrium solutions for different parameterizations}
\NormalTok{h\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# profit share}
\NormalTok{g\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# growth rate of capital stock}
\NormalTok{s\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# saving rate}
\NormalTok{c\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# consumption rate}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# profit rate}

\CommentTok{\# Set constant parameter values}
\NormalTok{v }\OperatorTok{=} \DecValTok{3}    \CommentTok{\# capital{-}to{-}potential output ratio}
\NormalTok{g1 }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# sensitivity of investment with respect to profit rate }
\NormalTok{un }\OperatorTok{=} \FloatTok{0.9}  \CommentTok{\# normal rate of capacity utilization}

\CommentTok{\# Set exogenous variables whose parameterization changes across regimes}
\NormalTok{g0 }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# animal spirits}
\NormalTok{sp }\OperatorTok{=}\NormalTok{ np.empty(S)  }\CommentTok{\# propensity to save out of profits}

\CommentTok{\# Construct different scenarios}
\CommentTok{\# Scenario 1: baseline}
\NormalTok{g0[:] }\OperatorTok{=} \FloatTok{0.02}
\NormalTok{sp[:] }\OperatorTok{=} \FloatTok{0.6}

\CommentTok{\# Scenario 2: increase in animal spirits}
\NormalTok{g0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{0.04}

\CommentTok{\# Scenario 3: increase in propensity to save out of profits}
\NormalTok{sp[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \FloatTok{0.9}

\CommentTok{\# Check stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(sp[i] }\OperatorTok{\textgreater{}}\NormalTok{ g1)}



\CommentTok{\# Initialize endogenous variables at some arbitrary positive value}
\NormalTok{g }\OperatorTok{=}\NormalTok{ r }\OperatorTok{=}\NormalTok{ s }\OperatorTok{=}\NormalTok{ c }\OperatorTok{=}\NormalTok{ h }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve this system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# (1) Profit rate}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (h }\OperatorTok{*}\NormalTok{ un) }\OperatorTok{/}\NormalTok{ v}

        \CommentTok{\# (2) Saving}
\NormalTok{        s }\OperatorTok{=}\NormalTok{ sp[i] }\OperatorTok{*}\NormalTok{ r}

        \CommentTok{\# (3) Consumption}
\NormalTok{        c }\OperatorTok{=}\NormalTok{ un }\OperatorTok{/}\NormalTok{ v }\OperatorTok{{-}}\NormalTok{ s}

        \CommentTok{\# (4) Investment}
\NormalTok{        g }\OperatorTok{=}\NormalTok{ g0[i] }\OperatorTok{+}\NormalTok{ g1 }\OperatorTok{*}\NormalTok{ r}

        \CommentTok{\# (5) Goods market equilibrium profit share}
\NormalTok{        h }\OperatorTok{=}\NormalTok{ (v }\OperatorTok{/}\NormalTok{ un) }\OperatorTok{*}\NormalTok{ (g0[i] }\OperatorTok{/}\NormalTok{ (sp[i] }\OperatorTok{{-}}\NormalTok{ g1))}

    \CommentTok{\# Save results for different parameterizations in arrays}
\NormalTok{    h\_star[i] }\OperatorTok{=}\NormalTok{ h}
\NormalTok{    g\_star[i] }\OperatorTok{=}\NormalTok{ g}
\NormalTok{    r\_star[i] }\OperatorTok{=}\NormalTok{ r}
\NormalTok{    s\_star[i] }\OperatorTok{=}\NormalTok{ s}
\NormalTok{    c\_star[i] }\OperatorTok{=}\NormalTok{ c}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-4}

Figures Figure~\ref{fig-profshare-kaldor-robinson} -
Figure~\ref{fig-growth-kaldor-robinson} depict the response of the
model's key endogenous variables to changes in aggregate demand. A rise
in animal spirits (scenario 2) raises the profit share. This reduces
consumption. However, the effect on capital accumulation and thus growth
is positive. In that sense, long-run growth is demand-driven, despite
the fixed rate of capacity utilisation.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(h\_star, }\AttributeTok{ylab=}\StringTok{"h"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: rise animal spirits"}\NormalTok{, }\StringTok{"3:rise savings propensity"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor-Robinson_model_files/figure-pdf/fig-profshare-kaldor-robinson-1.pdf}

}

\caption{\label{fig-profshare-kaldor-robinson}Profit share}

\end{figure}%

In the second scenario, the saving propensity of capital owners
increases. This constitutes a reduction in aggregate demand, leading to
a fall in the profit share, and a fall in the growth rate. Since
\(g=s\), the effect reflects the Keynesian `paradox of saving': a rise
in the saving propensity leads to a fall in the aggregate saving rate.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(c\_star, }\AttributeTok{ylab=}\StringTok{"c"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: rise animal spirits"}\NormalTok{, }\StringTok{"3:rise savings propensity"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor-Robinson_model_files/figure-pdf/fig-consumption-kaldor-robinson-1.pdf}

}

\caption{\label{fig-consumption-kaldor-robinson}Rate of consumption}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(g\_star, }\AttributeTok{ylab=}\StringTok{"g"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: rise animal spirits"}\NormalTok{, }\StringTok{"3:rise savings propensity"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor-Robinson_model_files/figure-pdf/fig-growth-kaldor-robinson-1.pdf}

}

\caption{\label{fig-growth-kaldor-robinson}Rate of growth}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here only for profit share) }
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Scenario labels}
\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: rise animal spirits"}\NormalTok{, }\StringTok{"3: rise savings propensity"}\NormalTok{]}

\CommentTok{\# Bar plot for h\_star}
\NormalTok{plt.bar(scenario\_names, h\_star)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}h\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xticks(scenario\_names, rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-4}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph }
\CommentTok{\# Construct auxiliary Jacobian matrix for 7 variables: }
             \CommentTok{\# r,h,s,g,g0,sp,un}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DecValTok{7}\NormalTok{, }\DecValTok{7}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"r"}\NormalTok{, }\StringTok{"h"}\NormalTok{, }\StringTok{"s"}\NormalTok{, }\StringTok{"g"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(g[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(s[Pi]), }\FunctionTok{expression}\NormalTok{(u[n]))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor-Robinson_model_files/figure-pdf/fig-dg-kaldor-robinson-2.pdf}

}

\caption{\label{fig-dg-kaldor-robinson}Directed graph of Kaldor-Robinson
growth model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}


\CommentTok{\# Define the Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"r"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"h"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"s"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"g"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\VerbatimStringTok{r"$g\_0$"}\NormalTok{, }\DecValTok{5}\NormalTok{: }\VerbatimStringTok{r"$s\_p$"}\NormalTok{, }\DecValTok{6}\NormalTok{: }\VerbatimStringTok{r"$u\_n$"}\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure Figure~\ref{fig-dg-kaldor-robinson}, it can be seen that
animal spirits (\(g_0\)), the propensity to save out of profits
(\(s_\Pi\)), and the normal rate of capacity utilisation (\(u_n\)) are
the key exogenous variable of the model. Saving (\(s\)), investment
(\(g\)), the rate of profit (\(r\)), and the profit share (\(h\)) are
endogenous and form a closed loop (or cycle) within the system.

\section{Analytical discussion}\label{analytical-discussion-3}

To find the equilibrium solution for the profit share
(Equation~\ref{eq-h-kr}), substitute Equation~\ref{eq-r-kr},
Equation~\ref{eq-g-kr} and Equation~\ref{eq-s-kr} and into \(g=s\) and
solve for \(h\).

The equilibrium solution for \(h\) can then be substituted into
Equation~\ref{eq-r-kr} to find: \begin{align}
r^* = \frac{g_0}{s_\Pi-g_1}
\end{align}

Similarly, substituting the equilibrium solution for \(r\) into
Equation~\ref{eq-g-kr} yields: \begin{align}
g^* = \frac{s_\Pi g_0}{s_\Pi-g_1}.
\end{align}

The Kaldor-Robinson stability condition requires \(s_\Pi-g_1>0\),
i.e.~saving needs to react more strongly to the profit rate than
investment.

Further analytical results can be found in Hein (2014), chap.~4.4.

\subsection{Calculate analytical solutions
numerically}\label{calculate-analytical-solutions-numerically}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Profit rate}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \FunctionTok{print}\NormalTok{((g0[i])}\SpecialCharTok{/}\NormalTok{(sp[i]}\SpecialCharTok{{-}}\NormalTok{g1))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.06666667
[1] 0.1333333
[1] 0.03333333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Growth rate}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \FunctionTok{print}\NormalTok{((sp[i]}\SpecialCharTok{*}\NormalTok{g0[i])}\SpecialCharTok{/}\NormalTok{(sp[i]}\SpecialCharTok{{-}}\NormalTok{g1))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.04
[1] 0.08
[1] 0.03
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Profit rate}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(g0[i] }\OperatorTok{/}\NormalTok{ (sp[i] }\OperatorTok{{-}}\NormalTok{ g1))}

\CommentTok{\# Growth rate}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{((sp[i] }\OperatorTok{*}\NormalTok{ g0[i]) }\OperatorTok{/}\NormalTok{ (sp[i] }\OperatorTok{{-}}\NormalTok{ g1))}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section*{References}\label{references-5}
\addcontentsline{toc}{section}{References}

\markright{References}

\chapter{A Post-Kaleckian Distribution and Growth
Model}\label{a-post-kaleckian-distribution-and-growth-model}

\section{Overview}\label{overview-5}

The post-Kaleckian growth model was developed by Bhaduri and Marglin
(1990) and others to synthesise Marxian and Keynesian ideas about the
effects of income distribution on economic growth.\footnote{See Hein
  (2014), chap.~7 and Lavoie (2014), chap.~6 for detailed treatments.}
According to the Marxian view, capital accumulation is driven by
profits. By contrast, Michal Kalecki and post-Keynesians such as
Nicholas Kaldor argued that a redistribution of income towards
profit-earners is likely to reduce consumption, as workers tend to have
a higher marginal propensity to consume than capital owners. The
post-Kaleckian growth model integrates these two mechanisms in a
Keynesian framework in which aggregate demand and growth are
demand-determined. It allows for wage-led as well as profit-led demand
and growth regimes. In a wage-led regime, a redistribution of income
towards workers has expansionary effects on aggregate demand (and
possibly growth) as the expansionary effect on consumption outweighs the
negative effect on investment. In a profit-led regime, the effect is
contradictory as investment falls by more than consumption rises.
Whether a regime is wage- or profit-led depends on the relative size of
the propensities to consume and the propensity to invest.

This is a model of long-run steady state growth. In the steady state,
all endogenous variables grow at the same rate.\footnote{All variables
  are normalised by the capital stock and thus rendered stationary.}
Changes in parameters or exogenous variables lead to an instantaneous
adjustment of the model's variables, so that the model can be analysed
like a static one. We consider a version of the model with linear
functions based on Hein (2014), chap.~7.2.2.

\section{The Model}\label{the-model-5}

\begin{equation}\phantomsection\label{eq-r}{
r=h \frac{u}{v}
}\end{equation}

\begin{equation}\phantomsection\label{eq-s}{
s=[s_W + (s_\Pi - s_W)h]\frac{u}{v}, \quad 0 \geq s_W > s_\Pi \geq 1
}\end{equation}

\begin{equation}\phantomsection\label{eq-c}{
c= \frac{u}{v}-s
}\end{equation}

\begin{equation}\phantomsection\label{eq-g}{
g=g_0+g_1u+g_2h, \quad g_i > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-u}{
u=v(c+g)
}\end{equation}

where \(r\), \(s\), \(c\), \(g\), and \(u\) are the profit rate, the
saving rate, the consumption rate, the investment rate, and the rate of
capacity utilisation, respectively.

Equation~\ref{eq-r} decomposes the profit rate into the product of the
profit share \(h\) (total profits over total output), the rate of
capacity utilisation (actual output over potential output), and the
inverse of \(v\) (the capital-potential output ratio). Let \(Y\) be
output, \(K\) be the capital stock, and \(Y^P\) be potential output, the
decomposition can also be written as
\(r=\frac{\Pi}{K}=\frac{\Pi}{Y}\frac{Y}{Y^P}\frac{Y^P}{K}\). The profit
share and the capital-potential output ratio are taken to be exogenous
in this model. Note also that the wage share is given by \(1-h\). By
Equation~\ref{eq-s}, the economy-wide saving rate is given by the sum of
saving out of wages (\(s_W(1-h)\frac{u}{v}\)) and saving out of profits
(\(s_\Pi h\frac{u}{v}\)). It is assumed that workers have a higher
marginal propensity to consume than capital owners (\(s_W>s_\Pi\)).
Equation~\ref{eq-c} simply states that consumption is income not saved.
According to Equation~\ref{eq-c}, investment is determined by an
autonomous component \(g_0\) that may capture Keynesian `animal
spirits', by the rate of capacity utilisation, and by the profit share.
While the rate of capacity utilisation is a signal of (future) demand,
the profit share may stimulate investment as internal funds are
typically the cheapest source of finance. Finally, Equation~\ref{eq-u}
is an equilibrium condition that assumes that the rate of capacity
utilisation adjusts to clear the goods market.

The key question addressed by this model is a how a change in the profit
share affects the rate of capacity utilisation and the rate of
growth.\footnote{Bhaduri and Marglin (1990) further discuss the effects
  on the profit rate.} As shown formally in the analytical discussion
below, there is no unambiguous answer to this question as the model
encompasses different regimes. Three main regimes can be identified.
First, a regime in which both the rate of utilisation and the rate of
growth are negatively affected by an increase in the profit share. We
will call this a wage-led demand and growth regime (WLD/WLG). Second, a
regime in which the rate of utilisation is negatively affected and the
rate of growth is positively affected by an increase in the profit
share. We will call this a wage-led demand regime and profit-led growth
regime (WLD/PLG). Third, a regime in which both the rate of utilisation
and the rate of growth are positively affected by an increase in the
profit share. We will call this a profit-led demand and growth regime
(PLD/PLG).

\section{Simulation}\label{simulation-5}

\subsection{Parameterisation}\label{parameterisation-5}

Table 1 reports the parameterisation used in the simulation. We will
consider three different parameterisations that represent the three
regimes outlined above. For each of these regimes, there is a baseline
scenario and a scenario in which the profit share (\(h\)) rises. This
allows to assess the effects on the model's endogenous variables for the
different regimes.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.4125}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0625}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0875}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1125}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0875}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0875}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0875}}
  >{\centering\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0625}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(v\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(s_W\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(s_\Pi\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(g_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(g_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(g_2\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
\(h\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1a: baseline WLD/WLG & 3 & 0.3 & 0.9 & 0.02 & 0.1 & 0.1 & 0.2 \\
1b: rise in profit share (\(h\)) & 3 & 0.3 & 0.9 & 0.02 & 0.1 & 0.1 &
0.3 \\
2a: baseline WLD/PLG & 3 & 0.3 & 0.9 & 0.02 & 0.08 & 0.1 & 0.2 \\
2b: rise in profit share (\(h\)) & 3 & 0.3 & 0.9 & 0.02 & 0.08 & 0.1 &
0.3 \\
3a: baseline PLD/PLG & 3 & 0.3 & 0.9 & -0.01 & 0.1 & 0.1 & 0.2 \\
3b: rise in profit share (\(h\)) & 3 & 0.3 & 0.9 & -0.01 & 0.1 & 0.1 &
0.3 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-5}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S}\OtherTok{=}\DecValTok{6}

\CommentTok{\#Create vector in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{u\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# utilisation rate}
\NormalTok{g\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# growth rate of capital stock}
\NormalTok{s\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# saving rate}
\NormalTok{c\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# consumption rate}
\NormalTok{r\_star}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# profit rate}

\CommentTok{\# Set exogenous variables whose parameterisation changes across regimes }
\NormalTok{g0}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# animal spirits}
\NormalTok{sw}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# propensity to save out of wages }
\NormalTok{h}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)  }\CommentTok{\# profit share}
\NormalTok{g1}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S) }\CommentTok{\# sensitivity of investment with respect to utilisation}

\DocumentationTok{\#\#\# Construct different scenarios across 3 regimes: (1) WLD/WLG, (2) WLD/PLG, (3) PLD/PLG }

\CommentTok{\# baseline WLD/WLG}
\NormalTok{g0[}\DecValTok{1}\NormalTok{]}\OtherTok{=}\FloatTok{0.02}
\NormalTok{g1[}\DecValTok{1}\NormalTok{]}\OtherTok{=}\FloatTok{0.1}
\NormalTok{h[}\DecValTok{1}\NormalTok{]}\OtherTok{=}\FloatTok{0.2}

\CommentTok{\# increase in profit share in WLD/WLG regime}
\NormalTok{g0[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{0.02}
\NormalTok{g1[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{0.1}
\NormalTok{h[}\DecValTok{2}\NormalTok{]}\OtherTok{=}\FloatTok{0.3}

\CommentTok{\# baseline WLD/PLG}
\NormalTok{g0[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\FloatTok{0.02}
\NormalTok{g1[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\FloatTok{0.08}
\NormalTok{h[}\DecValTok{3}\NormalTok{]}\OtherTok{=}\FloatTok{0.2}

\CommentTok{\# increase in profit share in WLD/PLG regime}
\NormalTok{g0[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{0.02}
\NormalTok{g1[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{0.08}
\NormalTok{h[}\DecValTok{4}\NormalTok{]}\OtherTok{=}\FloatTok{0.3}
  
\CommentTok{\# baseline PLD/PLG}
\NormalTok{g0[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\SpecialCharTok{{-}}\FloatTok{0.01}
\NormalTok{g1[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\FloatTok{0.1}
\NormalTok{h[}\DecValTok{5}\NormalTok{]}\OtherTok{=}\FloatTok{0.2}

\CommentTok{\# increase in profit share in PLD/PLG regime}
\NormalTok{g0[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\SpecialCharTok{{-}}\FloatTok{0.01}
\NormalTok{g1[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\FloatTok{0.1}
\NormalTok{h[}\DecValTok{6}\NormalTok{]}\OtherTok{=}\FloatTok{0.3}

\CommentTok{\#Set constant parameter values}
\NormalTok{v}\OtherTok{=}\DecValTok{3}    \CommentTok{\# capital{-}to{-}potential output ratio}
\NormalTok{g2}\OtherTok{=}\FloatTok{0.1} \CommentTok{\# sensitivity of investment with respect to profit share}
\NormalTok{sp}\OtherTok{=}\FloatTok{0.9} \CommentTok{\# propensity to save out of profits}
\NormalTok{sw}\OtherTok{=}\FloatTok{0.3} \CommentTok{\# propensity to save out of wages}

\CommentTok{\#Check Keynesian stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{(((sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{v) }\SpecialCharTok{{-}}\NormalTok{g1[i])}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check demand and growth regime for 3 baseline scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{))\{}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Parameterisation"}\NormalTok{, i, }\StringTok{"yields:"}\NormalTok{))   }
\ControlFlowTok{if}\NormalTok{(g2}\SpecialCharTok{*}\NormalTok{(sw}\SpecialCharTok{/}\NormalTok{v }\SpecialCharTok{{-}}\NormalTok{ g1[i])}\SpecialCharTok{{-}}\NormalTok{g0[i]}\SpecialCharTok{*}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{/}\NormalTok{v}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"wage{-}led demand regime"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{\{}
   \FunctionTok{print}\NormalTok{(}\StringTok{"profit{-}led demand regime"}\NormalTok{)}
\NormalTok{  \}}
\ControlFlowTok{if}\NormalTok{(g1[i]}\SpecialCharTok{*}\NormalTok{(g2}\SpecialCharTok{*}\NormalTok{(sw}\SpecialCharTok{/}\NormalTok{v }\SpecialCharTok{{-}}\NormalTok{ g1[i])}\SpecialCharTok{{-}}\NormalTok{g0[i]}\SpecialCharTok{*}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{/}\NormalTok{v)}\SpecialCharTok{+}\NormalTok{g2}\SpecialCharTok{*}\NormalTok{(((sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{*}\NormalTok{v}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{{-}}\NormalTok{g1[i])}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}\SpecialCharTok{\textless{}}\DecValTok{0}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"wage{-}led growth regime"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"profit{-}led growth regime"}\NormalTok{)}
\NormalTok{  \}  }
\NormalTok{\} }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Parameterisation 1 yields:"
[1] "wage-led demand regime"
[1] "wage-led growth regime"
[1] "Parameterisation 3 yields:"
[1] "wage-led demand regime"
[1] "profit-led growth regime"
[1] "Parameterisation 5 yields:"
[1] "profit-led demand regime"
[1] "profit-led growth regime"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialise endogenous variables at some arbitrary positive value }
\NormalTok{g}\OtherTok{=}\DecValTok{1}
\NormalTok{r}\OtherTok{=}\DecValTok{1}
\NormalTok{c}\OtherTok{=}\DecValTok{1}
\NormalTok{u}\OtherTok{=}\DecValTok{1}
\NormalTok{s}\OtherTok{=}\DecValTok{1}

\CommentTok{\#Solve this system numerically through 1000 iterations based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
    
    \CommentTok{\#(1) Profit rate}
\NormalTok{    r }\OtherTok{=}\NormalTok{ (h[i]}\SpecialCharTok{*}\NormalTok{u)}\SpecialCharTok{/}\NormalTok{v}
    
    \CommentTok{\#(2) Saving}
\NormalTok{    s }\OtherTok{=}\NormalTok{ (sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{*}\NormalTok{(u}\SpecialCharTok{/}\NormalTok{v)}
    
    \CommentTok{\#(3) Consumption}
\NormalTok{    c}\OtherTok{=}\NormalTok{ u}\SpecialCharTok{/}\NormalTok{v}\SpecialCharTok{{-}}\NormalTok{s}
    
    \CommentTok{\#(4) Investment}
\NormalTok{    g }\OtherTok{=}\NormalTok{ g0[i]}\SpecialCharTok{+}\NormalTok{g1[i]}\SpecialCharTok{*}\NormalTok{u}\SpecialCharTok{+}\NormalTok{g2}\SpecialCharTok{*}\NormalTok{h[i]}
    
    \CommentTok{\#(5) Rate of capacity utilisation}
\NormalTok{    u }\OtherTok{=}\NormalTok{ v}\SpecialCharTok{*}\NormalTok{(c}\SpecialCharTok{+}\NormalTok{g)}
\NormalTok{  \}}
  
  \CommentTok{\#Save results for different parameterisations in vector}
\NormalTok{  u\_star[i]}\OtherTok{=}\NormalTok{u}
\NormalTok{  g\_star[i]}\OtherTok{=}\NormalTok{g}
\NormalTok{  r\_star[i]}\OtherTok{=}\NormalTok{r}
\NormalTok{  s\_star[i]}\OtherTok{=}\NormalTok{s}
\NormalTok{  c\_star[i]}\OtherTok{=}\NormalTok{c}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Create arrays to store equilibrium solutions for different parameterizations}
\NormalTok{u\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{g\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{s\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{c\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{r\_star }\OperatorTok{=}\NormalTok{ np.zeros(S)}

\CommentTok{\# Set exogenous variables whose parameterization changes across regimes}
\NormalTok{g0 }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{sw }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{h }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{g1 }\OperatorTok{=}\NormalTok{ np.zeros(S)}

\CommentTok{\# Construct different scenarios across 3 regimes}
\CommentTok{\# Regime 1: WLD/WLG}
\NormalTok{g0[}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \FloatTok{0.02}
\NormalTok{g1[}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \FloatTok{0.1}
\NormalTok{h[}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \FloatTok{0.2}

\CommentTok{\# Regime 2: Increase in profit share in WLD/WLG regime}
\NormalTok{g0[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{0.02}
\NormalTok{g1[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{0.1}
\NormalTok{h[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \FloatTok{0.3}

\CommentTok{\# Regime 3: WLD/PLG}
\NormalTok{g0[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \FloatTok{0.02}
\NormalTok{g1[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \FloatTok{0.08}
\NormalTok{h[}\DecValTok{2}\NormalTok{] }\OperatorTok{=} \FloatTok{0.2}

\CommentTok{\# Regime 4: Increase in profit share in WLD/PLG regime}
\NormalTok{g0[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{0.02}
\NormalTok{g1[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{0.08}
\NormalTok{h[}\DecValTok{3}\NormalTok{] }\OperatorTok{=} \FloatTok{0.3}

\CommentTok{\# Regime 5: PLD/PLG}
\NormalTok{g0[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \OperatorTok{{-}}\FloatTok{0.01}
\NormalTok{g1[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \FloatTok{0.1}
\NormalTok{h[}\DecValTok{4}\NormalTok{] }\OperatorTok{=} \FloatTok{0.2}

\CommentTok{\# Regime 6: Increase in profit share in PLD/PLG regime}
\NormalTok{g0[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \OperatorTok{{-}}\FloatTok{0.01}
\NormalTok{g1[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \FloatTok{0.1}
\NormalTok{h[}\DecValTok{5}\NormalTok{] }\OperatorTok{=} \FloatTok{0.3}

\CommentTok{\# Set constant parameter values}
\NormalTok{v }\OperatorTok{=} \DecValTok{3}    \CommentTok{\# capital{-}to{-}potential output ratio}
\NormalTok{g2 }\OperatorTok{=} \FloatTok{0.1} \CommentTok{\# sensitivity of investment with respect to profit share}
\NormalTok{sp }\OperatorTok{=} \FloatTok{0.9} \CommentTok{\# propensity to save out of profits}
\NormalTok{sw }\OperatorTok{=} \FloatTok{0.3} \CommentTok{\# propensity to save out of wages}

\CommentTok{\# Check Keynesian stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(((sw }\OperatorTok{+}\NormalTok{ (sp }\OperatorTok{{-}}\NormalTok{ sw) }\OperatorTok{*}\NormalTok{ h[i]) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ v) }\OperatorTok{{-}}\NormalTok{ g1[i]) }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
    
\CommentTok{\# Check demand and growth regime for 3 baseline scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in}\NormalTok{ [}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{]:}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Parameterization }\SpecialCharTok{\{}\NormalTok{i}\OperatorTok{+}\DecValTok{1}\SpecialCharTok{\}}\SpecialStringTok{ yields:"}\NormalTok{)}
    
    \CommentTok{\# Check demand regime}
    \ControlFlowTok{if}\NormalTok{ g2 }\OperatorTok{*}\NormalTok{ (sw }\OperatorTok{/}\NormalTok{ v }\OperatorTok{{-}}\NormalTok{ g1[i]) }\OperatorTok{{-}}\NormalTok{ g0[i] }\OperatorTok{*}\NormalTok{ (sp }\OperatorTok{{-}}\NormalTok{ sw) }\OperatorTok{/}\NormalTok{ v }\OperatorTok{\textless{}} \DecValTok{0}\NormalTok{:}
        \BuiltInTok{print}\NormalTok{(}\StringTok{"Wage{-}led demand regime"}\NormalTok{)}
    \ControlFlowTok{else}\NormalTok{:}
        \BuiltInTok{print}\NormalTok{(}\StringTok{"Profit{-}led demand regime"}\NormalTok{)}
    
    \CommentTok{\# Check growth regime}
    \ControlFlowTok{if}\NormalTok{ g1[i] }\OperatorTok{*}\NormalTok{ (g2 }\OperatorTok{*}\NormalTok{ (sw }\OperatorTok{/}\NormalTok{ v }\OperatorTok{{-}}\NormalTok{ g1[i]) }\OperatorTok{{-}}\NormalTok{ g0[i] }\OperatorTok{*}\NormalTok{ (sp }\OperatorTok{{-}}\NormalTok{ sw) }\OperatorTok{/}\NormalTok{ v) }\OperatorTok{+}\NormalTok{ g2 }\OperatorTok{*}\NormalTok{ (((sw }\OperatorTok{+}\NormalTok{ (sp }\OperatorTok{{-}}\NormalTok{ sw) }\OperatorTok{*}\NormalTok{ h[i]) }\OperatorTok{*}\NormalTok{ v}\OperatorTok{**}\NormalTok{(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{) }\OperatorTok{{-}}\NormalTok{ g1[i])}\OperatorTok{**}\DecValTok{2}\NormalTok{) }\OperatorTok{\textless{}} \DecValTok{0}\NormalTok{:}
        \BuiltInTok{print}\NormalTok{(}\StringTok{"Wage{-}led growth regime"}\NormalTok{)}
    \ControlFlowTok{else}\NormalTok{:}
        \BuiltInTok{print}\NormalTok{(}\StringTok{"Profit{-}led growth regime"}\NormalTok{)}

\CommentTok{\# Initialize endogenous variables at an arbitrary positive value}
\NormalTok{g }\OperatorTok{=}\NormalTok{ r }\OperatorTok{=}\NormalTok{ c }\OperatorTok{=}\NormalTok{ u }\OperatorTok{=}\NormalTok{ s }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Solve the system numerically through 1000 iterations based on the initialization}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
        \CommentTok{\# (1) Profit rate}
\NormalTok{        r }\OperatorTok{=}\NormalTok{ (h[i] }\OperatorTok{*}\NormalTok{ u) }\OperatorTok{/}\NormalTok{ v}

        \CommentTok{\# (2) Saving}
\NormalTok{        s }\OperatorTok{=}\NormalTok{ (sw }\OperatorTok{+}\NormalTok{ (sp }\OperatorTok{{-}}\NormalTok{ sw) }\OperatorTok{*}\NormalTok{ h[i]) }\OperatorTok{*}\NormalTok{ (u }\OperatorTok{/}\NormalTok{ v)}

        \CommentTok{\# (3) Consumption}
\NormalTok{        c }\OperatorTok{=}\NormalTok{ u }\OperatorTok{/}\NormalTok{ v }\OperatorTok{{-}}\NormalTok{ s}

        \CommentTok{\# (4) Investment}
\NormalTok{        g }\OperatorTok{=}\NormalTok{ g0[i] }\OperatorTok{+}\NormalTok{ g1[i] }\OperatorTok{*}\NormalTok{ u }\OperatorTok{+}\NormalTok{ g2 }\OperatorTok{*}\NormalTok{ h[i]}

        \CommentTok{\# (5) Rate of capacity utilization}
\NormalTok{        u }\OperatorTok{=}\NormalTok{ v }\OperatorTok{*}\NormalTok{ (c }\OperatorTok{+}\NormalTok{ g)}

    \CommentTok{\# Save results for different parameterizations in vectors}
\NormalTok{    u\_star[i] }\OperatorTok{=}\NormalTok{ u}
\NormalTok{    g\_star[i] }\OperatorTok{=}\NormalTok{ g}
\NormalTok{    r\_star[i] }\OperatorTok{=}\NormalTok{ r}
\NormalTok{    s\_star[i] }\OperatorTok{=}\NormalTok{ s}
\NormalTok{    c\_star[i] }\OperatorTok{=}\NormalTok{ c}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-5}

Figures Figure~\ref{fig-utilisation-pkdg} -
Figure~\ref{fig-profit-rate-pkdg} depict the response of the model's key
endogenous variables to changes in the profit share. In the first case
of a wage-led demand and growth regime (WLD/WLG), investment is equally
sensitive to a change in the rate of capacity utilisation (\(g_1\)) and
a change in the profit share (\(g_2\)). A rise in the profit share
reduces consumption, which reduces the rate of capacity utilisation and
the rate of growth. This is despite a positive effect on the profit
rate.\footnote{If the negative effect on the rate of capacity
  utilisation was stronger, the profit rate could fall as well. See the
  analytical discussion for a formal derivation of the condition under
  which this may happen.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(u\_star, }\AttributeTok{ylab=}\StringTok{"u"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1a:baseline WLD/WLG"}\NormalTok{, }\StringTok{"1b:rise prof share"}\NormalTok{, }\StringTok{"2a:baseline WLD/PLG"}\NormalTok{, }\StringTok{"2b:rise prof share"}\NormalTok{, }\StringTok{"3a:baseline PLD/PLG"}\NormalTok{, }\StringTok{"3b: rise prof share"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_kaleckian_distribution_and_growth_model_files/figure-pdf/fig-utilisation-pkdg-1.pdf}

}

\caption{\label{fig-utilisation-pkdg}Rate of capacity utilisation}

\end{figure}%

In the second case where the demand regime is wage-led but the growth
regime is profit-led (WLD/PLG), investment is slightly less sensitive to
a change in the rate of capacity utilisation compared to a change in the
profit share. The rise in the profit share reduces consumption and the
rate of utilisation, but the ultimate effect on investment is positive
because investment reacts more strongly to the rise in the profit share
than to the fall in demand.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(g\_star, }\AttributeTok{ylab=}\StringTok{"g"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline WLD/WLG"}\NormalTok{, }\StringTok{"2:rise prof share"}\NormalTok{, }\StringTok{"3:baseline WLD/PLG"}\NormalTok{,}
                                      \StringTok{"4:rise prof share"}\NormalTok{, }
                                      \StringTok{"5:baseline PLD/PLG"}\NormalTok{, }\StringTok{"6: rise prof share"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_kaleckian_distribution_and_growth_model_files/figure-pdf/fig-growth-pkdg-1.pdf}

}

\caption{\label{fig-growth-pkdg}Rate of growth}

\end{figure}%

Finally, in the third case where the demand regime and the growth regime
are profit-led, investment is again equally sensitive to a change in the
rate of capacity utilisation and to a change in the profit share, but
now animal spirits are negative. A rise in the profit share now has
strong positive effects on investment, which raises the rate of capacity
utilisation and consumption.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(c\_star, }\AttributeTok{ylab=}\StringTok{"c"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline WLD/WLG"}\NormalTok{, }\StringTok{"2:rise prof share"}\NormalTok{, }\StringTok{"3:baseline WLD/PLG"}\NormalTok{,}
                                      \StringTok{"4:rise prof share"}\NormalTok{, }
                                      \StringTok{"5:baseline PLD/PLG"}\NormalTok{, }\StringTok{"6: rise prof share"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_kaleckian_distribution_and_growth_model_files/figure-pdf/fig-consumption-pkdg-1.pdf}

}

\caption{\label{fig-consumption-pkdg}Rate of consumption}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(r\_star, }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{names.arg=}\FunctionTok{c}\NormalTok{(}\StringTok{"1:baseline WLD/WLG"}\NormalTok{, }\StringTok{"2:rise prof share"}\NormalTok{, }\StringTok{"3:baseline WLD/PLG"}\NormalTok{,}
                                     \StringTok{"4:rise prof share"}\NormalTok{, }
                                     \StringTok{"5:baseline PLD/PLG"}\NormalTok{, }\StringTok{"6: rise prof share"}\NormalTok{), }\AttributeTok{cex.names =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_kaleckian_distribution_and_growth_model_files/figure-pdf/fig-profit-rate-pkdg-1.pdf}

}

\caption{\label{fig-profit-rate-pkdg}Rate of profit}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot results (here only for rate of capacity utilisation) }
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt    }

\CommentTok{\# Scenario labels}
\NormalTok{scenario\_names }\OperatorTok{=}\NormalTok{ [}\StringTok{"1a: baseline WLD/WLG"}\NormalTok{, }\StringTok{"1b: rise prof share"}\NormalTok{, }\StringTok{"2a: baseline WLD/PLG"}\NormalTok{, }\StringTok{"2b: rise prof share"}\NormalTok{, }\StringTok{"3a: baseline PLD/PLG"}\NormalTok{, }\StringTok{"3b: rise prof share"}\NormalTok{]}

\CommentTok{\# Bar plot for u\_star}
\NormalTok{plt.bar(scenario\_names, u\_star)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}u\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xticks(scenario\_names, rotation}\OperatorTok{=}\DecValTok{45}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{6}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-5}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph }
\CommentTok{\# Construct auxiliary Jacobian matrix for 6 variables: }
\CommentTok{\# r, h, u, s, c, g}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create and plot directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"r"}\NormalTok{, }\StringTok{"h"}\NormalTok{, }\StringTok{"u"}\NormalTok{, }\StringTok{"s"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"g"}\NormalTok{)}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_post_kaleckian_distribution_and_growth_model_files/figure-pdf/fig-dg-pkdg-2.pdf}

}

\caption{\label{fig-dg-pkdg}Directed graph of post-Kaleckian growth
model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Define the Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                 ])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"r"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"h"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"u"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"s"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{"c"}\NormalTok{, }\DecValTok{5}\NormalTok{: }\StringTok{"g"}\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure Figure~\ref{fig-dg-pkdg}, it can be seen that the profit share
(\(h\)) is the key exogenous variable of the model.\footnote{Other
  important exogenous variables or parameters that may shift but are not
  depicted here are animal spirits (\(g_0\)) or the saving propensities
  (\(s_W, s_\Pi\)). See Hein (2014), chap.~7.2.2, for a detailed
  discussion of their effects.} Consumption (\(c\)), saving (\(s\)),
investment (\(g\)), and the rate of utilisation (\(u\)) form a closed
loop (or cycle) within the system. The profit share affects both saving
and investment, which in turn affect consumption and the rate of
capacity utilisation. The profit rate is a residual variable (also
called a `sink') in this model.

\section{Analytical discussion}\label{analytical-discussion-4}

To find the equilibrium solutions, substitute Equation~\ref{eq-s} -
Equation~\ref{eq-g} into Equation~\ref{eq-u} and solve for \(u\):
\begin{align}
u^* = \frac{g_0+g_2h}{[s_W + (s_\Pi - s_W)h]v^{-1}-g_1}.
\end{align}

The equilibrium solution for \(u\) can then be substituted into
Equation~\ref{eq-g} to find: \begin{align}
g^* = \frac{(g_0+g_2h)[s_W + (s_\Pi - s_W)h]v^{-1}}{[s_W + (s_\Pi - s_W)h]v^{-1}-g_1}.
\end{align}

The Keynesian stability condition requires
\([s_W + (s_\Pi - s_W)h]v^{-1}-g_1>0\), i.e.~saving need to react more
strongly to income than investment.

The equilibrium solution for \(r\) can be found by substituting \(u^*\)
into Equation~\ref{eq-r}: \begin{align}
r^* = \frac{h(g_0+g_2h)}{[s_W + (s_\Pi - s_W)h]-vg_1}.
\end{align}

To assess whether the demand regime is wage- or profit-led, take the
derivative of \(u^*\) with respect to \(h\): \begin{align}
\frac{\partial u^*}{\partial h} = \frac{\frac{s_W}{v}(g_0+g_2 )-(g_0\frac{s_\Pi}{v} + g_1g_2)}{[[s_W + (s_\Pi - s_W)h]v^{-1}-g_1]^2}.
\end{align}

It can be seen that, e.g., a higher propensity to save out of wages or
negative animal spirits make the regime more likely to be profit-led.

By the same token, the sign of the derivative of \(g^*\) with respect to
\(h\) determines whether the growth regime is wage- or profit-led:
\begin{align}
\frac{\partial g^*}{\partial h} = g_1\frac{\partial u^*}{\partial h}+g_2.
\end{align}

It can be seen that, e.g., a higher sensitivity of investment with
respect to the profit share makes the regime more likely to be
profit-led.

Finally, the effect on the profit rate will depend on the sign of the
derivative: \begin{align}
\frac{\partial r^*}{\partial h} = \frac{u^*}{v} + \frac{h}{v}\frac{\partial u^*}{\partial h},
\end{align}

which is likely to be positive but can become negative if the demand
regime is strongly wage-led.

\subsection{Calculate analytical solutions
numerically}\label{calculate-analytical-solutions-numerically-1}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Utilisation rate}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{((g0[i]}\SpecialCharTok{+}\NormalTok{g2}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{/}\NormalTok{((sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{/}\NormalTok{v}\SpecialCharTok{{-}}\NormalTok{g1[i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
[1] 0.8333333
[1] 0.6666667
[1] 0.625
[1] 0.25
[1] 0.3333333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Growth rate}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \FunctionTok{print}\NormalTok{(((g0[i]}\SpecialCharTok{+}\NormalTok{g2}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{*}\NormalTok{(sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{/}\NormalTok{v)}\SpecialCharTok{/}\NormalTok{((sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{/}\NormalTok{v}\SpecialCharTok{{-}}\NormalTok{g1[i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.14
[1] 0.1333333
[1] 0.09333333
[1] 0.1
[1] 0.035
[1] 0.05333333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Profit rate}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  \FunctionTok{print}\NormalTok{((g0[i]}\SpecialCharTok{+}\NormalTok{g2}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{*}\NormalTok{(h[i]}\SpecialCharTok{/}\NormalTok{v)}\SpecialCharTok{/}\NormalTok{((sw}\SpecialCharTok{+}\NormalTok{(sp}\SpecialCharTok{{-}}\NormalTok{sw)}\SpecialCharTok{*}\NormalTok{h[i])}\SpecialCharTok{/}\NormalTok{v}\SpecialCharTok{{-}}\NormalTok{g1[i]))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.06666667
[1] 0.08333333
[1] 0.04444444
[1] 0.0625
[1] 0.01666667
[1] 0.03333333
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Utilisation rate}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{((g0[i]}\OperatorTok{+}\NormalTok{g2}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{/}\NormalTok{((sw}\OperatorTok{+}\NormalTok{(sp}\OperatorTok{{-}}\NormalTok{sw)}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{/}\NormalTok{v}\OperatorTok{{-}}\NormalTok{g1[i]))}

\CommentTok{\# Growth rate}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(((g0[i]}\OperatorTok{+}\NormalTok{g2}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{*}\NormalTok{(sw}\OperatorTok{+}\NormalTok{(sp}\OperatorTok{{-}}\NormalTok{sw)}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{/}\NormalTok{v)}\OperatorTok{/}\NormalTok{((sw}\OperatorTok{+}\NormalTok{(sp}\OperatorTok{{-}}\NormalTok{sw)}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{/}\NormalTok{v}\OperatorTok{{-}}\NormalTok{g1[i]))}
    
\CommentTok{\# Profit rate}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{((g0[i]}\OperatorTok{+}\NormalTok{g2}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{*}\NormalTok{(h[i]}\OperatorTok{/}\NormalTok{v)}\OperatorTok{/}\NormalTok{((sw}\OperatorTok{+}\NormalTok{(sp}\OperatorTok{{-}}\NormalTok{sw)}\OperatorTok{*}\NormalTok{h[i])}\OperatorTok{/}\NormalTok{v}\OperatorTok{{-}}\NormalTok{g1[i]))}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section*{References}\label{references-6}
\addcontentsline{toc}{section}{References}

\markright{References}

\part{Dynamic Models}

\chapter{An Introduction to the Analysis of Dynamic
Models}\label{sec-stab_analysis}

To build and analyse dynamic models, we need to understand the dynamics
of \emph{state variables}, which are a function of their own previous
values: \(y_t=h(y_{t-1})\). The state variables govern the dynamics of
the entire model (including the non-state variables). Typically, as
model has multiple state variables that interact with each other over
time. As briefly shown in Chapter~\ref{sec-how-to-simulate}, we can
simulate dynamic models numerically for a specific parameterisation.
However, to study their dynamics in general, we need to mathematically
analyse a \emph{system of difference (or differential) equations}. This
chapter provides a basic introduction to the mathematical tools to do
this. It will help you understand the analytical discussions in the
chapters on dynamic models but can be skipped if you are mostly
interested in numerical simulation.

\section{Solution of a single first-order linear difference
equation}\label{solution-of-a-single-first-order-linear-difference-equation}

Consider a first-order linear difference equation:\footnote{We will
  focus here on difference instead of differential equations, i.e.~on
  dynamics in discrete as opposed to continuous time. Most of the
  continuous-time counterpart is analogous to the material covered here.
  Sayama (2015) provides a very accessible and applied introduction to
  dynamic systems with Python code. An introductory treatment of the
  underlying mathematics is Chiang and Wainwright (2005), chaps. 15-19.
  Gandolfo (2009) provides a more advanced treatment of the mathematics
  as well as many economic examples. A great introduction to linear
  algebra is Anthony and Harvey (2012).}

\[
y_t = a_0 + a_1y_{t-1}.
\]

One way to find a solution is through (manual) iteration:

\[y_0,\] \[y_1 = a_0 + a_1 y_0,\]
\[y_2 = a_0 + a_1(a_0 + a_1 y_0) = a_0(a_1+1) + a_1^2y_0 ,\]
\[y_3 = a_0 + a_1[a_0 + a_1(a_0 +a_1y_0)]= a_0(a_1^2+a_1+1) + a_1^3y_0\]
\[...,\] \[y_t = a_0\sum^{t-1}_{i=0} a_1^i + a_1^ty_0 \]

This is effectively the same approach we have used before to solve
economic models via simulation.

If \(a_1\neq1\), the term \(a_0\sum^{t-1}_{i=0} a_1^i\) is a convergent
geometric series:

\[a_0\sum^{t-1}_{i=0} a_1^i= a_0\frac{(1-a_1^t)}{1-a_1}.\]

Thus, the solution thus takes the form:

\[
y_t = \frac{a_0(1-a_1^t)}{1-a_1} + a_1^ty_0 =\frac{a_0}{1-a_1} + a_1^t\left(y_0 - \frac{a_0}{1-a_1}\right).
\]

From iteration, we thus know that the solution to a difference equation
has two parts:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  a term that captures the long-run equilibrium \(y^*\) (the so-called
  \emph{particular solution}),
\item
  a term that captures the dynamics of \(y_t\) (the so-called
  \emph{complementary function}).
\end{enumerate}

\[
y_t = \underbrace{\frac{a_0}{1-a_1}}_{equilibrium \: y^*} + \underbrace{a_1^t\left(y_0 - \frac{a_0}{1-a_1}\right)}_{dynamics}.
\]

The complementary function tells us about the `asymptotic stability' of
the equation: does \(y_t\) converge to \(y^*\) as
\(t \rightarrow \infty\)?

For the case of a first-order difference equation, we can distinguish
the following cases:

\begin{itemize}
\item
  if \(|a_1|<1\), then the complementary function will converge to zero
  and \(y_t\) will approach the particular solution \(y^*\)
\item
  if \(|a_1|>1\), then the complementary function will grow
  exponentially or decay, and \(y_t\) will thus never converge to the
  particular solution \(y^*\)
\item
  if \(a_1=1\) and \(a_0 \neq0\), then \(y_t\) will grow linearly
\item
  if \(a_1=1\) and \(a_0 =0\), then \(y_t\) will not grow or fall
  forever, but it will also not approach a unique equilibrium
\end{itemize}

To better understand the last two cases, note that if \(a_1=1\), a
different (more general) approach to finding the particular solution is
required: the so-called \emph{method of undetermined coefficients}. This
method consists of substituting a trial solution that contains
undetermined coefficients into the difference equation and then
attempting to solve for those coefficients. If the trial solution allows
to pin down unique values for the coefficients, it constitute a valid
particular solution.

In the case above where \(a_1 \neq 1\), we could have used the trial
solution \(y_t=y_{t-1}=y^*\) and then solve for \(y\) to obtain
\(\frac{a_0}{1-a}\) as the particular solution. In the case where
\(a_1=1\) and \(a_0 \neq 0\), we can use the trial solution \(y^*=kt\),
which is a growing equilibrium. This yields \(y_t = k(t-1) + a_0\),
which solves for \(k=a_0\), so that we can conclude \(y^*=a_0t\). This
explains why we obtain linear growth. If \(a_1=1\) and \(a_0 =0\), we
have \(y_t=y_{t-1}\), so that the equilibrium is given by the initial
condition \(y_0\).

\section{Solution of a linear system of difference
equations}\label{solution-of-a-linear-system-of-difference-equations}

The solution approach just introduced can be extended to
\(N\)-dimensional systems of linear difference equations of the form:

\[
y_t=a_0 + Ay_{t-1},  
\]

where \(y_t\) is a \(1 \times N\) column vector and \(A\) an
\(N \times N\) square matrix.

If the inverse \((I-A)^{-1}\) exists, which requires
\(det(I-A) \neq 0\), the solution will be of the form:

\[
y_t= \underbrace{(I-A)^{-1}a_0}_{y^*} + A^t[y_0- \underbrace{(I-A)^{-1}a_0}_{y^*}].
\]

The problem with this generic solution is that it is difficult to assess
what is going on: the dynamics of any variable in \(y_t\) will depend on
a lengthy combination of the parameters in \(A\) that result from
repeated matrix multiplication (\(A^t=A\times A\times A\times A...\)).
This makes it is impossible to assess whether the system converges to
the particular solution. To address this problem, we can use a tool from
linear algebra called \emph{matrix diagonalisation}. Under certain
conditions, a matrix \(A\) can be decomposed into the product of three
matrices in which the matrix in the middle is diagonal. As we will see,
this trick has a useful application to our problem.

A matrix \(A\) is diagonalisable if there is a diagonal matrix \(D\) and
an invertible matrix \(P\) such that \(A=PDP^{-1}\). A major advantage
of this decomposition is the following property:
\(A^n = (PDP^{-1})^n = PD^nP^{-1}\).\footnote{This is because in the
  product \((PDP^{-1})(PDP^{-1})(PDP^{-1})...\), each \(P\) cancels a
  \(P^{-1}\), except for the first \(P\) and last \(P^{-1}\).} Thus, the
\(nth\) power of the matrix \(A\), which typically yields very
cumbersome expressions, simplifies to \(PD^nP^{-1}\), where the \(nth\)
power of \(D\) is simply applied to each individual element on the main
diagonal thanks to \(D\) being a diagonal matrix. As a result,
diagonalisation allows us to write the complementary function in the
solution to a system of difference equations as: \(PD^tP^{-1}y_0\). We
can further define a vector of arbitrary constants \(c=P^{-1}y_0\) so
that the complementary function becomes \(PD^tc\). The solution then
takes the form \(y_t = y^* + PD^tP^{-1}[y_0- y^*] = y^* + PD^tc\)

For the first variable in the system, the solution would be:

\[
y_{1t}=v_{11}c_1\lambda_1^t+v_{12}c_2\lambda_2^t + ...+ y_1^*,
\]

where \(v_j\) are the column vectors of \(P\) and \(\lambda_i\) are the
elements on the main diagonal of \(D\). The \(v_j\) are called the
\emph{eigenvectors} of the matrix \(A\) and the \(\lambda_i\) are its
\emph{eigenvalues} (more about them in a second). From this
representation of the solution, the nature of the dynamics can easily be
determined by looking at the eigenvalue \(\lambda\) that is largest in
absolute terms. This is also called the `dominant eigenvalue'. Only if
the dominant eigenvalue is \(|\lambda|<1\) will the system converge to
\(y^*\). The elements \(v_{ij}\) of the eigenvectors act as multipliers
on the eigenvalues and can thus switch off certain eigenvalues (if they
happen to be zero) or amplify their dynamics both into the positive and
negative domain (depending on their algebraic sign).

How can the diagonal matrix \(D\) be found? Notice that \(AP=PD\) can
also be written as \(Av=\lambda v\). We can then write
\(v(A-\lambda I)=0\). We want to find the solutions of this linear
system other than \(v = 0\) (we don't want the eigenvectors to be zero
vectors, otherwise the solution to the dynamic system presented above
wouldn't work). This requires the determinant of the matrix
\(A-\lambda I\) to become zero, i.e.~\(det(A-\lambda I)=0\). Note that
then there will be an infinite number of solutions for the eigenvectors.

Let's consider an example. Let \(a_0=0\) for simplicity, so that the
dynamic system is \(y_t = Ay_{t-1}\). Let the matrix \(A\) be given by:
\[A=\begin{bmatrix}7 & -15 \\ 2 & -4 \end{bmatrix}.\]

Then

\[A-\lambda I =\begin{bmatrix}7 - \lambda & -15 \\ 2 & -4 - \lambda \end{bmatrix}\]

and

\[det(A-\lambda I)=(7-\lambda)(-4-\lambda)+30=\lambda^2 - 3\lambda +2=0.\]

This second-order polynomial solves for \(\lambda_1=2\) and
\(\lambda_2=1\), which will be the elements on the diagonal of \(D\).

To find \(v_j\), substitute the \(\lambda_i\) into
\(v_j(A-\lambda_iI)=0\). For \(\lambda_1=2\), we get
\(5v_{11}- 15v_{21}=0\) and \(2v_{11}- 6v_{21}=0\), yielding the
eigenvector \(v_1=\begin{bmatrix} 3 \\ 1\end{bmatrix}\). However, any
scalar multiple of this eigenvector (other than zero) is admissible. It
is thus common to normalise the eigenvectors by dividing through one of
its elements. Dividing through by the first element yields the
normalised eigenvector
\(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\).

For \(\lambda_2=1\), this yields \(6v_{12}- 15v_{22}=0\) and
\(2v_{12}-5v_{22}=0\) from which we can deduce that
\(v_2=\begin{bmatrix} 5 \\ 2\end{bmatrix}\). The normalised eigenvector
is \(v_2=\begin{bmatrix} 1 \\ 0.4 \end{bmatrix}\).

Of course, you can also perform these calculations in \emph{R} or
\emph{Python}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\DocumentationTok{\#\# Find eigenvalues and eigenvectors of matrix}
\CommentTok{\# Define matrix}
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{15}\NormalTok{,}
           \DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues and eigenvectors}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{evals =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\AttributeTok{evecs =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{vector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          [,1]      [,2]
[1,] 0.9486833 0.9284767
[2,] 0.3162278 0.3713907
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Normalise eigenvectors by dividing through by the first element}
\NormalTok{evecs\_norm}\OtherTok{=}\NormalTok{evecs}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)\{}
\NormalTok{  evecs\_norm[,i]}\OtherTok{=}\NormalTok{evecs[,i]}\SpecialCharTok{/}\NormalTok{evecs[}\DecValTok{1}\NormalTok{,i]}
\NormalTok{\}}
\NormalTok{evecs\_norm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          [,1] [,2]
[1,] 1.0000000  1.0
[2,] 0.3333333  0.4
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Define matrix}
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{7}\NormalTok{, }\OperatorTok{{-}}\DecValTok{15}\NormalTok{],}
\NormalTok{              [}\DecValTok{2}\NormalTok{, }\OperatorTok{{-}}\DecValTok{4}\NormalTok{]])}

\CommentTok{\# Obtain eigenvalues and eigenvectors}
\NormalTok{evals, evecs }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}

\CommentTok{\# Print eigenvalues and eigenvectors}
\BuiltInTok{print}\NormalTok{(evals)}
\BuiltInTok{print}\NormalTok{(evecs)}

\CommentTok{\# Initialize an array to store the normalized eigenvectors}
\NormalTok{evecs\_norm }\OperatorTok{=}\NormalTok{ np.copy(evecs)}

\CommentTok{\# Normalize the eigenvectors}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{2}\NormalTok{):}
\NormalTok{    evecs\_norm[:, i] }\OperatorTok{=}\NormalTok{ evecs[:, i] }\OperatorTok{/}\NormalTok{ evecs[}\DecValTok{0}\NormalTok{, i]}

\CommentTok{\# Print normalized eigenvectors}
\BuiltInTok{print}\NormalTok{(evecs\_norm)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

We can now use this solution for the eigenvectors and eigenvalues to
write the solution of the dynamic system as:

\[
\begin{bmatrix} y_{1t} \\ y_{2t} \end{bmatrix}= \begin{bmatrix} 1 & 1 \\ \frac{1}{3} & 0.4 \end{bmatrix} \begin{bmatrix} 2 & 0 \\ 0 & 1 \end{bmatrix}^t \begin{bmatrix} 1 & 1 \\ \frac{1}{3} & 0.4 \end{bmatrix}^{-1} \begin{bmatrix} y_{10} \\ y_{20} \end{bmatrix} = \begin{bmatrix} 1 & 1 \\ \frac{1}{3} & 0.4 \end{bmatrix} \begin{bmatrix} 2 & 0 \\ 0 & 1 \end{bmatrix}^t \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix}.
\]

Multiplying the matrices out yields:

\[
 y_{1t} = c_{1}2^t + c_{2}1^t
\]

\[
 y_{2t} = \frac{1}{3}c_{1}2^t + 0.4c_{2}1^t. 
\]

Before comparing these analytical results with those from a numerical
simulation, let's summarise the information we gain from the
eigenvalues, eigenvectors, and arbitrary constants about the dynamics of
the system:

\begin{itemize}
\item
  since the dominant eigenvalue \(\lambda_1=2\) is larger than one, we
  know that the system is unstable
\item
  since both elements in the dominant eigenvector
  \(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\) are non-zero,
  both variables in the system will be driven by that dominant
  eigenvalue
\item
  since both variables will grow or decay at the same rate, their ratio
  will be constant as \(t \rightarrow \infty\) and will approach a value
  that is given by the ratio of the elements in the dominant eigenvector
\end{itemize}

To see the last point, observe that in
\(\frac{y_{2t}}{y_{1t}}=\frac{\frac{1}{3}c_{1}2^t + 0.4c_{2}1^t}{c_{1}2^t + c_{2}1^t}\)
the first terms in the numerator and denominator, respectively, quickly
dominate the second terms as \(t \rightarrow \infty\) (you can show this
formally using
\href{https://en.wikipedia.org/wiki/L\%27H\%C3\%B4pital\%27s_rule}{L'Hopital's
rule}). Thus, \(\frac{y_{2t}}{y_{1t}}\) will approach \(\frac{1}{3}\) as
\(t \rightarrow \infty\).

Let us simulate the system and compare the results for, say, \(t=10\)
with the analytical solution:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set number of periods for which you want to simulate}
\NormalTok{Q}\OtherTok{=}\DecValTok{100}

\CommentTok{\# Construct matrices in which values for different periods will be stored; initialise at 1}
\NormalTok{y1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{1}\NormalTok{, }\AttributeTok{ncol=}\NormalTok{Q)}
\NormalTok{y2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{1}\NormalTok{, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Solve this system recursively based on the initialisation}
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
\NormalTok{    y1[,t] }\OtherTok{=}\NormalTok{ J[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{y1[, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ J[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{y2[, t}\DecValTok{{-}1}\NormalTok{]}
\NormalTok{    y2[,t] }\OtherTok{=}\NormalTok{ J[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{y1[, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ J[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{y2[, t}\DecValTok{{-}1}\NormalTok{]}
\NormalTok{\} }\CommentTok{\# close time loop}

\CommentTok{\# Plot dynamics of y1}
\FunctionTok{plot}\NormalTok{(y1[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{15}\NormalTok{],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"y1"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{intro_stability_analysis_files/figure-pdf/stab_analysis2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Find arbitrary constants: c=(P\^{}{-}1)*y0}
\FunctionTok{library}\NormalTok{(matlib)}
\NormalTok{y0}\OtherTok{=}\FunctionTok{c}\NormalTok{(y1[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],y2[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{])  }\CommentTok{\# create vector with initial conditions y0}
\NormalTok{c}\OtherTok{=}\FunctionTok{inv}\NormalTok{(evecs\_norm)}\SpecialCharTok{\%*\%}\NormalTok{y0}
\NormalTok{c}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     [,1]
[1,]   -9
[2,]   10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Compute solution manually for y2 at t=10 and compare with simulated solution}
\NormalTok{t}\OtherTok{=}\DecValTok{10}
\NormalTok{evecs\_norm[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{c[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{evals[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{t }\SpecialCharTok{+}\NormalTok{ evecs\_norm[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{c[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{evals[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{t }\CommentTok{\# analytical solution}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -3068.667
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y2[,t}\SpecialCharTok{+}\DecValTok{1}\NormalTok{] }\CommentTok{\# simulated solution}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -3068
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot dynamics of y2/y1}
\NormalTok{y2\_y1}\OtherTok{=}\NormalTok{y2}\SpecialCharTok{/}\NormalTok{y1}
\FunctionTok{plot}\NormalTok{(y2\_y1[, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{50}\NormalTok{],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"y2/y1"}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{intro_stability_analysis_files/figure-pdf/stab_analysis2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compare y2/y1 with normalised dominant eigenvector}
\NormalTok{y2\_y1[,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.3333333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{evecs\_norm[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.3333333
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set the number of periods for simulation}
\NormalTok{Q }\OperatorTok{=} \DecValTok{100}

\CommentTok{\# Initialize arrays to store values for different periods}
\NormalTok{y1 }\OperatorTok{=}\NormalTok{ np.ones(Q)}
\NormalTok{y2 }\OperatorTok{=}\NormalTok{ np.ones(Q)}

\CommentTok{\# Solve the system recursively based on the initialization}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
\NormalTok{    y1[t] }\OperatorTok{=}\NormalTok{ J[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ y1[t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ J[}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ y2[t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}
\NormalTok{    y2[t] }\OperatorTok{=}\NormalTok{ J[}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ y1[t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ J[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ y2[t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}

\CommentTok{\# Plot dynamics of y1}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Q), y1, color}\OperatorTok{=}\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}y1\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{\textquotesingle{}Dynamics of y1\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}


\CommentTok{\# Define the initial conditions y0}
\NormalTok{y0 }\OperatorTok{=}\NormalTok{ np.array([y1[}\DecValTok{0}\NormalTok{], y2[}\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Calculate the arbitrary constants c using the normalized eigenvectors}
\NormalTok{c }\OperatorTok{=}\NormalTok{ np.linalg.inv(evecs\_norm).dot(y0)}
\NormalTok{c}

\CommentTok{\#\# Compute solution manually for y2 at t=10 and compare with simulated solution}
\NormalTok{t }\OperatorTok{=} \DecValTok{10} \OperatorTok{+}\DecValTok{1}
\NormalTok{evecs\_norm[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ c[}\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ evals[}\DecValTok{0}\NormalTok{] }\OperatorTok{**}\NormalTok{ t }\OperatorTok{+}\NormalTok{ evecs\_norm[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ c[}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ evals[}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ t}
\NormalTok{y2[t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}


\CommentTok{\# Calculate the ratio y2/y1}
\NormalTok{y2\_y1 }\OperatorTok{=}\NormalTok{ y2 }\OperatorTok{/}\NormalTok{ y1}

\CommentTok{\# Plot dynamics of y2/y1 for the first 50 periods}
\NormalTok{plt.plot(y2\_y1[:}\DecValTok{50}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}y2/y1\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}

\CommentTok{\# Compare y2/y1 with normalised dominant eigenvector}
\NormalTok{y2\_y1[Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{evecs\_norm[}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

It can be seen that the simulated results are equivalent to the results
we obtained analytically. The key takeaway is that by deriving
information about the eigenvalues (and possibly eigenvectors) of the
Jacobian matrix of the system, we are able to deduce knowledge of the
dynamic properties of the system even without numerical simulation.
However, the more complex the dynamic system, the more difficult this
will be, thereby rendering numerical simulation a key tool to supplement
formal analysis.

\section{Complex eigenvalues and
cycles}\label{complex-eigenvalues-and-cycles}

So far, we have discussed the case where the eigenvalues \(\lambda\) are
real numbers. However, what if the polynomial \(det(A-\lambda I)=0\)
does not yield real numbers? Recall that in the case of a second-order
polynomial \(\lambda^2+b\lambda+c=0\), the two roots are given by
\(\lambda_{1,2} = \frac{-b \pm \sqrt{b^2-4c}}{2}\). If the term under
the root \(\Delta=b^2-4c\), also called discriminant, becomes negative,
the solution will be a \emph{complex number}. More specifically, we can
write:

\[
\lambda_{1,2} = \frac{-b \pm \sqrt{b^2-4c}}{2}=\frac{-b \pm \sqrt{4c-b^2}\sqrt{-1}}{2} =\frac{-b \pm \sqrt{4c-b^2}i}{2}, 
\]

where \(i=\sqrt{-1}\) is the imaginary number. The expression can also
be written as:

\[
\lambda_{1,2} = \frac{-b}{2} \pm \frac{\sqrt{4c-b^2}}{2}i = h \pm mi,
\]

which is a pair of conjugate complex numbers containing a real part
given by \(h\) and an imaginary part given by \(m\).

Consider the model by Samuelson (1939) discussed in
Chapter~\ref{sec-how-to-simulate}: \[
C_t= c_1(C_{t-1} + I_{t-1} + G_0)
\]

\[
I_t= \beta[c_1(C_{t-1} + I_{t-1} + G_0) - C_{t-1}]
\]

The Jacobian matrix of this model is given by:

\[
J=\begin{bmatrix} c_1 & c_1 \\ \beta(c_1-1) & \beta c_1 \end{bmatrix}
\]

The characteristic polynomial yielding the eigenvalues of the Jacobian
is

\[\lambda^2-\lambda c_1(1+\beta)+\beta c_1=0,\]

where \(c_1(1+\beta) =tr(J)\) and \(\beta c_1 = det(J)\).

Thus we have

\[
\lambda_{1,2} = \frac{c_1(1+\beta) \pm \sqrt{[c_1(1+\beta)]^2-4\beta c_1}}{2}.
\]

Thus, the two eigenvalues will be a pair of complex conjugates if
\([c_1(1+\beta)]^2-4\beta c_1 <0\) or
\(c_1 < \frac{4\beta}{(1+\beta)^2}\). Suppose we have \(c_1=0.4\) and
\(\beta=2\). Then the discriminant will be negative and the eigenvalues
will be complex:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment }
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set parameter values}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.4}
\NormalTok{beta}\OtherTok{=}\DecValTok{2}

\CommentTok{\# Check if discriminant is negative}
\NormalTok{(c1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{beta))}\SpecialCharTok{\^{}}\DecValTok{2{-}4}\SpecialCharTok{*}\NormalTok{c1}\SpecialCharTok{*}\NormalTok{beta}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -1.76
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Find eigenvalues and eigenvectors of matrix}
\CommentTok{\# Define matrix}
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(c1, c1,}
\NormalTok{           beta}\SpecialCharTok{*}\NormalTok{(c1}\DecValTok{{-}1}\NormalTok{), beta}\SpecialCharTok{*}\NormalTok{c1), }
           \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues and eigenvectors}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{evals =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.6+0.663325i 0.6-0.663325i
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set parameter values}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.4}
\NormalTok{beta }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# Check if discriminant is negative}
\NormalTok{(c1 }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ beta))}\OperatorTok{**}\DecValTok{2} \OperatorTok{{-}} \DecValTok{4} \OperatorTok{*}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ beta}

\CommentTok{\# Define the matrix}
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([[c1, c1],}
\NormalTok{              [beta }\OperatorTok{*}\NormalTok{ (c1 }\OperatorTok{{-}} \DecValTok{1}\NormalTok{), beta }\OperatorTok{*}\NormalTok{ c1]])}

\CommentTok{\# Calculate eigenvalues and eigenvectors}
\NormalTok{evals, evecs }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}

\BuiltInTok{print}\NormalTok{(evals)}
\BuiltInTok{print}\NormalTok{(evals)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Another way of understanding the logic behind complex numbers is through
a so-called \emph{Argand diagram} that plots the real part of the
eigenvalue on the horizontal and the imaginary part on the vertical
axis. By Pythagoras' theorem, the distance of the eigenvalue from the
origin will then be given by \(R=\sqrt{h^2+m^2}\). The value of \(R\)
(which is always real-valued and positive) is called the \emph{modulus}
(or absolute value) of the complex eigenvalue and will contain important
information about the dynamic stability of economic models that exhibit
complex eigenvalues.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Draw Argand diagram}

\CommentTok{\# Save real and imaginary part of complex eigenvalue}
\NormalTok{re}\OtherTok{=}\FunctionTok{Re}\NormalTok{(evals[}\DecValTok{1}\NormalTok{])}
\NormalTok{im}\OtherTok{=}\FunctionTok{Im}\NormalTok{(evals[}\DecValTok{1}\NormalTok{])}

\CommentTok{\# Plot complex eigenvalue}
\FunctionTok{par}\NormalTok{(}\AttributeTok{bty=}\StringTok{"l"}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(re,im, }\AttributeTok{type=}\StringTok{"o"}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"h"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"m"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Argand diagram of complex eigenvalue"}\NormalTok{)}

\CommentTok{\# Plot unit circle}
\NormalTok{X}\OtherTok{=}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{by=}\FloatTok{0.001}\NormalTok{)}
\NormalTok{Y }\OtherTok{=} \FunctionTok{sqrt}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ X}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\FunctionTok{lines}\NormalTok{(X,Y, }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lty=}\StringTok{"dotted"}\NormalTok{)}

\CommentTok{\# Plot a ray from the origin to eigenvalue}
\FunctionTok{segments}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,re,im, }\AttributeTok{lty=}\StringTok{\textquotesingle{}solid\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Add labels}
\FunctionTok{text}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.025}\NormalTok{, }\FunctionTok{expression}\NormalTok{(theta), }\AttributeTok{cex=}\DecValTok{1}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FunctionTok{expression}\NormalTok{(R}\SpecialCharTok{==}\FunctionTok{sqrt}\NormalTok{(h}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{+}\NormalTok{m}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)), }\AttributeTok{cex=}\DecValTok{1}\NormalTok{)}
\FunctionTok{text}\NormalTok{(re, im}\FloatTok{+0.05}\NormalTok{, }\FunctionTok{expression}\NormalTok{(lambda}\SpecialCharTok{==}\NormalTok{h}\SpecialCharTok{+}\NormalTok{mi), }\AttributeTok{cex=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{intro_stability_analysis_files/figure-pdf/stab_analysis4-1.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Draw Argand diagram}

\CommentTok{\# Save real and imaginary part of complex eigenvalue}
\NormalTok{re }\OperatorTok{=}\NormalTok{ evals[}\DecValTok{0}\NormalTok{].real}
\NormalTok{im }\OperatorTok{=}\NormalTok{ evals[}\DecValTok{0}\NormalTok{].imag}

\CommentTok{\# Create a figure}
\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots()}
\NormalTok{ax.set\_xlim(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{ax.set\_ylim(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{\textquotesingle{}h\textquotesingle{}}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{\textquotesingle{}m\textquotesingle{}}\NormalTok{)}
\NormalTok{ax.set\_title(}\StringTok{\textquotesingle{}Argand diagram of complex eigenvalue\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Plot complex eigenvalue}
\NormalTok{ax.plot(re, im, }\StringTok{\textquotesingle{}o\textquotesingle{}}\NormalTok{, markersize}\OperatorTok{=}\DecValTok{8}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Plot unit circle}
\NormalTok{X }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\NormalTok{Y}\OperatorTok{=}\NormalTok{ np.sqrt(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{X}\OperatorTok{**}\DecValTok{2}\NormalTok{)}
\NormalTok{ax.plot(X, Y, }\StringTok{\textquotesingle{}k{-}{-}\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Plot a ray from the origin to the eigenvalue}
\NormalTok{ax.plot([}\DecValTok{0}\NormalTok{, re], [}\DecValTok{0}\NormalTok{, im], }\StringTok{\textquotesingle{}k{-}\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Add labels}
\NormalTok{ax.text(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.025}\NormalTok{, }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}theta$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{ax.text(}\FloatTok{0.001}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\VerbatimStringTok{r\textquotesingle{}$R=\textbackslash{}sqrt\{h\^{}2+m\^{}2\}$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{ax.text(re, im }\OperatorTok{{-}} \FloatTok{0.1}\NormalTok{, }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}lambda=h+mi$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}

\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The angle \(\theta\) of the line that connects the origin and the
complex eigenvalue and the x-axis of the Argand diagram also contains
information about the dynamics. To see this, note that the geometry of
the complex number represented in the Argand diagram can also be
expressed in trigonometric form: \[
\sin\theta=\frac{m}{R}
\] \[
\cos\theta=\frac{h}{R},
\]

where
\(\theta=\arcsin (\frac{m}{R}) =\arccos (\frac{h}{R})=\arctan(\frac{m}{h})\)

Thus, we can write the complex eigenvalue also as:

\[
\lambda_{1,2}=R(\cos\theta \pm \sin\theta \times i).
\]

By De Moivre's theorem, we have
\((\cos\theta \pm \sin\theta \times i)^t=(\cos\theta t \pm \sin\theta t \times i)\).
Thus, the solution to a dynamic system that exhibits complex eigenvalues
will be of the form:

\[
y_{1t}=v_{11}c_1 R_1^t(\cos\theta_1 t \pm \sin\theta_1 t \times i) +...+ y^*_1.
\]

From this solution we can again deduce key information about the
dynamics of the system based on the (complex) eigenvalues:

\begin{itemize}
\tightlist
\item
  stability will depend on the modulus: for \(R<\) the system will be
  stable, for \(R>1\) it will be unstable
\item
  from the nature of the trigonometric functions \(\sin(\theta t)\) and
  \(\cos(\theta t)\), we know that system will exhibit periodic cyclical
  dynamics as \(t\) increases
\item
  the length of the cycles will be given by \(L=\frac{2\pi}{\theta}\)
  and the frequency by \(F=1/L=\frac{\theta}{2\pi}\)
\item
  the amplitude of the cycles will depend on the elements of the
  eigenvectors, the initial conditions, and \(R\).
\end{itemize}

Let us simulate the Samuelson model with the parameterisation that
yields complex eigenvalues to illustrate these results:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate modulus}
\NormalTok{mod}\OtherTok{=}\FunctionTok{Mod}\NormalTok{(evals[}\DecValTok{1}\NormalTok{])}
\NormalTok{mod}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.8944272
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate cycle length}
\NormalTok{L}\OtherTok{=}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi)}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{acos}\NormalTok{(re}\SpecialCharTok{/}\NormalTok{mod))}
\NormalTok{L}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.520433
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set number of periods for which you want to simulate}
\NormalTok{Q}\OtherTok{=}\DecValTok{100}

\CommentTok{\# Set number of parameterisations that will be considered}
\NormalTok{S}\OtherTok{=}\DecValTok{1}

\CommentTok{\# Construct matrices in which values for different periods will be stored; initialise at 1}
\NormalTok{C}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}
\NormalTok{I}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Construct matrices for exogenous variable}
\NormalTok{G0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)}

\CommentTok{\#Solve this system recursively based on the initialisation}
\ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
\NormalTok{    C[}\DecValTok{1}\NormalTok{,t] }\OtherTok{=}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{(C[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ G0[}\DecValTok{1}\NormalTok{,t])}
\NormalTok{    I[}\DecValTok{1}\NormalTok{,t] }\OtherTok{=}\NormalTok{ beta}\SpecialCharTok{*}\NormalTok{(c1}\SpecialCharTok{*}\NormalTok{(C[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ G0[}\DecValTok{1}\NormalTok{,t]) }\SpecialCharTok{{-}}\NormalTok{ C[}\DecValTok{1}\NormalTok{,t}\DecValTok{{-}1}\NormalTok{])}
\NormalTok{  \} }\CommentTok{\# close t1me loop}

\CommentTok{\# Calculate output}
\NormalTok{Y}\OtherTok{=}\NormalTok{C}\SpecialCharTok{+}\NormalTok{G0}\SpecialCharTok{+}\NormalTok{I}

\CommentTok{\# Time series chart of output dynamics in Samuelson (1939) model}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{30}\NormalTok{],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Output fluctuations in Samuelson model with complex eigenvalues"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{intro_stability_analysis_files/figure-pdf/stab_analysis5-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate modulus}
\NormalTok{mod }\OperatorTok{=} \BuiltInTok{abs}\NormalTok{(evals[}\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(mod)}

\CommentTok{\# Calculate cycle length}
\ImportTok{import}\NormalTok{ math}
\NormalTok{L }\OperatorTok{=}\NormalTok{ (}\DecValTok{2} \OperatorTok{*}\NormalTok{ math.pi) }\OperatorTok{/}\NormalTok{ math.acos(re }\OperatorTok{/}\NormalTok{ mod)}
\BuiltInTok{print}\NormalTok{(L)}

\CommentTok{\# Set the number of periods and parameterizations}
\NormalTok{Q }\OperatorTok{=} \DecValTok{100}
\NormalTok{S }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Initialize matrices for consumption, investment, and exogenous government spending}
\NormalTok{C }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{I }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{G0 }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{5}\NormalTok{)}

\CommentTok{\# Solve the system recursively based on the initialization}
\ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
\NormalTok{    C[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ (C[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ G0[}\DecValTok{0}\NormalTok{, t])}
\NormalTok{    I[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (c1 }\OperatorTok{*}\NormalTok{ (C[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ G0[}\DecValTok{0}\NormalTok{, t]) }\OperatorTok{{-}}\NormalTok{ C[}\DecValTok{0}\NormalTok{, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}

\CommentTok{\# Calculate output}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ C }\OperatorTok{+}\NormalTok{ G0 }\OperatorTok{+}\NormalTok{ I}

\CommentTok{\# Plot the time series chart of output dynamics}
\NormalTok{plt.plot(Y[}\DecValTok{0}\NormalTok{, :}\DecValTok{30}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Output fluctuations in Samuelson model with complex eigenvalues"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

You can see that the model generates cycles with a length (from
peak/trough to peak/trough) of around 7.5 periods. Since the modulus is
\(R<1\), the system is stable and eventually converges to the
equilibrium.

A general condition for stability of 2D systems with complex eigenvalues
can be derived by making use of the fact that
\(R=\sqrt{h^2+m^2}= \sqrt{ \left( \frac{b}{2} \right) ^2 + \left(\frac{\sqrt{4c-b^2}}{2}i \right)^2} = \sqrt{c}\),
where \(b=tr(J)\) and \(c=det(J)\). Applied to the modulus of the
Samuelson model, this yields \(R=\sqrt{det(J)}=\sqrt{\beta c_1}\). Thus,
the stability condition is:

\[\beta c_1<1.\]

The following code generates a plot that displays the condition for
cycles and the stability condition in the \((\beta, c_1)\)-space:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create function for cycle condition: c1 \textless{} (4*beta)/(1+beta)\^{}2}
\NormalTok{cyc}\OtherTok{=} \ControlFlowTok{function}\NormalTok{ (beta) \{}
\NormalTok{  (}\DecValTok{4}\SpecialCharTok{*}\NormalTok{beta)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{beta)}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{\}}

\CommentTok{\# Create function for stability condition: c1 \textless{} 1/beta}
\NormalTok{stab}\OtherTok{=} \ControlFlowTok{function}\NormalTok{ (beta) \{}
  \DecValTok{1}\SpecialCharTok{/}\NormalTok{beta}
\NormalTok{\}}

\CommentTok{\# Plot the two functions in (beta, c1){-}space}
\FunctionTok{curve}\NormalTok{(cyc, }\AttributeTok{from =} \DecValTok{0}\NormalTok{, }\AttributeTok{to =} \DecValTok{5}\NormalTok{, }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\FunctionTok{expression}\NormalTok{(beta), }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(c[}\DecValTok{1}\NormalTok{]) , }\AttributeTok{main=}\StringTok{""}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{, }\AttributeTok{n=}\DecValTok{10000}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{1.5}\NormalTok{))}
\FunctionTok{curve}\NormalTok{(stab, }\AttributeTok{from =} \DecValTok{0}\NormalTok{, }\AttributeTok{to =} \DecValTok{5}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{, }\AttributeTok{n=}\DecValTok{10000}\NormalTok{, }\AttributeTok{add =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"cycle condition"}\NormalTok{, }\StringTok{"stability condition"}\NormalTok{), }
       \AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{intro_stability_analysis_files/figure-pdf/stab_analysis6-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Create function for cycle condition using beta as argument}
\KeywordTok{def}\NormalTok{ cyc(beta):}
    \ControlFlowTok{return}\NormalTok{ (}\DecValTok{4} \OperatorTok{*}\NormalTok{ beta) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ beta)}\OperatorTok{**}\DecValTok{2}

\CommentTok{\# Create function for stability condition using beta as argument}
\KeywordTok{def}\NormalTok{ stab(beta):}
    \ControlFlowTok{return} \DecValTok{1} \OperatorTok{/}\NormalTok{ beta}

\CommentTok{\# Define the range of beta values}
\NormalTok{beta }\OperatorTok{=}\NormalTok{ np.linspace(}\FloatTok{0.001}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10000}\NormalTok{)  }\CommentTok{\# start from 0.001 to avoid division by zero}

\CommentTok{\# Plot the two functions in (beta, c1){-}space}
\NormalTok{plt.plot(beta, cyc(beta), label}\OperatorTok{=}\StringTok{"cycle condition"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{)}
\NormalTok{plt.plot(beta, stab(beta), label}\OperatorTok{=}\StringTok{"stability condition"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{)}

\CommentTok{\# Set labels and title}
\NormalTok{plt.xlabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}beta$\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\VerbatimStringTok{r\textquotesingle{}$c\_1$\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylim(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"upper right"}\NormalTok{)}

\CommentTok{\# Display the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Combinations of \(c_1\) and \(\beta\) below the cycle condition curve
yield complex eigenvalues and thus cycles, while combinations below the
stability condition curve yield an asymptotically stable equilibrium.

\section{Nonlinear systems}\label{nonlinear-systems}

So far, we have analysed dynamic systems that are linear. However, in
the more general case, a dynamic system may be nonlinear and of the
form:

\[
y_t=f(y_{t-1}).
\]

An \(n\)-dimensional nonlinear system may have multiple equilibria
\(y^*\). To analyse the dynamic properties of such a system, we normally
conduct a linear approximation in the neighbourhood of one of the
equilibria. In that sense, the stability analysis of a nonlinear system
has only local as opposed to global validity.

Mathematically, linearisation around an equilibrium point can be done by
conducting a first-order Taylor expansion around that equilibrium:

\[
y_t=f^i(y^*) + \sum_{j=1}^{n}\frac{\partial f^i(y^*)}{\partial y_{jt-1}}(y_{jt-1}-y_j^*),
\]

where \(i=1,2,...,n\).

This yields a linear version of the system that can be written as:

\[
y_{t}=Ay_{t-1}+B,
\]

where \(A_{11}=\frac{\partial f^1(y^*)}{y_{1t-1}}\) and so forth. Thus,
\(A\) is simply the Jacobian matrix of \(f(y_{t-1})\) evaluated at
\(y^*\).

In practice, this means that to analyse the local stability of a
nonlinear system, one needs to:

\begin{itemize}
\tightlist
\item
  find the equilibrium solution \(y^*\) whose neighbourhood you want to
  analyse
\item
  compute the Jacobian matrix of \(f(y_{t-1})\)
\item
  substitute \(y^*\) into \(f(y_{t-1})\) and analyse the resulting
  matrix.
\end{itemize}

An example for the stability analysis of a simple nonlinear system can
be found in Chapter~\ref{sec-malthus}.

\section{Key takeaways}\label{key-takeaways}

\begin{itemize}
\tightlist
\item
  dynamic models are systems of difference (or differential) equations
\item
  the stability of a system depends on (a combination of) its
  coefficients
\item
  more generally, the system's dynamic properties (including stability)
  are encapsulated in the Jacobian matrix
\item
  the (dominant) eigenvalues of the Jacobian matrix indicate whether a
  system is

  \begin{itemize}
  \tightlist
  \item
    stable (\(\lambda < 1\)) or unstable (\(\lambda > 1\))
  \item
    acyclical (\(\lambda \in \mathbb{R}\)) or cyclical
    (\(\lambda \in \mathbb{C}\))
  \end{itemize}
\item
  the (dominant) eigenvectors mediate the impact of the eigenvalues in
  the dynamics
\item
  nonlinear systems are analysed locally around one of its equilibria
\end{itemize}

\section{References}\label{references-7}

\chapter{A New Keynesian 3-Equation
Model}\label{a-new-keynesian-3-equation-model}

\section{Overview}\label{overview-6}

New Keynesian dynamic general equilibrium models were developed in the
1990s and 2000s to guide monetary policy.\footnote{See Galí (2018) for
  an overview.} They build on real business cycle models with rational
expectations but introduce Keynesian frictions such as imperfect
competition and nominal rigidities. While the structural forms of these
models are typically complex as behavioural functions are derived from
the intertemporal optimisation, the reduced-form of the benchmark models
can be represented by three main equations: (i) an IS curve, (ii) a
Phillips curve, (iii) and an interest rate rule.

The IS curve establishes a negative relationship between real income and
the real interest rate. For a higher real interest rate, households will
save more and thus consume less. The Phillips curve models inflation as
a function of the output gap. A positive output gap (an economic
expansion) leads to higher inflation. The monetary policy rule specifies
how the central bank reacts to deviations of actual inflation from a
politically determined inflation target.

The simplified version of the 3-equation model we consider here is
directly taken from chapter 4 of Carlin and Soskice (2014). This is a
short-run model in which prices are flexible but the capital stock is
fixed. The focus is thus on goods market equilibrium rather than
economic growth. In the Carlin-Soskice version, inflation expectations
are assumed to be adaptive and the response of aggregate demand to a
change in the interest rate is sluggish. This renders the model
dynamic.\footnote{Note that this is quite different from conventional
  New Keynesian dynamic general equilibrium models in which the dynamic
  element stems from agents with rational expectations that react to
  serially correlated shocks.}

\section{The Model}\label{the-model-6}

\begin{equation}\phantomsection\label{eq-nk_y}{
y_t=A -a_1r_{t-1}
}\end{equation}

\begin{equation}\phantomsection\label{eq-nk_pi}{
\pi_t=\pi_{t-1}+a_2(y_t -y_e)
}\end{equation}

\begin{equation}\phantomsection\label{eq-nk_rs}{
r_s=\frac{(A - y_e)}{a_1}
}\end{equation}

\begin{equation}\phantomsection\label{eq-nk_r}{
r_t = r_s + a_3(\pi_t-\pi^T)
}\end{equation}

where \(y\), \(A\), \(r\), \(\pi\), \(y_e\), \(r_s\), and \(\pi^T\) are
real output, autonomous demand (times the multiplier), the real interest
rate, inflation, equilibrium output, the stabilising real interest rate,
and the inflation target, respectively.

Equation~\ref{eq-nk_y} is the IS curve or goods market equilibrium
condition. Aggregate output adjusts to the level of aggregate demand,
which is given by autonomous demand (times the multiplier) and a
component that is negatively related to the (lagged) real interest rate
via households' saving (\(a_1>0\)). Equation~\ref{eq-nk_pi} is the
Phillips curve. It is assumed that inflation is driven by adaptive
expectations (\(E[\pi_{t+1}]=\pi_{t-1}\)) and positively related to the
output gap \((y_t-y_e)\), i.e.~\(a_2>0\). By Equation~\ref{eq-nk_rs},
the stabilising real interest rate is that real interest rate that is
consistent with equilibrium output (\(y_e=A -a_1r_s\)). Finally, the
interest rate rule in Equation~\ref{eq-nk_r} specifies the real interest
rate the central bank needs to set to minimise its loss function (see
Section~\ref{sec-analytical} below for a derivation). The parameter
\(a_3\) is a composite one given by
\(a_3 = \frac{1}{a_1(\frac{1}{a_2 b} + a_2)} >0\). Although the central
bank only sets the nominal interest rate \(i = r + E[\pi_{t+1}]\)
directly, the fact that expected inflation is predetermined in every
period allows it to indirectly control the real interest rate.

\section{Simulation}\label{simulation-6}

\subsection{Parameterisation}\label{parameterisation-6}

Table 1 reports the parameterisation used in the simulation. For all
parameterisations, the system is initialised at the equilibrium
\((y^*,\pi^*,r^*)=(y_e,\pi^T, r_s)\). Three scenarios will then be
considered. In scenario 1, there is an increase in autonomous aggregate
demand (\(A\)). In scenario 2, the central bank sets a higher inflation
target (\(\pi^T\)). Scenario 3 considers a rise in equilibrium output
(\(y_e\)).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1429}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a_2\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(A\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\pi^T\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(y_e\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: rise in aggregate demand (\(A\)) & 0.3 & 0.7 & 1 & 12 & 2 & 5 \\
2: higher inflation target (\(\pi^T\)) & 0.3 & 0.7 & 1 & 10 & 2.5 & 5 \\
3: rise in equilibrium output (\(y_e\)) & 0.3 & 0.7 & 1 & 10 & 2 & 7 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-6}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{50}

\CommentTok{\# Set number of scenarios}
\NormalTok{S}\OtherTok{=}\DecValTok{3}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{5}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Income/output}
\NormalTok{p}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Inflation rate}
\NormalTok{r}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Real interest rate}
\NormalTok{rs}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Stabilising interest rate}

\CommentTok{\# Set constant parameter values}
\NormalTok{a1}\OtherTok{=}\FloatTok{0.3}  \CommentTok{\# Sensitivity of inflation with respect to output gap }
\NormalTok{a2}\OtherTok{=}\FloatTok{0.7}  \CommentTok{\# Sensitivity of output with respect to interest rate}
\NormalTok{b}\OtherTok{=}\DecValTok{1}     \CommentTok{\# Sensitivity of central bank to inflation gap}
\NormalTok{a3}\OtherTok{=}\NormalTok{(a1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(b}\SpecialCharTok{*}\NormalTok{a2) }\SpecialCharTok{+}\NormalTok{ a2))}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{10}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# autonomous spending}
\NormalTok{pt}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{2}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Inflation target}
\NormalTok{ye}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Potential output}

\NormalTok{A[}\DecValTok{1}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{12}  \CommentTok{\# scenario 1: AD boost  }
\NormalTok{pt[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{3}  \CommentTok{\# scenario 2: higher inflation target}
\NormalTok{ye[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{7}  \CommentTok{\# scenario 3: higher potential output}

\CommentTok{\# Initialise endogenous variables at equilibrium values}
\NormalTok{y[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{ye[,}\DecValTok{1}\NormalTok{]}
\NormalTok{p[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{pt[,}\DecValTok{1}\NormalTok{]}
\NormalTok{rs[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{(A[,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ ye[,}\DecValTok{1}\NormalTok{])}\SpecialCharTok{/}\NormalTok{a1 }
\NormalTok{r[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{rs[,}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \CommentTok{\#(1) IS curve}
\NormalTok{    y[i,t] }\OtherTok{=}\NormalTok{ A[i,t] }\SpecialCharTok{{-}}\NormalTok{ a1}\SpecialCharTok{*}\NormalTok{r[i,t}\DecValTok{{-}1}\NormalTok{]}
    
    \CommentTok{\#(2) Phillips Curve}
\NormalTok{    p[i,t] }\OtherTok{=}\NormalTok{ p[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{a2}\SpecialCharTok{*}\NormalTok{(y[i,t]}\SpecialCharTok{{-}}\NormalTok{ye[i,t])}
    
    \CommentTok{\#(3) Stabilising interest rate}
\NormalTok{    rs[i,t] }\OtherTok{=}\NormalTok{ (A[i,t] }\SpecialCharTok{{-}}\NormalTok{ ye[i,t])}\SpecialCharTok{/}\NormalTok{a1}
    
    \CommentTok{\#(4) Monetary policy rule, solved for r}
\NormalTok{    r[i,t] }\OtherTok{=}\NormalTok{ rs[i,t] }\SpecialCharTok{+}\NormalTok{ a3}\SpecialCharTok{*}\NormalTok{(p[i,t]}\SpecialCharTok{{-}}\NormalTok{pt[i,t])}
  
\NormalTok{  \} }\CommentTok{\# close time loop}
\NormalTok{\}   }\CommentTok{\# close scenarios loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{50}

\CommentTok{\# Set number of scenarios}
\NormalTok{S }\OperatorTok{=} \DecValTok{3}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{5}

\CommentTok{\# Create (S x Q) arrays to store simulated data}
\NormalTok{y }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# Income/output}
\NormalTok{p }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# Inflation rate}
\NormalTok{r }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# Real interest rate}
\NormalTok{rs }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# Stabilizing interest rate}

\CommentTok{\# Set constant parameter values}
\NormalTok{a1 }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# Sensitivity of inflation with respect to output gap}
\NormalTok{a2 }\OperatorTok{=} \FloatTok{0.7}  \CommentTok{\# Sensitivity of output with respect to interest rate}
\NormalTok{b }\OperatorTok{=} \DecValTok{1}     \CommentTok{\# Sensitivity of the central bank to inflation gap}
\NormalTok{a3 }\OperatorTok{=}\NormalTok{ (a1 }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (b }\OperatorTok{*}\NormalTok{ a2) }\OperatorTok{+}\NormalTok{ a2)) }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{10}\NormalTok{)  }\CommentTok{\# Autonomous spending}
\NormalTok{pt }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{2}\NormalTok{)  }\CommentTok{\# Inflation target}
\NormalTok{ye }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{5}\NormalTok{)  }\CommentTok{\# Potential output}

\NormalTok{A[}\DecValTok{0}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{12}  \CommentTok{\# Scenario 1: AD boost}
\NormalTok{pt[}\DecValTok{1}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{3}  \CommentTok{\# Scenario 2: Higher inflation target}
\NormalTok{ye[}\DecValTok{2}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{7}  \CommentTok{\# Scenario 3: Higher potential output}

\CommentTok{\# Initialize endogenous variables at equilibrium values}
\NormalTok{y[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ ye[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{p[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ pt[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{rs[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ (A[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ ye[:, }\DecValTok{0}\NormalTok{]) }\OperatorTok{/}\NormalTok{ a1}
\NormalTok{r[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ rs[:, }\DecValTok{0}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \CommentTok{\# (1) IS curve}
\NormalTok{        y[i, t] }\OperatorTok{=}\NormalTok{ A[i, t] }\OperatorTok{{-}}\NormalTok{ a1 }\OperatorTok{*}\NormalTok{ r[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}
        \CommentTok{\# (2) Phillips Curve}
\NormalTok{        p[i, t] }\OperatorTok{=}\NormalTok{ p[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ a2 }\OperatorTok{*}\NormalTok{ (y[i, t] }\OperatorTok{{-}}\NormalTok{ ye[i, t])}
        \CommentTok{\# (3) Stabilizing interest rate}
\NormalTok{        rs[i, t] }\OperatorTok{=}\NormalTok{ (A[i, t] }\OperatorTok{{-}}\NormalTok{ ye[i, t]) }\OperatorTok{/}\NormalTok{ a1}
        \CommentTok{\# (4) Monetary policy rule, solved for r}
\NormalTok{        r[i, t] }\OperatorTok{=}\NormalTok{ rs[i, t] }\OperatorTok{+}\NormalTok{ a3 }\OperatorTok{*}\NormalTok{ (p[i, t] }\OperatorTok{{-}}\NormalTok{ pt[i, t])}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-6}

Figures 1-3 depict the response of the model's key endogenous variables
to various shifts. A permanent rise in aggregate demand (scenario 1) has
an instantaneous expansionary effect on output, but also pushes
inflation above the target. This induces the central bank to raise the
interest rate, which brings down output below equilibrium in the next
period. The central bank then gradually lowers the policy rate towards
its new higher equilibrium value, where inflation is again stabilised at
its target level.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Plot results}

\DocumentationTok{\#\#\# Plots}
\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{15}

\CommentTok{\# Output under different scenarios}
\FunctionTok{plot}\NormalTok{(y[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab=}\StringTok{"y"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(y[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{Tmax],y[}\DecValTok{3}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 1: Output under different scenarios"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Time"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(y[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(y[}\DecValTok{3}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: aggregate demand boost"}\NormalTok{, }\StringTok{"2: rise inflation target"}\NormalTok{, }\StringTok{"3: rise potential output"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_new_keynesian_3_equation_model_files/figure-pdf/nk2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Inflation under different scenarios}
\FunctionTok{plot}\NormalTok{(p[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(pi), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(p[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax],p[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 2: Inflation under different scenarios"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Time"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(p[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(p[}\DecValTok{3}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: aggregate demand boost"}\NormalTok{, }\StringTok{"2: rise inflation target"}\NormalTok{, }\StringTok{"3: rise potential output"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_new_keynesian_3_equation_model_files/figure-pdf/nk2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Policy rate under different scenarios}
\FunctionTok{plot}\NormalTok{(r[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab=}\StringTok{"r"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(r[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax],r[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 3: Policy rate under different scenarios"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Time"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(r[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(r[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: aggregate demand boost"}\NormalTok{, }\StringTok{"2: rise inflation target"}\NormalTok{, }\StringTok{"3: rise potential output"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_new_keynesian_3_equation_model_files/figure-pdf/nk2-3.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{15}

\CommentTok{\# Plot output under different scenarios}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{))}
\NormalTok{plt.plot(y[}\DecValTok{0}\NormalTok{, :Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{], label}\OperatorTok{=}\StringTok{"Scenario 1: aggregate demand boost"}\NormalTok{,}
\NormalTok{         color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}solid\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}
\NormalTok{plt.plot(y[}\DecValTok{1}\NormalTok{, :Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{], label}\OperatorTok{=}\StringTok{"Scenario 2: Rise inflation target"}\NormalTok{,}
\NormalTok{         color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dashed\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}
\NormalTok{plt.plot(y[}\DecValTok{2}\NormalTok{, :Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{], label}\OperatorTok{=}\StringTok{"Scenario 3: Rise potential output"}\NormalTok{,}
\NormalTok{         color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dotted\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}

\NormalTok{plt.title(}\StringTok{"Output under Different Scenarios"}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"y"}\NormalTok{)}
\NormalTok{plt.xlim(}\DecValTok{1}\NormalTok{, Tmax)}
\NormalTok{plt.ylim(np.}\BuiltInTok{min}\NormalTok{(y), np.}\BuiltInTok{max}\NormalTok{(y))}
\NormalTok{plt.legend()}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

An increase in the central bank's inflation target (scenario 2)
gradually raises the inflation rate to a new level. During the
adjustment period, the interest rate falls, which temporarily allows for
a higher level of output. However, there is no permanent expansionary
effect.

By contrast, an increase in potential or equilibrium output (scenario 3)
allows for a permanently higher level of output and a lower real
interest rate.

\section{Directed graph}\label{directed-graph-6}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct auxiliary Jacobian matrix for 7 variables: y, p, r, A, ye, rs, pt}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{),}\DecValTok{7}\NormalTok{,}\DecValTok{7}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=}\ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(pi), }\StringTok{"r"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(y[e]),}\FunctionTok{expression}\NormalTok{(r[s]), }\FunctionTok{expression}\NormalTok{(pi}\SpecialCharTok{\^{}}\NormalTok{T))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Figure 4: Directed graph of 3{-}Equation model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_new_keynesian_3_equation_model_files/figure-pdf/nk3-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Directed graph}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}


\CommentTok{\# Define the Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                 ])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}
    \DecValTok{0}\NormalTok{: }\StringTok{"y"}\NormalTok{,}
    \DecValTok{1}\NormalTok{: }\StringTok{"π"}\NormalTok{,}
    \DecValTok{2}\NormalTok{: }\StringTok{"r"}\NormalTok{,}
    \DecValTok{3}\NormalTok{: }\StringTok{"A"}\NormalTok{,}
    \DecValTok{4}\NormalTok{: }\StringTok{"yₑ"}\NormalTok{,}
    \DecValTok{5}\NormalTok{: }\StringTok{"rₛ"}\NormalTok{,}
    \DecValTok{6}\NormalTok{: }\StringTok{"πᵀ"}
\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure 4, it can be seen that aggregate demand (\(A\)), equilibrium
output (\(y_e\)), and the inflation target (\(\pi^T\)) are the key
exogenous variables of the model. All other variables are endogenous and
form a closed loop (or cycle) within the system. The upper-right side of
the graph represents the supply side, given by the equilibrium level of
output and its effect on inflation. The upper-left side captures the
demand side and its effect on actual output. The key endogenous
variables, output, inflation, and the interest rate form the centre of
the graph, where they stand in a triangular relationship to each other.
Output drives inflation, which in turn impacts the real interest rate.
The latter then feeds back into output. Structural changes in the
relationship between demand and supply (e.g.~excess demand) also impact
the system through their effect on the stabilising interest rate
(\(r_s\)).

\section{Analytical discussion}\label{sec-analytical}

\subsection{Derivation of core
equations}\label{derivation-of-core-equations}

\subsubsection{IS curve}\label{is-curve}

The IS curve in Equation~\ref{eq-nk_y} is loosely based on the
consumption Euler equation introduced in
Chapter~\ref{sec-neoclassical-model}. Suppose there are two periods and
the household maximises its utility function
\(U=\ln(C_t) + \beta \ln(C_{t+1})\) subject to the intertemporal budget
constraint \(C_t+\frac{C_{t+1}}{1+r}=Y_t + \frac{Y_{t+1}}{1+r}\).
Substituting the constraint into the objective function and
differentiating with respect to \(C_t\) yields the first-order
condition:

\[
C_t = \frac{C_{t+1}}{\beta(1+r)}.
\]

This consumption Euler equation establishes the negative relationship
between the real interest rate and expenditures in
Equation~\ref{eq-nk_y}.

\subsubsection{PC curve}\label{pc-curve}

The Phillips curve Equation~\ref{eq-nk_pi} is derived from wage- and
price-setting in imperfect labour markets.\footnote{See chapter 2 of
  Carlin and Soskice (2014) for details.} Consider the following wage-
and price-setting functions: \[
\frac{W}{P^E} = B + \alpha(y_t - y_e) + z_w 
\] \begin{equation}\phantomsection\label{eq-nk_P}{
P=(1+\mu)\frac{W}{\lambda},
}\end{equation}

i.e.~the nominal wage \(W\), adjusted for the expected price level, is
increasing in the output gap, a factor \(B\) capturing unemployment
benefits and the disutility of work as well as a vector \(z_w\) of
wage-push factors. Prices are set based on a constant mark-up (\(\mu\))
on unit labour cost (\(\frac{W}{\lambda}\)).

In equilibrium, the real wage is given by: \(w_e = B + z_w\). In a
dynamic setting, wage setters will raise the expected real wage by
\(\left(\frac{W_t}{P_{t}^E}\right) - \left(\frac{W_{t-1}}{P_{t-1}}\right)=\alpha(y_t - y_e)\).
Together with adaptive expectations for prices
\(\hat{P_t^E} = \hat{P}_{t-1}\) and the approximation
\(\hat{W_t} - \hat{P_{t-1}} \approx \left(\frac{W_t}{P_{t}^E}\right) - \left(\frac{W_{t-1}}{P_{t-1}}\right)\),
this yields the following equation for wage inflation:
\begin{equation}\phantomsection\label{eq-nk_W}{
\hat{W_t} = \hat{P}_{t-1} +\alpha(y_t - y_e).
}\end{equation}

Transforming equation Equation~\ref{eq-nk_P} into growth rates
(\(\hat{P}=\hat{W}\)) and combining it with the wage-inflation equation
Equation~\ref{eq-nk_W} yields the Phillips curve
Equation~\ref{eq-nk_pi}.

\subsubsection{Monetary policy rule}\label{monetary-policy-rule}

Finally, to derive the interest rate rule, start from the following
central bank loss function:\footnote{See chapter 2 of Carlin and Soskice
  (2014) for details.}

\[
L=(y_t-y_e)^2 + b(\pi_t - \pi^T)^2. 
\] Substituting the Phillips curve (Equation~\ref{eq-nk_pi}) into the
loss function, differentiating with respect to \(y_t\), and simplifying
yields the first-order condition:

\[
y_t-y_e = -a_2b(\pi-\pi^T),
\]

which can also be regarded as a monetary policy rule. Next, substitute
the Phillips curve (Equation~\ref{eq-nk_pi}), the IS-curve
(Equation~\ref{eq-nk_y}), and the stabilising interest rate
(Equation~\ref{eq-nk_rs}) into the monetary policy rule and define
\(a_3 = \frac{1}{a_1(\frac{1}{a_2b} + a_2)}\), which yields the interest
rate rule (Equation~\ref{eq-nk_r}).

\subsection{Equilibrium solutions and stability
analysis}\label{equilibrium-solutions-and-stability-analysis}

By definition, in the steady state we have \(y^*=y_e\). This implies
that \(r^*=r_s\). From this, it follows that \(\pi^* = \pi^T\).

To analyse the dynamic stability of the model, we rewrite it as a system
of first-order difference equations. To this end, substitute
Equation~\ref{eq-nk_y} into Equation~\ref{eq-nk_pi}, which yields:
\begin{equation}\phantomsection\label{eq-nk_pi_reduc}{
\pi_t = \pi_{t-1} + a_2(A - a_1r_{t-1}-y_e)
}\end{equation}

Substitute this equation into Equation~\ref{eq-nk_r}, which yields:
\begin{equation}\phantomsection\label{eq-nk_r_reduc}{
r_t= r_{s} + a_3[\pi_{t-1} + a_2(A - a_1r_{t-1}-y_e) - \pi^T].
}\end{equation}

The Jacobian matrix of the system in Equation~\ref{eq-nk_y},
Equation~\ref{eq-nk_pi_reduc}, and Equation~\ref{eq-nk_r_reduc} is given
by: \[
J=\begin{bmatrix} 0& 0 &-a_1 \\0 & 1 & -a_1 a_2 \\ 0 & a_3 & -a_1 a_2 a_3 \end{bmatrix}.
\] The eigenvalues of the Jacobian can be obtained from the
characteristic polynomial
\(\lambda^3 - Tr(J)\lambda^2 + [Det(J_1) + Det(J_2) + Det(J_3)]\lambda - Det(J) = 0\),
where \(Tr(J)\) and \(Det(J\)) are the trace and determinant,
respectively, and \(Det(J_i)\) refers to the \(i_{th}\) principal minor
of the matrix. As there is a column in the Jacobian that only contains
zeros, it follows that the matrix is singular and will have a zero
determinant. In addition, all principal minors turn out to be zero. The
characteristic polynomial thus reduces to
\(\lambda^2[\lambda - Tr(J)]=0\). From this, it is immediate that
\(\lambda_{1,2}=0\) and \(\lambda_{3}=Tr(J)\), where
\(Tr(J)=1-a_1a_2a_3=\frac{1}{1+a_2^2b}\). Stability requires the single
real eigenvalue to be smaller than unity (in absolute terms). With
\(\lambda_3=\frac{1}{1+a_2^2b}\), stability thus only requires
\(a_2 \neq 0\) and \(b>0\), i.e.~the output gap needs to impact
inflation (otherwise the key channel through which interest rate policy
brings inflation back on target is blocked) and the central bank needs
to assign a (non-negative) loss to deviations of actual inflation from
its target.\footnote{As mentioned in footnote 2, this property of the
  Carlin-Soskice model is very different from conventional New Keynesian
  models with rational expectations. In these models, variables such as
  output and inflation are driven by the `forward-looking' behaviour of
  rational agents, i.e.~they depend on expectational terms for their
  current values rather than lagged values. To ensure what is called
  `determinancy', these forward-looking variables must adjust fast (or
  `jump') to bring the economy back onto a path that is consistent with
  the optimising equilibrium. This requires the number of jump variables
  to be matched by an equal number of unstable roots (i.e.~being outside
  the unit circle).}

We can verify these analytical solutions by comparing them with the
results from the numerical solution:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct Jacobian matrix }
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\SpecialCharTok{{-}}\NormalTok{a1,}
           \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\SpecialCharTok{{-}}\NormalTok{a1}\SpecialCharTok{*}\NormalTok{a2,}
           \DecValTok{0}\NormalTok{,a3,}\SpecialCharTok{{-}}\NormalTok{a1}\SpecialCharTok{*}\NormalTok{a2}\SpecialCharTok{*}\NormalTok{a3), }\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(values }\OtherTok{\textless{}{-}}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.6711409 0.0000000 0.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\FunctionTok{det}\NormalTok{(J)       }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J)) }\CommentTok{\# trace}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.6711409
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Construct Jacobian matrix }
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\OperatorTok{{-}}\NormalTok{a1],}
\NormalTok{          [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\OperatorTok{{-}}\NormalTok{a1 }\OperatorTok{*}\NormalTok{ a2],}
\NormalTok{          [}\DecValTok{0}\NormalTok{, a3, }\OperatorTok{{-}}\NormalTok{a1 }\OperatorTok{*}\NormalTok{ a2 }\OperatorTok{*}\NormalTok{ a3],])}

\CommentTok{\# Calculate eigenvalues}
\NormalTok{eigenvalues }\OperatorTok{=}\NormalTok{ np.linalg.eigvals(J)}

\CommentTok{\# Print the resulting eigenvalues}
\BuiltInTok{print}\NormalTok{(eigenvalues)}

\CommentTok{\# Calculate the determinant and trace of the Jacobian matrix}
\NormalTok{determinant }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\NormalTok{trace }\OperatorTok{=}\NormalTok{ np.trace(J)}
\BuiltInTok{print}\NormalTok{(determinant)}
\BuiltInTok{print}\NormalTok{(trace)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-8}

\chapter{A Conflict Inflation Model}\label{a-conflict-inflation-model}

\section{Overview}\label{overview-7}

This model is a version of the conflicting-claims approach to inflation
that has been developed in the Marxian and post-Keynesian tradition
(Rowthorn (1977)).\footnote{With textbook treatments in Blecker and
  Setterfield (2019), chap.~5, Hein (2023), chap.~5, and Lavoie (2022),
  chap.~8.} The conflict inflation approach argues that inflation is
driven by distributional conflict between price-setting firms and
wage-setting workers. Each social class aspires a share of real income
that is inconsistent with the claims of the other class. Workers
gradually adjust nominal wages to reach a real wage target. Firms, by
contrast, gradually adjust prices to achieve an implicit real wage
target. The (implicit) real wage target of firms may stem from an
(explicit) profitability target. Profitability, in turn, depends on the
unit cost of firms. With nominal wages being a key component of those
unit cost, any attempt by workers to raise real wages through higher
nominal wages will eat into firms' profitability, which will respond by
raising prices. Equally, any attempt by firms to raise profitability by
setting higher prices will undermine real wages and evoke a response by
workers. This interplay between mutually inconsistent claims drives the
inflationary process and the equilibrium real wage. Distributional
outcomes in this model depend on the distributional targets of workers
and firms as well as their ability to adjust wages and prices, which in
turn may be affected by their relative bargaining power and labour
market institutions.

We present a simplified version of the
\href{https://blogs.lse.ac.uk/businessreview/2023/11/29/how-to-reduce-inflation-without-increasing-unemployment-and-income-inequality/}{three-sector
conflict inflation model} in Wildauer et al. (2023) that examines the
inflationary and distributional effects of energy price
shocks.\footnote{Wildauer et al. (2023) use this model to study the
  2021-23 inflationary episode in the US. Besides an energy sector
  providing intermediate inputs, they consider a final goods and a final
  services sector. In addition to the energy price shock, there is a
  positive demand shift towards goods and a negative supply shock due to
  lockdowns, creating a rise in the rate of capacity utilisation of the
  final goods sector. These additional shocks allow the final goods
  sector to raise its markup. The present simplified version of the
  model only considers the energy sector and a final output sector, and
  treats the markup of the final output sector as constant.} A final
output sector uses energy as an intermediate input. Exogenous shocks to
the prices of energy inputs can trigger temporary `price-wage spirals',
where firms raise prices to defend their profit margins, which in turn
induces workers to raise nominal wages, which prolongs the inflationary
shocks. While real wages fall, the economy-wide profit share rises.

\section{The Model}\label{the-model-7}

The model is given by the following equations:

\begin{equation}\phantomsection\label{eq-conflict_omega}{
\Omega_t = \frac{w_t}{p_t} 
}\end{equation} \begin{equation}\phantomsection\label{eq-conflict_w}{
w_{t}  = w_{t-1}\left[ 1 + \phi(\Omega^W - \Omega_{t-1}) \right]
}\end{equation}

\begin{equation}\phantomsection\label{eq-conflict_p}{
p_t= p_{t-1} \left[ 1 + \psi (r^T - r_{t-1}) \right] 
}\end{equation}

\begin{equation}\phantomsection\label{eq-conflict_pf}{
p^T_t=(1+\theta^T)\left(w_t + \delta p^E\right)  
}\end{equation}

\begin{equation}\phantomsection\label{eq-conflict_rf}{
r^T=\frac{\theta^T}{1+\theta^T}
}\end{equation}

\begin{equation}\phantomsection\label{eq-conflict_r}{
r_T=1-\Omega_t - \delta \epsilon
}\end{equation} \begin{equation}\phantomsection\label{eq-conflict_p_E}{
p^E_t = \epsilon p_t 
}\end{equation}

where \(\Omega\), \(w\), \(p\), \(\Omega^W\), \(r^T\), \(r\), \(p^T\),
and \(p^E\) are the real wage, the nominal wage, the price level,
workers' desired real wage, firms' desired profit margin, the realised
profit margin, firms' desired price level, and the nominal energy price,
respectively.

Equation~\ref{eq-conflict_omega} defines the real wage \(\Omega\).
Equation~\ref{eq-conflict_w} specifies the dynamics of wage setting.
Workers set the growth rate of nominal wages \(w\) proportionally to the
gap between their target real wage \(\Omega^W\) and the actual real wage
\(\Omega\). The target real wage of workers is taken to be exogenous in
this version of the model.\footnote{Blecker and Setterfield (2019),
  chap.~5 and Lavoie (2022), chap.~8 analyse extensions which endogenise
  the real wage target of workers.} By Equation~\ref{eq-conflict_p},
firms set the price inflation rate in a symmetric manner, responding to
the deviation of the desired profit margin \(r^T\) from the actual
profit margin \(r\). Equation~\ref{eq-conflict_pf} specifies the desired
price level of firms, which charge a desired markup \(\theta^T\) on
their unit variable cost. Unit costs in this model consist of two
components: (i) unit labour cost given by \(w_t\) (where we normalise
labour productivity to unity for simplicity such that
\(\frac{Y}{L}=1\)), and (ii) unit energy cost \(\delta p^E\), where
\(\delta =\frac{E}{Y}\) is the (exogenous) energy intensity and \(p^E\)
is the nominal energy price. The profit margin is defined as profits
over gross output: \(r=\frac{\Pi}{pY}=\frac{pY-wL-p^E E}{pY}\). The
\emph{target} profit margin as implied by the desired price level is
then \(r^T = \frac{p^T - (w_t + \delta p^E) }{p^T}\), yielding
Equation~\ref{eq-conflict_rf}. The desired markup \(\theta^T\) is
considered exogenous in this version of the model.\footnote{In Wildauer
  et al. (2023), the target markup of the final goods sector is
  endogenous with respect to the rate of capacity utilisation.} The
actual or realised profit margin is given by
Equation~\ref{eq-conflict_r}, where \(\epsilon=\frac{p^E}{p}\) is the
real energy price. Finally, by Equation~\ref{eq-conflict_p_E}, the real
energy price \(\epsilon\) is taken to be exogenous (and subject to
shocks), implying that the nominal energy price must grow at the same
rate as the price level.

\section{Simulation}\label{simulation-7}

\subsection{Parameterisation}\label{parameterisation-7}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), three further scenarios will be
considered. In scenario 2, the real energy price \(\epsilon\) increases.
In scenario 3, the target markup \(\theta^T\) rises. In scenario 4, the
target real wage \(\Omega^W\) rises.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.2703}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1216}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\phi\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\psi\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\delta\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\epsilon\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\theta^T\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\Omega^W\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 1 & 1 & 1 & 0.55 & 0.4 & 0.2 \\
2: rise in real energy price \((\epsilon)\) & 1 & 1 & 1 & 0.8 & 0.4 &
0.2 \\
3: rise in target markup \((\theta^T)\) & 1 & 1 & 1 & 0.55 & 0.6 &
0.2 \\
4: rise in target real wage \((\Omega^W)\) & 1 & 1 & 1 & 0.55 & 0.4 &
0.3 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-7}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\#Set number of periods}
\NormalTok{Q }\OtherTok{=} \DecValTok{300}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S}\OtherTok{=}\DecValTok{4}

\CommentTok{\# Set period in which exogenous shift will occur}
\NormalTok{q}\OtherTok{=}\DecValTok{50}

\CommentTok{\#Create (S x Q) matrices in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{omega}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)   }\CommentTok{\# real wage}
\NormalTok{w}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)       }\CommentTok{\# nominal wage}
\NormalTok{p}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)       }\CommentTok{\# price level}
\NormalTok{w\_hat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)   }\CommentTok{\# growth rate of nominal wages}
\NormalTok{p\_hat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)   }\CommentTok{\# growth rate of prices = inflation rate}
\NormalTok{p\_T}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)     }\CommentTok{\# firms\textquotesingle{} desired price level}
\NormalTok{omega\_f}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# firms\textquotesingle{} desired real wage }
\NormalTok{p\_E}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)   }\CommentTok{\# nominal energy price}
\NormalTok{r\_T}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)     }\CommentTok{\# target profit margin}
\NormalTok{r}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)       }\CommentTok{\# realised profit margin}

\CommentTok{\# Set constant parameter values}
\NormalTok{phi}\OtherTok{=}\DecValTok{1}     \CommentTok{\# adjustment speed of nominal wages}
\NormalTok{psi}\OtherTok{=}\DecValTok{1}   \CommentTok{\# adjustment speed of prices}
\NormalTok{delta}\OtherTok{=}\DecValTok{1}   \CommentTok{\# energy intensity}

\CommentTok{\# Set and initialise exogenous variables/parameters that will be shifted}
\NormalTok{epsilon}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.55}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)  }\CommentTok{\# real energy price}
\NormalTok{theta\_T}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.4}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)       }\CommentTok{\# target markup}
\NormalTok{omega\_w}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.2}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q)   }\CommentTok{\# target real wage of workers}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{epsilon[}\DecValTok{2}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.8} \CommentTok{\# scenario 2: rise in real energy price}
\NormalTok{theta\_T[}\DecValTok{3}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.6}     \CommentTok{\# scenario 3: rise in target markup}
\NormalTok{omega\_w[}\DecValTok{4}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.3} \CommentTok{\# scenario 4: rise in target real wage of workers}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
    
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }\CommentTok{\# iterate the model 1000{-}times in each period}
    
    \CommentTok{\#(1) Real wage}
\NormalTok{    omega[i,t] }\OtherTok{=}\NormalTok{w[i,t]}\SpecialCharTok{/}\NormalTok{p[i,t]}
      
    \CommentTok{\#(2) Nominal wage}
\NormalTok{    w[i,t] }\OtherTok{=}\NormalTok{ w[i,t}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ phi}\SpecialCharTok{*}\NormalTok{(omega\_w[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ omega[i,t}\DecValTok{{-}1}\NormalTok{]))}
    
    \CommentTok{\#(3) Price level}
\NormalTok{    p[i,t] }\OtherTok{=}\NormalTok{ p[i, t}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ psi}\SpecialCharTok{*}\NormalTok{(r\_T[i, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ r[i, t}\DecValTok{{-}1}\NormalTok{]))}
    
    \CommentTok{\#(4) Firms\textquotesingle{} desired real wage}
\NormalTok{    omega\_f[i,t] }\OtherTok{=}\NormalTok{ w[i,t]}\SpecialCharTok{/}\NormalTok{p\_T[i,t]}
    
    \CommentTok{\#(5) Firms\textquotesingle{} desired price level}
\NormalTok{    p\_T[i,t] }\OtherTok{=}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ theta\_T[i,t])}\SpecialCharTok{*}\NormalTok{(w[i,t] }\SpecialCharTok{+}\NormalTok{ delta }\SpecialCharTok{*}\NormalTok{ p\_E[i,t])}
    
    \CommentTok{\#(6) Nominal energy price}
\NormalTok{    p\_E[i,t]}\OtherTok{=}\NormalTok{epsilon[i,t]}\SpecialCharTok{*}\NormalTok{p[i,t]}
    
    \CommentTok{\# Target profit margin}
\NormalTok{    r\_T[i, t}\DecValTok{{-}1}\NormalTok{] }\OtherTok{=}\NormalTok{ theta\_T[i, t]}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ theta\_T[i, t])}
    
    \CommentTok{\# Realised profit margin}
\NormalTok{    r[i, t] }\OtherTok{=} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ omega[i, t] }\SpecialCharTok{{-}}\NormalTok{ epsilon[i,t]}\SpecialCharTok{*}\NormalTok{delta}
    
    \CommentTok{\# Growth rate of nominal wages}
\NormalTok{    w\_hat[i,t]}\OtherTok{=}\NormalTok{ (w[i,t]}\SpecialCharTok{{-}}\NormalTok{ w[i,t}\DecValTok{{-}1}\NormalTok{])}\SpecialCharTok{/}\NormalTok{w[i,t}\DecValTok{{-}1}\NormalTok{]}
    
    \CommentTok{\# Growth rate of prices = inflation rate}
\NormalTok{    p\_hat[i,t]}\OtherTok{=}\NormalTok{ (p[i,t]}\SpecialCharTok{{-}}\NormalTok{ p[i,t}\DecValTok{{-}1}\NormalTok{])}\SpecialCharTok{/}\NormalTok{p[i,t}\DecValTok{{-}1}\NormalTok{]}

\NormalTok{  \} }\CommentTok{\# close iterations loop}
\NormalTok{ \}  }\CommentTok{\# close time loop}
\NormalTok{\}   }\CommentTok{\# close scenarios loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{300}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{4}

\CommentTok{\# Set period in which exogenous shift will occur}
\NormalTok{q }\OperatorTok{=} \DecValTok{50}

\CommentTok{\# Create (S x Q) matrices in which equilibrium solutions from different parameterizations will be stored}
\NormalTok{omega }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)  }\CommentTok{\# real wage}
\NormalTok{w }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.1}\NormalTok{)      }\CommentTok{\# nominal wage}
\NormalTok{p }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)      }\CommentTok{\# price level}
\NormalTok{w\_hat }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.1}\NormalTok{)  }\CommentTok{\# growth rate of nominal wages}
\NormalTok{p\_hat }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.1}\NormalTok{)  }\CommentTok{\# growth rate of prices = inflation rate}
\NormalTok{p\_T }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)    }\CommentTok{\# firms\textquotesingle{} desired price level}
\NormalTok{omega\_f }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{) }\CommentTok{\# firms\textquotesingle{} desired real wage }
\NormalTok{p\_E }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)  }\CommentTok{\# nominal energy price}
\NormalTok{r\_T }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)    }\CommentTok{\# target profit margin}
\NormalTok{r }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)      }\CommentTok{\# realised profit margin}

\CommentTok{\# Set constant parameter values}
\NormalTok{phi }\OperatorTok{=} \DecValTok{1}     \CommentTok{\# adjustment speed of nominal wages}
\NormalTok{psi }\OperatorTok{=} \DecValTok{1}   \CommentTok{\# adjustment speed of prices}
\NormalTok{delta }\OperatorTok{=} \DecValTok{1}   \CommentTok{\# energy intensity}

\CommentTok{\# Set and initialize exogenous variables/parameters that will be shifted}
\NormalTok{epsilon }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.55}\NormalTok{)  }\CommentTok{\# real energy price}
\NormalTok{theta\_T }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.4}\NormalTok{)       }\CommentTok{\# target markup}
\NormalTok{omega\_w }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.2}\NormalTok{)   }\CommentTok{\# target real wage of workers}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{epsilon[}\DecValTok{1}\NormalTok{, q:Q] }\OperatorTok{=} \FloatTok{0.8}  \CommentTok{\# scenario 2: rise in real energy price}
\NormalTok{theta\_T[}\DecValTok{2}\NormalTok{, q:Q] }\OperatorTok{=} \FloatTok{0.6}      \CommentTok{\# scenario 3: rise in target markup}
\NormalTok{omega\_w[}\DecValTok{3}\NormalTok{, q:Q] }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# scenario 4: rise in target real wage of workers}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \ControlFlowTok{for}\NormalTok{ \_ }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):  }\CommentTok{\# iterate the model 1000{-}times in each period}
            
            \CommentTok{\# (1) Real wage}
\NormalTok{            omega[i, t] }\OperatorTok{=}\NormalTok{ w[i, t] }\OperatorTok{/}\NormalTok{ p[i, t]}
              
            \CommentTok{\# (2) Nominal wage}
\NormalTok{            w[i, t] }\OperatorTok{=}\NormalTok{ w[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ phi }\OperatorTok{*}\NormalTok{ (omega\_w[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ omega[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
            
            \CommentTok{\# (3) Price level}
\NormalTok{            p[i, t] }\OperatorTok{=}\NormalTok{ p[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ psi }\OperatorTok{*}\NormalTok{ (r\_T[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ r[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
            
            \CommentTok{\# (4) Firms\textquotesingle{} desired real wage}
\NormalTok{            omega\_f[i, t] }\OperatorTok{=}\NormalTok{ w[i, t] }\OperatorTok{/}\NormalTok{ p\_T[i, t]}
            
            \CommentTok{\# (5) Firms\textquotesingle{} desired price level}
\NormalTok{            p\_T[i, t] }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ theta\_T[i, t]) }\OperatorTok{*}\NormalTok{ (w[i, t] }\OperatorTok{+}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ p\_E[i, t])}
            
            \CommentTok{\# (6) Nominal energy price}
\NormalTok{            p\_E[i, t] }\OperatorTok{=}\NormalTok{ epsilon[i, t] }\OperatorTok{*}\NormalTok{ p[i, t]}
            
            \CommentTok{\# Target profit margin}
\NormalTok{            r\_T[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ theta\_T[i, t] }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ theta\_T[i, t])}
            
            \CommentTok{\# Realised profit margin}
\NormalTok{            r[i, t] }\OperatorTok{=} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ omega[i, t] }\OperatorTok{{-}}\NormalTok{ epsilon[i, t] }\OperatorTok{*}\NormalTok{ delta}
            
            \CommentTok{\# Growth rate of nominal wages}
\NormalTok{            w\_hat[i, t] }\OperatorTok{=}\NormalTok{ (w[i, t] }\OperatorTok{{-}}\NormalTok{ w[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ w[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
            
            \CommentTok{\# Growth rate of prices = inflation rate}
\NormalTok{            p\_hat[i, t] }\OperatorTok{=}\NormalTok{ (p[i, t] }\OperatorTok{{-}}\NormalTok{ p[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ p[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
            
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-7}

Figure~\ref{fig-baseline-prices} displays the dynamics of nominal wages
and prices (in levels), both of which exhibit exponential growth.
Figure~\ref{fig-baseline-inflation} plots the corresponding growth
rates: the price and wage inflation rates. It can be seen that after an
initial adjustment period, both rates converge on the same value,
implying a constant real wage (and a constant profit margin).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{3}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{300}

\CommentTok{\# Prices and wages (baseline)}
\FunctionTok{plot}\NormalTok{(p[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"p, w"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Prices and wages (baseline)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(w[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"p"}\NormalTok{, }\StringTok{"w"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-baseline-prices-1.pdf}

}

\caption{\label{fig-baseline-prices}Prices and wages (baseline)}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{3}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{60}

\CommentTok{\# Price and wage inflation (in \%) (baseline)}
\FunctionTok{plot}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"\%"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Price and wage inflation (baseline)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p)), }\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w))),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-baseline-inflation-1.pdf}

}

\caption{\label{fig-baseline-inflation}Price and wage inflation
(baseline)}

\end{figure}%

Figure~\ref{fig-energy} displays the energy price shock (scenario 2),
where the real energy price rises permanently.\footnote{More accurately
  this is an energy price `shift'.} As a result, there is a bout in the
inflation rate, followed by an increase in the wage inflation rate. This
reaction may be characterised as a (temporary) `price-wage spiral'
(Wildauer et al. (2023)), where firms react to the cost shock by raising
prices to protect their profit margins, which trigger a response by
workers to defend their real wages, which prolongs the inflationary
shock. However, the inflation rate then embarks on a gradual downward
convergence towards a new equilibrium that is higher than the one before
the shock. Since the price inflation rate exceeds the wage inflation
rate during the adjustment process, the real wage falls in response to
the increase in the real energy price.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{10}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{100}

\CommentTok{\# Inflation and real wage in energy price shock scenario}
\FunctionTok{plot}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p))) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Wage and price inflation and real wage, energy price shock (scen. 2)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\AttributeTok{side =} \DecValTok{2}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{, }\AttributeTok{at=}\DecValTok{12}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(omega[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(omega[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at=}\FunctionTok{pretty}\NormalTok{(omega[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]))  }
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Omega), }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p)),}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\FunctionTok{expression}\NormalTok{(Omega)),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-energy-1.pdf}

}

\caption{\label{fig-energy}Price and wage inflation and real wage
(energy price shock)}

\end{figure}%

Figure~\ref{fig-markup} considers the scenario where the target markup
of firms rises. The resulting dynamics are very similar to the energy
price shock: the inflation rate spikes, triggering a response in nominal
wages that is weaker than the increase in inflation. As a result, the
real wage falls until a new equilibrium with a higher inflation rate has
been reached. In contrast to the energy price shock, both the profit
margin and the profit share must increase in this scenario.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{30}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{80}

\CommentTok{\# Inflation and real wage in scenario 3}
\FunctionTok{plot}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p))) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Price and wage inflation and real wage, rise in target markup (scen. 3)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\AttributeTok{side =} \DecValTok{2}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{, }\AttributeTok{at=}\DecValTok{7}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(omega[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(omega[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at=}\FunctionTok{pretty}\NormalTok{(omega[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]))  }
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Omega), }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p)),}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\FunctionTok{expression}\NormalTok{(Omega)),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-markup-1.pdf}

}

\caption{\label{fig-markup}Increase in target markup}

\end{figure}%

Figure~\ref{fig-targetrealwage} displays scenario 4, where the target
real wage of workers rises. The wage inflation rate shoots up, which is
followed by an increase in price inflation. As nominal wages temporarily
grow faster than prices, the real wage increases. By implication, both
profit share and margin will fall.

Taken together, scenarios 3 and 4 illustrate that besides cost shocks,
exogeneous changes in the price- and wage-setting behaviour of firm and
workers, respectively, will change the equilibrium inflation rate as
well as income distribution. Such changes could stem from increases in
market power (scenario 3) or fiercer industrial action by workers
(scenario 4). An increase of the claim of either party on total real
output will result in elevated social conflict, reflected in an increase
in the inflation rate. The resulting distributional effect will depend
on which party initiates the conflict.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Inflation and real wage in scenario 4}
\FunctionTok{plot}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p)), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{p\_hat[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Price and wage inflation real wage, rise in target real wage (scen. 4)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(}\DecValTok{100}\SpecialCharTok{*}\NormalTok{w\_hat[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\AttributeTok{side =} \DecValTok{2}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{, }\AttributeTok{at=}\FloatTok{7.5}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(omega[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(omega[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at=}\FunctionTok{pretty}\NormalTok{(omega[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]))  }
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Omega), }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(p)),}\FunctionTok{expression}\NormalTok{(}\FunctionTok{hat}\NormalTok{(w)), }\FunctionTok{expression}\NormalTok{(Omega)),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-targetrealwage-1.pdf}

}

\caption{\label{fig-targetrealwage}Increase in target real wage of
workers}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\# Plot (here only inflation in scenario 2)            }
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmin }\OperatorTok{=} \DecValTok{9}   \CommentTok{\# Zero{-}based index (equivalent to Tmin=10 in R)}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{100}

\CommentTok{\# Set up the main plot}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots()}

\CommentTok{\# Plot inflation rates (price and wage growth rates) on the primary y{-}axis}
\NormalTok{ax1.plot(}\DecValTok{100} \OperatorTok{*}\NormalTok{ p\_hat[}\DecValTok{1}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}hat}\SpecialCharTok{\{p\}}\VerbatimStringTok{$\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{"{-}"}\NormalTok{)  }\CommentTok{\# price inflation}
\NormalTok{ax1.plot(}\DecValTok{100} \OperatorTok{*}\NormalTok{ w\_hat[}\DecValTok{1}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}hat}\SpecialCharTok{\{w\}}\VerbatimStringTok{$\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{"{-}{-}"}\NormalTok{)  }\CommentTok{\# wage inflation}
\NormalTok{ax1.set\_xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}hat}\SpecialCharTok{\{p\}}\VerbatimStringTok{$, $\textbackslash{}hat}\SpecialCharTok{\{w\}}\VerbatimStringTok{$\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_ylim(}\DecValTok{0}\NormalTok{, }\DecValTok{30}\NormalTok{)  }\CommentTok{\# Adjust this limit as needed based on your data}

\CommentTok{\# Add secondary y{-}axis for real wage}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}
\NormalTok{ax2.plot(omega[}\DecValTok{1}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}Omega$\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{":"}\NormalTok{)  }\CommentTok{\# real wage}
\NormalTok{ax2.set\_ylabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}Omega$\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2.set\_ylim(}\DecValTok{0}\NormalTok{, }\FloatTok{0.2}\NormalTok{)  }\CommentTok{\# Set range based on omega values}

\CommentTok{\# Titles and legends}
\NormalTok{plt.title(}\StringTok{"Wage and price inflation and real wage, energy price shock (scenario 2)"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{ax1.legend(loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{)}
\NormalTok{ax2.legend(loc}\OperatorTok{=}\StringTok{"upper right"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{)}

\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{A closer look at the effect of energy price shocks on
profits}\label{a-closer-look-at-the-effect-of-energy-price-shocks-on-profits}

The model can be used to study the effects of an energy price shock on
different measures of profitability and income distribution. Table 2
provides an overview of these measures.

\textbf{Table 2: Measures of profits}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2459}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2459}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2623}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2459}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Definition
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Model equation
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Effect of energy price shock\footnote{We derive the exact effects in the
  analytical discussion below.} \((\uparrow \epsilon)\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Profit margin = profit share of energy sector &
\( r^E = \pi^E = \frac{\Pi^E}{p^E E} \) &
\( r^E = \frac{p^E E - w^E L^E}{p^E E} = 1 - \frac{\Omega^E}{\epsilon} \)
& Positive \\
Profit margin of final output sector & \( r = \frac{\Pi}{pY} \) &
\( r = \frac{pY - wL - p^E E}{pY} = 1 - \Omega - \delta \epsilon \) &
Negative \\
Profit share of final output sector & \( \pi = \frac{\Pi}{pVA} \) &
\( \pi = \frac{pY - wL - p^E E}{pY - p^E E} = 1 - \frac{\Omega}{1 - p^E \epsilon} \)
& Ambiguous \\
Total profit share & \( \pi^{Total} = \frac{\Pi + \Pi^E}{pY} \) &
\( \pi^{Total} = \frac{pY - w^E L^E - wL}{pY} = 1 - \delta \Omega^E - \Omega \)
& Positive \\
\end{longtable}

\textbf{Note:} \(\Pi\) represents nominal profits, \(E\) is the output
of the energy sector, which is an input to the final output \(Y\). The
real wage of the energy sector \(\Omega^E = w^E/p\) is exogenous. Labour
productivity in both sectors is normalised to unity:
\(L^E / E = L / Y = 1\). \(VA\) is value added.

The profit \emph{margin} \(r\) is defined as the share of profits in
\emph{gross} output. By contrast, the profit \emph{share} \(\pi\) is
defined as the share of profits in \emph{value added}, i.e.~output net
of intermediate inputs. For the energy sector, which in this model does
not use any intermediate inputs, the profit margin and profit share
coincide. With the real wage in the energy sector assumed exogenous, a
real energy price increase will unambiguously raise the profits of the
energy sector. For the final output sector that uses energy as an input,
an energy price shock will lower the profit margin due to the increase
in energy cost. However, the effect on the final output sector's profit
share are ambiguous and will depend on the relative ability of workers
and firms to defend their income targets in response to the shock.
Finally, the total profit share incorporates the profits of the energy
input sector and the final output sector (this assumes that the energy
sector is domestic). An increase in the real energy price has an
unambiguously positive effect on the economy-wide profit share.

In Figure~\ref{fig-energy-prof}, it can be seen how the energy price
shock affects the profit margin and profit share of the final output
sector in the simulations. While the profit margin \emph{falls} due to
the increase in energy cost, the profit share \emph{rises}. This is
because for the chosen parameterisation, we have
\(\psi r^T-\phi\Omega^W>0\), for which
\(\frac{\partial \pi}{\partial \epsilon} > 0\).\footnote{See analytical
  discussion below.} Thus, if the price-setting power of firms and their
target profit margins \(\psi r^T\) are sufficiently large relative to
wage-setting power and real wage target of workers \(\phi\Omega^W\),
profit shares of domestic non-energy sectors may rise in response to an
energy cost shock.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate final output profit share}
\NormalTok{pi}\OtherTok{=}\NormalTok{(p}\SpecialCharTok{{-}}\NormalTok{w}\SpecialCharTok{{-}}\NormalTok{p\_E}\SpecialCharTok{*}\NormalTok{delta)}\SpecialCharTok{/}\NormalTok{(p}\SpecialCharTok{{-}}\NormalTok{p\_E}\SpecialCharTok{*}\NormalTok{delta)}

\CommentTok{\# Check if psi*r\_T \textgreater{} phi*omega\_w, implying that the effect of an energy price increase on the profit share of the final output sector is positive}
\FunctionTok{print}\NormalTok{(psi}\SpecialCharTok{*}\NormalTok{r\_T[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ phi}\SpecialCharTok{*}\NormalTok{omega\_w[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot profit margin and profit share in energy price shock scenario}
\FunctionTok{plot}\NormalTok{(r[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"r,"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(r[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], pi[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Profit margin vs profit share, energy price shock (scenario 2)"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(pi[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(pi), }\AttributeTok{side =} \DecValTok{2}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{, }\AttributeTok{at=}\FloatTok{0.4}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"r"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(pi)),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_conflict_inflation_model_files/figure-pdf/fig-energy-prof-2.pdf}

}

\caption{\label{fig-energy-prof}Profit margin and profit share (energy
price shock)}

\end{figure}%

\section{Directed graph}\label{directed-graph-7}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 9 variables: }
  \CommentTok{\# endogenous: (1) Omega, (2) w, (3) p, (4) r\^{}T, (5) r, (6) p\_E}
  \CommentTok{\# exogenous: (7) epsilon, (8) \textbackslash{}theta\^{}T, (9) Omega\^{}W}

              \CommentTok{\#O w p rF r g e mF OW}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# Omega}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,  }\CommentTok{\# w}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# p}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# rf}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# r}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# p\_E}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# epsilon}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\CommentTok{\# \textbackslash{}theta\^{}T}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),  }\CommentTok{\# Omega\^{}W}
               \DecValTok{9}\NormalTok{, }\DecValTok{9}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Omega), }\StringTok{"w"}\NormalTok{, }\StringTok{"p"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(r}\SpecialCharTok{\^{}}\NormalTok{T), }\StringTok{"r"}\NormalTok{,}
             \FunctionTok{expression}\NormalTok{(p\_E), }\FunctionTok{expression}\NormalTok{(epsilon), }\FunctionTok{expression}\NormalTok{(theta}\SpecialCharTok{\^{}}\NormalTok{T), }\FunctionTok{expression}\NormalTok{(Omega}\SpecialCharTok{\^{}}\NormalTok{W))}


\CommentTok{\# Plot directed graph matrix}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Directed graph of conflict inflation model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{25}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.4}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\DecValTok{2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_conflict_inflation_model_files/figure-pdf/conflict_8-1.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\# Directed graph}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Construct auxiliary Jacobian matrix for 9 variables}
\CommentTok{\# endogenous: (1) Omega, (2) w, (3) p, (4) r\^{}T, (5) r, (6) p\_E}
\CommentTok{\# exogenous: (7) epsilon, (8) \textbackslash{}theta\^{}T, (9) Omega\^{}W}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# Omega}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],  }\CommentTok{\# w}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# p}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# r\^{}T}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# r}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# p\_E}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# epsilon}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# \textbackslash{}theta\^{}T}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]   }\CommentTok{\# Omega\^{}W}
\NormalTok{])}

\CommentTok{\# Create adjacency matrix by transposing the auxiliary Jacobian matrix}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.T}

\CommentTok{\# Create a directed graph from the adjacency matrix using networkx}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}Omega$\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"w"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"p"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$r\^{}T$\textquotesingle{}}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{"r"}\NormalTok{, }\DecValTok{5}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$p\^{}E$\textquotesingle{}}\NormalTok{,}
            \DecValTok{6}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}epsilon$\textquotesingle{}}\NormalTok{, }\DecValTok{7}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}theta\^{}T$\textquotesingle{}}\NormalTok{, }\DecValTok{8}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}Omega\^{}W$\textquotesingle{}}\NormalTok{\}}

\CommentTok{\# Plot the graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, k}\OperatorTok{=}\FloatTok{0.6}\NormalTok{)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{200}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{8}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}

\NormalTok{plt.title(}\StringTok{"Directed graph of conflict inflation model"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The key exogenous variables in this version of the conflict inflation
model are the real energy price \(\epsilon\), the target markup
\(\theta^T\), and the target real wage of workers \(\Omega^W\). The
first two exogenous variables feed into the endogenous conflict
inflation process via their impact on the realised profit margin \(r\)
and the desired profit margin \(r^T\), respectively. The gap between
desired and realised profit margins, in turn, impact price setting, the
real wage, and then wage setting. By contrast, the target real wage of
workers enters the inflationary process via its direct impact on nominal
wages, which then impacts real wages, the realised profit margin, and
then price setting. The directed graph thus highlights the joint
determination and endogenous interaction of prices, wages, and income
distribution.

\section{Analytical discussion}\label{analytical-discussion-5}

To study the properties of the model, we reduce it to a first-order
dynamic system in \(w_t\) and \(p_t\). To this end, substitute
Equation~\ref{eq-conflict_omega} into Equation~\ref{eq-conflict_w} to
obtain the equation for \(w_t\). Next, substitute
Equation~\ref{eq-conflict_r}, Equation~\ref{eq-conflict_rf} and
Equation~\ref{eq-conflict_omega} into Equation~\ref{eq-conflict_p}. This
gives the system:

\begin{equation}\phantomsection\label{eq-conflict_w_reduc}{
w_{t+1} = w_{t}\left[1+ \phi\left(\Omega^W - \frac{w_t}{p_t}\right)\right] \\
}\end{equation}
\begin{equation}\phantomsection\label{eq-conflict_p_reduc}{
p_{t+1} = p_{t} \left[1+\psi\left(\frac{w_t}{p_t} - \frac{1}{1+\theta^T} + \delta \epsilon \right) \right].
}\end{equation}

Next, let's introduce the definitions
\(\frac{w_{t+1} -w_{t}}{w_{t}} = \hat{w_t}\) and
\(\frac{p_{t+1} -p_{t}}{p_{t}} = \hat{p_t}\) for the growth rates of
wages and prices, respectively. The equilibrium in this model is given
by a real wage and inflation rate \((\Omega^*, \hat{p}^*)\) for which
\(\hat{w_t}=\hat{p_t}\), i.e.~wages and prices grow at the same rate,
such that the real wage is constant. Imposing this equilibrium condition
using Equation~\ref{eq-conflict_w_reduc} and
Equation~\ref{eq-conflict_p_reduc} yields:

\begin{equation}\phantomsection\label{eq-conflict_omega_eq}{\Omega^* = \frac{\phi \Omega^W+ \psi \left(\frac{1}{1+\theta^T}- \delta \epsilon \right)}{\phi + \psi}
}\end{equation}

and

\begin{equation}\phantomsection\label{eq-conflict_infl_eq}{
\hat{p}^* = \phi \psi \left[\frac{ \Omega^W - \left(\frac{1}{1+\theta^T}- \delta \epsilon \right)}{\phi + \psi}\right],
}\end{equation}

where the term \(\left(\frac{1}{1+\theta^T}- \delta \epsilon\right)\)
can also be interpreted as firms' implicit real wage target
\(\Omega^F\), such that for a positive equilibrium inflation rate
\(\hat{p}^* >0\) , we need
\(\Omega^W > \Omega^F = \frac{1}{1+\theta^T}- \delta \epsilon\). Thus,
workers' and firms' real wage targets need to be mutually inconsistent
for inflation to emerge in equilibrium.

With these equilibrium solutions, we can show that increases in
\(\theta^T\) and \(\epsilon\) reduce the equilibrium real wage and raise
the equilibrium inflation rate, whereas increases in \(\Omega^W\) raise
the equilibrium real wage and raise the inflation rate:

\[
\frac{\partial \Omega^*} {\partial \theta^T} = -\frac{\psi}{(\psi + \phi)(1+\theta^T)^2} < 0,
\] \[
\frac{\partial \hat{p}^*}{\partial \theta^T} = \frac{\phi\psi}{(\psi + \phi)(1+\theta^T)^2} > 0,
\]

\[
\frac{\partial \Omega^*}{\partial \epsilon} = -\frac{\psi \delta}{\psi + \phi} < 0,
\] \[
\frac{\partial \hat{p}^*}{\partial \epsilon} = \frac{\psi \phi \delta}{\psi + \phi} > 0,
\]

\[
\frac{\partial \Omega^*} {\partial \Omega^W} = \frac{\phi}{\psi + \phi} > 0,
\] \[
\frac{\partial \hat{p}^*}{\partial \Omega^W} = \frac{\phi\psi}{\psi + \phi} > 0.
\]

Using the result for \(\frac{\partial \Omega^*}{\partial \epsilon}\), we
can easily work out the effects on the different measure of
profitability listed in Table 2:

\[
\frac{\partial r^E}{\partial \epsilon} = \frac{\Omega^E}{\epsilon^2} > 0,
\]

\[
\frac{\partial r}{\partial \epsilon} =  -\frac{\delta \phi}{\psi + \phi} < 0,
\]

\[
\frac{\partial \pi}{\partial \epsilon} =   \frac{\delta(\psi r^T-\phi\Omega^W)}{(\psi + \phi)(1-\epsilon\delta)^2} \lesseqgtr 0, 
\]

\[
\frac{\partial \pi^{Total}}{\partial \epsilon} =  \frac{\delta \psi }{\psi + \phi} > 0.
\]

Next, to analyse dynamics of the model, we write down the Jacobian
matrix of the system in Equation~\ref{eq-conflict_w_reduc} and
Equation~\ref{eq-conflict_p_reduc}:

\[
J(w,p)=\begin{bmatrix}
            1 + \hat{w} - \phi \Omega & \phi {\Omega}^2   \\
            \psi & 1 + \hat{p} - \psi \Omega   \\
        \end{bmatrix},
\] where we used \(\hat{w}=\phi\left(\Omega^W - \frac{w_t}{p_t}\right)\)
and
\(\hat{p}=\psi\left(\frac{w_t}{p_t} - \frac{1}{1+\theta^T} + \delta \epsilon \right)\)
to simplify the expressions inside the Jacobian.

The stability conditions for two-dimensional systems in discrete time
are:

\[
1+tr(J)+det(J)>0,
\] \[
1-tr(J)+det(J)>0,
\] \[
1-det(J)>0,
\] where \(tr(J)\) is the trace and \(det(J)\) is the determinant of the
Jacobian.

We know that this system will be unstable, because prices and wages will
grow exponentially in equilibrium. We thus want to derive the condition
under which the system becomes unstable and generates conflict
inflation.

Imposing \(\hat{w_t}=\hat{p_t}\), the trace and determinant of the
Jacobian matrix in equilibrium are given by:

\[
tr(J)=2(1+\hat{w}) - \Omega(\phi+\psi),
\]

\begin{equation}

\det(J)=1-\Omega(\phi+\psi)+\hat{w}[2+\hat{w} - \Omega(\phi+\psi)].

\end{equation}

Let's focus on the second stability condition, which is:

\[
1-tr(J)+det(J)= \hat{w}[\hat{w} - \Omega(\phi+\psi)]>0.
\]

Substituting the equilibrium solutions for \(\hat{w}^*\) and
\(\omega^*\) into the term insight the square brackets yields:

\[
-\hat{w}^*\left(\frac{\omega^W\phi^2+(2\phi+\psi)\psi \Omega^F}{\phi+\psi}\right)<0.
\]

The term inside the brackets will be positive for meaningful economic
values. The term outside the brackets will be negative if
\(\hat{w}^*=\hat{p^*}>0\), i.e.~there is positive inflation, which in
turn requires \(\Omega^W > \Omega^F\), i.e.~workers' real wage target
needs to exceed firms' real wage target.

We can confirm these analytical results numerically. First, let's
confirm the solutions for the equilibrium real and the equilibrium
inflation rate as well as the `instability condition' that the target
real wage of workers needs to exceed the target real wage of firms.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Check solution for equilibrium real wage}
\CommentTok{\# Analytical}
\NormalTok{(}\AttributeTok{omega\_eq=}\NormalTok{ (phi}\SpecialCharTok{*}\NormalTok{omega\_w[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{psi}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{theta\_T[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{delta}\SpecialCharTok{*}\NormalTok{epsilon[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]))}\SpecialCharTok{/}\NormalTok{(phi}\SpecialCharTok{+}\NormalTok{psi))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.1821429
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Numerical}
\NormalTok{omega[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.1821429
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Check solution for equilibrium inflation rate}
\CommentTok{\# Analytical}
\NormalTok{phi}\SpecialCharTok{*}\NormalTok{psi}\SpecialCharTok{*}\NormalTok{(omega\_w[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{theta\_T[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{delta}\SpecialCharTok{*}\NormalTok{epsilon[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]))}\SpecialCharTok{/}\NormalTok{(phi}\SpecialCharTok{+}\NormalTok{psi)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.01785714
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Numerical}
\NormalTok{p\_hat[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.01785714
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Check condition for instability: Omega\^{}W \textgreater{} Omega\^{}F}
\FunctionTok{print}\NormalTok{(omega\_w[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{\textgreater{}} \DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{theta\_T[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{{-}}\NormalTok{delta}\SpecialCharTok{*}\NormalTok{epsilon[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

Next, we compute the Jacobian matrix of the simulated model (for the
baseline), obtain the eigenvalues, eigenvectors, trace, and determinant.
We then check the stability conditions. We find that the second
stability condition is indeed violated.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Check eigenvalues of Jacobian matrix}
\CommentTok{\# Define matrix}
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{p\_hat[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{phi}\SpecialCharTok{*}\NormalTok{omega[}\DecValTok{1}\NormalTok{,Q], phi}\SpecialCharTok{*}\NormalTok{omega[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{,}
\NormalTok{           psi, }\DecValTok{1}\SpecialCharTok{+}\NormalTok{p\_hat[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{psi}\SpecialCharTok{*}\NormalTok{omega[}\DecValTok{1}\NormalTok{,Q]), }
           \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues }
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{evals =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.0178571 0.6535714
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{evecs }\OtherTok{=}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{vectors}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det}\OtherTok{=}\FunctionTok{det}\NormalTok{(J)      }\CommentTok{\# determinant}
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J)) }\CommentTok{\# trace}

\CommentTok{\#Check stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

Finally, following the approach presented in
Chapter~\ref{sec-stab_analysis}, we can check whether the ratio of the
two unstable state variables \(w_t\) and \(p_t\), which is the real wage
\(\Omega\), approaches a value that is given by the ratios of the
elements in the dominant eigenvector. To do this, we first normalise the
eigenvectors by dividing through by the second element (which
corresponds to the second state variable in our system, \(p_t\)). The
first element in the normalised eigenvector should then correspond to
the equilibrium real wage. This is indeed the case.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Normalise eigenvectors by dividing through by the second element}
\NormalTok{evecs\_norm}\OtherTok{=}\NormalTok{evecs}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)\{}
\NormalTok{  evecs\_norm[,i]}\OtherTok{=}\NormalTok{evecs[,i]}\SpecialCharTok{/}\NormalTok{evecs[}\DecValTok{2}\NormalTok{,i]}
\NormalTok{\}}

\CommentTok{\# Compare first element of normalised eigenvector with real wage Omega=w/p}
\NormalTok{evecs\_norm[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.1821429
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{omega[}\DecValTok{1}\NormalTok{,Q] }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.1821429
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\#\#\# Analytical solutions}
\CommentTok{\# Analytical solution for equilibrium real wage}
\BuiltInTok{print}\NormalTok{((phi }\OperatorTok{*}\NormalTok{ omega\_w[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{+}\NormalTok{ psi }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ theta\_T[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]) }\OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ epsilon[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{])) }\OperatorTok{/}\NormalTok{ (phi }\OperatorTok{+}\NormalTok{ psi))}

\CommentTok{\# Numerical solution for equilibrium real wage}
\BuiltInTok{print}\NormalTok{(omega[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}

\CommentTok{\# Analytical solution for equilibrium inflation rate}
\BuiltInTok{print}\NormalTok{(phi }\OperatorTok{*}\NormalTok{ psi }\OperatorTok{*}\NormalTok{ (omega\_w[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ theta\_T[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]) }\OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ epsilon[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{])) }\OperatorTok{/}\NormalTok{ (phi }\OperatorTok{+}\NormalTok{ psi))}

\CommentTok{\# Numerical solution for equilibrium inflation rate}
\BuiltInTok{print}\NormalTok{(p\_hat[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }

\CommentTok{\# Check condition for instability: Omega\^{}W \textgreater{} Omega*}
\BuiltInTok{print}\NormalTok{( omega\_w[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textgreater{}}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ theta\_T[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]) }\OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ epsilon[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]))}

\CommentTok{\# Define the Jacobian matrix J}
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{1} \OperatorTok{+}\NormalTok{ p\_hat[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ phi }\OperatorTok{*}\NormalTok{ omega[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{], phi }\OperatorTok{*}\NormalTok{ omega[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}\OperatorTok{**}\DecValTok{2}\NormalTok{],}
\NormalTok{    [psi, }\DecValTok{1} \OperatorTok{+}\NormalTok{ p\_hat[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ psi }\OperatorTok{*}\NormalTok{ omega[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]]}
\NormalTok{])}

\CommentTok{\# Obtain eigenvalues and eigenvectors}
\NormalTok{ev }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}
\NormalTok{evals }\OperatorTok{=}\NormalTok{ ev[}\DecValTok{0}\NormalTok{]  }\CommentTok{\# eigenvalues}
\NormalTok{evecs }\OperatorTok{=}\NormalTok{ ev[}\DecValTok{1}\NormalTok{]  }\CommentTok{\# eigenvectors}
\BuiltInTok{print}\NormalTok{(evals)}
\BuiltInTok{print}\NormalTok{(evecs)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\NormalTok{tr }\OperatorTok{=}\NormalTok{ np.trace(J)}
\BuiltInTok{print}\NormalTok{(det)}
\BuiltInTok{print}\NormalTok{(tr)}

\CommentTok{\# Check stability conditions}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{+}\NormalTok{ tr }\OperatorTok{+}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ tr }\OperatorTok{+}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}

\CommentTok{\# Normalise eigenvectors by dividing through by the second element}
\NormalTok{evecs\_norm }\OperatorTok{=}\NormalTok{ evecs.copy()  }\CommentTok{\# Make a copy to modify}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{2}\NormalTok{):}
\NormalTok{    evecs\_norm[:, i] }\OperatorTok{=}\NormalTok{ evecs[:, i] }\OperatorTok{/}\NormalTok{ evecs[}\DecValTok{1}\NormalTok{, i]  }\CommentTok{\# Normalize by the second element}

\CommentTok{\# Compare first element of normalized eigenvector with real wage Omega = w/p}
\BuiltInTok{print}\NormalTok{(evecs\_norm[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(omega[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-9}

\chapter{A Sraffian Supermultiplier
Model}\label{a-sraffian-supermultiplier-model}

\section{Overview}\label{overview-8}

The Sraffian supermultiplier model was proposed by Serrano (1995) to
integrate a Sraffian long-run equilibrium into a post-Keynesian growth
model.\footnote{See chapter 7 in Blecker and Setterfield (2019), Dutt
  (2018), and chapter 6 in Lavoie (2022) for useful introductions. Note
  that contrary to what the name may suggest, this is a one-sector
  model.} The model requires the long-run rate of capacity utilisation
to settle on an exogenously given normal rate. This requires investment
to fully adjust to any changes in economic activity so as to bring back
actual utilisation to the desired normal rate. As a result, investment
expenditures (in the long-run) are assumed to be free of any
idiosyncratic components such as Keynesian `animal spirits'. Long-run
growth is then driven by those components of autonomous demand that do
not create productive capacity -- autonomous consumption in the simplest
version of the model. An increase in the growth rate of autonomous
consumption will stimulate economic activity and induce firms to adjust
their expectations about long-run growth towards the new rate given by
autonomous demand growth.

Income distribution is exogenous in this model. An increase in the wage
share has an expansionary effect on economic activity and growth in the
short-run as it increases consumption (investment is assumed to be
independent of income distribution). However, this expansionary effect
is only temporary as economic activity will eventually settle back on
the normal rate of capacity utilisation, and the growth rate towards the
rate given by autonomous demand growth. The absence of long-run effects
of income distribution on output and growth constitutes a key difference
between the Sraffian supermultiplier model and the post-Kaleckian model,
in which there is no normal rate of capacity utilisation and no
autonomous (non-capacity creating) demand.

This is a model of long-run steady state growth. In the steady state,
all endogenous variables grow at the same rate.\footnote{All variables
  are normalised by the capital stock and thus rendered stationary.} The
model contains two state variables that determine the model's dynamics:
the ratio of autonomous demand to the capital stock (which changes
during adjustment periods where the growth rate has not yet settled on
the rate given by autonomous demand growth) and the expected growth rate
of the capital stock, which sluggishly adjusts to the rate given by
autonomous demand growth. We consider a continuous-time version of the
model presented in chapter 6.5.8 of Lavoie (2022) .\footnote{Section~\ref{sec-sim-continuous}
  explains how continuous time models can be solved numerically.}

\section{The Model}\label{the-model-8}

The following equations describe the model:
\begin{equation}\phantomsection\label{eq-ssm_r}{
r_t=\pi u_t
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_s}{
s_t=-z_t + s_r r_t
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_c}{
c_t= u_t-s_t
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_g}{
g_t=g^0_t+g_1(u_t-u_n)
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_u}{
u_t=c_t+g_t
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_g0}{
\dot{g^0_t}=\mu(g_t-g^0_t) 
}\end{equation} \begin{equation}\phantomsection\label{eq-ssm_z}{
\dot{z_t}=z_t(g_z-g_t),
}\end{equation}

where \(r\), \(s\), \(c\), \(g\), \(u\), \(g^0\), and \(z\) are the
profit rate, the saving rate, the consumption rate, the investment rate,
the rate of capacity utilisation, the expected growth rate, and the rate
of autonomous demand, respectively. A dot over a variable represents the
derivative with respect to time (\(\dot{x}=\frac{d x}{d t}\)).

Equation~\ref{eq-ssm_r} decomposes the profit rate (total profits over
capital stock) into the product of the profit share \(\pi\) (total
profits over total output) and the rate of capacity utilisation (actual
output over capital stock).\footnote{For simplicity, it is assumed that
  the capital-potential output ratio is equal to unity. This implies
  that the ratio of actual output to potential output is equal to the
  ratio of actual output to the capital stock, so that the latter can be
  taken as a measure of the rate of capacity utilisation.} Note that the
wage share is given by \(1-\pi\). By Equation~\ref{eq-ssm_s}, the
economy-wide saving rate is given by the negative of the rate of
autonomous demand (\(z\)), which in this version of the model is
autonomous consumption, i.e.~dissaving, and saving out of profits
(\(s_r\)). It is assumed that workers do not save.
Equation~\ref{eq-ssm_c} simply states that consumption is income not
saved. According to Equation~\ref{eq-ssm_g}, investment is determined by
an autonomous component \(g_0\) that will be specified below and by the
deviation of capacity utilisation from its normal rate \(u_n\). In other
words, firms expand capacity whenever the actual rate of utilisation
exceeds the desired normal rate. Equation~\ref{eq-ssm_u} is the goods
market equilibrium condition assuming that the rate of capacity
utilisation adjusts to clear the goods market in the short run.
Equation~\ref{eq-ssm_g0} is a key equation in the Sraffian
supermultiplier approach, which posits that firms (sluggishly) adjust
the expected growth rate to the actual growth rate. Finally,
Equation~\ref{eq-ssm_z} is an identity that traces changes in the rate
of autonomous demand that stem from (temporary) mismatches between the
exogenously given growth rate of autonomous demand (\(g_z\)) and the
actual growth rate.

\section{Simulation}\label{simulation-8}

\subsection{Parameterisation}\label{parameterisation-8}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (labelled as scenario 1), three further scenarios will be
considered. In scenario 2, the growth rate of autonomous demand \(g_z\)
increases. In scenario 3, the profit share \(\pi\) rises. In scenario 4,
the normal rate of capacity utilisation \(u_n\) increases. The model is
initialised at the equilibrium of the baseline parameterisation and the
various shifts then occur in period 50.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.3684}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1053}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\pi\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(s_r\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(g_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(u_n\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\mu\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(g_z\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 0.35 & 0.8 & 0.2 & 0.75 & 0.08 & 0.02 \\
2: rise in autonomous demand growth (\(g_z\)) & 0.35 & 0.8 & 0.2 & 0.75
& 0.08 & 0.03 \\
3: rise in profit share (\(\pi\)) & 0.4 & 0.8 & 0.2 & 0.75 & 0.08 &
0.02 \\
4: rise in normal rate of capacity utilisation (\(u_n\)) & 0.35 & 0.8 &
0.2 & 0.8 & 0.08 & 0.02 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-8}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\#Set number of periods}
\NormalTok{Q }\OtherTok{=} \DecValTok{1000}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S}\OtherTok{=}\DecValTok{4}

\CommentTok{\# Set period in which exogenous shift will occur}
\NormalTok{q}\OtherTok{=}\DecValTok{50}

\CommentTok{\#Create (S x Q) matrices in which equilibrium solutions from different parameterisations will be stored}
\NormalTok{u}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# rate of capacity utilisation}
\NormalTok{g}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# growth rate of capital stock}
\NormalTok{s}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# saving rate}
\NormalTok{c}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# consumption rate}
\NormalTok{r}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# profit rate}
\NormalTok{g0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q)}\CommentTok{\# expected growth rate of capital stock}
\NormalTok{z}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# autonomous demand rate}

\CommentTok{\#Set constant parameter values}
\NormalTok{g1}\OtherTok{=}\FloatTok{0.2}  \CommentTok{\# Sensitivity of investment with respect to utilisation}
\NormalTok{sr}\OtherTok{=}\FloatTok{0.8}  \CommentTok{\# propensity to save out of profits}
\NormalTok{mu}\OtherTok{=}\FloatTok{0.08} \CommentTok{\# adjustment speed of expected growth rate}
\NormalTok{d}\OtherTok{=}\FloatTok{0.1}   \CommentTok{\# time increment}

\CommentTok{\# Set and initialise exogenous variables/parameters that will be shifted}
\NormalTok{pi}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.35}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# profit share}
\NormalTok{gz}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.02}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# growth rate of autonomous demand}
\NormalTok{un}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.75}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q)  }\CommentTok{\# normal rate of capacity utilisation}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{gz[}\DecValTok{2}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.03} \CommentTok{\# scenario 2: rise in autonomous demand growth}
\NormalTok{pi[}\DecValTok{3}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# scenario 3: rise in profit share}
\NormalTok{un[}\DecValTok{4}\NormalTok{,q}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.8} \CommentTok{\# scenario 4: rise in normal rate of utilisation}

\CommentTok{\# Initialise endogenous variables at equilibrium values}
\NormalTok{u[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{un[,}\DecValTok{1}\NormalTok{]}
\NormalTok{g[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{gz[,}\DecValTok{1}\NormalTok{]}
\NormalTok{s[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{g[,}\DecValTok{1}\NormalTok{]}
\NormalTok{c[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{un[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{s[,}\DecValTok{1}\NormalTok{]}
\NormalTok{g0[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{gz[,}\DecValTok{1}\NormalTok{]}
\NormalTok{z[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{sr}\SpecialCharTok{*}\NormalTok{pi[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{un[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{gz[,}\DecValTok{1}\NormalTok{]}
\NormalTok{r[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{pi[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{un[,}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
    
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }\CommentTok{\# iterate the model 1000{-}times in each period}
    
    \CommentTok{\#(1) Profit rate}
\NormalTok{    r[i,t] }\OtherTok{=}\NormalTok{pi[i,t]}\SpecialCharTok{*}\NormalTok{u[i,t]}
      
    \CommentTok{\#(2) Saving}
\NormalTok{    s[i,t] }\OtherTok{=} \SpecialCharTok{{-}}\NormalTok{z[i,t] }\SpecialCharTok{+}\NormalTok{ sr}\SpecialCharTok{*}\NormalTok{r[i,t]}
    
    \CommentTok{\#(3) Consumption}
\NormalTok{    c[i,t] }\OtherTok{=}\NormalTok{ u[i,t] }\SpecialCharTok{{-}}\NormalTok{ s[i,t]}
    
    \CommentTok{\#(4) Investment}
\NormalTok{    g[i,t] }\OtherTok{=}\NormalTok{ g0[i,t] }\SpecialCharTok{+}\NormalTok{g1}\SpecialCharTok{*}\NormalTok{(u[i,t] }\SpecialCharTok{{-}}\NormalTok{ un[i,t])}
    
    \CommentTok{\#(5) Capacity utilisation}
\NormalTok{    u[i,t] }\OtherTok{=}\NormalTok{ c[i,t] }\SpecialCharTok{+}\NormalTok{ g[i,t]}
    
    \CommentTok{\#(6) Dynamic adjustment of expected growth rate of capital stock}
\NormalTok{    g0[i,t] }\OtherTok{=}\NormalTok{ g0[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ mu}\SpecialCharTok{*}\NormalTok{(g[i,t}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{g0[i,t}\DecValTok{{-}1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{d}
    
    \CommentTok{\#(7) Dynamic adjustment of autonomous demand}
\NormalTok{    z[i,t] }\OtherTok{=}\NormalTok{ z[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ z[i,t}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(gz[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ g[i,t}\DecValTok{{-}1}\NormalTok{])}\SpecialCharTok{*}\NormalTok{d}

\NormalTok{  \} }\CommentTok{\# close iterations loop}
\NormalTok{ \}  }\CommentTok{\# close time loop}
\NormalTok{\}   }\CommentTok{\# close scenarios loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{1000}

\CommentTok{\# Set number of scenarios (including baselines)}
\NormalTok{S }\OperatorTok{=} \DecValTok{4}

\CommentTok{\# Set period in which exogenous shift will occur}
\NormalTok{q }\OperatorTok{=} \DecValTok{50}

\CommentTok{\# Create (S x Q) matrices for equilibrium solutions}
\NormalTok{u }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# rate of capacity utilization}
\NormalTok{g }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# growth rate of capital stock}
\NormalTok{s }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# saving rate}
\NormalTok{c }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# consumption rate}
\NormalTok{r }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# profit rate}
\NormalTok{g0 }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# expected growth rate of capital stock}
\NormalTok{z }\OperatorTok{=}\NormalTok{ np.zeros((S, Q))  }\CommentTok{\# autonomous demand rate}

\CommentTok{\# Set constant parameter values}
\NormalTok{g1 }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Sensitivity of investment with respect to utilization}
\NormalTok{sr }\OperatorTok{=} \FloatTok{0.8}  \CommentTok{\# propensity to save out of profits}
\NormalTok{mu }\OperatorTok{=} \FloatTok{0.08}  \CommentTok{\# adjustment speed of expected growth rate}
\NormalTok{d }\OperatorTok{=} \FloatTok{0.1}   \CommentTok{\# time increment}

\CommentTok{\# Set and initialize exogenous variables/parameters that will be shifted}
\NormalTok{pi }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.35}\NormalTok{)  }\CommentTok{\# profit share}
\NormalTok{gz }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.02}\NormalTok{)  }\CommentTok{\# growth rate of autonomous demand}
\NormalTok{un }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.75}\NormalTok{)  }\CommentTok{\# normal rate of capacity utilization}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{gz[}\DecValTok{1}\NormalTok{, q:] }\OperatorTok{=} \FloatTok{0.03}  \CommentTok{\# scenario 2: rise in autonomous demand growth}
\NormalTok{pi[}\DecValTok{2}\NormalTok{, q:] }\OperatorTok{=} \FloatTok{0.4}   \CommentTok{\# scenario 3: rise in profit share}
\NormalTok{un[}\DecValTok{3}\NormalTok{, q:] }\OperatorTok{=} \FloatTok{0.8}   \CommentTok{\# scenario 4: rise in normal rate of utilization}

\CommentTok{\# Initialize endogenous variables at equilibrium values}
\NormalTok{u[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ un[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{g[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ gz[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{s[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ g[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{c[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ un[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ s[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{g0[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ gz[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{z[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ sr }\OperatorTok{*}\NormalTok{ pi[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ un[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ gz[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{r[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ pi[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ un[:, }\DecValTok{0}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):  }\CommentTok{\# iterate the model 1000 times in each period}

            \CommentTok{\# (1) Profit rate}
\NormalTok{            r[i, t] }\OperatorTok{=}\NormalTok{ pi[i, t] }\OperatorTok{*}\NormalTok{ u[i, t]}

            \CommentTok{\# (2) Saving}
\NormalTok{            s[i, t] }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{z[i, t] }\OperatorTok{+}\NormalTok{ sr }\OperatorTok{*}\NormalTok{ r[i, t]}

            \CommentTok{\# (3) Consumption}
\NormalTok{            c[i, t] }\OperatorTok{=}\NormalTok{ u[i, t] }\OperatorTok{{-}}\NormalTok{ s[i, t]}

            \CommentTok{\# (4) Investment}
\NormalTok{            g[i, t] }\OperatorTok{=}\NormalTok{ g0[i, t] }\OperatorTok{+}\NormalTok{ g1 }\OperatorTok{*}\NormalTok{ (u[i, t] }\OperatorTok{{-}}\NormalTok{ un[i, t])}

            \CommentTok{\# (5) Capacity utilization}
\NormalTok{            u[i, t] }\OperatorTok{=}\NormalTok{ c[i, t] }\OperatorTok{+}\NormalTok{ g[i, t]}

            \CommentTok{\# (6) Dynamic adjustment of expected growth rate of capital stock}
\NormalTok{            g0[i, t] }\OperatorTok{=}\NormalTok{ g0[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ mu }\OperatorTok{*}\NormalTok{ (g[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g0[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ d}

            \CommentTok{\# (7) Dynamic adjustment of autonomous demand}
\NormalTok{            z[i, t] }\OperatorTok{=}\NormalTok{ z[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ z[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (gz[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ d}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-8}

Figures 1-3 depict the response of the three main endogenous variables
to changes in the exogenous variables. In the second scenario (solid
line), the growth rate of autonomous demand increases from 2\% to 3\%.
As a result, the rate of capacity temporarily increases but then returns
to the level given by the normal rate, as the rate of autonomous demand
falls due to the increase in the capital stock. By contrast, the growth
rate permanently settles to the new rate given by the autonomous rate.

In the third scenario (dashed line), the profit share rises, which
initially has a contractionary effect on the rate of utilisation and
growth. Both variables then briefly overshoot due to the increase in the
autonomous demand rate and then return to their previous values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{700}

\CommentTok{\# Capacity utilisation}
\FunctionTok{plot}\NormalTok{(u[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{ylab =} \StringTok{\textquotesingle{}u\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\FunctionTok{max}\NormalTok{(u[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax]),}\FunctionTok{min}\NormalTok{(u[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax])),}\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 1: Rate of capacity utilisation under different scenarios"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(u[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(u[}\DecValTok{4}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Rise autom demand"}\NormalTok{, }\StringTok{"Rise profit share"}\NormalTok{, }\StringTok{"Rise normal rate"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_sraffian_supermultiplier_model_files/figure-pdf/ssm2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Growth}
\FunctionTok{plot}\NormalTok{(g[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{ylab =} \StringTok{\textquotesingle{}g\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\FunctionTok{max}\NormalTok{(g[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax]),}\FunctionTok{min}\NormalTok{(g[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax])),}\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 2: Growth rate under different scenarios"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(g[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(g[}\DecValTok{4}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Rise autom demand"}\NormalTok{, }\StringTok{"Rise profit share"}\NormalTok{, }\StringTok{"Rise normal rate"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_sraffian_supermultiplier_model_files/figure-pdf/ssm2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Autonomous demand rate}
\FunctionTok{plot}\NormalTok{(z[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{ylab =} \StringTok{\textquotesingle{}z\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\FunctionTok{max}\NormalTok{(z[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax]),}\FunctionTok{min}\NormalTok{(z[, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax])),}\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 3: Rate of autonomous demand under different scenarios"}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(z[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(z[}\DecValTok{4}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Rise autom demand"}\NormalTok{, }\StringTok{"Rise profit share"}\NormalTok{, }\StringTok{"Rise normal rate"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_sraffian_supermultiplier_model_files/figure-pdf/ssm2-3.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\# Plots (here for capacity utilisation only)}

\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{700}

\CommentTok{\# Plot capacity utilization}
\NormalTok{plt.plot(u[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}Rise autom demand\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(u[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}Rise profit share\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(u[}\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}Rise normal rate\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}.\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{\textquotesingle{}Rate of Capacity Utilization under Different Scenarios\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}u\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}lower right\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Finally, a rise in the normal rate (dotted line) initially has
contractionary effects on utilisation and growth but eventually raises
utilisation to a permanently higher level. The growth rate returns to
its previous value.

\section{Directed graph}\label{directed-graph-8}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct auxiliary Jacobian matrix for 9 variables: }
\CommentTok{\# r, c, g, u, g0, z, pi, gz, un}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{9}\NormalTok{, }\DecValTok{9}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=}\ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"r"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"g"}\NormalTok{, }\StringTok{"u"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(g}\SpecialCharTok{\^{}}\DecValTok{0}\NormalTok{), }\StringTok{"z"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(pi), }\FunctionTok{expression}\NormalTok{(g[z]), }\FunctionTok{expression}\NormalTok{(u[n]))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Figure 4: Directed graph of Sraffian Supermultiplier Model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_sraffian_supermultiplier_model_files/figure-pdf/ssm3-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Directed graph}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Define the Jacobian matrix}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"r"}\NormalTok{, }
            \DecValTok{1}\NormalTok{: }\StringTok{"c"}\NormalTok{,}
            \DecValTok{2}\NormalTok{: }\StringTok{"g"}\NormalTok{,}
            \DecValTok{3}\NormalTok{: }\StringTok{"u"}\NormalTok{,}
            \DecValTok{4}\NormalTok{: }\VerbatimStringTok{r"$g\^{}0$"}\NormalTok{,}
            \DecValTok{5}\NormalTok{: }\StringTok{"z"}\NormalTok{,}
            \DecValTok{6}\NormalTok{: }\VerbatimStringTok{r"$\textbackslash{}pi$"}\NormalTok{,}
            \DecValTok{7}\NormalTok{: }\VerbatimStringTok{r"$g\_z$"}\NormalTok{,}
            \DecValTok{8}\NormalTok{: }\VerbatimStringTok{r"$u\_n$"}\NormalTok{\}}

\CommentTok{\# Plot the directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, seed}\OperatorTok{=}\DecValTok{43}\NormalTok{)  }
\NormalTok{nx.draw(G, pos, with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs, node\_size}\OperatorTok{=}\DecValTok{300}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{, }
\NormalTok{        font\_size}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{edge\_labels }\OperatorTok{=}\NormalTok{ \{(u, v): }\StringTok{\textquotesingle{}\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ u, v }\KeywordTok{in}\NormalTok{ G.edges\}}
\NormalTok{nx.draw\_networkx\_edge\_labels(G, pos, edge\_labels}\OperatorTok{=}\NormalTok{edge\_labels, font\_color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axis(}\StringTok{\textquotesingle{}off\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure 4, it can be seen that the growth rate of autonomous demand
(\(g_z\)), the profit share (\(\pi\)), and the normal rate of capacity
utilisation (\(u_n\)) are the key exogenous variable of the model. The
profit rate (\(r\)), consumption (\(c\)), the autonomous demand rate
(\(z\)), investment (\(g\)), the rate of utilisation (\(u\)), an the
expected growth rate (\(g_0\)) form a closed loop (or cycle) within the
system. For example, an increase in the growth rate of autonomous demand
increases consumption, which raises the rate of capacity utilisation,
growth, and the expected growth rate. In a second-round effect, the
increase in the growth rate then feeds back negatively into the
autonomous demand rate, which leads to a return of the rate of capacity
utilisation to its previous value.

\section{Analytical discussion}\label{analytical-discussion-6}

To find the short-run equilibrium solutions for \(u\) and \(g\), first
substitute Equation~\ref{eq-ssm_r}-Equation~\ref{eq-ssm_g} into
Equation~\ref{eq-ssm_u} and solve for \(u\): \[
u^* = \frac{g_0+z-g_1u_n}{s_r \pi-g_1}.
\] From this, we get: \[
g^* = g_0 + g_1(u^* - u_n).
\] The long-run equilibrium is given by \(u^{**}=u_n\), \(g^{**}=g_z\),
and (from Equation~\ref{eq-ssm_z}) \(z^{**}=u_n s_r \pi - g_z\).

The dynamics are governed by
Equation~\ref{eq-ssm_g0}-Equation~\ref{eq-ssm_z}. The Jacobian matrix
is: \[
J(g^0, z)=\begin{bmatrix} \frac{\mu g_1}{s_r\pi-g_1}& \frac{\mu g_1}{s_r\pi-g_1} \\ -z(\frac{g_1}{s_r\pi-g_1} +1)& \frac{-zg_1}{s_r\pi-g_1} \end{bmatrix}.
\]

The determinant of the Jacobian matrix evaluated at the long-run
equilibrium is: \[
det(J^*) = \frac{(u_n s_r \pi - g_z)\mu g_1}{s_r\pi-g_1} > 0,
\]

which is positive provided \(s_r\pi-g_1\), i.e.~if the Keynesian
stability condition holds.

The trace is:

\[
tr(J^*) = \frac{g_1(\mu-u_n s_r \pi + g_z)}{s_r\pi-g_1}.
\]

Stability requires a negative trace, yielding a second stability
condition: \(\mu<u_n s_r \pi - g_z\).

We can verify these analytical solutions by comparing them with the
results from the numerical solution:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct Jacobian matrix at the equilibrium }

\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{((mu}\SpecialCharTok{*}\NormalTok{g1)}\SpecialCharTok{/}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{g1), (mu}\SpecialCharTok{*}\NormalTok{g1)}\SpecialCharTok{/}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{g1),}
           \SpecialCharTok{{-}}\NormalTok{z[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{/}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{g1)), }\SpecialCharTok{{-}}\NormalTok{z[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{(g1}\SpecialCharTok{/}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{{-}}\NormalTok{g1))), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{J}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
       [,1]   [,2]
[1,]  0.200  0.200
[2,] -0.665 -0.475
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(values }\OtherTok{\textless{}{-}}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -0.1375+0.1381801i -0.1375-0.1381801i
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\FunctionTok{det}\NormalTok{(J) }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.038
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J)) }\CommentTok{\# trace}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -0.275
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check stability conditions for all scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Scenario "}\NormalTok{, i, }\StringTok{":"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(sr}\SpecialCharTok{*}\NormalTok{pi[i,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\textgreater{}}\NormalTok{g1) }\CommentTok{\# Keynesian stability condition}
\FunctionTok{print}\NormalTok{(mu}\SpecialCharTok{\textless{}}\NormalTok{sr}\SpecialCharTok{*}\NormalTok{un[i,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{pi[i,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{gz[i,}\DecValTok{1}\NormalTok{])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Scenario 1:"
[1] TRUE
[1] TRUE
[1] "Scenario 2:"
[1] TRUE
[1] TRUE
[1] "Scenario 3:"
[1] TRUE
[1] TRUE
[1] "Scenario 4:"
[1] TRUE
[1] TRUE
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Construct Jacobian matrix}
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [(mu }\OperatorTok{*}\NormalTok{ g1) }\OperatorTok{/}\NormalTok{ (sr }\OperatorTok{*}\NormalTok{ pi[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g1), (mu }\OperatorTok{*}\NormalTok{ g1) }\OperatorTok{/}\NormalTok{ (sr }\OperatorTok{*}\NormalTok{ pi[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g1)],}
\NormalTok{    [}\OperatorTok{{-}}\NormalTok{z[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (sr }\OperatorTok{*}\NormalTok{ pi[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (sr }\OperatorTok{*}\NormalTok{ pi[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g1)), }\OperatorTok{{-}}\NormalTok{z[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (g1 }\OperatorTok{/}\NormalTok{ (sr }\OperatorTok{*}\NormalTok{ pi[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ g1))]}
\NormalTok{])}
\BuiltInTok{print}\NormalTok{(J)}

\CommentTok{\# Obtain eigenvalues, determinant, and trace}

\NormalTok{eigenvalues, eigenvectors }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}
\BuiltInTok{print}\NormalTok{(eigenvalues)}

\NormalTok{determinant\_J }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\BuiltInTok{print}\NormalTok{(determinant\_J)}

\NormalTok{trace\_J }\OperatorTok{=}\NormalTok{ np.trace(J)}
\BuiltInTok{print}\NormalTok{(trace\_J)}

\CommentTok{\# Check stability conditions for all scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, S }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Scenario }\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{\}}\SpecialStringTok{:"}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(sr }\OperatorTok{*}\NormalTok{ pi[i }\OperatorTok{{-}} \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textgreater{}}\NormalTok{ g1)  }\CommentTok{\# Keynesian stability condition}
    \BuiltInTok{print}\NormalTok{(mu }\OperatorTok{\textless{}}\NormalTok{ sr }\OperatorTok{*}\NormalTok{ un[i }\OperatorTok{{-}} \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ pi[i }\OperatorTok{{-}} \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ gz[i }\OperatorTok{{-}} \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-10}

\chapter{A Malthusian Model}\label{sec-malthus}

\section{Overview}\label{overview-9}

This model captures some key feature of Thomas Malthus' theory of
population dynamics as developed in his 1798 book
\href{https://en.wikipedia.org/wiki/An_Essay_on_the_Principle_of_Population}{An
Essay on the Principle of Population}. The theory revolves around the
interaction between living standards and population growth.\footnote{See
  chapter 2 of Foley (2006) for an excellent introduction.} It assumes
that birth rates increase with rising living standards, while death
rates decline. Economic growth thus spurs population growth. However,
due to supply constraints in agricultural production, population growth
drives up food prices and thereby undermines real income, bringing
population growth to a halt. The model is adapted from
\href{https://karlwhelan.com/blog/?p=759}{Karl Whelan's lecture notes}.

\section{The Model}\label{the-model-9}

The following equations describe the model:

\begin{equation}\phantomsection\label{eq-malthus_N}{
N_t = N_{t-1} + B_{t-1} - D_{t-1} 
}\end{equation}

\begin{equation}\phantomsection\label{eq-malthus_B}{
\frac{B_{t}}{N_t} = b_0 + b_1Y_t 
}\end{equation}

\begin{equation}\phantomsection\label{eq-malthus_D}{
\frac{D_{t}}{N_t} = d_0 - d_1Y_t 
}\end{equation}

\begin{equation}\phantomsection\label{eq-malthus_Y}{
Y_t = a_0-a_1N_t 
}\end{equation}

where \(N_t\), \(B_t\), \(D_t\), and \(Y_t\) represent population,
number of births, number of deaths, and real income, respectively.

Equation~\ref{eq-malthus_N} describes population dynamics as driven by
births and deaths. Equation~\ref{eq-malthus_B} and
Equation~\ref{eq-malthus_D} the Malthusian hypothesis that birth rates
are positively and death rates negatively related to income.
Equation~\ref{eq-malthus_Y} makes real income a negative function of the
population, which captures the idea of supply constraints in
agriculture.

\section{Simulation}\label{simulation-9}

\subsection{Parameterisation}\label{parameterisation-9}

Table reports the parameterisation and initial values used in the
simulation. Besides a baseline (labelled as scenario 1), three further
scenarios will be considered. Scenario 2 models what Malthus called
preventative checks: a fall in the exogenous component of the birth rate
(\(b_0\)) due to an increased use of contraception, changes in marriage
norms etc. Scenario 3 models`positive checks': a rise in the sensitivity
of real income with respect to the population (\(a_1\)), capturing
factors such as increased food scarcity. Scenario 4 considers a rise in
the exogenous component of real income (\(a_0\)), which could be
interpreted as a productivity boost due to the invention of better
fertilisers. All scenarios initialise the population below its steady
state value at \(N_0=1\) and the other variables at their steady state
values.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0833}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(b_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(d_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(d_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(a_1\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 0.5 & 0.5 & 2.5 & 0.5 & 2.5 & 0.05 \\
2: fall in exog birth rate (\(b_0\)) & 0.4 & 0.5 & 2.5 & 0.5 & 2.5 &
0.05 \\
3: rise in sensitivity of income (\(a_1\)) & 0.5 & 0.5 & 2.5 & 0.5 & 2.5
& 0.07 \\
4: productivity boost (\(a_0\)) & 0.5 & 0.5 & 2.5 & 0.5 & 2.6 & 0.05 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-9}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{T}\OtherTok{=}\DecValTok{100}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{5}

\CommentTok{\# Create (S x T){-}matrices that will contain the simulated data}
\NormalTok{N}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# population}
\NormalTok{Y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# real income}
\NormalTok{B}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# births}
\NormalTok{D}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{0}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# deaths}
\NormalTok{N\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium population}
\NormalTok{Y\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium real income}
\NormalTok{B\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium births}
\NormalTok{D\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium deaths}

\CommentTok{\# Set baseline parameter values}
\NormalTok{b0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# Exogenous birth rate}
\NormalTok{b1}\OtherTok{=}\FloatTok{0.5} \CommentTok{\# Sensitivity of births with respect to real income}
\NormalTok{d0}\OtherTok{=}\FloatTok{2.5} \CommentTok{\# Exogenous death rate}
\NormalTok{d1}\OtherTok{=}\FloatTok{0.5} \CommentTok{\# Sensitivity of deaths with respect to real income}
\NormalTok{a0}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{2.5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\# Exogenous component of real income }
\NormalTok{a1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.05}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{T) }\CommentTok{\#Sensitivity of the real income with respect to population}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{b0[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{T]}\OtherTok{=}\FloatTok{0.4}  \CommentTok{\# scenario 2: reduction in birth rate}
\NormalTok{a1[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{T]}\OtherTok{=}\FloatTok{0.07} \CommentTok{\# scenario 3: increase in sensitivity of real income with respect to population}
\NormalTok{a0[}\DecValTok{4}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{T]}\OtherTok{=}\FloatTok{2.6}  \CommentTok{\# scenario 4: improvement in productivity}

\CommentTok{\# Initialise }
\NormalTok{N[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{Y[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{B[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{D[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}

\CommentTok{\# Simulate the model by looping over T time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{  }

  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{T)\{}
 
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }\CommentTok{\# run the model 1000{-}times in each period }
       
      \CommentTok{\# (1) Population dynamics    }
\NormalTok{      N[i,t] }\OtherTok{=}\NormalTok{ N[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ B[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ D[i,t}\DecValTok{{-}1}\NormalTok{]}
      
      \CommentTok{\# (2) Births}
\NormalTok{      B[i,t] }\OtherTok{=}\NormalTok{ (b0[i,t] }\SpecialCharTok{+}\NormalTok{ b1}\SpecialCharTok{*}\NormalTok{Y[i,t])}\SpecialCharTok{*}\NormalTok{N[i,t]}
      
      \CommentTok{\# (3) Deaths}
\NormalTok{      D[i,t] }\OtherTok{=}\NormalTok{ (d0 }\SpecialCharTok{{-}}\NormalTok{ d1}\SpecialCharTok{*}\NormalTok{Y[i,t])}\SpecialCharTok{*}\NormalTok{N[i,t]  }
      
      \CommentTok{\# (4) Real income}
\NormalTok{      Y[i,t] }\OtherTok{=}\NormalTok{ a0[i,t] }\SpecialCharTok{{-}}\NormalTok{ a1[i,t]}\SpecialCharTok{*}\NormalTok{N[i,t]   }
      
\NormalTok{    \}  }\CommentTok{\# close iterations loop }
\NormalTok{  \}    }\CommentTok{\# close time loop}
\NormalTok{\}      }\CommentTok{\# close scenario loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load relevant libraries}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{T }\OperatorTok{=} \DecValTok{100}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{5}

\CommentTok{\# Create (S x T){-}matrices that will contain the simulated data}
\NormalTok{N }\OperatorTok{=}\NormalTok{ np.zeros((S, T))  }\CommentTok{\# population}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ np.zeros((S, T))  }\CommentTok{\# real income}
\NormalTok{B }\OperatorTok{=}\NormalTok{ np.zeros((S, T))  }\CommentTok{\# births}
\NormalTok{D }\OperatorTok{=}\NormalTok{ np.zeros((S, T))  }\CommentTok{\# deaths}
\NormalTok{N\_eq }\OperatorTok{=}\NormalTok{ np.zeros((S))  }\CommentTok{\# equilibrium population}
\NormalTok{Y\_eq }\OperatorTok{=}\NormalTok{ np.zeros((S))  }\CommentTok{\# equilibrium real income}
\NormalTok{B\_eq }\OperatorTok{=}\NormalTok{ np.zeros((S))  }\CommentTok{\# equilibrium births}
\NormalTok{D\_eq }\OperatorTok{=}\NormalTok{ np.zeros((S))  }\CommentTok{\# equilibrium deaths}

\CommentTok{\# Set baseline parameter values}
\NormalTok{b0 }\OperatorTok{=}\NormalTok{ np.zeros((S, T)) }\OperatorTok{+} \FloatTok{0.5}  \CommentTok{\# Exogenous birth rate}
\NormalTok{b1 }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# Sensitivity of births with respect to real income}
\NormalTok{d0 }\OperatorTok{=} \FloatTok{2.5}  \CommentTok{\# Exogenous death rate}
\NormalTok{d1 }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# Sensitivity of deaths with respect to real income}
\NormalTok{a0 }\OperatorTok{=}\NormalTok{ np.zeros((S, T)) }\OperatorTok{+} \FloatTok{2.5}  \CommentTok{\# Exogenous component of real income}
\NormalTok{a1 }\OperatorTok{=}\NormalTok{ np.zeros((S, T)) }\OperatorTok{+} \FloatTok{0.05}  \CommentTok{\# Sensitivity of the real income with respect to population}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{b0[}\DecValTok{1}\NormalTok{, s:T] }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# scenario 2: reduction in birth rate}
\NormalTok{a1[}\DecValTok{2}\NormalTok{, s:T] }\OperatorTok{=} \FloatTok{0.07}  \CommentTok{\# scenario 3: increase in sensitivity of real income with respect to population}
\NormalTok{a0[}\DecValTok{3}\NormalTok{, s:T] }\OperatorTok{=} \FloatTok{2.6}  \CommentTok{\# scenario 4: improvement in productivity}

\CommentTok{\# Initialise }
\NormalTok{N[:,}\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{Y[:,}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ Y\_eq[}\DecValTok{0}\NormalTok{]}
\NormalTok{B[:,}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ B\_eq[}\DecValTok{0}\NormalTok{]}
\NormalTok{D[:,}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ D\_eq[}\DecValTok{0}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over T time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):  }
  \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, T):}
    \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{): }\CommentTok{\# run the model 1000{-}times in each period (to make sure the order of equations doesn\textquotesingle{}t matter)}
      \CommentTok{\# (1) Population dynamics    }
\NormalTok{      N[i,t] }\OperatorTok{=}\NormalTok{ N[i,t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ B[i,t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ D[i,t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
      \CommentTok{\# (2) Births}
\NormalTok{      B[i,t] }\OperatorTok{=}\NormalTok{ (b0[i,t] }\OperatorTok{+}\NormalTok{ b1}\OperatorTok{*}\NormalTok{Y[i,t])}\OperatorTok{*}\NormalTok{N[i,t]}
      \CommentTok{\# (3) Deaths}
\NormalTok{      D[i,t] }\OperatorTok{=}\NormalTok{ (d0 }\OperatorTok{{-}}\NormalTok{ d1}\OperatorTok{*}\NormalTok{Y[i,t])}\OperatorTok{*}\NormalTok{N[i,t]  }
      \CommentTok{\# (4) Real income}
\NormalTok{      Y[i,t] }\OperatorTok{=}\NormalTok{ a0[i,t] }\OperatorTok{{-}}\NormalTok{ a1[i,t]}\OperatorTok{*}\NormalTok{N[i,t]   }
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-9}

Figure 1 displays population and real income dynamics for the baseline
scenario. Starting from a below-equilibrium level of population, the
population initially grows rapidly (seemingly exponentially) but then
approaches a steady state. During the adjustment phase, real income is
driven down to its steady state level (which can be interpreted as the
subsistence level). Figure 2 displays the corresponding dynamics of
births and deaths.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{20}

\DocumentationTok{\#\# Baseline}
\CommentTok{\#Population and real income}
\FunctionTok{plot}\NormalTok{(N[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 1: Population and real income, baseline"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\DecValTok{20}\NormalTok{]),}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax])))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\DecValTok{15}\NormalTok{, }\FloatTok{2.3}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"N"}\NormalTok{, }\StringTok{"Y"}\NormalTok{),}
        \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_malthusian_model_files/figure-pdf/malthus2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Births and deaths}
\FunctionTok{plot}\NormalTok{(B[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 2: Births and deaths, baseline"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(D[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"B"}\NormalTok{, }\StringTok{"D"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_malthusian_model_files/figure-pdf/malthus2-2.pdf}

Figure 3 displays population dynamics under the different scenarios
described in Table 1. As expected, both preventative and positive checks
are effective: a fall in the exogenous component of the birth rate and
an increase in the sensitivity of real income slow down population
dynamics and lower its steady state value. By contrast, a productivity
boost allows for a higher equilibrium level of population.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Population dynamics under different scenarios}
\FunctionTok{plot}\NormalTok{(N[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(N[}\DecValTok{4}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 3: Population dynamics under different scenarios"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(N[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(N[}\DecValTok{3}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(N[}\DecValTok{4}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{4}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{,}\StringTok{"2: fall in exog birth rate"}\NormalTok{, }\StringTok{"3: rise in sensitivity of income"}\NormalTok{,}
      \StringTok{"4: productivity boost"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_malthusian_model_files/figure-pdf/malthus3-1.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Plots (here for population and real income only)}

\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set maximum period for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{20}

\CommentTok{\#\# Baseline}
\CommentTok{\# Population and real income}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots()}
\NormalTok{ax1.plot(N[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:(Tmax}\OperatorTok{+}\DecValTok{1}\NormalTok{)], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}solid\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax1.set\_xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}
\NormalTok{ax2.plot(Y[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:Tmax], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dashed\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax2.set\_ylabel(}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{lines, labels }\OperatorTok{=}\NormalTok{ ax1.get\_legend\_handles\_labels() }\CommentTok{\#collect legend in one box}
\NormalTok{lines2, labels2 }\OperatorTok{=}\NormalTok{ ax2.get\_legend\_handles\_labels()}
\NormalTok{ax2.legend(lines }\OperatorTok{+}\NormalTok{ lines2, labels }\OperatorTok{+}\NormalTok{ labels2, loc}\OperatorTok{=}\DecValTok{5}\NormalTok{)}
\NormalTok{plt.show()  }
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-9}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 6 variables: N, B, D, Y, b0, a0,}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
              \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"N"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"Y"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(b[}\DecValTok{0}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(a[}\DecValTok{0}\NormalTok{]))}

\CommentTok{\# Plot directed graph matrix}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Figure 4: Directed graph of Malthusian model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_malthusian_model_files/figure-pdf/malthus4-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]

\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\#Construct auxiliary Jacobian matrix for 6 variables: N, B, D, Y, b0, a0}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"N"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"B"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"D"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"Y"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{"$b\_0$"}\NormalTok{, }\DecValTok{5}\NormalTok{: }\StringTok{"$a\_0$"}\NormalTok{\}}

\CommentTok{\# Plot the graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{500}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{12}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}
\NormalTok{plt.axis(}\StringTok{"off"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Figure 4: Directed graph of Malthusian model"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure 4, it can be seen that the exogenous birth rate (\(b0\)) and
productivity (\(a0\)) are exogenous variables that impact births and
income, respectively. Births, deaths, employment and income are
endogenous and form a closed loop (or cycle) within the system. Births
and deaths affect the population size (with simultaneous feedback from
population to births and deaths), and the population affects income.
Income, in turn, feeds back into population size.

\section{Analytical discussion}\label{analytical-discussion-7}

To find the steady state solution for \(N\), substitute
Equation~\ref{eq-malthus_B} - Equation~\ref{eq-malthus_Y} into
Equation~\ref{eq-malthus_N} and collect terms::

\begin{equation}\phantomsection\label{eq-malthus_N_reduced}{
N_t = N_{t-1}[1+b_0-d_0+a_0(b_1+d_1)] - N_{t-1}^2 [a_1(b_1+d_1)].
}\end{equation}

Subtract \(N_{t-1}\) and divide through by \(N_{t-1}\): \[
\frac{N_t - N_{t-1}}{N_{t-1}} = [b_0-d_0+a_0(b_1+d_1)] - N_{t-1} [a_1(b_1+d_1)].
\]

Set \(\frac{N_t - N_{t-1}}{N_t{t-1}}=0\) and solve for \(N_{t}\) to find
the non-trivial steady state:\footnote{A trivial steady state is at
  \(N^*=0\).} \[
N^* = \frac{b_0-d_0+a_0(b_1+d_1)}{a_1(b_1+d_1)}.
\]

Substitution of \(N^*\) into Equation~\ref{eq-malthus_Y} and simplifying
yields: \[
Y^* = \frac{d_0-b_0}{b_1+d_1}.
\]

Finally, to assess the dynamic stability of the model, differentiate
Equation~\ref{eq-malthus_N_reduced} with respect to \(N_{t-1}\): \[
\frac{\partial N_t}{\partial N_{t-1}} = 1+b_0-d_0+a_0(b_1+d_1)-2N_{t-1}[a_1(b_1+d_1)].
\]

Due to then non-linearity of the model, stability can only be assessed
locally around the steady state. To do this, substitute the steady state
solution and simplify: \[
\frac{\partial N_t}{\partial N_{t-1}} = 1-b_0+d_0-a_0(b_1+d_1).
\] From this, we can conclude that the steady state is stable iff: \[
 |1-b_0+d_0-a_0(b_1+d_1)| < 1.
\]

We can verify these analytical solutions by comparing them with the
results from the numerical solution:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate analytical equilibrium solutions }
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\NormalTok{N\_eq[i]}\OtherTok{=}\NormalTok{(b0[i,T]}\SpecialCharTok{{-}}\NormalTok{d0}\SpecialCharTok{+}\NormalTok{a0[i,T]}\SpecialCharTok{*}\NormalTok{(b1}\SpecialCharTok{+}\NormalTok{d1))}\SpecialCharTok{/}\NormalTok{(a1[i,T]}\SpecialCharTok{*}\NormalTok{(b1}\SpecialCharTok{+}\NormalTok{d1))}
\NormalTok{Y\_eq[i]}\OtherTok{=}\NormalTok{(d0}\SpecialCharTok{{-}}\NormalTok{b0[i,T])}\SpecialCharTok{/}\NormalTok{(b1}\SpecialCharTok{+}\NormalTok{d1)}
\NormalTok{B\_eq[i]}\OtherTok{=}\NormalTok{(b0[i,T] }\SpecialCharTok{+}\NormalTok{ b1}\SpecialCharTok{*}\NormalTok{Y\_eq[i])}\SpecialCharTok{*}\NormalTok{N\_eq[i]}
\NormalTok{D\_eq[i]}\OtherTok{=}\NormalTok{(d0 }\SpecialCharTok{{-}}\NormalTok{ d1}\SpecialCharTok{*}\NormalTok{Y\_eq[i])}\SpecialCharTok{*}\NormalTok{N\_eq[i]}
\NormalTok{\}}

\CommentTok{\# Compare with numerical solutions (here for the example of Y, scenario1)}
\NormalTok{Y\_eq[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y[}\DecValTok{1}\NormalTok{,T]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Scenario "}\NormalTok{, i, }\StringTok{":"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(}\FunctionTok{abs}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{b0[i,T]}\SpecialCharTok{+}\NormalTok{d0}\SpecialCharTok{{-}}\NormalTok{a0[i,T]}\SpecialCharTok{*}\NormalTok{(b1}\SpecialCharTok{+}\NormalTok{d1)) }\SpecialCharTok{\textless{}} \DecValTok{1}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Scenario 1:"
[1] TRUE
[1] "Scenario 2:"
[1] TRUE
[1] "Scenario 3:"
[1] TRUE
[1] "Scenario 4:"
[1] TRUE
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Calculate analytical equilibrium solutions }
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
\NormalTok{  N\_eq[i] }\OperatorTok{=}\NormalTok{ (b0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ d0 }\OperatorTok{+}\NormalTok{ a0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (b1 }\OperatorTok{+}\NormalTok{ d1)) }\OperatorTok{/}\NormalTok{ (a1[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (b1 }\OperatorTok{+}\NormalTok{ d1))}
\NormalTok{  Y\_eq[i] }\OperatorTok{=}\NormalTok{ (d0 }\OperatorTok{{-}}\NormalTok{ b0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (b1 }\OperatorTok{+}\NormalTok{ d1)}
\NormalTok{  B\_eq[i] }\OperatorTok{=}\NormalTok{ (b0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ b1 }\OperatorTok{*}\NormalTok{ Y\_eq[i]) }\OperatorTok{*}\NormalTok{ N\_eq[i]}
\NormalTok{  D\_eq[i] }\OperatorTok{=}\NormalTok{ (d0 }\OperatorTok{{-}}\NormalTok{ d1 }\OperatorTok{*}\NormalTok{ Y\_eq[i]) }\OperatorTok{*}\NormalTok{ N\_eq[i]}
  
\CommentTok{\# Compare with numerical solutions (here for the example of Y, scenario1)}
\BuiltInTok{print}\NormalTok{(Y\_eq[}\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(Y[}\DecValTok{0}\NormalTok{,T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}

\CommentTok{\# Check stability condition for all scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Scenario }\SpecialCharTok{\{}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\SpecialCharTok{\}}\SpecialStringTok{:"}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(}\BuiltInTok{abs}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ b0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ d0 }\OperatorTok{{-}}\NormalTok{ a0[i, T}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (b1 }\OperatorTok{+}\NormalTok{ d1)) }\OperatorTok{\textless{}} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-11}

\chapter{A Ricardian One-Sector Model}\label{sec-ricardo_1}

\section{Overview}\label{overview-10}

This model captures some key feature of David Ricardo's theory of growth
and distribution as developed in his 1817 book
\href{https://en.wikipedia.org/wiki/On_the_Principles_of_Political_Economy_and_Taxation}{On
the Principles of Political Economy and Taxation}. The model revolves
around the determination of real wages, rents, and profits, and how
profitability in turn drives capital accumulation.\footnote{See chapter
  2 of Foley (2006) for an excellent introduction.} It assumes a corn
economy with a single good (corn) that serves both as an investment and
consumption good.\footnote{See Chapter~\ref{sec-ricardo_2} for a
  two-sector extension of the model.} Corn production is subject to
diminishing marginal returns. Real wages are driven down to a
subsistence level and rent is a differential surplus landowners gain
based on the fertility of their land relative to the marginal plot of
land (the plot of land where fertility is lowest and no rent is earned).
Profits are a residual. As employment increases and more land is
utilised, marginal productivity falls and differential rents increase.
As a result, profits are driven down and capital accumulation comes to a
halt. A stationary state is reached. Landowners are the main
beneficiaries of this process. The model is adapted from Pasinetti
(1960).

\section{The Model}\label{the-model-10}

The following equations describe the model:

\begin{equation}\phantomsection\label{eq-ricardo1_Y}{
Y_t=AN_t^a
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_W}{
W_t=K_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_w}{
w_t =W_t/N_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_MPL}{
MPL_t =\frac{\partial Y_t}{\partial N_t} =aAN_t^{a-1}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_R}{
R_t = Y_t - N_tMPL_t 
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_P}{
P_t = Y_t - R_t - N_tw_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_K}{
K_t = K_{t-1} + \beta P_{t-1} 
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo1_N}{
N_t = N_{t-1} + \gamma (w_{t-1} - w^S)
}\end{equation}

where \(Y_t\), \(A\), \(N_t\), \(W_t\), \(K_t\),\(w_t\), \(Y_t\),
\(MPL_t\), \(R_t\), \(P_t\), and \(w^S\) are real output (measured in
units of corn), productivity, employment, the real wage bill (or wage
fund), the capital stock, the real wage rate, the marginal product of
labour, rents, profits, and the subsistence wage, respectively.

Equation~\ref{eq-ricardo1_Y} is the production function with
\(\alpha \in (0,1)\), i.e.~exhibiting diminishing marginal returns to
labour.\footnote{Pasinetti (1960) specifies a generic function
  \(f(N_t)\) with \(f(0) \geq\) 0, \(f'(0) > w^*\), and
  \(f''(N_t) < 0\). Equation~\ref{eq-ricardo1_Y} satisfies these
  conditions.} By Equation~\ref{eq-ricardo1_W}, the wage fund is defined
as the capital stock of this model (reflecting the fact that the
production of corn only involves labour). Equation~\ref{eq-ricardo1_w}
defines the real wage rate. Equation~\ref{eq-ricardo1_w} specifies the
marginal product of labour. Equation~\ref{eq-ricardo1_R} captures the
determination of (differential) rents as a negative function of the
marginal product of labour.\footnote{Equation~\ref{eq-ricardo1_R} is
  based on the definition of total rent as the sum of the net gains of
  the non-marginal landowners. See Pasinetti (1960) for a formal
  derivation.} Thus, the lower the productivity on the marginal land,
the higher the rents. In Equation~\ref{eq-ricardo1_P}, profits are
determined residually. Capital accumulation in
Equation~\ref{eq-ricardo1_K} is driven by the reinvestment of profits
(with \(\beta\) determining the proportion of profits that are
reinvested). Finally, Equation~\ref{eq-ricardo1_N} specifies population
dynamics, whereby the population increases whenever the actual real wage
is above the subsistence wage, echoing the Malthusian population
mechanism.

\section{Simulation}\label{simulation-10}

\subsection{Parameterisation}\label{parameterisation-10}

Table 1 reports the parameterisation and initial values used in the
simulation. In line with the Classical tradition, it will be assumed
that all profits are reinvested, i.e.~\(\beta=1\). Besides a baseline
(labelled as scenario 1), three further scenarios will be considered.
Scenarios 2 and 3 model two different forms of technological change: an
increase in the productivity parameter \(A\) and an increase in the
elasticity of output with respect to labour (\(a\)). Scenario 4
considers a higher subsistence wage (\(w^S\)). In all scenarios the
population/employment is initialised below its equilibrium value.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}llll@{}}
\toprule\noalign{}
Scenario & \(A\) & \(a\) & \(w^S\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 2 & 0.7 & 0.5 \\
2: productivity boost I (\(A\)) & 3 & 0.7 & 0.5 \\
3: productivity boost II (\(a\)) & 2 & 0.75 & 0.5 \\
4: higher subsistence wage (\(w^S\)) & 2 & 0.7 & 0.7 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-10}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{500}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{20}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Income/output}
\NormalTok{R}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Rent}
\NormalTok{P}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Profits}
\NormalTok{N}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# employment}
\NormalTok{w}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# real wage}
\NormalTok{K}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# capital stock}
\NormalTok{MPL}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# marginal product of labour}
\NormalTok{W}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# wage bill}
\NormalTok{N\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium population}
\NormalTok{K\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium capital}

\CommentTok{\# Set baseline parameter values}
\NormalTok{A}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{2}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# productivity}
\NormalTok{a}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.7}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# labour elasticity of output}
\NormalTok{beta}\OtherTok{=}\DecValTok{1} \CommentTok{\# Sensitivity of investment with respect to profits}
\NormalTok{gamma}\OtherTok{=}\DecValTok{5} \CommentTok{\# adjustment speed of population}
\NormalTok{wS}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# subsistence wage rate}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{3} \CommentTok{\# scenario 2: productivity boost I}
\NormalTok{a[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.75} \CommentTok{\# scenario 3: productivity boost II}
\NormalTok{wS[}\DecValTok{4}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# scenario 4: increase in subsistence wage}

\CommentTok{\# Initialise variables such that employment and the capital stock are below the equilibrium}
\NormalTok{N[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{K[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}   
\NormalTok{Y[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{A[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{N[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(a[,}\DecValTok{1}\NormalTok{])}
\NormalTok{MPL[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{a[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{A[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(N[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(a[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}
\NormalTok{w[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{wS[,}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }\CommentTok{\# run the model 1000{-}times in each period}
      
    \CommentTok{\#Model equations}
    
    \CommentTok{\#(1) Output}
\NormalTok{    Y[i,t] }\OtherTok{=}\NormalTok{ A[i,t]}\SpecialCharTok{*}\NormalTok{N[i,t]}\SpecialCharTok{\^{}}\NormalTok{(a[i,t])}
    
    \CommentTok{\#(2) Wage bill}
\NormalTok{    W[i,t] }\OtherTok{=}\NormalTok{ K[i,t] }
    
    \CommentTok{\#(3) Real wage rate}
\NormalTok{    w[i,t] }\OtherTok{=}\NormalTok{ W[i,t]}\SpecialCharTok{/}\NormalTok{N[i,t] }
     
    \CommentTok{\#(4) Marginal product of labour}
\NormalTok{    MPL[i,t] }\OtherTok{=}\NormalTok{ a[i,t]}\SpecialCharTok{*}\NormalTok{A[i,t]}\SpecialCharTok{*}\NormalTok{(N[i,t]}\SpecialCharTok{\^{}}\NormalTok{(a[i,t]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}

    \CommentTok{\#(5) Rents}
\NormalTok{    R[i,t] }\OtherTok{=}\NormalTok{ Y[i,t] }\SpecialCharTok{{-}}\NormalTok{ N[i,t]}\SpecialCharTok{*}\NormalTok{MPL[i,t]}
    
    \CommentTok{\#(6) Profits}
\NormalTok{    P[i,t] }\OtherTok{=}\NormalTok{ Y[i,t]}\SpecialCharTok{{-}}\NormalTok{ R[i,t] }\SpecialCharTok{{-}}\NormalTok{ N[i,t]}\SpecialCharTok{*}\NormalTok{w[i,t]}
    
    \CommentTok{\# (7) Capital accumulation}
\NormalTok{    K[i,t] }\OtherTok{=}\NormalTok{ K[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ beta}\SpecialCharTok{*}\NormalTok{P[i,t}\DecValTok{{-}1}\NormalTok{]}
    
    \CommentTok{\#(8) Employment/population dynamics  }
\NormalTok{    N[i,t] }\OtherTok{=}\NormalTok{ N[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ gamma}\SpecialCharTok{*}\NormalTok{(w[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ wS[i,t}\DecValTok{{-}1}\NormalTok{])}
    
\NormalTok{    \} }\CommentTok{\# close iterations loop}
\NormalTok{  \}   }\CommentTok{\# close time loop}
\NormalTok{\}     }\CommentTok{\# close scenario loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{500}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{20}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Income/output}
\NormalTok{R }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Rent}
\NormalTok{P }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Profits}
\NormalTok{N }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# employment}
\NormalTok{w }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# real wage}
\NormalTok{K }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# capital stock}
\NormalTok{MPL }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# marginal product of labour}
\NormalTok{W }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# wage bill}

\CommentTok{\# Set baseline parameter values}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.ones((S, Q)) }\OperatorTok{*} \DecValTok{2}  \CommentTok{\# productivity}
\NormalTok{a }\OperatorTok{=}\NormalTok{ np.ones((S, Q)) }\OperatorTok{*} \FloatTok{0.7}  \CommentTok{\# labour elasticity of output}
\NormalTok{beta }\OperatorTok{=} \DecValTok{1}  \CommentTok{\# Sensitivity of investment with respect to profits}
\NormalTok{gamma }\OperatorTok{=} \DecValTok{5}  \CommentTok{\# adjustment speed of population}
\NormalTok{wS }\OperatorTok{=}\NormalTok{ np.ones((S, Q)) }\OperatorTok{*} \FloatTok{0.5}  \CommentTok{\# subsistence wage rate}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A[}\DecValTok{1}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{3}  \CommentTok{\# scenario 2: productivity boost I}
\NormalTok{a[}\DecValTok{2}\NormalTok{, s:Q] }\OperatorTok{=} \FloatTok{0.75}  \CommentTok{\# scenario 3: productivity boost II}
\NormalTok{wS[}\DecValTok{3}\NormalTok{, s:Q] }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# scenario 4: increase in subsistence wage}

\CommentTok{\# Initialise variables such that employment and the capital stock are below the equilibrium}
\NormalTok{N[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{K[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{Y[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ A[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ N[:, }\DecValTok{0}\NormalTok{]}\OperatorTok{**}\NormalTok{(a[:, }\DecValTok{0}\NormalTok{])}
\NormalTok{MPL[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ a[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ (N[:, }\DecValTok{0}\NormalTok{]}\OperatorTok{**}\NormalTok{(a[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}} \DecValTok{1}\NormalTok{))}
\NormalTok{w[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ wS[:, }\DecValTok{0}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):  }\CommentTok{\# run the model 1000 times in each period}
            \CommentTok{\# Model equations}
            \CommentTok{\# (1) Output}
\NormalTok{            Y[i, t] }\OperatorTok{=}\NormalTok{ A[i, t] }\OperatorTok{*}\NormalTok{ N[i, t]}\OperatorTok{**}\NormalTok{(a[i, t])}
            \CommentTok{\# (2) Wage bill}
\NormalTok{            W[i, t] }\OperatorTok{=}\NormalTok{ K[i, t]}
            \CommentTok{\# (3) Real wage rate}
\NormalTok{            w[i, t] }\OperatorTok{=}\NormalTok{ W[i, t] }\OperatorTok{/}\NormalTok{ N[i, t]}
            \CommentTok{\# (4) Marginal product of labour}
\NormalTok{            MPL[i, t] }\OperatorTok{=}\NormalTok{ a[i, t] }\OperatorTok{*}\NormalTok{ A[i, t] }\OperatorTok{*}\NormalTok{ (N[i, t]}\OperatorTok{**}\NormalTok{(a[i, t] }\OperatorTok{{-}} \DecValTok{1}\NormalTok{))}
            \CommentTok{\# (5) Rents}
\NormalTok{            R[i, t] }\OperatorTok{=}\NormalTok{ Y[i, t] }\OperatorTok{{-}}\NormalTok{ N[i, t] }\OperatorTok{*}\NormalTok{ MPL[i, t]}
            \CommentTok{\# (6) Profits}
\NormalTok{            P[i, t] }\OperatorTok{=}\NormalTok{ Y[i, t] }\OperatorTok{{-}}\NormalTok{ R[i, t] }\OperatorTok{{-}}\NormalTok{ N[i, t] }\OperatorTok{*}\NormalTok{ w[i, t]}
            \CommentTok{\# (7) Capital accumulation}
\NormalTok{            K[i, t] }\OperatorTok{=}\NormalTok{ K[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ P[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}
            \CommentTok{\# (8) Employment/population dynamics}
\NormalTok{            N[i, t] }\OperatorTok{=}\NormalTok{ N[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (w[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ wS[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-10}

Figure 1 displays employment, capital accumulation, and income for the
baseline scenario. Starting from a below-equilibrium level of
population, the economy grows in terms of output, capital, and
employment but then approaches what Ricardo famously called a
`stationary state'. Figure 2 shows that during the adjustment phase, the
MPL declines reflecting diminishing marginal returns in the production
of corn. This captures the idea that a growing economy will have to
utilise less fertile lands. The real wage is initially below the MPL,
allowing for profits. Over time, the MPL and actual real wage converge
to the exogenously given subsistence wage. Figure 3 shows that profits
initially increase but are then squeezed to zero as differential rents
increase.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{280}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{10}

\DocumentationTok{\#\# Baseline}
\CommentTok{\#Employment, capital accumulation, and income}
\FunctionTok{plot}\NormalTok{(N[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 1: Employment, capital accumulation, and income"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)]),}\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)])))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"K, Y"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"N"}\NormalTok{, }\StringTok{"K"}\NormalTok{, }\StringTok{"Y"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_one_sector_model_files/figure-pdf/ricardo1_2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Real wage, subsistence wage, and MPL}
\FunctionTok{plot}\NormalTok{(w[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(wS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],w[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 2: Real wage, marginal product of labour, and subsistence wage"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(MPL[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(wS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"w"}\NormalTok{, }\StringTok{"MPL"}\NormalTok{, }\StringTok{"wS"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_one_sector_model_files/figure-pdf/ricardo1_2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Profits and Rents}
\FunctionTok{plot}\NormalTok{(P[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(P[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 3: Profits and rents"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(R[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"P"}\NormalTok{, }
     \AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(R[}\DecValTok{1}\NormalTok{, }\DecValTok{3}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{) }
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(R[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)])))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"R"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"P"}\NormalTok{, }\StringTok{"R"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_one_sector_model_files/figure-pdf/ricardo1_2-3.pdf}

Figure 4 displays capital accumulation under the different scenarios
described in Table 1. As expected, both forms of technical change boost
both the speed of capital accumulation and the equilibrium level of
capital. An increase in the subsistence wage reduces the pace of capital
accumulation and leads to a lower equilibrium level of capital.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Different scenarios}
\CommentTok{\# Capital accumulation}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{Tmax], K[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 4: Capital accumulation under different scenarios"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{4}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{,}\StringTok{"2: product. boost I"}\NormalTok{, }\StringTok{"3: product. boost II"}\NormalTok{, }\StringTok{"4: higher subs. wage"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_one_sector_model_files/figure-pdf/ricardo1_3-1.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\# Plots (here for employment, capital accumulation, and income only)}

\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{280}
\NormalTok{Tmin }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Baseline}
\CommentTok{\# Employment, capital accumulation, and income}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots()}
\NormalTok{ax1.plot(N[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:(Tmax}\OperatorTok{+}\DecValTok{1}\NormalTok{)], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}solid\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}

\NormalTok{ax1.set\_xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}
\NormalTok{ax2.plot(K[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:Tmax], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dashed\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax2.plot(Y[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:Tmax], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dotted\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax2.set\_ylabel(}\StringTok{\textquotesingle{}Y, K\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{lines, labels }\OperatorTok{=}\NormalTok{ ax1.get\_legend\_handles\_labels() }\CommentTok{\#collect legend in one box}
\NormalTok{lines2, labels2 }\OperatorTok{=}\NormalTok{ ax2.get\_legend\_handles\_labels()}
\NormalTok{ax2.legend(lines }\OperatorTok{+}\NormalTok{ lines2, labels }\OperatorTok{+}\NormalTok{ labels2, loc}\OperatorTok{=}\DecValTok{5}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Figure 1: Employment, capital accumulation, and income"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-10}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 10 variables: Y W w MPL R P K N A wS,}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{10}\NormalTok{,}\DecValTok{10}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create and plot directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"W"}\NormalTok{, }\StringTok{"w"}\NormalTok{, }\StringTok{"MPL"}\NormalTok{, }\StringTok{"R"}\NormalTok{, }\StringTok{"P"}\NormalTok{, }\StringTok{"K"}\NormalTok{, }\StringTok{"N"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(w}\SpecialCharTok{\^{}}\NormalTok{S))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Figure 5: Directed graph of Ricardian One{-}Sector Model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_one_sector_model_files/figure-pdf/ricardo1_4-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create directed graph}

\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Construct auxiliary Jacobian matrix for 10 variables: Y W w MPL R P K N A wS,}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]}
\NormalTok{])}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{\textquotesingle{}W\textquotesingle{}}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{\textquotesingle{}w\textquotesingle{}}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{\textquotesingle{}MPL\textquotesingle{}}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{\textquotesingle{}R\textquotesingle{}}\NormalTok{, }\DecValTok{5}\NormalTok{: }\StringTok{\textquotesingle{}P\textquotesingle{}}\NormalTok{, }\DecValTok{6}\NormalTok{: }\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\DecValTok{7}\NormalTok{: }\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\DecValTok{8}\NormalTok{: }\StringTok{\textquotesingle{}A\textquotesingle{}}\NormalTok{, }\DecValTok{9}\NormalTok{: }\StringTok{\textquotesingle{}wS\textquotesingle{}}\NormalTok{\}}

\CommentTok{\# Plot the graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{500}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{12}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}
\NormalTok{plt.axis(}\StringTok{"off"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Figure 5: Directed graph of Ricardian One{-}Sector Model"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure 5, it can be seen that productivity (\(A\)) and the
subsistence wage (\(w^S\)) are the key exogenous variables that impact
income and the marginal product of labour, and population dynamics,
respectively. Most other variables are endogenous and form a closed loop
(or cycle) within the system. Profits are a residual. The directed graph
illustrates the supply-driven nature of the model, where productivity
determines employment and distribution, which in turn feed back into
income and capital accumulation. At the same time, income distribution
has an exogenous element in the form of the subsistence wage, which
feeds into the system.

\section{Analytical discussion}\label{analytical-discussion-8}

To analyse the dynamics, combine Equation~\ref{eq-ricardo1_Y} to
Equation~\ref{eq-ricardo1_P} and substitute into
Equation~\ref{eq-ricardo1_K}. Further use Equation~\ref{eq-ricardo1_W}
and Equation~\ref{eq-ricardo1_w} in Equation~\ref{eq-ricardo1_N}. This
yields the two-dimensional dynamic system in \(K_t\) and \(N_t\):

\[
K_t = (1-\beta)K_{t-1}+\beta(aA N_{t-1}^a )
\] \[
N_t = N_{t-1} +\gamma\left(\frac{K_{t-1}}{N_{t-1}} -w^S\right) 
\] The Jacobian matrix is given by: \[
J(K, N)=\begin{bmatrix} 1-\beta& \beta a^2AN^{\alpha-1} \\\frac{\gamma}{N} & 1-\frac{\gamma K}{N^2} \end{bmatrix}.
\]

From equations Equation~\ref{eq-ricardo1_K} and
Equation~\ref{eq-ricardo1_N}, it can readily be seen that an equilibrium
is reached when \[
P^*=0
\] and \[
w^*=w^S.
\] Using \(P^*=0\) with Equation~\ref{eq-ricardo1_R} and
Equation~\ref{eq-ricardo1_P}, yields \(w^*=w^S=MPL\). Thus, in
equilibrium, profits are zero, and the real wage is equal to the MPL and
the subsistence wage. Setting \(K_t=K_{t-1}\) and \(N_t=N_{t-1}\), we
can further derive:

\[
K^*=aA\left(\frac{w^S}{aA}\right)^{-\frac{a}{1-a}}
\] and

\[
N^*=\left(\frac{w^S}{aA}\right)^{-\frac{1}{1-a}}
\] With this, we can evaluate the Jacobian at the steady state: \[
J(K^*, N^*)=\begin{bmatrix} 1-\beta & \beta a w^S \\ \gamma \left(\frac{w^S}{aA}\right)^{\frac{1}{1-a}} & 1-\gamma aA \left(\frac{w^S}{aA}\right)^{\frac{2-a}{1-a}} 
\end{bmatrix}.
\] For the system to be stable, both eigenvalues of the Jacobian need to
be inside the unit circle. This requires the following three conditions
to hold:

\[
1+tr(J)+det(J)>0
\] \[
1-tr(J)+det(J)>0
\] \[
1-det(J)>0,
\] where \(tr(J)\) is the trace and \(det(J)\) is the determinant of the
Jacobian.

Let us consider the Classical case where \(\beta=1\), i.e.~all profits
are reinvested. Then we have

\[
det(J)=-aw^S \gamma \left(\frac{w^S}{aA}\right)^{\frac{1}{1-a}}<0,
\] so that the third condition is always satisfied and it is the first
one that is binding. The first condition then becomes

\[
2-\gamma a \left[ A \left(\frac{w^S}{aA}\right)^{\frac{2-a}{1-a}} + w^S\left(\frac{w^S}{aA}\right)^{\frac{1}{1-a}} \right]>0
\]

We can check the analytical solutions and stability conditions
numerically:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate equilibrium solutions}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\NormalTok{  N\_eq[i]}\OtherTok{=}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(a[i,Q]}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[i,Q]))}
\NormalTok{  K\_eq[i]}\OtherTok{=}\NormalTok{a[i,Q]}\SpecialCharTok{*}\NormalTok{A[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(a[i,Q]}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a[i,Q]}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[i,Q]))}
\NormalTok{\}}

\CommentTok{\# Compare with numerical solutions (here only for baseline)}
\NormalTok{N\_eq[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 30.94046
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{N[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 30.94031
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K\_eq[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 15.47023
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 15.47018
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Examine model properties (here for the baseline scenario only)}
\CommentTok{\# Construct Jacobian matrix at the equilibrium }
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta, beta}\SpecialCharTok{*}\NormalTok{a[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{wS[}\DecValTok{1}\NormalTok{,Q],}
\NormalTok{           beta}\SpecialCharTok{*}\NormalTok{(wS[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{/}\NormalTok{(a[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[}\DecValTok{1}\NormalTok{,Q])),}
           \DecValTok{1}\SpecialCharTok{{-}}\NormalTok{gamma}\SpecialCharTok{*}\NormalTok{a[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{(wS[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{/}\NormalTok{(a[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]))}\SpecialCharTok{\^{}}\NormalTok{((}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{a[}\DecValTok{1}\NormalTok{,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[}\DecValTok{1}\NormalTok{,Q]))), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{values =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  0.93134557 -0.01214592
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{det}\OtherTok{=}\FunctionTok{det}\NormalTok{(J)      }\CommentTok{\# determinant}
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J)) }\CommentTok{\# trace}

\CommentTok{\#Check general stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check specific stability condition for the case beta=1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Scenario "}\NormalTok{, i, }\StringTok{":"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{gamma}\SpecialCharTok{*}\NormalTok{a[i,Q]}\SpecialCharTok{*}\NormalTok{(A[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(a[i,Q]}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{((}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{a[i,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[i,Q])) }
                      \SpecialCharTok{+}\NormalTok{ wS[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(a[i,Q]}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a[i,Q])))}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Scenario 1:"
[1] TRUE
[1] "Scenario 2:"
[1] TRUE
[1] "Scenario 3:"
[1] TRUE
[1] "Scenario 4:"
[1] TRUE
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialize arrays for equilibrium solutions}
\NormalTok{N\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{K\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}

\CommentTok{\# Calculate equilibrium solutions}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
\NormalTok{    N\_eq[i] }\OperatorTok{=}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
\NormalTok{    K\_eq[i] }\OperatorTok{=}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\NormalTok{a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}

\CommentTok{\# Compare with numerical solutions (here only for baseline)}
\NormalTok{N\_eq[}\DecValTok{0}\NormalTok{]}
\NormalTok{N[}\DecValTok{0}\NormalTok{,Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Construct Jacobian matrix at the equilibrium }
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta, beta }\OperatorTok{*}\NormalTok{ a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]],}
\NormalTok{    [beta }\OperatorTok{*}\NormalTok{ (wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])),}
     \DecValTok{1} \OperatorTok{{-}}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ ((}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))]}
\NormalTok{])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{eigenvalues, eigenvectors }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}
\BuiltInTok{print}\NormalTok{(eigenvalues)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\NormalTok{tr }\OperatorTok{=}\NormalTok{ np.trace(J)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}

\CommentTok{\# Check specific stability condition for the case beta=1}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Scenario }\SpecialCharTok{\{}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\SpecialCharTok{\}}\SpecialStringTok{:"}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (}
\NormalTok{        A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ ((}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{+}
\NormalTok{        wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
\NormalTok{    ) }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-12}

\chapter{A Ricardian Two-Sector Model}\label{sec-ricardo_2}

This model captures some key feature of David Ricardo's theory of growth
and distribution as developed in his 1817 book
\href{https://en.wikipedia.org/wiki/On_the_Principles_of_Political_Economy_and_Taxation}{On
the Principles of Political Economy and Taxation}. The model revolves
around the determination of real wages, rents, and profits, and how
profitability in turn drives capital accumulation.\footnote{See chapter
  2 of Foley (2006) for an excellent introduction.} It assumes an
economy with two sectors: an agricultural sector producing corn subject
to diminishing marginal returns and a luxury good sector with constant
marginal returns.\footnote{See Chapter~\ref{sec-ricardo_1} for a simpler
  one-sector version of the model,} Prices are determined by the
quantity of labour required for production. Rent on the land used for
agricultural production is a differential surplus landowners gain based
on the fertility of their land relative to the marginal plot of land
(the plot of land where fertility is lowest and no rent is earned). Real
wages are determined by the subsistence level in the long run. Profits
in agriculture are a residual and set the economy-wide profit rate. As
employment increases and more land is utilised, marginal productivity in
agriculture falls and differential rents increase. As a result, profits
are driven down to zero and capital accumulation comes to a halt. A
`stationary state' is reached. Landowners are the main beneficiaries of
this process. The model is adapted from Pasinetti (1960).

\section{The Model}\label{the-model-11}

The following equations describe the model:
\begin{equation}\phantomsection\label{eq-ricardo2_Y}{
Y_t=AN_{1t}^{a_1}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_MPL}{
MPL_t =\frac{\partial Y_{1t}}{\partial N_{1t}} =a_1AN_{1t}^{a_1-1}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_N1}{
N_{1t}=N_t - N_{2t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_W}{
W_t=K_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_w}{
w_t =\frac{W_t}{N_t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_R}{
R_t =  Y_{1t} - N_{1t}MPL_{t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_P1}{
P_{1t} = Y_{1t} - R_t - N_{1t}w_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_p1}{
p_{1t}=\frac{1}{MPL_t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_Y2}{
Y_{2t}=\left(\frac{p_{1t}}{p_{2}}\right)R_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_N2}{
N_{2t} = \frac{Y_{2t}}{a_2}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_p2}{
p_{2}=\frac{1}{a_2}
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_P2}{
P_{2t}=Y_{2t}-\left(\frac{p_{1t}}{p_{2}}\right)N_{2t}w_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_P}{
P_{t}=p_{1t}Y_{1t}+p_{2}Y_{2t}-p_{1t}R_t -p_{1t}W_t
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_K}{
K_t = K_{t-1} + g\left(\frac{P_{t-1}}{p_{1t-1}}\right)
}\end{equation}

\begin{equation}\phantomsection\label{eq-ricardo2_N}{
N_t = N_{t-1} + \gamma (w_{t-1} - w^S)
}\end{equation}

where \(Y_t\), \(A\), \(N_t\), \(W_t\), \(K_t\),\(w_t\), \(Y_t\),
\(MPL_t\), \(R_t\), \(P_t\), \(p\), and \(w^S\) are real output,
productivity, employment, the real wage bill (or wage fund), the capital
stock (in terms of corn), the real wage rate (in terms of corn), the
marginal product of labour (in the corn sector), rents, profits, prices,
and the subsistence wage, respectively. The subscripts 1 and 2 denote
the corn, i.e.~agricultural, sector and the luxury goods sectors,
respectively.

Equation~\ref{eq-ricardo2_Y} is the production function with
\(\alpha \in (0,1)\), i.e.~exhibiting diminishing marginal returns to
labour.\footnote{Pasinetti (1960) specifies a generic function
  \(f(N_t)\) with \(f(0) \geq\) 0, \(f'(0) > w^*\), and
  \(f''(N_t) < 0\). Equation~\ref{eq-ricardo2_Y} satisfies these
  conditions.} By Equation~\ref{eq-ricardo2_W}, the wage fund is defined
as the capital stock of this model (reflecting the fact that the
production of corn only involves labour). Equation~\ref{eq-ricardo2_w}
defines the real wage rate. Equation~\ref{eq-ricardo2_w} specifies the
marginal product of labour. By Equation~\ref{eq-ricardo2_N1}, employment
in agriculture is residually determined after employment in the luxury
goods sector has been determined (more on this below)
Equation~\ref{eq-ricardo2_R} captures the determination of
(differential) rents as a negative function of the marginal product of
labour.\footnote{Equation~\ref{eq-ricardo2_R} is based on the definition
  of total rent as the sum of the net gains of the non-marginal
  landowners. See Pasinetti (1960) for a formal derivation. Note that by
  using Equation~\ref{eq-ricardo2_MPL}, Equation~\ref{eq-ricardo2_R} can
  also be written as \(R_t = Y_{1t}(1-a_1)\).} Thus, the lower the
productivity on the marginal land, the higher the rents. By
Equation~\ref{eq-ricardo2_P1}, profits in agriculture are determined
residually. Equation Equation~\ref{eq-ricardo2_p1} specifies price
determination and captures Ricardo's labour theory of value according to
which the value of a good (net of rent) is determined by the quantity of
labour required to produce it. \footnote{To see this, notice that
  equation Equation~\ref{eq-ricardo2_p1} can be derived from
  \(p_{t1}Y_{t1}-p_{t1}R_{t}=N_{t1}\) if combined with equation
  Equation~\ref{eq-ricardo2_R}.}

Equation~\ref{eq-ricardo2_Y2} specifies that the production of the
luxury good is demand determined. Only landlords consume luxuries and
they spend all their income (rent) on luxuries.\footnote{Output in
  equation Equation~\ref{eq-ricardo2_Y2} is expressed in real terms and
  can be derived from \(p_{2}Y_{2t}=p_{1t}R_t\).} With production in
sector 2 demand determined, employment in sector 2 as given by
Equation~\ref{eq-ricardo2_N2} must accommodate based on the production
function \(Y_{2t}=a_2N_{2t}\). With employment in sector 2 pinned down
in this way and total employment given by the wage fund
(Equation~\ref{eq-ricardo2_W}), employment in sector 1 must be the
residual (as specified in equation Equation~\ref{eq-ricardo2_N1}). From
the labour theory of value, \(p_2Y_2=N_2\) must hold. Together with the
production function \(Y_{2t}=a_2N_{2t}\) this yields
Equation~\ref{eq-ricardo2_p2} for the price of the luxury good. Note
that due to the constant marginal returns in this sector, its price is
constant too.\footnote{The luxury good may therefore serve as Ricardo's
  `invariable standard of value' in terms of which the value of all
  commodities could be expressed.} By Equation~\ref{eq-ricardo2_P2},
profits in the luxuries sector are determined residually (note that no
rent is paid by this sector).

Equation~\ref{eq-ricardo2_P} specifies total profits (in nominal
terms).\footnote{Note that by combining Equation~\ref{eq-ricardo2_P}
  with Equation~\ref{eq-ricardo2_Y2}, total profits can also be written
  as \(P_t=p_{1t}(Y_{1t} - W_t)\). In other words, total profits are
  independent of output in sector 2.} Capital accumulation in equation
Equation~\ref{eq-ricardo2_K} is driven by the reinvestment of profits
(with \(\beta\) determining the proportion of profits that are
reinvested). Finally, Equation~\ref{eq-ricardo2_N} specifies population
dynamics, whereby the population increases whenever the actual real wage
is above the subsistence wage, echoing the Malthusian population
mechanism.

\section{Simulation}\label{simulation-11}

\subsection{Parameterisation}\label{parameterisation-11}

Table 1 reports the parameterisation and initial values used in the
simulation. In line with the Classical tradition, it will be assumed
that all profits are reinvested, i.e.~\(\beta=1\). Besides a baseline
(labelled as scenario 1), three further scenarios will be considered.
Scenarios 2-4 model three different forms of technological change: an
increase in the productivity parameter \(A\) (scenario 2), an increase
in the elasticity \(a_1\) of agricultural output with respect to labour
(scenario 3), and an increase in labour productivity \(a_2\) in the
luxury good sector (scenario 4). Scenario 5 considers a higher
subsistence wage (\(w^S\)). In all scenarios the population/employment
is initialised below its equilibrium value.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}lllll@{}}
\toprule\noalign{}
Scenario & \(A\) & \(a_1\) & \(a_2\) & \(w^S\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 2 & 0.7 & 0.5 & 0.5 \\
2: productivity boost I (\(A\)) & 3 & 0.7 & 0.5 & 0.5 \\
3: productivity boost II (\(a_1\)) & 2 & 0.75 & 0.5 & 0.5 \\
4: productivity boost III (\(a_2\)) & 2 & 0.7 & 0.55 & 0.5 \\
5: higher subsistence wage (\(w^S\)) & 2 & 0.7 & 0.5 & 0.6 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-11}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{600}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{5}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{15}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Output in sector 1}
\NormalTok{Y2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Output in sector 2}
\NormalTok{R}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Rent}
\NormalTok{P}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Qotal profits}
\NormalTok{P1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Profits in sector 1}
\NormalTok{P2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Profits in sector 2}
\NormalTok{N}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# total employment}
\NormalTok{N1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# employment in sector 1}
\NormalTok{N2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# employment in sector 2}
\NormalTok{w}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# real wage}
\NormalTok{wn}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# nominal wage}
\NormalTok{K}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# capital stock}
\NormalTok{MPL}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# marginal product of labour (in sector 1)}
\NormalTok{r}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# profit rate}
\NormalTok{p1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# price of good from sector 1}
\NormalTok{p2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# price of good from sector 2}
\NormalTok{N\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium population}
\NormalTok{K\_eq}\OtherTok{=}\FunctionTok{vector}\NormalTok{(}\AttributeTok{length=}\NormalTok{S)          }\CommentTok{\# equilibrium capital}

\NormalTok{test}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# price of good from sector 2}


\CommentTok{\# Set baseline parameter values}
\NormalTok{A}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{2}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# productivity}
\NormalTok{a1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.7}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# labour elasticity of output, sector 1}
\NormalTok{a2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# labour coefficient, sector 2}
\NormalTok{gamma}\OtherTok{=}\DecValTok{5} \CommentTok{\# adjustment speed of population }
\NormalTok{beta}\OtherTok{=}\DecValTok{1} \CommentTok{\# Sensitivity of investment with respect to profits}
\NormalTok{wS}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.5}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# natural wage rate}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{3}     \CommentTok{\# scenario 2: productivity boost I}
\NormalTok{a1[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.75} \CommentTok{\# scenario 3: productivity boost II}
\NormalTok{a2[}\DecValTok{4}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.55} \CommentTok{\# scenario 4: productivity boost III}
\NormalTok{wS[}\DecValTok{5}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.6}  \CommentTok{\# scenario 5: higher subsistence wage}

\CommentTok{\# Initialise variables such that employment and the capital stock are below the equilibrium}
\NormalTok{N1[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{N2[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{N[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{N1[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{N2[,}\DecValTok{1}\NormalTok{]}
\NormalTok{K[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{1}
\NormalTok{w[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{wS[,}\DecValTok{1}\NormalTok{]}
\NormalTok{Y1[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{A[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{N1[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(a1[,}\DecValTok{1}\NormalTok{])}
\NormalTok{MPL[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{a1[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{A[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(N1[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(a1[,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}

  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }\CommentTok{\# run the model 1000{-}times in each period}
      
    \CommentTok{\#Model equations}
      
      \CommentTok{\#(2) Wage bill (omitted for simplicity)}
      \CommentTok{\#W[i,t]=K[i,t] }

      \CommentTok{\#(3) Output sector 1}
\NormalTok{      Y1[i,t] }\OtherTok{=}\NormalTok{ A[i,t]}\SpecialCharTok{*}\NormalTok{(N1[i,t]}\SpecialCharTok{\^{}}\NormalTok{a1[i,t])}
      
      \CommentTok{\#(4) Employment sector 1}
\NormalTok{      N1[i,t] }\OtherTok{=}\NormalTok{ N[i,t] }\SpecialCharTok{{-}}\NormalTok{ N2[i,t]}

      \CommentTok{\#(5) Marginal product of labour (sector 1)}
\NormalTok{      MPL[i,t]}\OtherTok{=}\NormalTok{a1[i,t]}\SpecialCharTok{*}\NormalTok{A[i,t]}\SpecialCharTok{*}\NormalTok{(N1[i,t]}\SpecialCharTok{\^{}}\NormalTok{(a1[i,t]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}

      \CommentTok{\#(6) Rent (simplified equation)}
\NormalTok{      R[i,t]}\OtherTok{=}\NormalTok{ Y1[i,t]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[i,t]) }
      
      \CommentTok{\#(7) Profits sector 1}
\NormalTok{      P1[i,t] }\OtherTok{=}\NormalTok{ Y1[i,t] }\SpecialCharTok{{-}}\NormalTok{ R[i,t] }\SpecialCharTok{{-}}\NormalTok{ N1[i,t]}\SpecialCharTok{*}\NormalTok{w[i,t]}

      \CommentTok{\#(8) Prices sector 1}
\NormalTok{      p1[i,t] }\OtherTok{=} \DecValTok{1}\SpecialCharTok{/}\NormalTok{(MPL[i,t])        }

      \CommentTok{\#(9) Output sector 2}
\NormalTok{      Y2[i,t]}\OtherTok{=}\NormalTok{(p1[i,t]}\SpecialCharTok{/}\NormalTok{p2[i,t])}\SpecialCharTok{*}\NormalTok{R[i,t]}
      
      \CommentTok{\#(3 Real wage rate}
\NormalTok{      w[i,t] }\OtherTok{=}\NormalTok{ K[i,t]}\SpecialCharTok{/}\NormalTok{N[i,t] }
      
      \CommentTok{\#(10) Employment sector 2}
\NormalTok{      N2[i,t]}\OtherTok{=}\NormalTok{ Y2[i,t]}\SpecialCharTok{/}\NormalTok{a2[i,t]}

      \CommentTok{\#(11) Prices}
\NormalTok{      p2[i,t] }\OtherTok{=} \DecValTok{1}\SpecialCharTok{/}\NormalTok{a2[i,t]}

      \CommentTok{\#(12) Profits sector 2}
\NormalTok{      P2[i,t] }\OtherTok{=}\NormalTok{ Y2[i,t] }\SpecialCharTok{{-}}\NormalTok{ (p1[i,t]}\SpecialCharTok{/}\NormalTok{p2[i,t])}\SpecialCharTok{*}\NormalTok{N2[i,t]}\SpecialCharTok{*}\NormalTok{w[i,t]}

      \CommentTok{\#(13) Total profits}
\NormalTok{      P[i,t]}\OtherTok{=}\NormalTok{p1[i,t]}\SpecialCharTok{*}\NormalTok{Y1[i,t] }\SpecialCharTok{+}\NormalTok{ p2[i,t]}\SpecialCharTok{*}\NormalTok{Y2[i,t] }\SpecialCharTok{{-}}\NormalTok{ p1[i,t]}\SpecialCharTok{*}\NormalTok{R[i,t] }\SpecialCharTok{{-}}\NormalTok{ p1[i,t]}\SpecialCharTok{*}\NormalTok{K[i,t]}

      \CommentTok{\#(14) Capital accumulation}
\NormalTok{      K[i,t]}\OtherTok{=}\NormalTok{ K[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ beta}\SpecialCharTok{*}\NormalTok{(P[i,t}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{/}\NormalTok{p1[i,t}\DecValTok{{-}1}\NormalTok{])}
      
      \CommentTok{\#(8) Employment/population dynamics  }
\NormalTok{      N[i,t] }\OtherTok{=}\NormalTok{ N[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ gamma}\SpecialCharTok{*}\NormalTok{(w[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ wS[i,t}\DecValTok{{-}1}\NormalTok{])}
      
\NormalTok{    \} }\CommentTok{\# close iterations loop}
\NormalTok{  \} }\CommentTok{\# close time loop}
\NormalTok{\} }\CommentTok{\# close scenarios loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{600}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{5}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{15}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{Y2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{R }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{P }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{P1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{P2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{N }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{N1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{N2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{w }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{wn }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{K }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{MPL }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{r }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{p1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{p2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}
\NormalTok{N\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{K\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{test }\OperatorTok{=}\NormalTok{ np.ones((S, Q))}

\CommentTok{\# Set baseline parameter values}
\NormalTok{gamma }\OperatorTok{=} \DecValTok{5}
\NormalTok{beta }\OperatorTok{=} \DecValTok{1}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{2.0}\NormalTok{)}
\NormalTok{a1 }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.7}\NormalTok{)}
\NormalTok{a2 }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)}
\NormalTok{wS }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.5}\NormalTok{)}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{A[}\DecValTok{1}\NormalTok{, s:] }\OperatorTok{=} \DecValTok{3}     \CommentTok{\# scenario 2: productivity boost I}
\NormalTok{a1[}\DecValTok{2}\NormalTok{, s:] }\OperatorTok{=} \FloatTok{0.75} \CommentTok{\# scenario 3: productivity boost II}
\NormalTok{a2[}\DecValTok{3}\NormalTok{, s:] }\OperatorTok{=} \FloatTok{0.55} \CommentTok{\# scenario 4: productivity boost III}
\NormalTok{wS[}\DecValTok{4}\NormalTok{, s:] }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# scenario 5: higher subsistence wage}

\CommentTok{\# Initialize variables}
\NormalTok{N1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{N2[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{N[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ N1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{+}\NormalTok{ N2[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{K[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{w[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ wS[:, }\DecValTok{0}\NormalTok{]}
\NormalTok{Y1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ A[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ N1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{**}\NormalTok{ (a1[:, }\DecValTok{0}\NormalTok{])}
\NormalTok{MPL[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ a1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ A[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ (N1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{**}\NormalTok{ (a1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{{-}} \DecValTok{1}\NormalTok{))}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):}
            \CommentTok{\# Model equations}
\NormalTok{            Y1[i, t] }\OperatorTok{=}\NormalTok{ A[i, t] }\OperatorTok{*}\NormalTok{ (N1[i, t] }\OperatorTok{**}\NormalTok{ a1[i, t])}
\NormalTok{            N1[i, t] }\OperatorTok{=}\NormalTok{ N[i, t] }\OperatorTok{{-}}\NormalTok{ N2[i, t]}
\NormalTok{            MPL[i, t] }\OperatorTok{=}\NormalTok{ a1[i, t] }\OperatorTok{*}\NormalTok{ A[i, t] }\OperatorTok{*}\NormalTok{ (N1[i, t] }\OperatorTok{**}\NormalTok{ (a1[i, t] }\OperatorTok{{-}} \DecValTok{1}\NormalTok{))}
\NormalTok{            R[i, t] }\OperatorTok{=}\NormalTok{ Y1[i, t] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[i, t])}
\NormalTok{            P1[i, t] }\OperatorTok{=}\NormalTok{ Y1[i, t] }\OperatorTok{{-}}\NormalTok{ R[i, t] }\OperatorTok{{-}}\NormalTok{ N1[i, t] }\OperatorTok{*}\NormalTok{ w[i, t]}
\NormalTok{            p1[i, t] }\OperatorTok{=} \DecValTok{1} \OperatorTok{/}\NormalTok{ MPL[i, t]}
\NormalTok{            Y2[i, t] }\OperatorTok{=}\NormalTok{ (p1[i, t] }\OperatorTok{/}\NormalTok{ p2[i, t]) }\OperatorTok{*}\NormalTok{ R[i, t]}
\NormalTok{            w[i, t] }\OperatorTok{=}\NormalTok{ K[i, t] }\OperatorTok{/}\NormalTok{ N[i, t]}
\NormalTok{            N2[i, t] }\OperatorTok{=}\NormalTok{ Y2[i, t] }\OperatorTok{/}\NormalTok{ a2[i, t]}
\NormalTok{            p2[i, t] }\OperatorTok{=} \DecValTok{1} \OperatorTok{/}\NormalTok{ a2[i, t]}
\NormalTok{            P2[i, t] }\OperatorTok{=}\NormalTok{ Y2[i, t] }\OperatorTok{{-}}\NormalTok{ (p1[i, t] }\OperatorTok{/}\NormalTok{ p2[i, t]) }\OperatorTok{*}\NormalTok{ N2[i, t] }\OperatorTok{*}\NormalTok{ w[i, t]}
\NormalTok{            P[i, t] }\OperatorTok{=}\NormalTok{ p1[i, t] }\OperatorTok{*}\NormalTok{ Y1[i, t] }\OperatorTok{+}\NormalTok{ p2[i, t] }\OperatorTok{*}\NormalTok{ Y2[i, t] }\OperatorTok{{-}}\NormalTok{ p1[i, t] }\OperatorTok{*}\NormalTok{ R[i, t] }\OperatorTok{{-}}\NormalTok{ p1[i, t] }\OperatorTok{*}\NormalTok{ K[i, t]}
\NormalTok{            K[i, t] }\OperatorTok{=}\NormalTok{ K[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (P[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ p1[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}
\NormalTok{            N[i, t] }\OperatorTok{=}\NormalTok{ N[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (w[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ wS[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-11}

Figures 1-4 illustrate the model's dynamics under the baseline
parameterisation. Starting from below-equilibrium levels, the economy
grows in terms of output, capital, and employment but then approaches
what Ricardo famously called a `stationary state'. Figure 3 shows that
during the adjustment phase, the MPL declines, reflecting diminishing
marginal returns in agriculture. This captures the idea that a growing
economy will have to utilise less fertile lands. The real wage is driven
up until it is equal to the MPL. Figure 4 shows that total profits
initially increase but are then squeezed to zero as differential rents
increase.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{100}
\NormalTok{Tmin}\OtherTok{=}\DecValTok{6}

\DocumentationTok{\#\# Baseline}
\CommentTok{\#Employment and capital accumulation}
\FunctionTok{plot}\NormalTok{(N[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 1: Employment and capital accumulation"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)])))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"K"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"N"}\NormalTok{, }\StringTok{"K"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Output in the two sectors}
\FunctionTok{plot}\NormalTok{(Y1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(Y1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 2: Output in agriculture and luxuries"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y1"}\NormalTok{, }\StringTok{"Y2"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Real wage, MPL, and subsistence wage}
\FunctionTok{plot}\NormalTok{(w[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(wS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],w[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 3: Real wage, marginal product of labour, and subsistence wage"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(MPL[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(wS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"w"}\NormalTok{, }\StringTok{"MPL"}\NormalTok{, }\StringTok{"wS"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_2-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Total Profits and Rents}
\FunctionTok{plot}\NormalTok{(P[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(P[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],R[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 4: Total profits and rents"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(R[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"P"}\NormalTok{, }\StringTok{"R"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_2-4.pdf}

Figures 5 and 6 display capital accumulation under the five different
scenarios described in Table 1. Technical change that increases
productivity in agriculture (scenarios 2 and 3) raises the speed of
capital accumulation and the equilibrium level of capital. By contrast,
an increase in productivity in the luxury good sector (scenario 4) has
no effect on capital accumulation. This is because productivity in
sector 2 has no effects on functional income distribution.\footnote{The
  increase in \(a_2\) does raise real output and profits in sector 2 but
  it leaves total profits unchanged.} An increase in the initial stock
of capital (scenario 5) raises the steady state value. Thus, economies
with larger initial endowments will reach a higher level of income in
the stationary state.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Scenarios}
\CommentTok{\# Capital accumulation under scenarios 1{-}3}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], K[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 5: Capital accumulation under different scenarios (pt 1)"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{,}\StringTok{"2: productivity boost I"}\NormalTok{, }\StringTok{"3: productivity boost II"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_3-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Capital accumulation under scenarios 1, 4+5}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{(Tmax)), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], K[}\DecValTok{5}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Figure 6: Capital accumulation under different scenarios (pt 2)"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(K[}\DecValTok{5}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{,}\StringTok{"4: productivity boost III"}\NormalTok{, }\StringTok{"5: higher subsist. wage"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_3-2.pdf}

Figures 7 and 8 show the dynamics of relative prices (corn price
relative to luxury good price) for the different scenarios. Over time,
corn becomes more expensive in relative turns due to diminishing
marginal returns. Improvements in labour productivity reduce the
relative price of the respective sector in line with the labour theory
of value.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Relative prices under scenarios 1 {-} 3}
\NormalTok{relpr}\OtherTok{=}\NormalTok{p1}\SpecialCharTok{/}\NormalTok{p2}
\FunctionTok{plot}\NormalTok{(relpr[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{main=}\StringTok{"Figure 7: Relative prices under different scenarios (pt 1)"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}p1/p2\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(relpr[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)], relpr[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)]),}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(relpr[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(relpr[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: productivity boost I"}\NormalTok{, }\StringTok{"3: productivity boost II"}\NormalTok{),}\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Relative prices under scenarios 1, 4{-}5}
\FunctionTok{plot}\NormalTok{(relpr[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{, }
     \AttributeTok{main=}\StringTok{"Figure 8: Relative prices under different scenarios (pt 2)"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}p1/p2\textquotesingle{}}\NormalTok{,}\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(relpr[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)], relpr[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)]),}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(relpr[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(relpr[}\DecValTok{5}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"4: productivity boost III"}\NormalTok{, }\StringTok{"5: higher subsist. wage"}\NormalTok{), }\AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_4-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plots (here for employment and capital accumulation only)}

\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{100}
\NormalTok{Tmin }\OperatorTok{=} \DecValTok{6}

\CommentTok{\# Baseline}
\CommentTok{\# Employment and capital accumulation}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots()}
\NormalTok{ax1.plot(N[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:(Tmax}\OperatorTok{+}\DecValTok{1}\NormalTok{)], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}solid\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}

\NormalTok{ax1.set\_xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}
\NormalTok{ax2.plot(K[}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{:Tmax], linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}dashed\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{0.8}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax2.set\_ylabel(}\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, rotation}\OperatorTok{=}\DecValTok{0}\NormalTok{)}
\NormalTok{lines, labels }\OperatorTok{=}\NormalTok{ ax1.get\_legend\_handles\_labels() }\CommentTok{\#collect legend in one box}
\NormalTok{lines2, labels2 }\OperatorTok{=}\NormalTok{ ax2.get\_legend\_handles\_labels()}
\NormalTok{ax2.legend(lines }\OperatorTok{+}\NormalTok{ lines2, labels }\OperatorTok{+}\NormalTok{ labels2, loc}\OperatorTok{=}\DecValTok{5}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Figure 1: Employment and capital accumulation"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-11}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).\footnote{Valuation effects from
  changes in relative prices were omitted for simplicity.}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 18 variables: }
\CommentTok{\#(1)Y1 (2)N1 (3)MPL (4)R (5)P1 (6)p1 (7)Y2 (8)w (9)N2 (10)p2 (11)P2}
\CommentTok{\#(12)P (13)K (14)N (15)A (16)a1 (17)a2 (18)wS,}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\CommentTok{\#              1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#1}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#2}
               \DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#3}
               \DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#4}
               \DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#5}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#6}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#7}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#8}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#9}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#10}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#11 }
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#12}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#13}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\CommentTok{\#14}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#15}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#16}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\#17}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}  \CommentTok{\#18}
\NormalTok{               ), }\DecValTok{18}\NormalTok{,}\DecValTok{18}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create and plot directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(N[}\DecValTok{1}\NormalTok{]), }\StringTok{"MPL"}\NormalTok{, }\StringTok{"R"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(P[}\DecValTok{1}\NormalTok{]), }
             \FunctionTok{expression}\NormalTok{(p[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{2}\NormalTok{]), }\StringTok{"w"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(N[}\DecValTok{2}\NormalTok{]), }
             \FunctionTok{expression}\NormalTok{(p[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(P[}\DecValTok{2}\NormalTok{]), }\StringTok{"P"}\NormalTok{, }\StringTok{"K"}\NormalTok{, }\StringTok{"N"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }
             \FunctionTok{expression}\NormalTok{(a[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(a[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(w}\SpecialCharTok{\^{}}\NormalTok{S))}

\CommentTok{\# Plot directed graph}
\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Figure 9: Directed graph"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{0.8}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_ricardian_two_sector_model_files/figure-pdf/ricardo2_5-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create directed graph}

\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Construct auxiliary Jacobian matrix for 18 variables: }
\CommentTok{\#(1)Y1 (2)N1 (3)MPL (4)R (5)P1 (6)p1 (7)Y2 (8)w (9)N2 (10)p2 (11)P2}
\CommentTok{\#(12)P (13)K (14)N (15)A (16)a1 (17)a2 (18)wS,}
\CommentTok{\# where non{-}zero elements in regular Jacobian are set to 1 and zero elements are unchanged}

\CommentTok{\#                    1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([  [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#1}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#2}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#3}
\NormalTok{                    [}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#4}
\NormalTok{                    [}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#5}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#6}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#7}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#8}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#9}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#10}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#11}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#12}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#13}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{], }\CommentTok{\#14}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#15}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#16}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\#17}
\NormalTok{                    [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]])}\CommentTok{\#18}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create the graph from the adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}
    \DecValTok{0}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$Y\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$N\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{\textquotesingle{}MPL\textquotesingle{}}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{\textquotesingle{}R\textquotesingle{}}\NormalTok{, }\DecValTok{4}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$P\_1$\textquotesingle{}}\NormalTok{, }
    \DecValTok{5}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$p\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{6}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$Y\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{7}\NormalTok{: }\StringTok{\textquotesingle{}w\textquotesingle{}}\NormalTok{, }\DecValTok{8}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$N\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{9}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$p\_2$\textquotesingle{}}\NormalTok{, }
    \DecValTok{10}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$P\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{11}\NormalTok{: }\StringTok{\textquotesingle{}P\textquotesingle{}}\NormalTok{, }\DecValTok{12}\NormalTok{: }\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\DecValTok{13}\NormalTok{: }\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{, }\DecValTok{14}\NormalTok{: }\StringTok{\textquotesingle{}A\textquotesingle{}}\NormalTok{, }
    \DecValTok{15}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$a\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{16}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$a\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{17}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$w\^{}S$\textquotesingle{}}
\NormalTok{\}}

\CommentTok{\# Plot the graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, k}\OperatorTok{=}\FloatTok{0.9}\NormalTok{)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{200}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{8}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}
\NormalTok{plt.axis(}\StringTok{"off"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Figure: Directed graph of Ricardian Two{-}Sector Model"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

In Figure 9, it can be seen that productivity in agriculture (\(A\) and
\(a_1\)) are key exogenous variables that impact income in sector 1 and
the marginal product of labour. The subsistence wage (\(w^S\)) is
another exogenous variable that impacts the system through its effect on
population dynamics. Productivity in the luxuries sector (\(a_2\)) feeds
into the system via employment.ost other variables are endogenous and
form a closed loop (or cycle) within the system. Profits are a residual.
The directed graph illustrates the supply-driven nature of the
agricultural sector, where (marginal) productivity determine employment
and distribution. By contrast, the luxury goods sector is
demand-determined with employment being the residual. Profits determine
capital accumulation, which in turn provides funds that can be used to
hire more agricultural workers. A higher subsistence wage reduces
capital accumulation as it leaves fewer profits to be reinvested.

\section{Analytical discussion}\label{analytical-discussion-9}

To analyse the dynamics, combine Equation~\ref{eq-ricardo2_Y} to
Equation~\ref{eq-ricardo2_P} and substitute into
Equation~\ref{eq-ricardo2_K}. Further use Equation~\ref{eq-ricardo2_W}
and Equation~\ref{eq-ricardo2_w} in Equation~\ref{eq-ricardo2_N}. This
yields the two-dimensional dynamic system in \(K_t\) and \(N_t\):

\[
K_t = (1-\beta)K_{t-1}+\beta(a_1^{a_1}A N_{t-1}^{a_1} )
\] \[ 
N_t = N\_{t-1} +\gamma\left(\frac{K_{t-1}}{N_{t-1}} -w^S\right)
\] The Jacobian matrix is given by:

\[
J(K, N)=\begin{bmatrix} 1-\beta& \beta a_1^{1+a_1}AN^{a_1-1} \\\frac{\gamma}{N} & 1-\frac{\gamma K}{N^2} \end{bmatrix}.
\]

From equations Equation~\ref{eq-ricardo2_K} and
Equation~\ref{eq-ricardo2_N}, it can readily be seen that an equilibrium
is reached when \[
P^*=0
\] and \[
w^*=w^S.
\] Using \(P^*=0\) with Equation~\ref{eq-ricardo2_R} and
Equation~\ref{eq-ricardo2_P}, yields \(w^*=w^S=MPL\). Thus, in
equilibrium, profits are zero, and the real wage is equal to the MPL and
the subsistence wage. Setting \(K_t=K_{t-1}\) and \(N_t=N_{t-1}\), we
can further derive:

\[
K^*=a_1^{a_1}A\left(\frac{w^S}{a_1^{a_1}A}\right)^{-\frac{a_1}{1-a_1}}
\] and

\[
N^*=\left(\frac{w^S}{a_1^{a_1}A}\right)^{-\frac{1}{1-a_1}}
\] With this, we can evaluate the Jacobian at the steady state: \[
J(K^*, N^*)=\begin{bmatrix} 1-\beta & \beta a_1 w^S \\ \gamma \left(\frac{w^S}{a_1^{a_1}A}\right)^{\frac{1}{1-a_1}} & 1-\gamma a_1^{a_1}A \left(\frac{w^S}{a_1^{a_1}A}\right)^{\frac{2-a_1}{1-a_1}} 
\end{bmatrix}.
\] For the system to be stable, both eigenvalues of the Jacobian need to
be inside the unit circle. This requires the following three conditions
to hold:

\[
1+tr(J)+det(J)>0
\] \[
1-tr(J)+det(J)>0
\] \[
1-det(J)>0,
\] where \(tr(J)\) is the trace and \(det(J)\) is the determinant of the
Jacobian.

Let us consider the Classical case where \(\beta=1\), i.e.~all profits
are reinvested. Then we have

\[
det(J)=-a_1w^S \gamma \left(\frac{w^S}{a_1^{a_1}A}\right)^{\frac{1}{1-a_1}}<0,
\]

so that the third condition is always satisfied and it is the first one
that is binding. The first condition then becomes

\[
2-\gamma  \left[a_1^{a_1} A \left(\frac{w^S}{a_1^{a_1}A}\right)^{\frac{2-a_1}{1-a_1}} + a_1 w^S\left(\frac{w^S}{a_1^{a_1}A}\right)^{\frac{1}{1-a_1}} \right]>0
\]

We can check the analytical solutions and stability conditions
numerically:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate equilibrium solutions}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\NormalTok{  N\_eq[i]}\OtherTok{=}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[i,Q]))}
\NormalTok{  K\_eq[i]}\OtherTok{=}\NormalTok{(a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{a1[i,Q]}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[i,Q]))}
\NormalTok{\}}

\CommentTok{\# Compare with numerical solutions (here for the example of Y, baseline)}
\NormalTok{N\_eq[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 44.20066
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{N[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 44.19942
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K\_eq[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 22.10033
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K[}\DecValTok{1}\NormalTok{,Q]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 22.09989
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Examine model properties (here for the baseline scenario only)}
\CommentTok{\# Construct Jacobian matrix at the equilibrium }
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta, }
\NormalTok{           beta}\SpecialCharTok{*}\NormalTok{a1[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{wS[}\DecValTok{1}\NormalTok{,Q],}
\NormalTok{           gamma}\SpecialCharTok{*}\NormalTok{(wS[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{/}\NormalTok{((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[}\DecValTok{1}\NormalTok{,Q])),}
           \DecValTok{1}\SpecialCharTok{{-}}\NormalTok{gamma}\SpecialCharTok{*}\NormalTok{(a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{*}\NormalTok{(wS[}\DecValTok{1}\NormalTok{,Q]}\SpecialCharTok{/}\NormalTok{((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[}\DecValTok{1}\NormalTok{,Q]))}\SpecialCharTok{\^{}}\NormalTok{((}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{a1[}\DecValTok{1}\NormalTok{,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[}\DecValTok{1}\NormalTok{,Q]))), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{values =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  0.98368845 -0.04024869
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{det}\OtherTok{=}\FunctionTok{det}\NormalTok{(J)      }\CommentTok{\# determinant}
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J)) }\CommentTok{\# trace}

\CommentTok{\#Check stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check specific stability condition for the case beta=1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Scenario "}\NormalTok{, i, }\StringTok{":"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{gamma}\SpecialCharTok{*}\NormalTok{((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q])))}\SpecialCharTok{\^{}}\NormalTok{((}\DecValTok{2}\SpecialCharTok{{-}}\NormalTok{a1[i,Q])}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[i,Q]))) }\SpecialCharTok{+}\NormalTok{ a1[i,Q]}\SpecialCharTok{*}\NormalTok{wS[i,Q]}\SpecialCharTok{*}\NormalTok{(wS[i,Q]}\SpecialCharTok{/}\NormalTok{(((a1[i,Q]}\SpecialCharTok{\^{}}\NormalTok{a1[i,Q])}\SpecialCharTok{*}\NormalTok{A[i,Q]))}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{a1[i,Q])))}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Scenario 1:"
[1] TRUE
[1] "Scenario 2:"
[1] TRUE
[1] "Scenario 3:"
[1] TRUE
[1] "Scenario 4:"
[1] TRUE
[1] "Scenario 5:"
[1] TRUE
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialize arrays for equilibrium solutions}
\NormalTok{N\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}
\NormalTok{K\_eq }\OperatorTok{=}\NormalTok{ np.zeros(S)}

\CommentTok{\# Calculate equilibrium solutions}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
\NormalTok{    N\_eq[i] }\OperatorTok{=}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
\NormalTok{    K\_eq[i] }\OperatorTok{=}\NormalTok{ (a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\NormalTok{a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}

\CommentTok{\# Compare with numerical solutions (example for N, baseline)}
\NormalTok{N\_eq[}\DecValTok{0}\NormalTok{]}
\NormalTok{N[}\DecValTok{0}\NormalTok{,Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Construct Jacobian matrix at the equilibrium }
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta, beta }\OperatorTok{*}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]],}
\NormalTok{    [gamma }\OperatorTok{*}\NormalTok{ (wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])),}
     \DecValTok{1} \OperatorTok{{-}}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ ((}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[}\DecValTok{0}\NormalTok{, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))]}
\NormalTok{])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{eigenvalues, eigenvectors }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}
\BuiltInTok{print}\NormalTok{(eigenvalues)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\NormalTok{tr }\OperatorTok{=}\NormalTok{ np.trace(J)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}

\CommentTok{\# Check specific stability condition for the case beta=1}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Scenario }\SpecialCharTok{\{}\NormalTok{i }\OperatorTok{+} \DecValTok{1}\SpecialCharTok{\}}\SpecialStringTok{:"}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (}
\NormalTok{        (a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*} 
\NormalTok{        (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ ((}\DecValTok{2} \OperatorTok{{-}}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{+}
\NormalTok{        a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{*}\NormalTok{ (wS[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ ((a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{*}\NormalTok{ A[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])) }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ a1[i, Q}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}
\NormalTok{    ) }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-13}

\chapter{A Lewis Model of Economic Development}\label{sec-lewis}

\section{Overview}\label{overview-11}

This model captures some key features of W. Arthur Lewis (1954)'
two-sector model of the growth process of a developing country. The
model describes the development process as one where a modern urban
sector draws labour inputs from a traditional subsistence sector that is
characterised by surplus labour, i.e.~labour that does not produce any
additional output (reflected in a zero marginal product). Workers in the
traditional sector are paid a fixed subsistence wage. The presence of
surplus labour allows the modern sector to attract workers from the
traditional sector for a small wage premium above the subsistence wage.
This enables the modern sector to make excess profits that are
reinvested and thus drive rapid capital accumulation in the modern
sector. As a result, the economy undergoes industrialisation. This
process of rapid structural change comes to an end when the surplus
labour in the traditional sector is depleted. Labour supply then becomes
sensitive to the real wage, leading to a slowdown in the growth of
profits and capital accumulation.

We present a formal version of the model that is adapted from the
graphical representation in Todaro and Smith (2015), pp.~124-127.

\section{The Model}\label{the-model-12}

\begin{equation}\phantomsection\label{eq-lewis_Y1}{
    Y_{1t}= 
\begin{cases}
    \lambda^\alpha, &    \text{if } L_{1t-1} > \lambda \\
    L^\alpha_{1t},& \text{if } L_{1t-1}\leq \lambda
\end{cases}
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_w1}{
w_{1t} = w^S  
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_L1}{
L_{1t} = L - L_{2t}  
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_Y2}{
Y_{2t} = L_{2t}^\beta K_{2t}^{1-\beta}  
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_w2}{
    w_{2t}= 
\begin{cases}
    w^S(1 + \rho), &    \text{if } L_{1t-1} > \lambda \\
    \gamma L_{2t},& \text{if } L_{1t-1}\leq \lambda
\end{cases}
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_MPL}{
MPL_{2t}= \frac{\partial Y_{2t}}{\partial L_{2t}} = \frac{\beta Y_{2t}}{L_{2t}}
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_L2}{
L_{2t}= L_{2t-1} + \delta(MPL_{2t-1} - w_{2t-1})
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_P2}{
P_{2t}=Y_{2t} - w_{2t}L_{2t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-lewis_K2}{
K_{2t}=K_{2t-1} + P_{2t-1}
}\end{equation}

where the subscripts 1 and 2 refer to the traditional and modern sector,
respectively, and \(Y_t\), \(w_t\), \(L_t\), \(MPL_t\), \(K_t\), and
\(P_t\) represent output, the real wage rate, employment, the marginal
product of labour, the capital stock, and profits, respectively.

Equation~\ref{eq-lewis_Y1} describes output determination in the
traditional sector. The variable \(\lambda\) is the employment level
beyond which the marginal product of labour (MPL) in sector 1 becomes
zero. As long as employment is above this threshold, there is surplus
labour and output is fixed at the level implied by the level of
employment for which the MPL becomes zero (\(\lambda\)). If actual
employment falls below this level, the sector faces a production
function that is increasing in employment but with diminishing marginal
returns \((\alpha \in (0,1))\). By Equation~\ref{eq-lewis_w1}, the real
wage in the traditional sector is an exogenously given subsistence wage
\(w^S\). Equation~\ref{eq-lewis_L1} says that the level of employment in
the traditional sector is residually determined by the total labour
supply net of employment in the modern sector. Total labour is taken to
be exogenous. Unlike the traditional sector, the modern sector employs
capital. Equation~\ref{eq-lewis_Y2} is the production function of the
modern sector, which exhibits constant returns to scale and diminishing
marginal returns \((\beta\in (0,1))\). Equation~\ref{eq-lewis_w2}
specifies wage determination in the modern sector. If there is surplus
labour in the traditional sector, the modern sector pays a wage premium
\(\rho\) on the subsistence wage. As soon as surplus labour is depleted,
the modern sector faces an upward-sloping labour supply curve, which we
model for simplicity as a linear function with slope coefficient
\(\gamma\). Equation~\ref{eq-lewis_MPL} specifies the marginal product
of labour of the modern sector:
\(MPL_{2t}=\beta L_{2t}^{\beta-1} K_{2t}^{1-\beta} = \beta \frac{Y_{2t}}{L_{2t}}\).
Equation~\ref{eq-lewis_L2} is the labour demand curve of the modern
sector. To maximise profits, the firm would have to equalise the real
wage and the MPL: \(w_{2t}=MPL_{2t}\). Equation~\ref{eq-lewis_L2}
specifies this as a gradual process, where the rate at which the modern
firm attracts workers from the traditional sector is increasing in the
gap between their marginal product and the fixed wage the firm pays
these workers. Finally, Equation~\ref{eq-lewis_P2} defines profits in
the modern sector, and Equation~\ref{eq-lewis_K2} describes capital
accumulation in that sector, where it is assumed that all profits are
invested \((P_{2t}=I_{2t})\).

\section{Simulation}\label{simulation-12}

\subsection{Parameterisation}\label{parameterisation-12}

Table reports the parameterisation used in the simulation. All scenarios
are initialised such that there is surplus labour
(\(L_{10} > \lambda\)).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.4336}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0442}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0973}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0885}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0796}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1062}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0619}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0885}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(L\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\lambda\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\alpha\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\beta\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\delta\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(w^S\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\gamma\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 20 & 10 & 0.9 & 0.7 & 0.5 & 0.4 & 0.12 \\
2: rise subsistence wage (\(w^S\)) & 20 & 10 & 0.9 & 0.7 & 0.5 & 0.3 &
0.12 \\
3: rise in labour supply elasticity (\(\gamma\)) & 20 & 10 & 0.9 & 0.7 &
0.5 & 0.4 & 0.17 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-12}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{250}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{3}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{1}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Output in sector 1 (traditional)}
\NormalTok{Y2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Output in sector 2 (modern)}
\NormalTok{L1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# employment in sector 1}
\NormalTok{L2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# employment in sector 2}
\NormalTok{w2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# real wage sector 2}
\NormalTok{MPL2 }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# marginal product of labour in sector 2}
\NormalTok{K}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# capital stock (only in sector 2)}
\NormalTok{P2}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\#  profits in sector 2}

\CommentTok{\# Set fixed parameter values}
\NormalTok{alpha}\OtherTok{=}\FloatTok{0.9} \CommentTok{\# labour elasticity of output, sector 1}
\NormalTok{rho}\OtherTok{=}\DecValTok{1}     \CommentTok{\# wage premium}
\NormalTok{L}\OtherTok{=}\DecValTok{20}      \CommentTok{\# total labour supply (exogenous)}
\NormalTok{lambda}\OtherTok{=}\DecValTok{10} \CommentTok{\# employment at which MPL in sector 1 becomes zero}
\NormalTok{beta}\OtherTok{=}\FloatTok{0.7}  \CommentTok{\# labour elasticity of output, sector 2}
\NormalTok{delta }\OtherTok{=} \FloatTok{0.5}  \CommentTok{\# sensitivity of employment in sector 2 to deviation of MPL2 from w2}

\CommentTok{\# Set baseline parameter values}
\NormalTok{w1}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.4}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# subsistence real wage sector 1}
\NormalTok{gamma}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{0.12}\NormalTok{, }\AttributeTok{nrow=}\NormalTok{S, }\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# labour supply coefficient, sector 2}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{w1[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.3}         \CommentTok{\# scenario 2: fall in subsistence wage}
\NormalTok{gamma[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.17}     \CommentTok{\# scenario 3: rise in labour supply elasticity}

\CommentTok{\# Create vectors that will record when the turning point occurs and when the simulation ends}
\NormalTok{tp }\OtherTok{=} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, S)}
\NormalTok{end }\OtherTok{=} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, S)}

\CommentTok{\# Initialise such that there is surplus labour (L1 \textgreater{} lambda)}
\NormalTok{L1[,}\DecValTok{1}\NormalTok{]}\OtherTok{=} \FloatTok{0.9}\SpecialCharTok{*}\NormalTok{L}
\NormalTok{L2[,}\DecValTok{1}\NormalTok{]}\OtherTok{=}\NormalTok{ L }\SpecialCharTok{{-}}\NormalTok{ L1[,}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over T time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \CommentTok{\# Create flag that will be set to TRUE when the turning point has been reached}
\NormalTok{  cond }\OtherTok{=} \ConstantTok{FALSE}
  
  \CommentTok{\# Inititalise time index}
\NormalTok{  t }\OtherTok{=} \DecValTok{2}
  
  \CommentTok{\# Run the model as long as the number of periods Q hasn\textquotesingle{}t been reached yet and employment in sector 1 is positive }
  \ControlFlowTok{while}\NormalTok{ (t }\SpecialCharTok{\textless{}=}\NormalTok{ Q }\SpecialCharTok{\&\&}\NormalTok{ L1[i, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
    
   \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{ }
      
      \DocumentationTok{\#\# Model equations}
      \CommentTok{\# Output sector1 and wages sector 2}
      \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\NormalTok{cond }\SpecialCharTok{\&\&}\NormalTok{ L1[i, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{\textgreater{}}\NormalTok{ lambda) \{}
\NormalTok{      Y1[i,t] }\OtherTok{=}\NormalTok{ lambda}\SpecialCharTok{\^{}}\NormalTok{alpha}
\NormalTok{      w2[i,t]}\OtherTok{=}\NormalTok{ w1[i,t]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ rho)}
\NormalTok{      \}}
      \ControlFlowTok{else}\NormalTok{\{}
\NormalTok{      Y1[i,t] }\OtherTok{=}\NormalTok{ (L1[i,t]}\SpecialCharTok{\^{}}\NormalTok{alpha)}
\NormalTok{      w2[i,t]}\OtherTok{=}\NormalTok{ gamma[i,t]}\SpecialCharTok{*}\NormalTok{L2[i,t]}
\NormalTok{      cond }\OtherTok{=} \ConstantTok{TRUE} \CommentTok{\# set the flag to TRUE once the condition is violated }
                  \CommentTok{\#(this prevents the iterations loop from getting trapped between the two conditions)}
\NormalTok{      \}}

      \CommentTok{\# Employment sector 1}
\NormalTok{      L1[i,t] }\OtherTok{=}\NormalTok{ L }\SpecialCharTok{{-}}\NormalTok{ L2[i,t]}
     
      \CommentTok{\# Output sector 2}
\NormalTok{      Y2[i,t]}\OtherTok{=}\NormalTok{(L2[i,t]}\SpecialCharTok{\^{}}\NormalTok{beta)}\SpecialCharTok{*}\NormalTok{(K[i,t]}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta))}

      \CommentTok{\# MPL sector 2}
\NormalTok{      MPL2[i,t] }\OtherTok{=}\NormalTok{ beta}\SpecialCharTok{*}\NormalTok{ (Y2[i, t]}\SpecialCharTok{/}\NormalTok{L2[i, t]) }
            
      \CommentTok{\# Employment sector 2 }
\NormalTok{      L2[i,t] }\OtherTok{=}\NormalTok{L2[i, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ delta}\SpecialCharTok{*}\NormalTok{(MPL2[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ w2[i,t}\DecValTok{{-}1}\NormalTok{])}
      
      \CommentTok{\# Profits sector 2}
\NormalTok{      P2[i,t]}\OtherTok{=}\NormalTok{Y2[i,t] }\SpecialCharTok{{-}}\NormalTok{ w2[i,t]}\SpecialCharTok{*}\NormalTok{L2[i,t]}
      
      \CommentTok{\# Capital accumulation sector 2}
\NormalTok{      K[i,t]}\OtherTok{=}\NormalTok{ K[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ P2[i,t}\DecValTok{{-}1}\NormalTok{]}

\NormalTok{    \} }\CommentTok{\# close iterations loop}
    
      \ControlFlowTok{if}\NormalTok{ (L1[i, t] }\SpecialCharTok{\textgreater{}}\NormalTok{ lambda) \{}
\NormalTok{        tp[i] }\OtherTok{=}\NormalTok{ t }\CommentTok{\# record when turning point occurs}
\NormalTok{      \}}
    
      \ControlFlowTok{if}\NormalTok{ (L1[i, t] }\SpecialCharTok{\textless{}=} \DecValTok{0}\NormalTok{) \{}
\NormalTok{        end[i] }\OtherTok{=}\NormalTok{ t }\CommentTok{\# record when L1 becomes non{-}positive, which terminates the simulation}
\NormalTok{      \}}
    
    \CommentTok{\# Update time index  }
\NormalTok{     t }\OtherTok{=}\NormalTok{ t }\SpecialCharTok{+} \DecValTok{1}

\NormalTok{  \} }\CommentTok{\# close time loop}
\NormalTok{\} }\CommentTok{\# close scenarios loop}

\CommentTok{\# Calculate profits in S1}
\NormalTok{P1}\OtherTok{=}\NormalTok{Y1 }\SpecialCharTok{{-}}\NormalTok{ w1}\SpecialCharTok{*}\NormalTok{L1}

\CommentTok{\#Calculate aggregate profit share }
\NormalTok{PS}\OtherTok{=}\NormalTok{(P1 }\SpecialCharTok{+}\NormalTok{ P2)}\SpecialCharTok{/}\NormalTok{(Y1 }\SpecialCharTok{+}\NormalTok{ Y2)}

\CommentTok{\# Calculate sectoral profit shares}
\NormalTok{PS1}\OtherTok{=}\NormalTok{(P1)}\SpecialCharTok{/}\NormalTok{(Y1)}
\NormalTok{PS2}\OtherTok{=}\NormalTok{(P2)}\SpecialCharTok{/}\NormalTok{(Y2)}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{250}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{3}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Output in sector 1 (traditional)}
\NormalTok{Y2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Output in sector 2 (modern)}
\NormalTok{L1 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Employment in sector 1}
\NormalTok{L2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Employment in sector 2}
\NormalTok{w2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Real wage sector 2}
\NormalTok{MPL2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Marginal product of labour in sector 2}
\NormalTok{K }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Capital stock (only in sector 2)}
\NormalTok{P2 }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Profits in sector 2}

\CommentTok{\# Set fixed parameter values}
\NormalTok{alpha }\OperatorTok{=} \FloatTok{0.9}  \CommentTok{\# Labour elasticity of output, sector 1}
\NormalTok{rho }\OperatorTok{=} \DecValTok{1}  \CommentTok{\# Wage premium}
\NormalTok{L }\OperatorTok{=} \DecValTok{20}  \CommentTok{\# Total labour supply (exogenous)}
\NormalTok{lambda\_ }\OperatorTok{=} \DecValTok{10}  \CommentTok{\# Employment at which MPL in sector 1 becomes zero}
\NormalTok{beta }\OperatorTok{=} \FloatTok{0.7}  \CommentTok{\# Labour elasticity of output, sector 2}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# Sensitivity of employment in sector 2 to deviation of MPL2 from w2}

\CommentTok{\# Set baseline parameter values}
\NormalTok{w1 }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.4}\NormalTok{)  }\CommentTok{\# Subsistence real wage sector 1}
\NormalTok{gamma }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{0.12}\NormalTok{)  }\CommentTok{\# Labour supply coefficient, sector 2}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{w1[}\DecValTok{1}\NormalTok{, s:Q] }\OperatorTok{=} \FloatTok{0.3}  \CommentTok{\# Scenario 2: fall in subsistence wage}
\NormalTok{gamma[}\DecValTok{2}\NormalTok{, s:Q] }\OperatorTok{=} \FloatTok{0.17}  \CommentTok{\# Scenario 3: rise in labour supply elasticity}

\CommentTok{\# Create vectors that will record when the turning point occurs and when the simulation ends}
\NormalTok{tp }\OperatorTok{=}\NormalTok{ np.full(S, np.nan)}
\NormalTok{end }\OperatorTok{=}\NormalTok{ np.full(S, np.nan)}

\CommentTok{\# Initialise such that there is surplus labour (L1 \textgreater{} lambda)}
\NormalTok{L1[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=} \FloatTok{0.9} \OperatorTok{*}\NormalTok{ L}
\NormalTok{L2[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ L }\OperatorTok{{-}}\NormalTok{ L1[:, }\DecValTok{0}\NormalTok{]}

\CommentTok{\# Simulate the model by looping over time periods for different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
\NormalTok{    cond }\OperatorTok{=} \VariableTok{False}  \CommentTok{\# Flag for turning point condition}
\NormalTok{    t }\OperatorTok{=} \DecValTok{1}  \CommentTok{\# Initialize time index (Python uses 0{-}based indexing)}

    \CommentTok{\# Run the model as long as Q periods haven\textquotesingle{}t been reached and employment in sector 1 is positive}
    \ControlFlowTok{while}\NormalTok{ t }\OperatorTok{\textless{}}\NormalTok{ Q }\KeywordTok{and}\NormalTok{ L1[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{:}
        \ControlFlowTok{for}\NormalTok{ \_ }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1000}\NormalTok{):  }\CommentTok{\# Iterations loop}
            \CommentTok{\# Model equations for output sector 1 and wages sector 2}
            \ControlFlowTok{if} \KeywordTok{not}\NormalTok{ cond }\KeywordTok{and}\NormalTok{ L1[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{\textgreater{}}\NormalTok{ lambda\_:}
\NormalTok{                Y1[i, t] }\OperatorTok{=}\NormalTok{ lambda\_}\OperatorTok{**}\NormalTok{alpha}
\NormalTok{                w2[i, t] }\OperatorTok{=}\NormalTok{ w1[i, t] }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ rho)}
            \ControlFlowTok{else}\NormalTok{:}
\NormalTok{                Y1[i, t] }\OperatorTok{=}\NormalTok{ L1[i, t]}\OperatorTok{**}\NormalTok{alpha}
\NormalTok{                w2[i, t] }\OperatorTok{=}\NormalTok{ gamma[i, t] }\OperatorTok{*}\NormalTok{ L2[i, t]}
\NormalTok{                cond }\OperatorTok{=} \VariableTok{True}  \CommentTok{\# Set flag once condition is violated}

            \CommentTok{\# Employment sector 1}
\NormalTok{            L1[i, t] }\OperatorTok{=}\NormalTok{ L }\OperatorTok{{-}}\NormalTok{ L2[i, t]}

            \CommentTok{\# Output sector 2}
\NormalTok{            Y2[i, t] }\OperatorTok{=}\NormalTok{ (L2[i, t]}\OperatorTok{**}\NormalTok{beta) }\OperatorTok{*}\NormalTok{ (K[i, t]}\OperatorTok{**}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta))}

            \CommentTok{\# MPL sector 2}
\NormalTok{            MPL2[i, t] }\OperatorTok{=}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (Y2[i, t] }\OperatorTok{/}\NormalTok{ L2[i, t])}

            \CommentTok{\# Employment sector 2}
\NormalTok{            L2[i, t] }\OperatorTok{=}\NormalTok{ L2[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ (MPL2[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ w2[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}

            \CommentTok{\# Profits sector 2}
\NormalTok{            P2[i, t] }\OperatorTok{=}\NormalTok{ Y2[i, t] }\OperatorTok{{-}}\NormalTok{ w2[i, t] }\OperatorTok{*}\NormalTok{ L2[i, t]}

            \CommentTok{\# Capital accumulation sector 2}
\NormalTok{            K[i, t] }\OperatorTok{=}\NormalTok{ K[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ P2[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}

        \CommentTok{\# Record turning point}
        \ControlFlowTok{if}\NormalTok{ L1[i, t] }\OperatorTok{\textgreater{}}\NormalTok{ lambda\_:}
\NormalTok{            tp[i] }\OperatorTok{=}\NormalTok{ t}

        \CommentTok{\# Record when L1 becomes non{-}positive}
        \ControlFlowTok{if}\NormalTok{ L1[i, t] }\OperatorTok{\textless{}=} \DecValTok{0}\NormalTok{:}
\NormalTok{            end[i] }\OperatorTok{=}\NormalTok{ t}

        \CommentTok{\# Update time index}
\NormalTok{        t }\OperatorTok{+=} \DecValTok{1}

\CommentTok{\# Calculate profits in sector 1}
\NormalTok{P1 }\OperatorTok{=}\NormalTok{ Y1 }\OperatorTok{{-}}\NormalTok{ w1 }\OperatorTok{*}\NormalTok{ L1}

\CommentTok{\# Calculate aggregate profit share}
\NormalTok{PS }\OperatorTok{=}\NormalTok{ (P1 }\OperatorTok{+}\NormalTok{ P2) }\OperatorTok{/}\NormalTok{ (Y1 }\OperatorTok{+}\NormalTok{ Y2)}

\CommentTok{\# Calculate sectoral profit shares}
\NormalTok{PS1 }\OperatorTok{=}\NormalTok{ P1 }\OperatorTok{/}\NormalTok{ Y1}
\NormalTok{PS2 }\OperatorTok{=}\NormalTok{ P2 }\OperatorTok{/}\NormalTok{ Y2}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-12}

Figure~\ref{fig-output} - Figure~\ref{fig-capacc} display the model's
dynamics under the baseline scenario. The red vertical line marks the
`Lewis turning point', which is the period in which the surplus labour
in the traditional sector is depleted \((L_{1t}<\lambda)\). It can be
seen that before the Lewis turning point is reached, output in the
modern sector grows exponentially thanks to the availability of cheap
surplus labour whose employment comes with rising profits. After the
turning point, output continues to increase but at a lower rate. This is
because as the surplus labour in the traditional sector is depleted, the
modern sector faces an upward-sloping labour supply curve. As a result,
real wages increase and profits are reduced. This slows down capital
accumulation and growth. In the traditional sector, output falls after
the turning point as the sector now faces diminishing marginal return to
labour.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{50}
\NormalTok{Tmin}\OtherTok{=}\DecValTok{2}

\CommentTok{\#Output in the two sectors, baseline}
\FunctionTok{plot}\NormalTok{(Y1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(Y1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Output in traditional (Y1) and modern (Y2) sector"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{2}\NormalTok{])),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-output-1.pdf}

}

\caption{\label{fig-output}Output in traditional (Y1) and modern (Y2)
sector}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Employment in the two sectors, baseline}
\FunctionTok{plot}\NormalTok{(L1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"L"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(L1[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],L2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Employment in traditional (L1) and modern (L2) sector"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(L2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"right"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(L[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(L[}\DecValTok{2}\NormalTok{])),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-employment-1.pdf}

}

\caption{\label{fig-employment}Employment in traditional (L1) and modern
(L2) sector}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Profits and capital accumulation in manufacturing, baseline}
\FunctionTok{plot}\NormalTok{(P2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(P2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Capital accumulation and profits in modern sector"}\NormalTok{, }\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(P[}\DecValTok{2}\NormalTok{]), }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{,}\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]),}\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])))  }
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(K[}\DecValTok{2}\NormalTok{]), }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(P[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(K[}\DecValTok{2}\NormalTok{])),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-capacc-1.pdf}

}

\caption{\label{fig-capacc}Capital accumulation and profits in modern
sector}

\end{figure}%

Figure~\ref{fig-wage} and Figure~\ref{fig-profshare} illustrate the
distributional implications of the model. Before the Lewis turning
point, the profit share of the modern sector increases, as firms benefit
from a real wage that is fixed below the marginal product of labour.
After the turning point, real wages jump upwards and begin to increase
further, gradually closing the gap with the marginal product. As a
result, the profit share falls and embarks on a downward convergence to
the level implied by the marginal product of labour.\footnote{In
  equilibrium, where \(L_{2t} - L_{2t-1} =0\), the real wage \(w_2\)
  will be equal to the MPL in sector 2. The profit share is then
  constant and given by \(\frac{P{_2}}{Y{_2}} = 1-\beta\).} The
aggregate profit share broadly displays an inverted U-shaped pattern.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Real wage and profit share in manufacturing}
\FunctionTok{plot}\NormalTok{(PS2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(Tmin}\SpecialCharTok{:}\NormalTok{Tmax), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(PS2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Profit share and real wage in modern sector"}\NormalTok{,}\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(pi[}\DecValTok{2}\NormalTok{]), }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(w2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\NormalTok{Tmax),}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(w2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{cex.axis=}\DecValTok{1}\NormalTok{,}\AttributeTok{cex.lab=}\FloatTok{0.75}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at =} \FunctionTok{pretty}\NormalTok{(}\FunctionTok{range}\NormalTok{(w2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])))  }
\FunctionTok{mtext}\NormalTok{(}\FunctionTok{expression}\NormalTok{(w[}\DecValTok{2}\NormalTok{]), }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(pi[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(w[}\DecValTok{2}\NormalTok{])),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-wage-1.pdf}

}

\caption{\label{fig-wage}Real wage and profit share in modern sector}

\end{figure}%

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Aggregate profit share}
\FunctionTok{plot}\NormalTok{(PS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(pi), }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(Tmin}\SpecialCharTok{:}\NormalTok{Tmax), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(PS[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Aggregate profit share"}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-profshare-1.pdf}

}

\caption{\label{fig-profshare}Aggregate profit share}

\end{figure}%

Figure~\ref{fig-scen2} compares output dynamics in the modern sector for
the baseline scenario with scenario 2 in which the subsistence wage
\(w^s\) is fixed at a lower level and with scenario 3 in which the
labour supply elasticity \(\gamma\) the modern sector faces after the
turning point is higher. It can be seen that for a lower subsistence
wage, the modern sector grows faster and the Lewis turning point is
reached earlier. For a higher labour supply elasticity, the labour
supply curve after the turning point is steeper, which leads to a faster
increase in the real wage, a stronger squeeze of profits, and thus
slower output growth. These results illustrate the Classical nature of
the model, whereby capital accumulation is driven by profits. Thus, any
reduction in profits slows down the growth process.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Tmax}\OtherTok{=}\DecValTok{60}
\FunctionTok{plot}\NormalTok{(Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlim=}\FunctionTok{range}\NormalTok{(Tmin}\SpecialCharTok{:}\NormalTok{Tmax), }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{2}\NormalTok{]), }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(Y2[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y2[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax])) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Output in  modern sector"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{ ,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y2[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(Y2[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{1}\NormalTok{], }\AttributeTok{col =} \StringTok{"darkred"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ tp[}\DecValTok{2}\NormalTok{], }\AttributeTok{col =} \StringTok{"red"}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"1: baseline"}\NormalTok{, }\StringTok{"2: lower subsistence wage"}\NormalTok{, }\StringTok{"3: higher labour supply elasticity"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Lewis_model_files/figure-pdf/fig-scen2-1.pdf}

}

\caption{\label{fig-scen2}Output in modern sector under different
scenarios}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Plots (here only for output)}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set start and end periods for plots (set as integers)}
\NormalTok{Tmax }\OperatorTok{=} \BuiltInTok{int}\NormalTok{(end[}\DecValTok{0}\NormalTok{] }\OperatorTok{{-}}\DecValTok{2}\NormalTok{)}
\NormalTok{Tmin }\OperatorTok{=} \BuiltInTok{int}\NormalTok{(}\DecValTok{2}\NormalTok{)}

\CommentTok{\# Output in the two sectors, baseline}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{), Y1[}\DecValTok{0}\NormalTok{, Tmin:Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}k{-}\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}Y1\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{), Y2[}\DecValTok{0}\NormalTok{, Tmin:Tmax }\OperatorTok{+} \DecValTok{1}\NormalTok{], }\StringTok{\textquotesingle{}k{-}{-}\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}Y2\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Highlight Lewis turning point}
\NormalTok{plt.axvline(x}\OperatorTok{=}\NormalTok{tp[}\DecValTok{0}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}darkred\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Set plot labels and title}
\NormalTok{plt.title(}\StringTok{\textquotesingle{}Output in traditional (Y1) and modern (Y2) sector\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylim(}\BuiltInTok{min}\NormalTok{(Y1[}\DecValTok{0}\NormalTok{, Tmin:Tmax]), }\BuiltInTok{max}\NormalTok{(Y2[}\DecValTok{0}\NormalTok{, Tmin:Tmax]))}

\CommentTok{\# Add legend}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}upper left\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Show the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-12}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 9 variables: }

\CommentTok{\#              Y1,Y2,L1,L2,w1,w2,P2,K, MPL2}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
               \DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DecValTok{9}\NormalTok{, }\DecValTok{9}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian }
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=} \FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(Y[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(L[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(L[}\DecValTok{2}\NormalTok{]), }
             \FunctionTok{expression}\NormalTok{(w[}\DecValTok{1}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(w[}\DecValTok{2}\NormalTok{]), }\FunctionTok{expression}\NormalTok{(P[}\DecValTok{2}\NormalTok{]), }\StringTok{"K"}\NormalTok{, }\StringTok{"MPL"}\NormalTok{)}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Directed Graph of Lewis Model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{20}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_Lewis_model_files/figure-pdf/lewisDAG-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create directed graph}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Create the adjacency matrix (M\_mat in R)}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]])}

\CommentTok{\# Transpose the matrix to get A\_mat}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.transpose()}

\CommentTok{\# Create a directed graph from the adjacency matrix using networkx}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define the node labels as expressions for plotting}
\NormalTok{nodelabs  }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$Y\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{1}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$Y\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{2}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$L\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{3}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$L\_2$\textquotesingle{}}\NormalTok{, }
          \DecValTok{4}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$w\_1$\textquotesingle{}}\NormalTok{, }\DecValTok{5}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$w\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{6}\NormalTok{: }\VerbatimStringTok{r\textquotesingle{}$P\_2$\textquotesingle{}}\NormalTok{, }\DecValTok{7}\NormalTok{: }\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{, }\DecValTok{8}\NormalTok{: }\StringTok{\textquotesingle{}MPL\textquotesingle{}}\NormalTok{\}}

\CommentTok{\# Plot the graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, k}\OperatorTok{=}\FloatTok{0.4}\NormalTok{)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{200}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{8}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}
\NormalTok{plt.axis(}\StringTok{"off"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Directed Graph of Lewis Model"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The directed graph illustrates that the subsistence wage in the
traditional sector \(w_1=w^s\) is the key exogenous variables that
impact the dynamics of growth and distribution via its effect on real
wages in the modern sector. Employment, output, profits, and capital
accumulation in the modern sector form a closed loop (or cycle) within
the system. The traditional sector plays a residual role.

\section{Analytical discussion}\label{analytical-discussion-10}

Let us analyse the dynamic stability of the model before the Lewis
turning point, i.e.~for the case where \((L_{1t}>\lambda)\) such that
\(w_2\) is exogenous. Combining Equation~\ref{eq-lewis_L2} and
Equation~\ref{eq-lewis_MPL} yields a first-order difference equation for
\(L_2\), and combining Equation~\ref{eq-lewis_K2},
Equation~\ref{eq-lewis_P2}, and Equation~\ref{eq-lewis_L2}, yields a
first-order difference equation for \(K_2\):

\[
L_{2t}= L_{2t-1} + \delta(\beta L_{2t-1}^{\beta -1}K_{2t-1}^{1-\beta} - w_{2})
\] \[
K_{2t}=K_{2t-1} + L_{2t-1}^\beta K_{2t-1}^{1-\beta} - wL_{2t-1}
\] The Jacobian matrix is given by:

\[
J(L_2, K_2)=\begin{bmatrix} 1+ \delta\beta (\beta-1) L_{2t-1}^{\beta-2} K_{2t-1}^{1-\beta}   &\delta\beta (1-\beta) L_{2t-1}^{\beta-1} K_{2t-1}^{-\beta} \\ \beta L_{2t-1}^{\beta-1} K_{2t-1}^{1-\beta} -w & 1+ (1-\beta) L_{2t-1}^{\beta} K_{2t-1}^{-\beta} \end{bmatrix}.
\]

For the system to be stable, both eigenvalues of the Jacobian need to be
inside the unit circle. This requires the following three conditions to
hold:

\[
1+tr(J)+det(J)>0
\] \[
1-tr(J)+det(J)>0
\] \[
1-det(J)>0,
\] where \(tr(J)\) is the trace and \(det(J)\) is the determinant of the
Jacobian.

With \(tr(J)\) clearly positive, let us focus on \(1-tr(J)+det(J)>0\).
Plugging in \(tr(J)\) and \(det(J)\) and simplifying yields:

\[
w_2 - \frac{Y_{2t-1}}{L_{2t-1}}>0.
\] As long as the real wage is below the average product of labour,
\(\frac{Y_{2}}{L_{2}}\), the condition will be violated, as there are
positive profits and thus capital accumulation. With the real wage being
lower or equal to the marginal product of labour, this is indeed the
case. The system is then dynamically unstable and will generate
exponential growth.

We can check this stability analysis numerically:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Examine stability before the turning point (here for the baseline scenario only)}

\CommentTok{\# Construct Jacobian matrix before the turning point }
\NormalTok{J}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ delta}\SpecialCharTok{*}\NormalTok{beta}\SpecialCharTok{*}\NormalTok{(beta}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(L2[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(beta}\DecValTok{{-}2}\NormalTok{))}\SpecialCharTok{*}\NormalTok{(K[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta)), }
\NormalTok{           delta}\SpecialCharTok{*}\NormalTok{beta}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta)}\SpecialCharTok{*}\NormalTok{(L2[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(beta}\DecValTok{{-}1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{(K[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{beta)),}
\NormalTok{           beta}\SpecialCharTok{*}\NormalTok{(L2[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(beta}\DecValTok{{-}1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{(K[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta)) }\SpecialCharTok{{-}}\NormalTok{ w2[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{],}
           \DecValTok{1} \SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{beta)}\SpecialCharTok{*}\NormalTok{(L2[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(beta))}\SpecialCharTok{*}\NormalTok{(K[}\DecValTok{1}\NormalTok{,tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{beta))), }
          \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J)}
\NormalTok{(}\AttributeTok{values =}\NormalTok{ ev}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.0552484 0.9580697
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{(}\AttributeTok{det=}\FunctionTok{det}\NormalTok{(J))      }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.011002
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\AttributeTok{tr=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J))) }\CommentTok{\# trace}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.013318
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Check stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check simplified stability condition}
\FunctionTok{print}\NormalTok{(w2[}\DecValTok{1}\NormalTok{,(tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)] }\SpecialCharTok{{-}}\NormalTok{ Y2[}\DecValTok{1}\NormalTok{,(tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)]}\SpecialCharTok{/}\NormalTok{L2[}\DecValTok{1}\NormalTok{,(tp[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)] }\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Examine stability before the turning point (here for the baseline scenario only)}

\CommentTok{\# Set turning point as integer}
\NormalTok{tp }\OperatorTok{=}\NormalTok{ tp.astype(}\BuiltInTok{int}\NormalTok{)  }

\CommentTok{\# Construct Jacobian matrix before the turning point }
\NormalTok{J }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{1} \OperatorTok{+}\NormalTok{ delta }\OperatorTok{*}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (beta }\OperatorTok{{-}} \DecValTok{1}\NormalTok{) }\OperatorTok{*}\NormalTok{ (L2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (beta }\OperatorTok{{-}} \DecValTok{2}\NormalTok{)) }\OperatorTok{*}\NormalTok{ (K[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta)),}
\NormalTok{     delta }\OperatorTok{*}\NormalTok{ beta }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta) }\OperatorTok{*}\NormalTok{ (L2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (beta }\OperatorTok{{-}} \DecValTok{1}\NormalTok{)) }\OperatorTok{*}\NormalTok{ (K[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\NormalTok{beta))],}
\NormalTok{    [beta }\OperatorTok{*}\NormalTok{ (L2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (beta }\OperatorTok{{-}} \DecValTok{1}\NormalTok{)) }\OperatorTok{*}\NormalTok{ (K[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta)) }\OperatorTok{{-}}\NormalTok{ w2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{],}
     \DecValTok{1} \OperatorTok{+}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ beta) }\OperatorTok{*}\NormalTok{ (L2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ beta) }\OperatorTok{*}\NormalTok{ (K[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{**}\NormalTok{ (}\OperatorTok{{-}}\NormalTok{beta))]}
\NormalTok{])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{eigenvalues, eigenvectors }\OperatorTok{=}\NormalTok{ np.linalg.eig(J)}
\BuiltInTok{print}\NormalTok{(eigenvalues)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det }\OperatorTok{=}\NormalTok{ np.linalg.det(J)}
\NormalTok{tr }\OperatorTok{=}\NormalTok{ np.trace(J)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{tr}\OperatorTok{+}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{det}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)}

\CommentTok{\# Check simplified stability condition}
\BuiltInTok{print}\NormalTok{(w2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ Y2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ L2[}\DecValTok{0}\NormalTok{, tp[}\DecValTok{0}\NormalTok{]}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-14}

\chapter{A Hicksian Business Cycle Model with Floors and
Ceilings}\label{sec-hicks}

\section{Overview}\label{overview-12}

This model captures some key features of John R. J. R. Hicks (1950)'
nonlinear model of business cycle fluctuations. The model builds on
Samuelson (1939)'s linear multiplier-accelerator model analysed in
Chapter~\ref{sec-how-to-simulate} and Chapter~\ref{sec-stab_analysis},
but gives it a different twist. While Samuelson (1939)'s business cycle
model usually requires repeated external shocks to produce sustained
cycles, J. R. Hicks (1950)'s model produces permanent, shock-independent
fluctuations that are bounded by a floor and a ceiling.\footnote{More
  precisely, Samuelson (1939)'s model generates shock-independent cycles
  only for a very specific parameter combination, whereas J. R. Hicks
  (1950)'s model generates endogenous cycles for a much broader set of
  parameters.} The goods market equilibrium is assumed to be locally
unstable due to a strong accelerator effect, i.e.~investment reacts
strongly to increases in aggregate output, which creates more output and
boosts investment even further. However, aggregate output is constrained
by a ceiling that may stem from full employment (and a fixed labour
supply). On the downward trajectory, output is constrained by a floor
that is given by a minimum amount of investment needed to replace the
depreciated capital stock.

We present a version of the model that is adapted from Gabisch and
Lorenz (1989), chapter 2.1.\footnote{Following Hommes (1995), we
  consider a stationary version of the model that abstracts from the
  growth path assumed in J. R. Hicks (1950).}

\section{The Model}\label{the-model-13}

\begin{equation}\phantomsection\label{eq-hicks_Y}{
  Y_{t}=\min[C_t + I_t, Y^C] 
}\end{equation}

\begin{equation}\phantomsection\label{eq-hicks_C}{
C_{t} = c_0 + c_1 Y_{t-1},  \quad c_1 \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-hicks_I}{
I_{t} = I_0 + \max[\beta(Y_{t-1} - Y_{t-2}), -D],  \quad \beta > 1, D >0 
}\end{equation}

where \(Y_t\), \(C_t\), \(I_t\), \(Y^C\), and \(D\), represent output,
consumption, investment, the (full employment) output ceiling, and
depreciation, respectively.

Equation~\ref{eq-hicks_Y} specifies aggregate income. For values below
the ceiling \(Y^C\), aggregate income is determined by aggregate demand
(consisting only of consumption and net investment). As soon as
aggregate demand hits the ceiling, aggregate income is given by the
ceiling. Equation~\ref{eq-hicks_C} is a simple linear Keynesian
consumption function. Equation~\ref{eq-hicks_I} is the investment
function. For investment levels above depreciation \(D\), net investment
is given by an autonomous component \(I_0\) and an accelerator component
that is responsive to the change in aggregate income.\footnote{ This
  differs from Samuelson (1939), who assumed that investment reacts to
  changes in consumption, see Chapter~\ref{sec-how-to-simulate}.} The
reaction coefficient \(\beta\) is assumed to be sufficiently large to
generate explosive dynamics. Once the change in aggregate income has
fallen below the negative of the level of depreciation \(D\), net
investment is given by the floor \(I_0 - D\).

\section{Simulation}\label{simulation-13}

\subsection{Parameterisation}\label{parameterisation-13}

Table 1 reports the parameterisation used in the simulation. Besides a
baseline (scenario 1), we consider a fall in the output ceiling \(Y^C\)
in scenario 2, an increase in the investment floor \(I_0 - D\) in
scenario 3, and finally a decrease in the accelerator coefficient
\(\beta\) (scenario 4).

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.5385}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0549}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0989}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0989}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0769}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0549}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Scenario
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(c_1\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(I_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(\beta\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(Y^C\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\(D\)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1: baseline & 0 & 0.75 & 10 & 1.25 & 80 & 10 \\
2: fall in output ceiling (\(Y^C\)) & 0 & 0.75 & 10 & 1.25 & 100 & 10 \\
3: increase in investment floor (\(I_0 - D\)) & 0 & 0.75 & 10 & 1.25 &
80 & 1 \\
4: decrease in accelerator coefficient (\(\beta\)) & 0 & 0.75 & 10 & 0.8
& 80 & 10 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-13}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{200}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S}\OtherTok{=}\DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s}\OtherTok{=}\DecValTok{50}

\CommentTok{\# Create (S x Q){-}matrices that will contain the simulated data}
\NormalTok{Y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Income/output}
\NormalTok{C}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Consumption}
\NormalTok{I}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Investment}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0}\OtherTok{=}\DecValTok{0}
\NormalTok{c1}\OtherTok{=}\FloatTok{0.75}
\NormalTok{I0}\OtherTok{=}\DecValTok{10}

\CommentTok{\# Set baseline parameter values}
\NormalTok{Yc}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{80}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q)      }\CommentTok{\# output ceiling}
\NormalTok{D}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{10}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q)       }\CommentTok{\# investment floor (depreciation)}
\NormalTok{beta}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\FloatTok{1.25}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{S,}\AttributeTok{ncol=}\NormalTok{Q)  }\CommentTok{\# accelerator coefficient}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{Yc[}\DecValTok{2}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{100} \CommentTok{\# scenario 2: increase in output ceiling}
\NormalTok{D[}\DecValTok{3}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\DecValTok{1}    \CommentTok{\# scenario 3: increase in investment floor}
\NormalTok{beta[}\DecValTok{4}\NormalTok{,s}\SpecialCharTok{:}\NormalTok{Q]}\OtherTok{=}\FloatTok{0.8} \CommentTok{\# scenario 4: reduction in accelerator coefficient}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{S)\{}
  
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{500}\NormalTok{)\{ }\CommentTok{\# run the model 500{-}times in each period}
      
    \CommentTok{\#Model equations}
    
    \CommentTok{\#(1) Output}
\NormalTok{    Y[i,t] }\OtherTok{=} \FunctionTok{min}\NormalTok{(C[i,t]}\SpecialCharTok{+}\NormalTok{I[i,t], Yc[i,t])}
    
    \CommentTok{\#(2) Consumption}
\NormalTok{    C[i,t] }\OtherTok{=}\NormalTok{ c0 }\SpecialCharTok{+}\NormalTok{ c1}\SpecialCharTok{*}\NormalTok{Y[i,t}\DecValTok{{-}1}\NormalTok{]}
    
    \CommentTok{\#(3) Investment}
\NormalTok{    I[i,t] }\OtherTok{=}\NormalTok{ I0 }\SpecialCharTok{+} \FunctionTok{max}\NormalTok{(beta[i,t]}\SpecialCharTok{*}\NormalTok{(Y[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ Y[i,t}\DecValTok{{-}2}\NormalTok{]), }\SpecialCharTok{{-}}\NormalTok{D[i,t]) }
    
\NormalTok{    \} }\CommentTok{\# close iterations loop}
\NormalTok{  \}   }\CommentTok{\# close time loop}
\NormalTok{\}     }\CommentTok{\# close scenario loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{200}

\CommentTok{\# Set number of scenarios (including baseline)}
\NormalTok{S }\OperatorTok{=} \DecValTok{4}

\CommentTok{\# Set period in which shock/shift will occur}
\NormalTok{s }\OperatorTok{=} \DecValTok{50}

\CommentTok{\# Create (S x Q){-}arrays that will contain the simulated data}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Income/output}
\NormalTok{C }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Consumption}
\NormalTok{I }\OperatorTok{=}\NormalTok{ np.ones((S, Q))  }\CommentTok{\# Investment}

\CommentTok{\# Set fixed parameter values}
\NormalTok{c0 }\OperatorTok{=} \DecValTok{0}
\NormalTok{c1 }\OperatorTok{=} \FloatTok{0.75}
\NormalTok{I0 }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Set baseline parameter values}
\NormalTok{Yc }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{80}\NormalTok{)      }\CommentTok{\# output ceiling}
\NormalTok{D }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\DecValTok{10}\NormalTok{)       }\CommentTok{\# investment floor (depreciation)}
\NormalTok{beta }\OperatorTok{=}\NormalTok{ np.full((S, Q), }\FloatTok{1.25}\NormalTok{)  }\CommentTok{\# accelerator coefficient}

\CommentTok{\# Set parameter values for different scenarios}
\NormalTok{Yc[}\DecValTok{1}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{100}     \CommentTok{\# scenario 2: increase in output ceiling}
\NormalTok{D[}\DecValTok{2}\NormalTok{, s:Q] }\OperatorTok{=} \DecValTok{1}        \CommentTok{\# scenario 3: increase in investment floor}
\NormalTok{beta[}\DecValTok{3}\NormalTok{, s:Q] }\OperatorTok{=} \FloatTok{0.8}   \CommentTok{\# scenario 4: reduction in accelerator coefficient}

\CommentTok{\# Simulate the model by looping over Q time periods for S different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(S):}
    
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        
        \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{500}\NormalTok{):  }\CommentTok{\# run the model 500{-}times in each period}
            
            \CommentTok{\# Model equations}
            
            \CommentTok{\# (1) Output}
\NormalTok{            Y[i, t] }\OperatorTok{=} \BuiltInTok{min}\NormalTok{(C[i, t] }\OperatorTok{+}\NormalTok{ I[i, t], Yc[i, t])}
            
            \CommentTok{\# (2) Consumption}
\NormalTok{            C[i, t] }\OperatorTok{=}\NormalTok{ c0 }\OperatorTok{+}\NormalTok{ c1 }\OperatorTok{*}\NormalTok{ Y[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{]}
            
            \CommentTok{\# (3) Investment}
\NormalTok{            I[i, t] }\OperatorTok{=}\NormalTok{ I0 }\OperatorTok{+} \BuiltInTok{max}\NormalTok{(beta[i, t] }\OperatorTok{*}\NormalTok{ (Y[i, t }\OperatorTok{{-}} \DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ Y[i, t }\OperatorTok{{-}} \DecValTok{2}\NormalTok{]), }\OperatorTok{{-}}\NormalTok{D[i, t])}
            
        \CommentTok{\# Close iterations loop}
    \CommentTok{\# Close time loop}
\CommentTok{\# Close scenario loop}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-13}

Figure~\ref{fig-baseline} displays the model's dynamics under the
baseline scenario. The model generates cycles in aggregate output,
consumption and investment that are constrained by the output ceiling
\(Y^C=80\) and the investment floor \(I_0-D=0\). These cycles are
permanent, i.e.~they don't require any external shocks, and they are
(roughly) periodic, with a cycle length from peak (trough) to peak
(trough) of around 13.5 periods. What generates the turning points?
Suppose income is on an increasing trajectory. The accelerator effect on
investment will amplify this process as firms will increase their
investment, which raises aggregate demand and increases income further.
When the output ceiling is reached, the change in income becomes zero,
and investment demand decreases relative to the boom phase. This
decrease in investment lowers aggregate output, and the accelerator
effect again amplifies this tendency that now plays out on a downward
trajectory until net investment hits the lower bound. Once investment
has stopped its downward trajectory, aggregate income stops falling as
well, which allows the accelerator effect to turn positive again and
thereby induce a new cycle.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{100}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{10}

\CommentTok{\#Income, consumption, and investment}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y, C, I"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(I[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)]))}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Income, consumption, and investment (baseline)"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(C[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(I[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Hicks_model_files/figure-pdf/fig-baseline-1.pdf}

}

\caption{\label{fig-baseline}Income, consumption, and investment
(baseline)}

\end{figure}%

In Figure~\ref{fig-scen2}, the output ceiling rises to \(Y^C = 100\) in
\(t=50\). This raises the amplitude of the cycles. Interestingly, the
ceiling is no longer binding, but the cycles still do not explode. This
illustrates a feature of the model that has been noted before: it
actually does not need a ceiling to generate bounded cycles (see, e.g.,
Puu, Gardini, and Sushko (2005)). The acceleration of income during a
boom will become smaller and smaller, and eventually turn negative,
thereby lowering investment and inducing a switch from boom to bust.
Hence, cycles (and thus turning points) will occur even without floor
and ceilings, but to prevent these cycles to become larger and larger, a
floor is sufficient.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Scenario 2: increase in ceiling}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y, C, I"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(I[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)]))}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Scenario 2: Increase in output ceiling"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(C[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(I[}\DecValTok{2}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Hicks_model_files/figure-pdf/fig-scen2-1.pdf}

}

\caption{\label{fig-scen2}Increase in output ceiling}

\end{figure}%

An increase in the investment floor to \(I_0 - D = 9\) in period
\(t=50\), displayed in Figure~\ref{fig-scen3}, has the effect of
reducing the amplitude of the fluctuations. Intuitively, the milder the
bust, the milder the recovery.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Scenario 3: increase in investment floor}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y, C, I"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(I[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)]))}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Scenario 3: Increase in investment floor"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(C[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(I[}\DecValTok{3}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Hicks_model_files/figure-pdf/fig-scen3-1.pdf}

}

\caption{\label{fig-scen3}Increase in investment floor}

\end{figure}%

Finally, Figure~\ref{fig-scen4} displays the scenario where the
accelerator coefficient \(\beta\) falls, rendering investment much less
sensitive to changes in aggregate income. As a result, the model's
regular cycles turn into damped oscillations that eventually converge to
a stable equilibrium.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Scenario 4: Reduction in accelerator coefficient}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y, C, I"}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(I[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],Y[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)]))}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Scenario 4: Reduction in accelerator coefficient"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(C[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(I[}\DecValTok{4}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Hicks_model_files/figure-pdf/fig-scen4-1.pdf}

}

\caption{\label{fig-scen4}Reduction in accelerator coefficient}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Plots (here only for baseline)}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{100}
\NormalTok{Tmin }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Plot income (Y), consumption (C), and investment (I)}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax), Y[}\DecValTok{0}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Income, consumption, and investment (baseline)"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}
\NormalTok{plt.xlabel(}\StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{\textquotesingle{}Y, C, I\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax), C[}\DecValTok{0}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}C\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,)}
\NormalTok{plt.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax), I[}\DecValTok{0}\NormalTok{, Tmin:Tmax], label}\OperatorTok{=}\StringTok{\textquotesingle{}I\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}:\textquotesingle{}}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,)}

\CommentTok{\# Add a legend to the top{-}left corner}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}upper left\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{8}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{)}

\CommentTok{\# Show the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Directed graph}\label{directed-graph-13}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 5 variables: }
  \CommentTok{\# endogenous: (1) Y, (2) C, (3) I}
  \CommentTok{\# exogenous: (4) I0{-}D, (5) Yc}

              \CommentTok{\#Y C I I0{-}D Yc}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\DecValTok{1}\NormalTok{, }\CommentTok{\# Y}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\DecValTok{0}\NormalTok{, }\CommentTok{\# C}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{,  }\DecValTok{0}\NormalTok{, }\CommentTok{\# I}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\DecValTok{0}\NormalTok{, }\CommentTok{\# I0{-}D}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,  }\DecValTok{0}\NormalTok{),}\CommentTok{\# Yc}
               \DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian and add column names}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(I[}\DecValTok{0}\NormalTok{]}\SpecialCharTok{{-}}\NormalTok{D), }\FunctionTok{expression}\NormalTok{(Y}\SpecialCharTok{\^{}}\NormalTok{C))}

\CommentTok{\# Plot directed graph matrix}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Directed graph of Hicks model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{40}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_Hicks_model_files/figure-pdf/hicks_6-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Directed graph}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Construct auxiliary Jacobian matrix for 5 variables: }
\CommentTok{\# endogenous: (1) Y, (2) C, (3) I}
\CommentTok{\# exogenous: (4) I0{-}D, (5) Yc}

\CommentTok{\# Create the matrix M\_mat}
\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],  }\CommentTok{\# Y}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# C}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# I}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# I0{-}D}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]]) }\CommentTok{\# Yc}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.T}

\CommentTok{\# Create directed graph from adjacency matrix using networkx}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"C"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"I"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"$I\_0 {-} D$"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\StringTok{"$Y\^{}C$"}\NormalTok{\}}

\CommentTok{\# Plot directed graph}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, k}\OperatorTok{=}\FloatTok{0.08}\NormalTok{)}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{200}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{8}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}
\NormalTok{plt.axis(}\StringTok{"off"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Directed Graph of Lewis Model"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

It can thus be seen that the key exogenous variables in the J. R. Hicks
(1950) model are the output ceiling \(Y^C\) and the investment floor
\(I_0 - D\), which constrain the endogenous cycle generated by the
interaction between the endogenous variables income \(Y\), investment
\(I\), and consumption \(C\).

\section{Analytical discussion}\label{analytical-discussion-11}

The dynamic properties of the J. R. Hicks (1950) model when the floor
and ceiling are not binding are similar, but not entirely equivalent to
the Samuelson (1939) model analysed in Chapter~\ref{sec-stab_analysis}.

First, define \(X_t = Y_{t-1}\) to re-write the system as:

\begin{equation}\phantomsection\label{eq-hicks_X}{
  X_{t}=\min[C_{t-1} + I_{t-1}, Y^C] 
}\end{equation}

\begin{equation}\phantomsection\label{eq-hicks_C_mod}{
C_{t} = c_0 + c_1 X_{t}
}\end{equation}

\begin{equation}\phantomsection\label{eq-hicks_I_mod}{
I_{t} = I_0 + \max[\beta(X_{t} - X_{t-1}), -D].
}\end{equation}

Then shift Equation~\ref{eq-hicks_C_mod} one period back and substite
into Equation~\ref{eq-hicks_X} to obtain:

\begin{equation}\phantomsection\label{eq-hicks_X_mod}{
  X_{t}=\min [c_0 + c_1 X_{t-1} + I_{t-1}, Y^C]. 
}\end{equation}

Next, substitute Equation~\ref{eq-hicks_X_mod} into
Equation~\ref{eq-hicks_I_mod}:

\begin{equation}\phantomsection\label{eq-hicks_I_mod2}{
I_{t} = I_0 + \max[\beta( c_0 + (c_1 -1) X_{t-1} + I_{t-1}), -D].
}\end{equation}

Equation~\ref{eq-hicks_X_mod} and Equation~\ref{eq-hicks_I_mod2} are a
two-dimensional dynamic system in \(X_t\) and \(It\).

For \(Y_t < Y^C\) and \(I_t > I_0 - D\), the system's Jacobian matrix is
given by:

\[
J=\begin{bmatrix} c_1 & 1 \\ \beta(c_1-1) & \beta  \end{bmatrix}.
\]

The characteristic polynomial yielding the eigenvalues of the Jacobian
is:

\[\lambda^2-\lambda(c_1+\beta)+\beta=0,\]

where \(c_1+\beta =tr(J)\) and \(\beta = det(J)\).

Thus, we have:

\[
\lambda_{1,2} = \frac{(c_1+\beta) \pm \sqrt{(c_1+\beta)^2-4\beta}}{2},
\]

and two eigenvalues will be a pair of complex conjugates if
\((c_1+\beta)^2-4\beta <0\) or
\(\left( \frac{c_1+\beta}{2} \right)^2 < \beta\).

To assess stability, we need to check whether the modulus of the complex
eigenvalue \(R\) is inside the unit circle, i.e.~\(R \in (-1,1)\). For a
two-dimensional system with complex eigenvalues, we have
\(R=\sqrt{det(J)}\). Thus, the stability condition for the Hicks model
is \(\beta <1\).

The following code generates a plot that displays the condition for
cycles, \(\left( \frac{c_1+\beta}{2} \right)^2 < \beta\), and the
stability condition, \(\beta <1\), in the
\((\beta, c_1)\)-space:\footnote{To create the function for the cycle
  condition, we set \(\left( \frac{c_1+\beta}{2} \right)^2 = \beta\) and
  solve for \(c_1\), where we only consider positive values for \(c_1\)
  and \(\beta\).}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create function for cycle condition using beta as argument}
\NormalTok{cyc}\OtherTok{=} \ControlFlowTok{function}\NormalTok{ (beta) \{}
  \DecValTok{2}\SpecialCharTok{*}\FunctionTok{sqrt}\NormalTok{(beta)}\SpecialCharTok{{-}}\NormalTok{beta}
\NormalTok{\}}

\CommentTok{\# Plot the two conditions in (beta, c1){-}space}
\FunctionTok{curve}\NormalTok{(cyc, }\AttributeTok{from =} \DecValTok{0}\NormalTok{, }\AttributeTok{to =} \FloatTok{4.5}\NormalTok{, }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\FunctionTok{expression}\NormalTok{(beta), }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(c[}\DecValTok{1}\NormalTok{]) , }\AttributeTok{main=}\StringTok{""}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{, }\AttributeTok{n=}\DecValTok{10000}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{1.5}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\DecValTok{1}\NormalTok{, }\AttributeTok{col=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"cycle condition"}\NormalTok{, }\StringTok{"stability condition"}\NormalTok{), }
       \AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{a_Hicks_model_files/figure-pdf/hicks_7-2.pdf}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create function for cycle condition using beta as an argument}
\KeywordTok{def}\NormalTok{ cyc(beta):}
    \ControlFlowTok{return} \DecValTok{2} \OperatorTok{*}\NormalTok{ np.sqrt(beta) }\OperatorTok{{-}}\NormalTok{ beta}

\CommentTok{\# Define the range for beta }
\NormalTok{beta\_values }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{0}\NormalTok{, }\FloatTok{4.5}\NormalTok{, }\DecValTok{10000}\NormalTok{)}

\CommentTok{\# Compute the corresponding c1 values using the cyc function}
\NormalTok{c1\_values }\OperatorTok{=}\NormalTok{ cyc(beta\_values)}

\CommentTok{\# Plot the cycle condition in (beta, c1){-}space}
\NormalTok{plt.plot(beta\_values, c1\_values, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}cycle condition\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Plot the stability condition as a vertical line at beta = 1}
\NormalTok{plt.axvline(x}\OperatorTok{=}\DecValTok{1}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}stability condition\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Set labels and title}
\NormalTok{plt.xlabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}beta$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.ylabel(}\VerbatimStringTok{r\textquotesingle{}$c\_1$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Set y{-}axis limit }
\NormalTok{plt.ylim(}\DecValTok{0}\NormalTok{, }\FloatTok{1.5}\NormalTok{)}

\CommentTok{\# Add legend}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}upper right\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Show the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The Hicks model requires combinations of \(c_1\) and \(\beta\) below the
cycle condition and to the right of the stability condition to yield
cycles that would be explosive without the floor.

We can also compute the eigenvalues and check the general stability
conditions numerically.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Stability analysis}
\DocumentationTok{\#\# Baseline}

\CommentTok{\# Construct Jacobian matrix }
\NormalTok{J\_base}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(c1, }\DecValTok{1}\NormalTok{,}
\NormalTok{           beta[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(c1}\DecValTok{{-}1}\NormalTok{), beta[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]),}
          \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev\_base}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J\_base)}
\NormalTok{(}\AttributeTok{evals\_base =}\NormalTok{ ev\_base}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1+0.5i 1-0.5i
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{(}\AttributeTok{det=}\FunctionTok{det}\NormalTok{(J\_base))      }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.25
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J\_base)) }\CommentTok{\# trace}

\CommentTok{\# Calculate modulus}
\NormalTok{(}\AttributeTok{mod\_base=}\FunctionTok{Mod}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.118034
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Check general stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check analytical stability condition}
\NormalTok{beta[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{\textless{}} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Compare with scenario 4}
\NormalTok{J\_scen4}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(c1, }\DecValTok{1}\NormalTok{,}
\NormalTok{           beta[}\DecValTok{4}\NormalTok{,s]}\SpecialCharTok{*}\NormalTok{(c1}\DecValTok{{-}1}\NormalTok{), beta[}\DecValTok{4}\NormalTok{,s]),}
          \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev\_scen4}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J\_scen4)}
\NormalTok{(}\AttributeTok{evals\_scen4 =}\NormalTok{ ev\_scen4}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.775+0.4465143i 0.775-0.4465143i
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{(}\AttributeTok{det=}\FunctionTok{det}\NormalTok{(J\_scen4))      }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J\_scen4)) }\CommentTok{\# trace}

\CommentTok{\# Calculate modulus}
\NormalTok{(}\AttributeTok{mod\_scen4=}\FunctionTok{Mod}\NormalTok{(evals\_scen4[}\DecValTok{1}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.8944272
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Check general stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check analytical stability condition}
\NormalTok{beta[}\DecValTok{4}\NormalTok{,s] }\SpecialCharTok{\textless{}} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

For the baseline, the modulus of the complex eigenvalue is indeed larger
than unity and the system thus unstable. This is due to the accelerator
coefficient \(\beta\) being larger than unity. By contrast, in scenario
4, we have \(\beta < 1\) and the system is thus stable.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Check cycle condition and compute cycle length (baseline)}

\CommentTok{\# Check analytical cycle condition}
\NormalTok{(c1}\SpecialCharTok{+}\NormalTok{beta[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{])}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{{-}} \DecValTok{4}\SpecialCharTok{*}\NormalTok{beta[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{] }\SpecialCharTok{\textless{}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Save real and imaginary part of complex eigenvalue}
\NormalTok{re}\OtherTok{=}\FunctionTok{Re}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{])}
\NormalTok{im}\OtherTok{=}\FunctionTok{Im}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{])}

\CommentTok{\# Calculate cycle length}
\NormalTok{L}\OtherTok{=}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi)}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{acos}\NormalTok{(re}\SpecialCharTok{/}\NormalTok{mod\_base))}
\NormalTok{L}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 13.55164
\end{verbatim}

The analytical cycle condition confirms that the eigenvalues of the
system will be complex and thus generate cycles. The implied cycle
length is around 13.5 periods.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Stability Analysis {-} Baseline}
\CommentTok{\# Construct the Jacobian matrix for the baseline scenario}
\NormalTok{J\_base }\OperatorTok{=}\NormalTok{ np.array([[c1, }\DecValTok{1}\NormalTok{],}
\NormalTok{                   [beta[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{*}\NormalTok{ (c1 }\OperatorTok{{-}} \DecValTok{1}\NormalTok{), beta[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]]])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{evals\_base, \_ }\OperatorTok{=}\NormalTok{ np.linalg.eig(J\_base)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Eigenvalues (Baseline):"}\NormalTok{, evals\_base)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det\_base }\OperatorTok{=}\NormalTok{ np.linalg.det(J\_base)  }\CommentTok{\# determinant}
\NormalTok{tr\_base }\OperatorTok{=}\NormalTok{ np.trace(J\_base)  }\CommentTok{\# trace}

\CommentTok{\# Calculate modulus of the first eigenvalue}
\NormalTok{mod\_base }\OperatorTok{=}\NormalTok{ np.}\BuiltInTok{abs}\NormalTok{(evals\_base[}\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Modulus (Baseline):"}\NormalTok{, mod\_base)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Stability conditions (Baseline):"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{+}\NormalTok{ tr\_base }\OperatorTok{+}\NormalTok{ det\_base }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ tr\_base }\OperatorTok{+}\NormalTok{ det\_base }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ det\_base }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}

\CommentTok{\# Check analytical stability condition}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Analytical stability condition (Baseline):"}\NormalTok{, beta[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}} \DecValTok{1}\NormalTok{)}


\CommentTok{\#\#\# Compare with Scenario 4}
\CommentTok{\# Construct the Jacobian matrix for scenario 4}
\NormalTok{J\_scen4 }\OperatorTok{=}\NormalTok{ np.array([[c1, }\DecValTok{1}\NormalTok{],}
\NormalTok{                    [beta[}\DecValTok{3}\NormalTok{, s] }\OperatorTok{*}\NormalTok{ (c1 }\OperatorTok{{-}} \DecValTok{1}\NormalTok{), beta[}\DecValTok{3}\NormalTok{, s]]])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{evals\_scen4, \_ }\OperatorTok{=}\NormalTok{ np.linalg.eig(J\_scen4)}

\CommentTok{\# Print eigenvalues}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Eigenvalues (Scenario 4):"}\NormalTok{, evals\_scen4)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{det\_scen4 }\OperatorTok{=}\NormalTok{ np.linalg.det(J\_scen4)  }\CommentTok{\# determinant}
\NormalTok{tr\_scen4 }\OperatorTok{=}\NormalTok{ np.trace(J\_scen4)  }\CommentTok{\# trace}

\CommentTok{\# Calculate modulus of the first eigenvalue}
\NormalTok{mod\_scen4 }\OperatorTok{=}\NormalTok{ np.}\BuiltInTok{abs}\NormalTok{(evals\_scen4[}\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Modulus (Scenario 4):"}\NormalTok{, mod\_scen4)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Stability conditions (Scenario 4):"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{+}\NormalTok{ tr\_scen4 }\OperatorTok{+}\NormalTok{ det\_scen4 }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ tr\_scen4 }\OperatorTok{+}\NormalTok{ det\_scen4 }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ det\_scen4 }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{)}

\CommentTok{\# Check analytical stability condition}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Analytical stability condition (Scenario 4):"}\NormalTok{, beta[}\DecValTok{3}\NormalTok{, s] }\OperatorTok{\textless{}} \DecValTok{1}\NormalTok{)}

\CommentTok{\#\#\# Check cycle condition (baseline)}
\NormalTok{cycle\_condition }\OperatorTok{=}\NormalTok{ (c1 }\OperatorTok{+}\NormalTok{ beta[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{])}\OperatorTok{**}\DecValTok{2} \OperatorTok{{-}} \DecValTok{4} \OperatorTok{*}\NormalTok{ beta[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}} \DecValTok{0}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Cycle condition (Baseline):"}\NormalTok{, cycle\_condition)}

\CommentTok{\# Save real and imaginary parts of the complex eigenvalue}
\NormalTok{re }\OperatorTok{=}\NormalTok{ np.real(evals\_base[}\DecValTok{0}\NormalTok{])}
\NormalTok{im }\OperatorTok{=}\NormalTok{ np.imag(evals\_base[}\DecValTok{0}\NormalTok{])}

\CommentTok{\# Calculate cycle length (L)}
\NormalTok{L }\OperatorTok{=}\NormalTok{ (}\DecValTok{2} \OperatorTok{*}\NormalTok{ np.pi) }\OperatorTok{/}\NormalTok{ np.arccos(re }\OperatorTok{/}\NormalTok{ mod\_base)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Cycle length (Baseline):"}\NormalTok{, L)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{References}\label{references-15}

\chapter{A Kaldorian Endogenous Business Cycle Model}\label{sec-kaldor}

\section{Overview}\label{overview-13}

This model captures some key features of Nicholas Kaldor (1940)'s
nonlinear model of endogenous business cycle fluctuations. Unlike
Samuelson (1939)'s linear multiplier-accelerator model (see
Chapter~\ref{sec-how-to-simulate} and Chapter~\ref{sec-stab_analysis}),
which usually requires repeated external shocks to produce sustained
cycles, Kaldor (1940) outlined a model that would produces endogenous,
i.e.~shock-independent, whereas fluctuations.\footnote{More precisely,
  Samuelson (1939)'s model generates shock-independent cycles only for a
  very specific parameter combination, Kaldor (1940)'s model generates
  endogenous cycles for a much broader set of parameters.} Kaldor (1940)
assumed that investment and saving were very sensitive to income for
normal levels of income, but relatively insensitive for extreme values
of income. Graphically, these assumptions give rise to sigmoid-shaped
investment and saving functions. As a result, the goods market
equilibrium becomes locally unstable due to strong positive feedback
effects, but then becomes stable once the economy has sufficiently moved
away from equilibrium during booms or busts. Similar to J. R. Hicks
(1950) (see Chapter~\ref{sec-hicks}), Kaldor (1940) also assumed a
locally unstable goods market, but unlike Hicks who postulated discrete
bounds that would prevent fluctuations from exploding, Kaldor (1940)
considered smooth bounds that stemmed from the investment and saving
behaviour of firms and households. For instance, at high levels of
output, investment may become insensitive to output due to rising costs
of construction or surging financing cost. Similarly, for low levels of
output profit opportunities may be missing, thereby rending investment
insensitive to changes in output. It is then the interaction between
output and the capital stock that turns these bounded output dynamics
into a cycle: Kaldor (1940) assumed that the capital stock exerts a
negative effect on investment as an increasing capital stock lowers the
marginal efficiency of capital, whereas output pushes up the dynamics of
the capital stock due to the accelerator effect.

Kaldor (1940)'s initial paper mostly relied on graphical analysis. A
continuous-time version formalisation of his graphical was subsequently
presented in Chang and Smyth (1971). Textbook treatments can be found in
Gabisch and Lorenz (1989), chapter 4. We present a discrete time version
of the Kaldor model due to Bischi et al. (2001).

\section{The Model}\label{the-model-14}

\begin{equation}\phantomsection\label{eq-kaldor_Y}{
  Y_{t}=Y_{t-1} + \alpha(I_{t} - S_{t}),  \quad \alpha > 0
}\end{equation}

\begin{equation}\phantomsection\label{eq-kaldor_K}{
K_{t} = (1-\delta)K_{t-1} + I_{t-1},  \quad \delta \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-kaldor_S}{
S_{t} = \sigma Y_t,  \quad \sigma \in (0,1)
}\end{equation}

\begin{equation}\phantomsection\label{eq-kaldor_I}{
I_{t} = \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right) + \arctan(Y_{t}- Y^E),  \quad \gamma, Y^E > 0 
}\end{equation}

where \(Y_t\), \(K_t\), \(S_t\), and \(I_t\) represent aggregate output,
the capital stock, saving, and investment, respectively.

Equation~\ref{eq-kaldor_Y} specifies that output reacts slugglishly to
excess demand \((I_t > S_t)\) and excess supply \((I_t < S_t)\), with
the speed of adjustment given by \(\alpha\). A high value of \(\alpha\)
means that firms respond strongly to disequilibria in the goods market.
Equation~\ref{eq-kaldor_K} is the law of motion of the capital stock,
with \(\delta\) representing the rate of depreciation.
Equation~\ref{eq-kaldor_S} is th saving function. While Kaldor (1940)
assumed a non-linear (sigmoid-shaped) Keynesian saving function, Bischi
et al. (2001) (for simplicity) use a linear saving function with a
constant marginal propensity to save out of income \((\sigma)\). The key
nonlinearity in this version of the Kaldor model lies in the investment
function Equation~\ref{eq-kaldor_I}. The first term in the investment
function, \(\sigma Y^E\), is a normal level of saving that prevails for
a normal or expected level of output, \(Y^E\). The second term,
\(\gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right)\), incorporates a
negative feedback effect of the level of the capital stock on
investment, where \(\frac{\sigma Y^E}{\delta}\) is the normal level of
the capital stock. The third term, \(\arctan(Y_{t}- Y^E)\), introduces
the sigmoid relationship between investment and output, modelled by
means of the arctangent function. Investment is increasing in aggregate
output; and this effect is stronger for smaller deviations of actual
investment from normal output. Figure~\ref{fig-inv} plots an example of
this sigmoid-shaped investment function for a normal level of output of
\(Y^E=10\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Plot investment function }
\CommentTok{\# Set  parameter values}
\NormalTok{alpha}\OtherTok{=}\FloatTok{1.2} \CommentTok{\# adjustment speed of output}
\NormalTok{delta}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# depreciation rate}
\NormalTok{sigma}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# propensity to save}
\NormalTok{Y\_E}\OtherTok{=}\DecValTok{10}    \CommentTok{\# normal level of output}
\NormalTok{gamma}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# sensitivity of investment to deviations of actual from normal cap stock}
\NormalTok{K}\OtherTok{=}\NormalTok{sigma}\SpecialCharTok{*}\NormalTok{Y\_E}\SpecialCharTok{/}\NormalTok{delta }\CommentTok{\# set capital stock to normal level}

\CommentTok{\# Create investment function using Y as argument}
\NormalTok{inv}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(Y)\{}
\NormalTok{  sigma}\SpecialCharTok{*}\NormalTok{Y\_E }\SpecialCharTok{+}\NormalTok{ gamma}\SpecialCharTok{*}\NormalTok{(sigma}\SpecialCharTok{*}\NormalTok{Y\_E}\SpecialCharTok{/}\NormalTok{delta }\SpecialCharTok{{-}}\NormalTok{ K) }\SpecialCharTok{+} \FunctionTok{atan}\NormalTok{(Y }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
\NormalTok{\}}

\CommentTok{\# Plot the function in (I,Y) space}
\FunctionTok{curve}\NormalTok{(inv, }\AttributeTok{from =} \DecValTok{5}\NormalTok{, }\AttributeTok{to =} \DecValTok{15}\NormalTok{, }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"I"}\NormalTok{ , }\AttributeTok{main=}\StringTok{""}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{, }\AttributeTok{n=}\DecValTok{10000}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{Y\_E, }\AttributeTok{col=}\DecValTok{2}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(Y}\SpecialCharTok{\^{}}\NormalTok{E)), }
       \AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-inv-1.pdf}

}

\caption{\label{fig-inv}Kaldor's sigmoid investment function}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\#\# Plot investment function }

\CommentTok{\# Import necessary libraries}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}

\CommentTok{\# Set parameter values}
\NormalTok{alpha }\OperatorTok{=} \FloatTok{1.2}  \CommentTok{\# adjustment speed of output}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# depreciation rate}
\NormalTok{sigma }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# propensity to save}
\NormalTok{Y\_E }\OperatorTok{=} \DecValTok{10}     \CommentTok{\# normal level of output}
\NormalTok{gamma }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# sensitivity of investment to deviations of actual from normal cap stock}
\NormalTok{K }\OperatorTok{=}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{/}\NormalTok{ delta  }\CommentTok{\# set capital stock to normal level}

\CommentTok{\# Define the investment function using Y as argument}
\KeywordTok{def}\NormalTok{ inv(Y):}
    \ControlFlowTok{return}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{/}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ K) }\OperatorTok{+}\NormalTok{ np.arctan(Y }\OperatorTok{{-}}\NormalTok{ Y\_E)}

\CommentTok{\# Plot the function in (I,Y) space}
\NormalTok{Y\_values }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{5}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{10000}\NormalTok{)}
\NormalTok{I\_values }\OperatorTok{=}\NormalTok{ inv(Y\_values)}

\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\NormalTok{plt.plot(Y\_values, I\_values, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}I\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.axvline(x}\OperatorTok{=}\NormalTok{Y\_E, color}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}$Y\^{}E$\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Customize the plot}
\NormalTok{plt.xlabel(}\StringTok{"Y"}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{"I"}\NormalTok{)}
\NormalTok{plt.title(}\StringTok{"Investment Function"}\NormalTok{)}
\NormalTok{plt.ylim(}\DecValTok{2}\NormalTok{, }\DecValTok{6}\NormalTok{)}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"lower right"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\NormalTok{plt.grid(}\VariableTok{True}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{, alpha}\OperatorTok{=}\FloatTok{0.6}\NormalTok{)}

\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\section{Simulation}\label{simulation-14}

\subsection{Parameterisation}\label{parameterisation-14}

Table 1 reports the parameterisation used in the simulation. We will
analyse below how the model's dynamic properties change as \(\alpha\)
and \(\sigma\) vary.

\textbf{Table 1: Parameterisation}

\begin{longtable}[]{@{}lllll@{}}
\toprule\noalign{}
\(\alpha\) & \(\delta\) & \(\sigma\) & \(Y^E\) & \(\gamma\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1.2 & 0.2 & 0.4 & 10 & 0.6 \\
\end{longtable}

\subsection{Simulation code}\label{simulation-code-14}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Set number of periods}
\NormalTok{Q}\OtherTok{=}\DecValTok{200}

\CommentTok{\# Set number of scenarios }
\NormalTok{Scen}\OtherTok{=}\DecValTok{1}

\CommentTok{\# Create (Scen x Q){-}matrices that will contain the simulated data}
\NormalTok{Y}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{Scen,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Income/output}
\NormalTok{K}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{Scen,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# capital stock}
\NormalTok{S}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{Scen,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# saving}
\NormalTok{I}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\DecValTok{1}\NormalTok{,}\AttributeTok{nrow=}\NormalTok{Scen,}\AttributeTok{ncol=}\NormalTok{Q) }\CommentTok{\# Investment}

\CommentTok{\# Set fixed parameter values}
\NormalTok{alpha}\OtherTok{=}\FloatTok{1.2} \CommentTok{\# adjustment speed of output}
\NormalTok{delta}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# depreciation rate}
\NormalTok{sigma}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# propensity to save}
\NormalTok{Y\_E}\OtherTok{=}\DecValTok{10}    \CommentTok{\# normal level of output}
\NormalTok{gamma}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# sensitivity of investment to deviations of actual from normal cap stock}

\CommentTok{\# Simulate the model by looping over Q time periods for Scen different scenarios}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{Scen)\{}
  
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q)\{}
    
    \ControlFlowTok{for}\NormalTok{ (iterations }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{500}\NormalTok{)\{ }\CommentTok{\# run the model 500{-}times in each period}
      
    \CommentTok{\#Model equations}
    
    \CommentTok{\#(1) Output}
\NormalTok{    Y[i,t] }\OtherTok{=}\NormalTok{ Y[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ alpha}\SpecialCharTok{*}\NormalTok{(I[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ S[i,t}\DecValTok{{-}1}\NormalTok{])}
    
    \CommentTok{\#(2) Capital stock}
\NormalTok{    K[i,t] }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta)}\SpecialCharTok{*}\NormalTok{K[i,t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ I[i,t}\DecValTok{{-}1}\NormalTok{]}
    
    \CommentTok{\#(3) Saving}
\NormalTok{    S[i,t] }\OtherTok{=}\NormalTok{ sigma}\SpecialCharTok{*}\NormalTok{Y[i,t] }
    
    \CommentTok{\#(4) Investment}
\NormalTok{    I[i,t] }\OtherTok{=}\NormalTok{ sigma}\SpecialCharTok{*}\NormalTok{Y\_E }\SpecialCharTok{+}\NormalTok{ gamma}\SpecialCharTok{*}\NormalTok{(sigma}\SpecialCharTok{*}\NormalTok{Y\_E}\SpecialCharTok{/}\NormalTok{delta }\SpecialCharTok{{-}}\NormalTok{ K[i,t]) }\SpecialCharTok{+} \FunctionTok{atan}\NormalTok{(Y[i,t] }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
    
\NormalTok{    \} }\CommentTok{\# close iterations loop}
\NormalTok{  \}   }\CommentTok{\# close time loop}
\NormalTok{\}     }\CommentTok{\# close scenario loop}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Import necessary libraries}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\CommentTok{\# Set number of periods}
\NormalTok{Q }\OperatorTok{=} \DecValTok{200}

\CommentTok{\# Set number of scenarios}
\NormalTok{Scen }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# Create (Scen x Q){-}matrices to contain the simulated data}
\NormalTok{Y }\OperatorTok{=}\NormalTok{ np.ones((Scen, Q))  }\CommentTok{\# Income/output}
\NormalTok{K }\OperatorTok{=}\NormalTok{ np.ones((Scen, Q))  }\CommentTok{\# Capital stock}
\NormalTok{S }\OperatorTok{=}\NormalTok{ np.ones((Scen, Q))  }\CommentTok{\# Saving}
\NormalTok{I }\OperatorTok{=}\NormalTok{ np.ones((Scen, Q))  }\CommentTok{\# Investment}

\CommentTok{\# Set fixed parameter values}
\NormalTok{alpha }\OperatorTok{=} \FloatTok{1.2}  \CommentTok{\# Adjustment speed of output}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Depreciation rate}
\NormalTok{sigma }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# Propensity to save}
\NormalTok{Y\_E }\OperatorTok{=} \DecValTok{10}     \CommentTok{\# Normal level of output}
\NormalTok{gamma }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of investment to deviations of actual from normal capital stock}

\CommentTok{\# Simulate the model by looping over Q time periods for Scen different scenarios}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(Scen):}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        \ControlFlowTok{for}\NormalTok{ iterations }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{500}\NormalTok{):  }\CommentTok{\# Run the model 500 times in each period}
            
            \CommentTok{\# Model equations}
            
            \CommentTok{\# (1) Output}
\NormalTok{            Y[i, t] }\OperatorTok{=}\NormalTok{ Y[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ (I[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ S[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}
            
            \CommentTok{\# (2) Capital stock}
\NormalTok{            K[i, t] }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta) }\OperatorTok{*}\NormalTok{ K[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ I[i, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
            
            \CommentTok{\# (3) Saving}
\NormalTok{            S[i, t] }\OperatorTok{=}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ Y[i, t]}
            
            \CommentTok{\# (4) Investment}
\NormalTok{            I[i, t] }\OperatorTok{=}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{/}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ K[i, t]) }\OperatorTok{+}\NormalTok{ np.arctan(Y[i, t] }\OperatorTok{{-}}\NormalTok{ Y\_E)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\subsection{Plots}\label{plots-14}

Figure~\ref{fig-output} displays the dynamics of aggregate output. The
model generates endogenous cycles in output that are permanent,
i.e.~they don't require any external shocks, and they are (roughly)
periodic with a cycle length from peak (trough) to peak (trough) of
around 17 periods. What generates the turning points? Suppose income is
close to its normal level of \(Y^E = 10\), but on an increasing
trajectory. The accelerator effect on investment will amplify this
process as firms will increase their investment, which raises aggregate
demand and increases income further. As aggregate output increases, this
positive feedback effect gradually becomes weaker, possibly because
firms face tighter supply constraints. The rise in the capital stock
exerts a negative feedback effect on investment and will eventually
dominate the accelerator effect. Firms then start reducing investment
and the boom turns into a bust. The accelerator effect again amplifies
this downward trajectory until the capital stock has sufficiently fallen
to make investment attractive again. This allows the cycle to repeat
itself.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax}\OtherTok{=}\DecValTok{100}
\NormalTok{Tmin }\OtherTok{=}\DecValTok{10}

\CommentTok{\# Plot aggregate output and capital stock}
\FunctionTok{plot}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Time"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Y"}\NormalTok{) }
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Aggregate output and capital stock"}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{+} \FloatTok{0.3}\NormalTok{)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{new =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax], }\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{2}\NormalTok{, }\AttributeTok{font.main=}\DecValTok{1}\NormalTok{, }\AttributeTok{cex.main=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{range}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]), }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{at=}\FunctionTok{pretty}\NormalTok{(K[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax]))  }
\FunctionTok{mtext}\NormalTok{(}\StringTok{"K"}\NormalTok{, }\AttributeTok{side =} \DecValTok{4}\NormalTok{, }\AttributeTok{line =} \DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"K"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-output-1.pdf}

}

\caption{\label{fig-output}Output and capital stock}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set start and end periods for plots}
\NormalTok{Tmax }\OperatorTok{=} \DecValTok{100}
\NormalTok{Tmin }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Plot aggregate output and capital stock}
\NormalTok{fig, ax1 }\OperatorTok{=}\NormalTok{ plt.subplots(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{))}

\CommentTok{\# Plot Y (aggregate output)}
\NormalTok{ax1.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax), Y[}\DecValTok{0}\NormalTok{, Tmin:Tmax], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}Y\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_xlabel(}\StringTok{"Time"}\NormalTok{)}
\NormalTok{ax1.set\_ylabel(}\StringTok{"Y"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.tick\_params(axis}\OperatorTok{=}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{, labelcolor}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax1.set\_title(}\StringTok{"Aggregate Output and Capital Stock"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{10}\NormalTok{)}

\CommentTok{\# Create a twin axis for the capital stock}
\NormalTok{ax2 }\OperatorTok{=}\NormalTok{ ax1.twinx()}

\CommentTok{\# Plot K (capital stock)}
\NormalTok{ax2.plot(}\BuiltInTok{range}\NormalTok{(Tmin, Tmax), K[}\DecValTok{0}\NormalTok{, Tmin:Tmax], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}{-}\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\StringTok{\textquotesingle{}K\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2.set\_ylabel(}\StringTok{"K"}\NormalTok{, color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\NormalTok{ax2.tick\_params(axis}\OperatorTok{=}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{, labelcolor}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Figure~\ref{fig-saving} displays the endogenous fluctuations in saving
and investment. The horizontal lines represent the average level of
saving and investment computed from the simulated data.\footnote{The
  first 10 periods were excluded from the computation as these are
  driven by the adjustment from the arbitrary initialisation.} It can be
seen that these are virtually identical, reflecting the fact that that
the model generates cycles around the goods market equilibrium but never
reaches it.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Calculate average saving and investment ignoring the first 10 periods}
\NormalTok{S\_avr}\OtherTok{=}\FunctionTok{rowMeans}\NormalTok{(S[,}\DecValTok{10}\SpecialCharTok{:}\NormalTok{Q, }\AttributeTok{drop=}\ConstantTok{FALSE}\NormalTok{])}
\NormalTok{I\_avr}\OtherTok{=}\FunctionTok{rowMeans}\NormalTok{(I[,}\DecValTok{10}\SpecialCharTok{:}\NormalTok{Q, }\AttributeTok{drop=}\ConstantTok{FALSE}\NormalTok{])}

\CommentTok{\#Plot saving and investment along with their long{-}run average values}
\FunctionTok{plot}\NormalTok{(S[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)],}\AttributeTok{type=}\StringTok{"l"}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{lty=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{""}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"S, I"}\NormalTok{, }
     \AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(I[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],S[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{(Tmax)]))}
\FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\StringTok{"Saving and investment"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{\textquotesingle{}Time\textquotesingle{}}\NormalTok{,}\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{,}\AttributeTok{line=}\DecValTok{2}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(I[}\DecValTok{1}\NormalTok{, Tmin}\SpecialCharTok{:}\NormalTok{Tmax],}\AttributeTok{lty=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\NormalTok{S\_avr, }\AttributeTok{col=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\NormalTok{I\_avr, }\AttributeTok{col=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend=}\FunctionTok{c}\NormalTok{(}\StringTok{"S"}\NormalTok{, }\StringTok{"I"}\NormalTok{),}
       \AttributeTok{lty=}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{, }\AttributeTok{y.intersp=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-saving-2.pdf}

}

\caption{\label{fig-saving}Saving and investment}

\end{figure}%

\subsection{Creating a bifurcation
diagram}\label{creating-a-bifurcation-diagram}

Next, we explore numerically under which conditions the model generates
endogenous cycles. To do so, we need to introduce some terminology.
First, a \emph{limit cycle} is defined as a closed orbit of the state
variables of a dynamic system around a locally unstable equilibrium (see
Gandolfo (2009), chap.~23). In the neighbourhood of the equilibrium, the
system is unstable and gets pushed away from it. However, rather than
exhibiting explosive behaviour, the system eventually reaches a periodic
cycle as it is bounded by nonlinearities. The fluctuations in
Figure~\ref{fig-output} indeed constitute a limit cycle. Second, a
\emph{bifurcation} is defined as a qualitative change of the behaviour
of a dynamic system that occurs as a parameter of the system crosses a
critical value (see Gandolfo (2009), chap.~24). Third, a \emph{Hopf
bifurcation} is a bifurcation that gives rise to a limit
cycle.\footnote{In discrete-time dynamic systems, the Hopf bifurcation
  is also called \emph{Neimark-Sacker bifurcation}.}

We can analyse the emergence of Hopf bifurcations in this model by means
of so-called bifurcation diagrams that plot the dynamics of a
representative endogenous variable variable from the model against
different values of a parameter of interest. This is accomplished by
fixing a parameterisation, simulating the model for a specific value of
the parameter of interest, saving the last \(T_0\) values of the chosen
endogenous variable, and repeating the process for a marginally
different value of the parameter of interest. The \(T_0\) data points
from each run are then placed on the bifurcation diagram.

The following code first creates a function called \emph{kaldor} that
simulates the Kaldor model,\footnote{To increase computational
  efficiency, we simulate a reduced-form version of the model in \(Y_t\)
  and \(K_t\) only that is derived in the analytical discussion below.}
taking values of \(\alpha\) and \(\sigma\) as arguments, and returns the
last \(T_0=50\) values of output.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clear the environment}
\FunctionTok{rm}\NormalTok{(}\AttributeTok{list=}\FunctionTok{ls}\NormalTok{(}\AttributeTok{all=}\ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Define a function called "kaldor" that simulates a reduced{-}form version of the model}
\CommentTok{\# and returns the last 50 values of Y; use alpha and sigma as arguments that }
\CommentTok{\# need to be supplied when the function is called}
\NormalTok{kaldor }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(alpha, sigma) \{}
  
  \CommentTok{\# Set how many last values of output you want to save}
\NormalTok{  T\_0 }\OtherTok{=} \DecValTok{50}
  
  \CommentTok{\# Set number of periods}
\NormalTok{  Q }\OtherTok{=} \DecValTok{200}
  
  \CommentTok{\# Create matrices for simulated data}
\NormalTok{  Y }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data =} \DecValTok{1}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1}\NormalTok{, }\AttributeTok{ncol =}\NormalTok{ Q)  }\CommentTok{\# Income/output}
\NormalTok{  K }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data =} \DecValTok{1}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1}\NormalTok{, }\AttributeTok{ncol =}\NormalTok{ Q)  }\CommentTok{\# Capital stock}
  
  \CommentTok{\# Set fixed parameter values}
\NormalTok{  gamma }\OtherTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of investment to deviations of actual from normal cap stock}
\NormalTok{  delta }\OtherTok{=} \FloatTok{0.2}  \CommentTok{\# Depreciation rate}
\NormalTok{  Y\_E }\OtherTok{=} \DecValTok{10}     \CommentTok{\# Normal level of output}

  \CommentTok{\# Simulate the model by looping over time periods}
    \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\NormalTok{Q) \{}

        \DocumentationTok{\#\# Model equations}
        \CommentTok{\# Output}
\NormalTok{        Y[}\DecValTok{1}\NormalTok{, t] }\OtherTok{=}\NormalTok{ Y[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+} 
\NormalTok{          alpha }\SpecialCharTok{*}\NormalTok{ (sigma }\SpecialCharTok{*}\NormalTok{ Y\_E }\SpecialCharTok{+}\NormalTok{ gamma }\SpecialCharTok{*}\NormalTok{ (sigma }\SpecialCharTok{*}\NormalTok{ Y\_E }\SpecialCharTok{/}\NormalTok{ delta }\SpecialCharTok{{-}}\NormalTok{ K[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{]) }\SpecialCharTok{+} 
                   \FunctionTok{atan}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ Y\_E) }\SpecialCharTok{{-}}\NormalTok{ sigma }\SpecialCharTok{*}\NormalTok{ Y[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{])}
        
        \CommentTok{\#  Capital stock}
\NormalTok{        K[}\DecValTok{1}\NormalTok{, t] }\OtherTok{=}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ delta) }\SpecialCharTok{*}\NormalTok{ K[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{+} 
\NormalTok{          sigma }\SpecialCharTok{*}\NormalTok{ Y\_E }\SpecialCharTok{+}\NormalTok{ gamma }\SpecialCharTok{*}\NormalTok{ (sigma }\SpecialCharTok{*}\NormalTok{ Y\_E }\SpecialCharTok{/}\NormalTok{ delta }\SpecialCharTok{{-}}\NormalTok{ K[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{]) }\SpecialCharTok{+} 
          \FunctionTok{atan}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, t}\DecValTok{{-}1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
        
\NormalTok{    \} }\CommentTok{\# Close time loop}

  \FunctionTok{return}\NormalTok{(Y[}\DecValTok{1}\NormalTok{, (Q}\SpecialCharTok{{-}}\NormalTok{T\_0)}\SpecialCharTok{:}\NormalTok{Q])  }\CommentTok{\# Return last 50 periods of output}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Next, we prepare an initially empty bifurcation diagram and then loop
over the \emph{kaldor} function, increasing the parameter \(\alpha\)
from 0.5 to 2 in successive steps of 0.01 (while keeping \(\sigma\)
fixed at 0.4), and place the resulting data points on the bifurcation
diagram. From Figure~\ref{fig-bif-alpha}, it can be seen that there
indeed appears to be a critical value \(\alpha_0 \approx 1.15\) below
which the model does not generate a limit cycle because the equilibrium
is stable. By contrast, for values of \(\alpha\) above that critical
value, the model generates a limit cycle whose amplitude appears to be
increasing in \(\alpha\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prepare the bifurcation diagram in alpha}
\FunctionTok{plot}\NormalTok{(}\ConstantTok{NULL}\NormalTok{, }\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\FloatTok{2.0}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\FloatTok{7.5}\NormalTok{, }\FloatTok{12.5}\NormalTok{), }
     \AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(alpha), }\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(Y[t]), }
     \AttributeTok{pch =} \StringTok{"."}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{col =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{main =} 
       \FunctionTok{expression}\NormalTok{(}\StringTok{"Bifurcation diagram in "} \SpecialCharTok{*}\NormalTok{ alpha))}

\CommentTok{\# Run kaldor function for different values of alpha (keeping sigma at 0.4) }
\CommentTok{\# and place data points on bifurcation diagram }
\NormalTok{alpha }\OtherTok{=} \FloatTok{0.5}  \CommentTok{\# initialise alpha}
\ControlFlowTok{while}\NormalTok{ (alpha }\SpecialCharTok{\textless{}=} \DecValTok{2}\NormalTok{) \{ }\CommentTok{\# run kaldor model until alpha assumes value of 2}
\NormalTok{  output }\OtherTok{=} \FunctionTok{kaldor}\NormalTok{(}\AttributeTok{alpha=}\NormalTok{alpha, }\AttributeTok{sigma=}\FloatTok{0.4}\NormalTok{) }\CommentTok{\# obtain values of Y for given value of alpha}
  \FunctionTok{points}\NormalTok{(}\FunctionTok{rep}\NormalTok{(alpha, }\FunctionTok{length}\NormalTok{(output)), output, }\AttributeTok{pch =} \StringTok{"."}\NormalTok{, }\AttributeTok{col =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{)  }\CommentTok{\# add data points to diagram}
\NormalTok{  alpha }\OtherTok{=}\NormalTok{ alpha }\SpecialCharTok{+} \FloatTok{0.01}  \CommentTok{\# increase alpha stepwise}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-bif-alpha-1.pdf}

}

\caption{\label{fig-bif-alpha}Bifurcation diagram for different
sensitivities of output to saving-investment gap}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\# Generate kaldor function}

\CommentTok{\# Define a function called "kaldor" that simulates a reduced{-}form version of the model}
\CommentTok{\# and returns the last 50 values of Y}

\KeywordTok{def}\NormalTok{ kaldor(alpha, sigma):}
    \CommentTok{\# Set how many last values of output you want to save}
\NormalTok{    T\_0 }\OperatorTok{=} \DecValTok{50}
    
    \CommentTok{\# Set number of periods}
\NormalTok{    Q }\OperatorTok{=} \DecValTok{200}
    
    \CommentTok{\# Create matrices for simulated data}
\NormalTok{    Y }\OperatorTok{=}\NormalTok{ np.ones((}\DecValTok{1}\NormalTok{, Q))  }\CommentTok{\# Income/output}
\NormalTok{    K }\OperatorTok{=}\NormalTok{ np.ones((}\DecValTok{1}\NormalTok{, Q))  }\CommentTok{\# Capital stock}
    
    \CommentTok{\# Set fixed parameter values}
\NormalTok{    gamma }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of investment to deviations of actual from normal capital stock}
\NormalTok{    delta }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Depreciation rate}
\NormalTok{    Y\_E }\OperatorTok{=} \DecValTok{10}     \CommentTok{\# Normal level of output}
    
    \CommentTok{\# Simulate the model by looping over time periods}
    \ControlFlowTok{for}\NormalTok{ t }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, Q):}
        
        \CommentTok{\# Model equations}
        
        \CommentTok{\# (1) Output}
\NormalTok{        Y[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ (}
\NormalTok{            sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{/}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ K[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{+} 
\NormalTok{            np.arctan(Y[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ Y\_E) }\OperatorTok{{-}}\NormalTok{ sigma }\OperatorTok{*}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}
        
        \CommentTok{\# (2) Capital stock}
\NormalTok{        K[}\DecValTok{0}\NormalTok{, t] }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta) }\OperatorTok{*}\NormalTok{ K[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{+}\NormalTok{ (}
\NormalTok{            sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{+}\NormalTok{ gamma }\OperatorTok{*}\NormalTok{ (sigma }\OperatorTok{*}\NormalTok{ Y\_E }\OperatorTok{/}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ K[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]) }\OperatorTok{+} 
\NormalTok{            np.arctan(Y[}\DecValTok{0}\NormalTok{, t}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ Y\_E))}
    
    \CommentTok{\# Return last 50 periods of output}
    \ControlFlowTok{return}\NormalTok{ Y[}\DecValTok{0}\NormalTok{, (Q}\OperatorTok{{-}}\NormalTok{T\_0):Q]}


\CommentTok{\#\#\#\# Generate bifurcation diagram}

\CommentTok{\# Prepare the bifurcation diagram in alpha}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{6}\NormalTok{))}
\NormalTok{plt.title(}\VerbatimStringTok{r\textquotesingle{}Bifurcation Diagram in $\textbackslash{}alpha$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{14}\NormalTok{)}
\NormalTok{plt.xlabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}alpha$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.ylabel(}\VerbatimStringTok{r\textquotesingle{}$Y\_t$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.xlim(}\FloatTok{0.5}\NormalTok{, }\FloatTok{2.0}\NormalTok{)}
\NormalTok{plt.ylim(}\FloatTok{7.5}\NormalTok{, }\FloatTok{12.5}\NormalTok{)}

\CommentTok{\# Run kaldor function for different values of alpha (keeping sigma at 0.4)}
\CommentTok{\# and place data points on bifurcation diagram}

\NormalTok{alpha }\OperatorTok{=} \FloatTok{0.5}  \CommentTok{\# Initialize alpha}
\ControlFlowTok{while}\NormalTok{ alpha }\OperatorTok{\textless{}=} \FloatTok{2.0}\NormalTok{:}
    \CommentTok{\# Obtain values of Y for the given value of alpha}
\NormalTok{    output }\OperatorTok{=}\NormalTok{ kaldor(alpha}\OperatorTok{=}\NormalTok{alpha, sigma}\OperatorTok{=}\FloatTok{0.4}\NormalTok{)}
    
    \CommentTok{\# Add data points to the diagram}
\NormalTok{    plt.scatter([alpha] }\OperatorTok{*} \BuiltInTok{len}\NormalTok{(output), output, color}\OperatorTok{=}\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{, s}\OperatorTok{=}\DecValTok{4}\NormalTok{, marker}\OperatorTok{=}\StringTok{\textquotesingle{}.\textquotesingle{}}\NormalTok{)}
    
    \CommentTok{\# Increase alpha stepwise}
\NormalTok{    alpha }\OperatorTok{+=} \FloatTok{0.01}

\CommentTok{\# Show the bifurcation diagram}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Figure~\ref{fig-bif-sigma} does the same for the parameter \(\sigma\),
starting from \(\sigma=0.1\) and raising it to 0.5 in steps of 0.001
(while keeping a fixed \(\alpha\) of 1.2). The parameter \(\sigma\)
appears to exhibit a critical value \(\sigma_0 \approx 0.25\) above
which a limit cycle occurs.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prepare the bifurcation diagram in sigma}
\FunctionTok{plot}\NormalTok{(}\ConstantTok{NULL}\NormalTok{, }\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.5}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\FloatTok{11.5}\NormalTok{), }
     \AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(sigma), }\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(Y[t]), }
     \AttributeTok{pch =} \StringTok{"."}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{col =} \StringTok{"blue"}\NormalTok{,}
     \AttributeTok{main =} \FunctionTok{expression}\NormalTok{(}\StringTok{"Bifurcation diagram in "} \SpecialCharTok{*}\NormalTok{ sigma))}

\CommentTok{\# Run kaldor function for different values of sigma (keeping alpha at 1.2)}
\CommentTok{\# and place data points on bifurcation diagram }
\NormalTok{sigma }\OtherTok{=} \FloatTok{0.1} \CommentTok{\# initialise alpha}
\ControlFlowTok{while}\NormalTok{ (sigma }\SpecialCharTok{\textless{}=} \FloatTok{0.5}\NormalTok{) \{ }\CommentTok{\# run kaldor model until sigma assumes value of 0.5}
\NormalTok{  output }\OtherTok{=} \FunctionTok{kaldor}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{sigma=}\NormalTok{sigma) }\CommentTok{\# obtain the values of Y for given value of sigma}
  \FunctionTok{points}\NormalTok{(}\FunctionTok{rep}\NormalTok{(sigma, }\FunctionTok{length}\NormalTok{(output)), output, }\AttributeTok{pch =} \StringTok{"."}\NormalTok{, }\AttributeTok{col =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{cex =} \DecValTok{1}\NormalTok{)  }\CommentTok{\# add data points to diagram}
\NormalTok{  sigma }\OtherTok{=}\NormalTok{ sigma }\SpecialCharTok{+} \FloatTok{0.001}  \CommentTok{\# increase sigma stepwise}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-bif-sigma-2.pdf}

}

\caption{\label{fig-bif-sigma}Bifurcation diagram for different saving
propensities}

\end{figure}%

\section{Directed graph}\label{directed-graph-14}

Another perspective on the model's properties is provided by its
directed graph. A directed graph consists of a set of nodes that
represent the variables of the model. Nodes are connected by directed
edges. An edge directed from a node \(x_1\) to node \(x_2\) indicates a
causal impact of \(x_1\) on \(x_2\).

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Create directed graph}
\CommentTok{\# Construct auxiliary Jacobian matrix for 5 variables: }
  \CommentTok{\# endogenous: (1) Y, (2) K, (3) S, (4) I}
  \CommentTok{\# exogenous: (5) YE}

              \CommentTok{\#Y K S I YE}
\NormalTok{M\_mat}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\CommentTok{\# Y}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\# K}
               \DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\CommentTok{\# S}
               \DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\CommentTok{\# I}
               \DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{),}\CommentTok{\# YE}
               \DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian}
\NormalTok{A\_mat}\OtherTok{=}\FunctionTok{t}\NormalTok{(M\_mat)}

\CommentTok{\# Create directed graph from adjacency matrix}
\FunctionTok{library}\NormalTok{(igraph)}
\NormalTok{dg}\OtherTok{=}\FunctionTok{graph\_from\_adjacency\_matrix}\NormalTok{(A\_mat, }\AttributeTok{mode=}\StringTok{"directed"}\NormalTok{, }\AttributeTok{weighted=} \ConstantTok{NULL}\NormalTok{)}

\CommentTok{\# Define node labels}
\FunctionTok{V}\NormalTok{(dg)}\SpecialCharTok{$}\NormalTok{name}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Y"}\NormalTok{, }\StringTok{"K"}\NormalTok{, }\StringTok{"S"}\NormalTok{, }\StringTok{"I"}\NormalTok{, }\FunctionTok{expression}\NormalTok{(Y}\SpecialCharTok{\^{}}\NormalTok{E))}

\CommentTok{\# Plot directed graph}
\FunctionTok{plot}\NormalTok{(dg, }\AttributeTok{main=}\StringTok{"Directed graph of Kaldor model"}\NormalTok{, }\AttributeTok{vertex.size=}\DecValTok{40}\NormalTok{, }\AttributeTok{vertex.color=}\StringTok{"lightblue"}\NormalTok{, }
     \AttributeTok{vertex.label.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{edge.arrow.size=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{edge.width=}\FloatTok{1.1}\NormalTok{, }\AttributeTok{edge.size=}\FloatTok{1.2}\NormalTok{,}
     \AttributeTok{edge.arrow.width=}\FloatTok{1.2}\NormalTok{, }\AttributeTok{edge.color=}\StringTok{"black"}\NormalTok{, }\AttributeTok{vertex.label.cex=}\FloatTok{1.2}\NormalTok{, }
     \AttributeTok{vertex.frame.color=}\StringTok{"NA"}\NormalTok{, }\AttributeTok{margin=}\SpecialCharTok{{-}}\FloatTok{0.08}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-dag-1.pdf}

}

\caption{\label{fig-dag}Directed graph of Kaldor model}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\#\#\# Generate directed graph}
\CommentTok{\# Import necessary libraries}
\ImportTok{import}\NormalTok{ networkx }\ImportTok{as}\NormalTok{ nx}

\CommentTok{\# Construct auxiliary Jacobian matrix for 5 variables:}
\CommentTok{\# Endogenous: (1) Y, (2) K, (3) S, (4) I}
\CommentTok{\# Exogenous: (5) YE}

\NormalTok{M\_mat }\OperatorTok{=}\NormalTok{ np.array([[}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{],  }\CommentTok{\# Y}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# K}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{],  }\CommentTok{\# S}
\NormalTok{                  [}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{],  }\CommentTok{\# I}
\NormalTok{                  [}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{]]) }\CommentTok{\# YE}

\CommentTok{\# Create adjacency matrix from transpose of auxiliary Jacobian}
\NormalTok{A\_mat }\OperatorTok{=}\NormalTok{ M\_mat.T}

\CommentTok{\# Create directed graph from adjacency matrix}
\NormalTok{G }\OperatorTok{=}\NormalTok{ nx.DiGraph(A\_mat)}

\CommentTok{\# Define node labels}
\NormalTok{nodelabs }\OperatorTok{=}\NormalTok{ \{}\DecValTok{0}\NormalTok{: }\StringTok{"Y"}\NormalTok{, }\DecValTok{1}\NormalTok{: }\StringTok{"K"}\NormalTok{, }\DecValTok{2}\NormalTok{: }\StringTok{"S"}\NormalTok{, }\DecValTok{3}\NormalTok{: }\StringTok{"I"}\NormalTok{, }\DecValTok{4}\NormalTok{: }\VerbatimStringTok{r"$Y\^{}E$"}\NormalTok{\}}

\CommentTok{\# Plot the graph using the specified approach}
\NormalTok{pos }\OperatorTok{=}\NormalTok{ nx.spring\_layout(G, k}\OperatorTok{=}\FloatTok{0.5}\NormalTok{)}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\NormalTok{nx.draw\_networkx(G, pos, node\_size}\OperatorTok{=}\DecValTok{200}\NormalTok{, node\_color}\OperatorTok{=}\StringTok{"lightblue"}\NormalTok{, }
\NormalTok{                 edge\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{, width}\OperatorTok{=}\FloatTok{1.2}\NormalTok{, arrowsize}\OperatorTok{=}\DecValTok{10}\NormalTok{, }
\NormalTok{                 arrowstyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textgreater{}\textquotesingle{}}\NormalTok{, font\_size}\OperatorTok{=}\DecValTok{8}\NormalTok{, font\_color}\OperatorTok{=}\StringTok{"black"}\NormalTok{,}
\NormalTok{                 with\_labels}\OperatorTok{=}\VariableTok{True}\NormalTok{, labels}\OperatorTok{=}\NormalTok{nodelabs)}

\NormalTok{plt.title(}\StringTok{"Directed Graph of Kaldor Model"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{14}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Figure~\ref{fig-dag} illustrates the endogenous cycle generated by the
interaction between income \(Y\), investment \(I\), saving \(S\), and
the capital stock. An important exogenous variable depicted here is the
normal income level \(Y^E\), which sets the equilibrium around which
output fluctuates.

\section{Analytical discussion}\label{analytical-discussion-12}

To analyse the dynamic properties of this discrete-time version of the
Kaldor (1940) model, we first reduce it to a two-dimensional system in
\(Y_t\) and \(K_t\). Substitution of Equation~\ref{eq-kaldor_S} and
Equation~\ref{eq-kaldor_S} into Equation~\ref{eq-kaldor_Y} and
Equation~\ref{eq-kaldor_K} yields:

\begin{equation}\phantomsection\label{eq-kaldor_Y_reduc}{
Y_{t}=Y_{t-1} + \alpha \left[\sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_{t-1} \right) + \arctan(Y_{t-1}- Y^E)  -  \sigma Y_{t-1} \right]
}\end{equation}

\begin{equation}\phantomsection\label{eq-kaldor_K_reduc}{
K_{t} = (1-\delta)K_{t-1} + \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right) + \arctan(Y_{t-1}- Y^E). 
}\end{equation}

Using the fact that
\(\frac{\partial \arctan(a+bx)}{\partial x}=\frac{1}{1+(a+bx)^2}\), we
can write the system's Jacobian matrix as:

\[
J=\begin{bmatrix} 1 + \frac{\alpha}{1+(Y-Y^E)^2} - \alpha\sigma & -\alpha \gamma \\ \frac{1}{1+(Y-Y^E)^2} & 1-\delta - \gamma\  \end{bmatrix}.
\]

Next, we determine the steady states of the model by setting
\(Y_t = Y_{t-1}\) and \(K_t = K_{t-1}\), which yields:

\begin{equation}\phantomsection\label{eq-kaldor_Y_eq}{
0=\sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K \right) + \arctan(Y- Y^E)  -  \sigma Y 
}\end{equation}

\begin{equation}\phantomsection\label{eq-kaldor_K_eq}{
0 = -\delta K + \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K \right) + \arctan(Y- Y^E). 
}\end{equation}

From this, we can readily obtain:

\[
K=\frac{\sigma}{\delta}Y,
\] and using this equation to eliminate \(K\) in
Equation~\ref{eq-kaldor_K_eq}, we get:

\begin{equation}\phantomsection\label{eq-kaldor_eq}{
\sigma \left(1+\frac{\gamma}{\delta}\right)(Y- Y^E)=\arctan(Y-Y^E).
}\end{equation}

Let \(\sigma \left(1+\frac{\gamma}{\delta}\right)=\theta\).
Figure~\ref{fig-eq} plots the left-hand side and right-hand side of
Equation~\ref{eq-kaldor_eq}, for two different parameterisations of
\(\theta\). It can be seen that for \(\theta_1 >1\), there is a unique
equilibrium at \(Y^*=Y^E\), which implies
\(K^*=\frac{\sigma}{\delta}Y^E\). However, for \(\theta_2 < 1\), two
further equilibria emerge, which are located symmetrically around the
\(Y^*=Y^E\) equilibrium.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Plot equilibria }
\CommentTok{\# Set  parameter values}
\NormalTok{parm\_1}\OtherTok{=}\FloatTok{1.2}
\NormalTok{parm\_2}\OtherTok{=}\FloatTok{0.8}
\NormalTok{Y\_E}\OtherTok{=}\DecValTok{10}

\CommentTok{\# Create functions using Y as argument}
\NormalTok{f1a}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(Y)\{}
\NormalTok{  parm\_1}\SpecialCharTok{*}\NormalTok{(Y }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
\NormalTok{\}}

\NormalTok{f1b}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(Y)\{}
\NormalTok{  parm\_2}\SpecialCharTok{*}\NormalTok{(Y }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
\NormalTok{\}}

\NormalTok{f2}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(Y)\{}
 \FunctionTok{atan}\NormalTok{(Y }\SpecialCharTok{{-}}\NormalTok{ Y\_E)}
\NormalTok{\}}

\CommentTok{\# Plot the functions}
\FunctionTok{curve}\NormalTok{(f1a, }\AttributeTok{from =} \DecValTok{5}\NormalTok{, }\AttributeTok{to =} \DecValTok{15}\NormalTok{, }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Y"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{ , }\AttributeTok{main=}\StringTok{""}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{, }\AttributeTok{n=}\DecValTok{10000}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{range}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{curve}\NormalTok{(f1b, }\AttributeTok{from =} \DecValTok{5}\NormalTok{, }\AttributeTok{to =} \DecValTok{15}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{, }\AttributeTok{add=}\ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{,)}
\FunctionTok{curve}\NormalTok{(f2, }\AttributeTok{from =} \DecValTok{5}\NormalTok{, }\AttributeTok{to =} \DecValTok{15}\NormalTok{, }\AttributeTok{col =} \DecValTok{3}\NormalTok{, }\AttributeTok{add=}\ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{lwd=}\FloatTok{1.5}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"bottomright"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\FunctionTok{expression}\NormalTok{(theta[}\DecValTok{1}\NormalTok{](Y}\SpecialCharTok{{-}}\NormalTok{Y}\SpecialCharTok{\^{}}\NormalTok{E)), }
      \FunctionTok{expression}\NormalTok{(theta[}\DecValTok{2}\NormalTok{](Y}\SpecialCharTok{{-}}\NormalTok{Y}\SpecialCharTok{\^{}}\NormalTok{E)), }\FunctionTok{expression}\NormalTok{(}\FunctionTok{arctan}\NormalTok{(Y}\SpecialCharTok{{-}}\NormalTok{Y}\SpecialCharTok{\^{}}\NormalTok{E))), }
       \AttributeTok{col =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-eq-2.pdf}

}

\caption{\label{fig-eq}Equilibria}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\#\# Plot equilibria}

\CommentTok{\# Set parameter values}
\NormalTok{parm\_1 }\OperatorTok{=} \FloatTok{1.2}
\NormalTok{parm\_2 }\OperatorTok{=} \FloatTok{0.8}
\NormalTok{Y\_E }\OperatorTok{=} \DecValTok{10}

\CommentTok{\# Define functions}
\KeywordTok{def}\NormalTok{ f1a(Y):}
    \ControlFlowTok{return}\NormalTok{ parm\_1 }\OperatorTok{*}\NormalTok{ (Y }\OperatorTok{{-}}\NormalTok{ Y\_E)}

\KeywordTok{def}\NormalTok{ f1b(Y):}
    \ControlFlowTok{return}\NormalTok{ parm\_2 }\OperatorTok{*}\NormalTok{ (Y }\OperatorTok{{-}}\NormalTok{ Y\_E)}

\KeywordTok{def}\NormalTok{ f2(Y):}
    \ControlFlowTok{return}\NormalTok{ np.arctan(Y }\OperatorTok{{-}}\NormalTok{ Y\_E)}

\CommentTok{\# Create Y values for plotting}
\NormalTok{Y\_vals1 }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{5}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{1000}\NormalTok{)}
\NormalTok{Y\_vals2 }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{5}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{1000}\NormalTok{)}

\CommentTok{\# Plot the functions}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{))}
\NormalTok{plt.plot(Y\_vals1, f1a(Y\_vals1), color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}theta\_1(Y {-} Y\^{}E)$\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(Y\_vals1, f1b(Y\_vals1), color}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}theta\_2(Y {-} Y\^{}E)$\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.plot(Y\_vals2, f2(Y\_vals2), color}\OperatorTok{=}\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\FloatTok{1.5}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}arctan(Y {-} Y\^{}E)$\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Customize the plot}
\NormalTok{plt.xlabel(}\StringTok{"Y"}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.ylabel(}\StringTok{""}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.ylim(}\OperatorTok{{-}}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"lower right"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{)}

\CommentTok{\# Show the plot}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

Let us focus on the \(\theta >1\) case yielding the unique \(Y^*= Y^E\)
equilibrium, which is the one corresponding to the parameterisation used
in the simulations above.\footnote{See Bischi et al. (2001) for a
  comprehensive mathematical analysis of all possible equilibria of the
  model.} The Jacobian matrix evaluated at this equilibrium is given by:

\[
J^*=\begin{bmatrix} 1 + \alpha(1-\sigma) & -\alpha \gamma \\ 1 & 1-\delta - \gamma\  \end{bmatrix}.
\] The characteristic polynomial yielding the eigenvalues of the
Jacobian is:

\[\lambda^2-\lambda[2+\alpha(1-\sigma)-\delta-\gamma]+(1-\delta -\gamma)(1-\alpha\sigma) +\alpha(1-\delta)=0,\]

where \(2+\alpha(1-\sigma)-\delta-\gamma =tr(J)\) and
\((1-\delta -\gamma)(1-\alpha\sigma) +\alpha(1-\delta) = det(J)\).

First, let us derive the condition under which the model produces cycles
thanks to the eigenvalues being a pair of complex conjugates. The roots
of the polynomial are:

\[
\lambda_{1,2} = \frac{tr(J) \pm \sqrt{tr(J)^2-4det(J)}}{2},
\]

so that the eigenvalues will be complex if \(tr(J)^2-4 det(J)<0\), which
can also be written as \((J_{11}-J_{22})^2 + J_{12}J_{21}<0\), where
\(J_{ii}\) are the elements of the Jacobian matrix.\footnote{See also
  Stockhammer et al. (2019) on this condition for cycles.} Thus, the
condition for cycles becomes:

\[
[\alpha(1-\sigma) + \delta + \gamma]^2 - 4\alpha \gamma < 0.  
\] Next, the stability conditions for two-dimensional systems in
discrete time are:

\[
1+tr(J)+det(J)>0,
\] \[
1-tr(J)+det(J)>0,
\] \[
1-det(J)>0,
\]

where \(tr(J)\) is the trace and \(det(J)\) is the determinant of the
Jacobian.

Let us focus on the last condition, which gives:

\[
(1-\delta -\gamma)(1-\alpha \sigma) +\alpha(1-\delta)< 1.
\]

We now generate a plot that displays the cycle and the stability
condition in the \((\alpha, \sigma)\)-space. We further add a horizontal
line at \(\sigma \left(1+\frac{\gamma}{\delta}\right)=\theta=1\),
demarcating values of \(\sigma\) for which there is a unique equilibrium
(above the line) and for which there are three equilibria (below the
line).\footnote{To plot the conditions, we replace the inequalities by
  equality signs and solve for 0.}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Plot cycle and stability condition }

\CommentTok{\# Set fixed parameter values}
\NormalTok{delta}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# depreciation rate}
\NormalTok{gamma}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# sensitivity of investment to deviations of actual from normal cap stock}

\CommentTok{\# Create function for cycle condition}
\NormalTok{cyc}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(alpha, sigma)\{}
\NormalTok{ (alpha}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{sigma) }\SpecialCharTok{+}\NormalTok{ delta }\SpecialCharTok{+}\NormalTok{ gamma)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{{-}} \DecValTok{4}\SpecialCharTok{*}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{gamma }
\NormalTok{\}}

\CommentTok{\# Create function for stability condition}
\NormalTok{stab}\OtherTok{=} \ControlFlowTok{function}\NormalTok{(alpha, sigma)\{}
\NormalTok{ (}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta }\SpecialCharTok{{-}}\NormalTok{gamma)}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{sigma) }\SpecialCharTok{+}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta) }\SpecialCharTok{{-}} \DecValTok{1}
\NormalTok{\}}

\CommentTok{\# Create a grid of alpha and sigma values}
\NormalTok{alpha\_vals }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{100}\NormalTok{)}
\NormalTok{sigma\_vals }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{100}\NormalTok{)}
\NormalTok{grid}\OtherTok{=}\FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ alpha\_vals, }\AttributeTok{sigma =}\NormalTok{ sigma\_vals)}

\CommentTok{\# Evaluate the functions on the grid}
\NormalTok{cyc\_vals }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{cyc}\NormalTok{(grid}\SpecialCharTok{$}\NormalTok{alpha, grid}\SpecialCharTok{$}\NormalTok{sigma), }\AttributeTok{nrow =} \DecValTok{100}\NormalTok{)}
\NormalTok{stab\_vals }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{stab}\NormalTok{(grid}\SpecialCharTok{$}\NormalTok{alpha, grid}\SpecialCharTok{$}\NormalTok{sigma), }\AttributeTok{nrow =} \DecValTok{100}\NormalTok{)}

\CommentTok{\# Plot the curves}
\FunctionTok{contour}\NormalTok{(alpha\_vals, sigma\_vals, cyc\_vals, }\AttributeTok{levels =} \DecValTok{0}\NormalTok{, }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }
        \AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(alpha), }\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(sigma), }\AttributeTok{main =} \StringTok{""}\NormalTok{)}
\FunctionTok{contour}\NormalTok{(alpha\_vals, sigma\_vals, stab\_vals, }\AttributeTok{levels =} \DecValTok{0}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }\AttributeTok{add =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{gamma}\SpecialCharTok{/}\NormalTok{delta), }\AttributeTok{col=}\DecValTok{3}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{"cycle condition"}\NormalTok{,}
       \StringTok{"stability condition"}\NormalTok{, }\StringTok{"unique equilibrium condition"}\NormalTok{), }
       \AttributeTok{col =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{lty =} \DecValTok{1}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.8}\NormalTok{, }\AttributeTok{bty =} \StringTok{"n"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{a_Kaldor_model_files/figure-pdf/fig-bif-2.pdf}

}

\caption{\label{fig-bif}Cycle and stability conditions}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\#\#\# Plot cycle and stability condition}
\ImportTok{from}\NormalTok{ matplotlib.lines }\ImportTok{import}\NormalTok{ Line2D}
\CommentTok{\# Set fixed parameter values}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Depreciation rate}
\NormalTok{gamma }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of investment to deviations from normal capital stock}

\CommentTok{\# Define functions for cycle and stability conditions}
\KeywordTok{def}\NormalTok{ cyc(alpha, sigma):}
    \ControlFlowTok{return}\NormalTok{ (alpha }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ sigma) }\OperatorTok{+}\NormalTok{ delta }\OperatorTok{+}\NormalTok{ gamma)}\OperatorTok{**}\DecValTok{2} \OperatorTok{{-}} \DecValTok{4} \OperatorTok{*}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ gamma}

\KeywordTok{def}\NormalTok{ stab(alpha, sigma):}
    \ControlFlowTok{return}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ gamma) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ sigma) }\OperatorTok{+}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta) }\OperatorTok{{-}} \DecValTok{1}

\CommentTok{\# Create a grid of alpha and sigma values}
\NormalTok{alpha\_vals }\OperatorTok{=}\NormalTok{ np.linspace(}\FloatTok{0.5}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\NormalTok{sigma\_vals }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\NormalTok{alpha\_grid, sigma\_grid }\OperatorTok{=}\NormalTok{ np.meshgrid(alpha\_vals, sigma\_vals)}

\CommentTok{\# Evaluate the functions on the grid}
\NormalTok{cyc\_vals }\OperatorTok{=}\NormalTok{ cyc(alpha\_grid, sigma\_grid)}
\NormalTok{stab\_vals }\OperatorTok{=}\NormalTok{ stab(alpha\_grid, sigma\_grid)}

\CommentTok{\# Plot the curves}
\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{))}

\CommentTok{\# Plot cycle condition contour}
\NormalTok{cyc\_contour }\OperatorTok{=}\NormalTok{ plt.contour(alpha\_vals, sigma\_vals, cyc\_vals, levels}\OperatorTok{=}\NormalTok{[}\DecValTok{0}\NormalTok{], colors}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, linewidths}\OperatorTok{=}\DecValTok{2}\NormalTok{)}

\CommentTok{\# Plot stability condition contour}
\NormalTok{stab\_contour }\OperatorTok{=}\NormalTok{ plt.contour(alpha\_vals, sigma\_vals, stab\_vals, levels}\OperatorTok{=}\NormalTok{[}\DecValTok{0}\NormalTok{], colors}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, linewidths}\OperatorTok{=}\DecValTok{2}\NormalTok{)}

\CommentTok{\# Plot unique equilibrium condition}
\NormalTok{unique\_eq\_line }\OperatorTok{=}\NormalTok{ plt.axhline(y}\OperatorTok{=}\DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ gamma }\OperatorTok{/}\NormalTok{ delta), color}\OperatorTok{=}\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{, linestyle}\OperatorTok{=}\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}

\CommentTok{\# Customize the plot}
\NormalTok{plt.xlabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}alpha$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}
\NormalTok{plt.ylabel(}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}sigma$\textquotesingle{}}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{12}\NormalTok{)}

\CommentTok{\# Create custom legend symbols}
\NormalTok{legend\_elements }\OperatorTok{=}\NormalTok{ [}
\NormalTok{    Line2D([}\DecValTok{0}\NormalTok{], [}\DecValTok{0}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{, lw}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{"Cycle condition"}\NormalTok{),}
\NormalTok{    Line2D([}\DecValTok{0}\NormalTok{], [}\DecValTok{0}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, lw}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{"Stability condition"}\NormalTok{),}
\NormalTok{    Line2D([}\DecValTok{0}\NormalTok{], [}\DecValTok{0}\NormalTok{], color}\OperatorTok{=}\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{, lw}\OperatorTok{=}\DecValTok{2}\NormalTok{, label}\OperatorTok{=}\StringTok{"Unique equilibrium condition"}\NormalTok{)}
\NormalTok{]}

\CommentTok{\# Add legend with symbols}
\NormalTok{plt.legend(handles}\OperatorTok{=}\NormalTok{legend\_elements, loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, fontsize}\OperatorTok{=}\DecValTok{9}\NormalTok{)}

\NormalTok{plt.grid(}\VariableTok{False}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

According to Figure~\ref{fig-bif}, combinations of \(\alpha\) and
\(\sigma\) above the cycle and to the right of the stability condition
yield eigenvalues of the model that are a pair of complex conjugates
with a modulus greater than one. The model will then generate a limit
cycle. For combinations of \(\alpha\) and \(\sigma\) to the left of the
stability and above the cycle condition, the model yields damped
oscillations that will converge to a stable equilibrium. For
combinations of \(\alpha\) and \(\sigma\) to the left of the stability
and below the cycle condition, the model yields monotonic converges to a
stable equilibrium.

These analytically derived conditions correspond to and illuminate
further the numerical results in the bifurcation diagrams above. In
Figure~\ref{fig-bif-alpha}, it could be seen that for a fixed
\(\sigma=0.4\), limit cycles appear to occur for
\(\alpha \gtrapprox 1.15\). With the analytical results plotted in
Figure~\ref{fig-bif} we can confirm that this indeed constitutes a Hopf
bifurcation, where the equilibrium loses its stability while the
eigenvalues are complex. Similarly, in Figure~\ref{fig-bif-sigma}, it
could be seen that for a fixed \(\alpha=1.2\), a limit cycle appears to
occur for \(\sigma \gtrapprox 0.25\). Figure~\ref{fig-bif} suggests that
for values of \(\sigma\) below that critical value, the \(Y^*=Y^E\)
equilibrium ceases to be unique, and the system is apparently attracted
to one of the other two equilibria, which appear to be stable.

Finally, we can also compute the eigenvalues and check the analytical
stability and cycle conditions numerically.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Stability analysis}

\CommentTok{\# Set parameter values}
\NormalTok{alpha}\OtherTok{=}\FloatTok{1.2} \CommentTok{\# adjustment speed of output}
\NormalTok{delta}\OtherTok{=}\FloatTok{0.2} \CommentTok{\# depreciation rate}
\NormalTok{sigma}\OtherTok{=}\FloatTok{0.4} \CommentTok{\# propensity to save}
\NormalTok{gamma}\OtherTok{=}\FloatTok{0.6} \CommentTok{\# sensitivity of investment to deviations of actual from normal cap stock}

\CommentTok{\# Construct Jacobian matrix evaluated at the Y*=Y\_E steady state}
\NormalTok{J\_base}\OtherTok{=}\FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{sigma), }\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{gamma,}
                \DecValTok{1}\NormalTok{, }\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta}\SpecialCharTok{{-}}\NormalTok{gamma),}
                 \DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{ev\_base}\OtherTok{=}\FunctionTok{eigen}\NormalTok{(J\_base)}
\NormalTok{(}\AttributeTok{evals\_base =}\NormalTok{ ev\_base}\SpecialCharTok{$}\NormalTok{values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.96+0.3773592i 0.96-0.3773592i
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Obtain determinant and trace}
\NormalTok{tr}\OtherTok{=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(J\_base)) }\CommentTok{\# trace}
\NormalTok{(}\AttributeTok{det=}\FunctionTok{det}\NormalTok{(J\_base))      }\CommentTok{\# determinant}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.064
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate modulus}
\NormalTok{(}\AttributeTok{mod\_base=}\FunctionTok{Mod}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.031504
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Check general stability conditions}
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{tr}\SpecialCharTok{+}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{det}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check analytical stability condition}
\NormalTok{((}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta }\SpecialCharTok{{-}}\NormalTok{gamma)}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{sigma) }\SpecialCharTok{+}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{delta)) }\SpecialCharTok{\textless{}} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

These results confirm that the modulus of the complex eigenvalue is
indeed larger than unity and the system thus unstable.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Check cycle condition and compute cycle length }

\CommentTok{\# Check analytical cycle condition}
\NormalTok{((alpha}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{sigma) }\SpecialCharTok{+}\NormalTok{ delta }\SpecialCharTok{+}\NormalTok{ gamma)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{{-}} \DecValTok{4}\SpecialCharTok{*}\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{gamma) }\SpecialCharTok{\textless{}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Save real and imaginary part of complex eigenvalue}
\NormalTok{re}\OtherTok{=}\FunctionTok{Re}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{])}
\NormalTok{im}\OtherTok{=}\FunctionTok{Im}\NormalTok{(evals\_base[}\DecValTok{1}\NormalTok{])}

\CommentTok{\# Calculate cycle length}
\NormalTok{L}\OtherTok{=}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi)}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{acos}\NormalTok{(re}\SpecialCharTok{/}\NormalTok{mod\_base))}
\NormalTok{L}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 16.77624
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, coltitle=black, left=2mm, rightrule=.15mm, colbacktitle=quarto-callout-note-color!10!white, colframe=quarto-callout-note-color-frame, breakable, leftrule=.75mm, opacitybacktitle=0.6, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Python code}, bottomtitle=1mm, opacityback=0, toptitle=1mm, colback=white, titlerule=0mm, arc=.35mm, bottomrule=.15mm]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#\#\#\#\#\# Stability analysis}

\CommentTok{\# Set parameter values}
\NormalTok{alpha }\OperatorTok{=} \FloatTok{1.2}  \CommentTok{\# Adjustment speed of output}
\NormalTok{delta }\OperatorTok{=} \FloatTok{0.2}  \CommentTok{\# Depreciation rate}
\NormalTok{sigma }\OperatorTok{=} \FloatTok{0.4}  \CommentTok{\# Propensity to save}
\NormalTok{gamma }\OperatorTok{=} \FloatTok{0.6}  \CommentTok{\# Sensitivity of investment to deviations from normal capital stock}

\CommentTok{\# Construct Jacobian matrix evaluated at the Y* = Y\_E steady state}
\NormalTok{J\_base }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{1} \OperatorTok{+}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ sigma), }\OperatorTok{{-}}\NormalTok{alpha }\OperatorTok{*}\NormalTok{ gamma],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ gamma]}
\NormalTok{])}

\CommentTok{\# Obtain eigenvalues}
\NormalTok{evals\_base, \_ }\OperatorTok{=}\NormalTok{ np.linalg.eig(J\_base)}

\CommentTok{\# Print eigenvalues}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Eigenvalues:"}\NormalTok{, evals\_base)}

\CommentTok{\# Obtain determinant and trace}
\NormalTok{tr }\OperatorTok{=}\NormalTok{ np.trace(J\_base)   }\CommentTok{\# Trace}
\NormalTok{det }\OperatorTok{=}\NormalTok{ np.linalg.det(J\_base)  }\CommentTok{\# Determinant}

\CommentTok{\# Print determinant}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Determinant: }\SpecialCharTok{\{}\NormalTok{det}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# Calculate and print modulus of the first eigenvalue}
\NormalTok{mod\_base }\OperatorTok{=} \BuiltInTok{abs}\NormalTok{(evals\_base[}\DecValTok{0}\NormalTok{])}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Modulus of first eigenvalue: }\SpecialCharTok{\{}\NormalTok{mod\_base}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# Check general stability conditions}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"1 + tr + det \textgreater{} 0: }\SpecialCharTok{\{}\DecValTok{1} \OperatorTok{+}\NormalTok{ tr }\OperatorTok{+}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"1 {-} tr + det \textgreater{} 0: }\SpecialCharTok{\{}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ tr }\OperatorTok{+}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"1 {-} det \textgreater{} 0: }\SpecialCharTok{\{}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ det }\OperatorTok{\textgreater{}} \DecValTok{0}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}

\CommentTok{\# Check analytical stability condition}
\BuiltInTok{print}\NormalTok{(((}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta }\OperatorTok{{-}}\NormalTok{ gamma) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ sigma) }\OperatorTok{+}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ delta)) }\OperatorTok{\textless{}} \DecValTok{1}\NormalTok{)}

\CommentTok{\#\#\# Check cycle condition and compute cycle length }

\CommentTok{\# Check analytical cycle condition}
\BuiltInTok{print}\NormalTok{(((alpha }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}}\NormalTok{ sigma) }\OperatorTok{+}\NormalTok{ delta }\OperatorTok{+}\NormalTok{ gamma)}\OperatorTok{**}\DecValTok{2} \OperatorTok{{-}} \DecValTok{4} \OperatorTok{*}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ gamma) }\OperatorTok{\textless{}} \DecValTok{0}\NormalTok{)}

\CommentTok{\# Save real and imaginary parts of complex eigenvalue}
\NormalTok{re }\OperatorTok{=}\NormalTok{ np.real(evals\_base[}\DecValTok{0}\NormalTok{])}
\NormalTok{im }\OperatorTok{=}\NormalTok{ np.imag(evals\_base[}\DecValTok{0}\NormalTok{])}

\CommentTok{\# Calculate cycle length}
\NormalTok{L }\OperatorTok{=}\NormalTok{ (}\DecValTok{2} \OperatorTok{*}\NormalTok{ np.pi) }\OperatorTok{/}\NormalTok{ np.arccos(re }\OperatorTok{/}\NormalTok{ mod\_base)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Cycle length: }\SpecialCharTok{\{}\NormalTok{L}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

The analytical cycle condition confirms that the eigenvalues of the
system will be complex and thus generate cycles. The implied cycle
length is around 17 periods.

\section{References}\label{references-16}

\bookmarksetup{startatroot}

\chapter*{Additional Online
Resources}\label{additional-online-resources}
\addcontentsline{toc}{chapter}{Additional Online Resources}

\markboth{Additional Online Resources}{Additional Online Resources}

Below you can find some related free online resources for macroeconomic
model simulation.

\section*{Economic Modelling in
General}\label{economic-modelling-in-general}
\addcontentsline{toc}{section}{Economic Modelling in General}

\markright{Economic Modelling in General}

\begin{itemize}
\tightlist
\item
  \href{https://open.umn.edu/opentextbooks/textbooks/233}{Sayama (2015)}
  is a free introductory textbook for the modelling and simulation of
  complex systems in \emph{Python}
\item
  \href{https://open.umn.edu/opentextbooks/textbooks/233}{QuantEcon}
  provides online intermediate and advanced resources for economic
  modelling and data analysis in \emph{Python} and \emph{Julia}
\end{itemize}

\section*{Stock-Flow Consistent
Modelling}\label{stock-flow-consistent-modelling}
\addcontentsline{toc}{section}{Stock-Flow Consistent Modelling}

\markright{Stock-Flow Consistent Modelling}

\begin{itemize}
\tightlist
\item
  \href{https://www.marcopassarella.it/en/teaching-2/}{Marco Veronese
  Passarella's website} provides \emph{R} codes for most chapters of
  \href{https://link.springer.com/book/10.1057/9780230626546}{Monetary
  Economics: An Integrated Approach to Credit, Money, Income, Production
  and Wealth} by Wynne Godley and Marc Lavoie, and more
\item
  \href{https://sfc-models.net/}{SFC Models} provides resources on
  stock-flow consistent modelling
\end{itemize}

\section*{Agent-Based Modelling}\label{agent-based-modelling}
\addcontentsline{toc}{section}{Agent-Based Modelling}

\markright{Agent-Based Modelling}

\begin{itemize}
\tightlist
\item
  \href{https://sites.google.com/view/alessandro-caiani/teaching?authuser=0}{Alessandro
  Caiani's website} provides \emph{R} codes for simple agent-based
  models, including those in the introductory book
  \href{https://link.springer.com/book/10.1007/978-3-319-44058-3}{Economics
  with Heterogeneous Interacting Agents: A Practical Guide to
  Agent-Based Modeling} by Alessandro Caiani, Alberto Russo, Antonio
  Palestrini and Mauro Gallegati
\end{itemize}

\section*{Coding}\label{coding}
\addcontentsline{toc}{section}{Coding}

\markright{Coding}

\begin{itemize}
\tightlist
\item
  \href{https://aeturrell.github.io/coding-for-economists/intro.html}{Coding
  for Economists} provides a guide for coding in \emph{Python}
\end{itemize}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Anthony2012}
Anthony, Martin, and Michele Harvey. 2012. \emph{{Linear Algebra:
Concepts and Methods}}. Cambridge UK: {Cambridge University Press}.

\bibitem[\citeproctext]{ref-bhaduri_unemployment_1990}
Bhaduri, Amit, and Stephen Marglin. 1990. {``Unemployment and the Real
Wage: The Economic Basis for Contesting Political Ideologies.''}
\emph{Cambridge Journal of Economics} 14 (4): 375--93.

\bibitem[\citeproctext]{ref-Bischi2001}
Bischi, Gian Italo, Roberto Dieci, Giorgio Rodano, and Enrico Saltari.
2001. {``Multiple Attractors and Global Bifurcations in a Kaldor-Type
Business Cycle Model.''} \emph{Journal of Evolutionary Economics} 11
(5): 527--54. \url{https://doi.org/10.1007/s191-001-8320-9}.

\bibitem[\citeproctext]{ref-Blanchard2013}
Blanchard, Olivier, and David R. Johnson. 2013. \emph{Macroeconomics,
6th Edition}. Pearson.

\bibitem[\citeproctext]{ref-Blecker2019}
Blecker, Robert A., and Mark Setterfield. 2019. \emph{Heterodox
Macroeconomics. Models of Demand, Distribution and Growth}. Edward
Elgar.

\bibitem[\citeproctext]{ref-Carlin2014}
Carlin, Wendy, and David Soskice. 2014. \emph{Macroeconomics.
Instititions, Instability, and the Financial System}. Oxford University
Press.

\bibitem[\citeproctext]{ref-Chang1971}
Chang, W. W., and D. J. Smyth. 1971. {``The Existence and Persistence of
Cycles in a Non-Linear Model: Kaldor's 1940 Model Re-Examined.''}
\emph{The Review of Economic Studies} 38 (1): 37.
\url{https://doi.org/10.2307/2296620}.

\bibitem[\citeproctext]{ref-Chiang2005}
Chiang, Alpha C, and Kevin Wainwright. 2005. \emph{Fundamental {Methods}
of {Mathematical Economics}}. 4th ed. New York: {McGraw-Hill Education}.

\bibitem[\citeproctext]{ref-Dutt2018}
Dutt, Amitava Krishna. 2018. {``Some Observations on Models of Growth
and Distribution with Autonomous Demand Growth.''} \emph{Metroeconomica}
70 (2): 288--301. \url{https://doi.org/10.1111/meca.12234}.

\bibitem[\citeproctext]{ref-Fennell2015}
Fennell, Peter G., David J. P. O'Sullivan, Antoine Godin, and Stephen
Kinsella. 2015. {``Is It Possible to Visualise Any Stock Flow Consistent
Model as a Directed Acyclic Graph?''} \emph{Computational Economics} 48
(2): 307--16. \url{https://doi.org/10.1007/s10614-015-9521-8}.

\bibitem[\citeproctext]{ref-Foley2006}
Foley, Duncan K. 2006. \emph{Adam's Fallacy. A Guide to Economic
Theology}. Cambridge, MA / London: Harvard University Press.

\bibitem[\citeproctext]{ref-fontana_simple_2009}
Fontana, Giuseppe, and Mark Setterfield. 2009. {``A {Simple} (and
{Teachable}) {Macreconomic Model} with {Endogenous Money}.''} In
\emph{Macroeconomic {Theory} and {Macroeconomic Pedagogy}}, edited by
Giuseppe Fontana and Mark Setterfield, 144--68. Basingstoke ; New York:
{Palgrave Macmillan}.

\bibitem[\citeproctext]{ref-Froyen2005}
Froyen, Richard T. 2005. \emph{Macroeconomics. Theories and Policies.
8th Edition.} Pearson Education.

\bibitem[\citeproctext]{ref-Gabisch1989}
Gabisch, Günter, and Hans-Walter Lorenz. 1989. \emph{Business Cycle
Theory. A Survey of Methods and Concepts, 2nd Edition}. Springer-Verlag.

\bibitem[\citeproctext]{ref-gali_state_2018}
Galí, Jordi. 2018. {``The {State} of {New Keynesian Economics}: {A
Partial Assessment}.''} \emph{Journal of Economic Perspectives} 32 (3):
87--112. \url{https://doi.org/10.1257/jep.32.3.87}.

\bibitem[\citeproctext]{ref-Gandolfo2009}
Gandolfo, Giancarlo. 2009. \emph{Economic Dynamics. Study Edition. 4th
Edition.} Springer.

\bibitem[\citeproctext]{ref-Garin2021}
Garín, Julio, Robert Lester, and Eric Sims. 2021. \emph{Intermediate
Macroeconomics}. Draft Version 3.0.1.
\url{https://juliogarin.com/files/textbook/GLS_Intermediate_Macro.pdf}.

\bibitem[\citeproctext]{ref-hein_distribution_2014}
Hein, Eckhard. 2014. \emph{Distribution and {Growth After Keynes}: {A
Post}-{Keynesian Guide}}. Cheltenham: {Edward Elgar}.

\bibitem[\citeproctext]{ref-Hein2023}
---------. 2023. \emph{Macroeconmics After Kalecki and Keynes.
Post-Keynesian Foundations}. Edward Elgar.

\bibitem[\citeproctext]{ref-Hicks1937}
Hicks, A. R. 1937. {``{Mr. Keynes and the "Classics": A Suggested
Interpretation}.''} \emph{Econometrica} 5 (2): 147.
\url{https://doi.org/10.2307/1907242}.

\bibitem[\citeproctext]{ref-Hicks1950}
Hicks, John R. 1950. \emph{A Contribution to the Theory of the Trade
Cycle}. Clarendon Press.

\bibitem[\citeproctext]{ref-Hommes1995}
Hommes, Cars H. 1995. {``{A reconsideration of Hicks' non-linear trade
cycle model}.''} \emph{Structural Change and Economic Dynamics} 6 (4):
435--95. \url{https://doi.org/10.1016/0954-349X(95)00032-I}.

\bibitem[\citeproctext]{ref-Kaldor1940}
Kaldor, Nicholas. 1940. {``A Model of the Trade Cycle.''} \emph{The
Economic Journal} 50 (197): 78--92.

\bibitem[\citeproctext]{ref-Lavoie2006}
Lavoie, Marc. 2006. \emph{Introduction to Post-Keynesian Economics}.
Palgrave Macmillan.

\bibitem[\citeproctext]{ref-lavoie_post-keynesian_2014}
---------. 2014. \emph{Post-{Keynesian Economics}: {New Foundations}}.
Cheltenham; Northampton, MA: {Edward Elgar}.

\bibitem[\citeproctext]{ref-Lavoie2022}
---------. 2022. \emph{Post-Keynesian Economics. New Foundations}. 2nd
ed. Edward Elgar.

\bibitem[\citeproctext]{ref-Lewis1954}
Lewis, W. A. 1954. {``{Economic Development with Unlimited Supplies of
Labour}.''} \emph{The Manchester School} 22 (2): 139--91.
\url{https://doi.org/10.1111/j.1467-9957.1954.tb00021.x}.

\bibitem[\citeproctext]{ref-Pasinetti1960}
Pasinetti, Luigi L. 1960. {``{A Mathematical Formulation of the
Ricardian System}.''} \emph{The Review of Economic Studies} 27 (2):
78--98. \url{https://doi.org/10.2307/2296129}.

\bibitem[\citeproctext]{ref-Puu2005}
Puu, Tönu, Laura Gardini, and Irina Sushko. 2005. {``A Hicksian
Multiplier-Accelerator Model with Floor Determined by Capital Stock.''}
\emph{Journal of Economic Behavior \& Organization} 56 (3): 331--48.
\url{https://doi.org/10.1016/j.jebo.2003.10.008}.

\bibitem[\citeproctext]{ref-Rowthorn1977}
Rowthorn, R. E. 1977. {``{Conflict, inflation and money}.''}
\emph{Cambridge Journal of Economics} 1 (3).
\url{https://doi.org/10.1093/oxfordjournals.cje.a035360}.

\bibitem[\citeproctext]{ref-Samuelson1939}
Samuelson, Paul A. 1939. {``{Interactions between the Multiplier
Analysis and the Principle of Acceleration}.''} \emph{The Review of
Economics and Statistics} 21 (2): 75--78.
\url{https://doi.org/10.2307/1927758}.

\bibitem[\citeproctext]{ref-Sayama2015}
Sayama, Hiroki. 2015. \emph{Introduction to the Modeling and Analysis of
Complex Systems}. Open SUNY Textbooks, Milne Library.

\bibitem[\citeproctext]{ref-Serrano1995}
Serrano, Franklin. 1995. {``{Long Period Effective Demand and the
Sraffian Supermultiplier}.''} \emph{Contributions to Political Economy}
14 (1): 67--90.
\url{https://doi.org/10.1093/oxfordjournals.cpe.a035642}.

\bibitem[\citeproctext]{ref-Stockhammer2019}
Stockhammer, Engelbert, Robert Calvert Jump, Karsten Kohler, and Julian
Cavallero. 2019. {``Short and Medium Term Financial-Real Cycles: An
Empirical Assessment.''} \emph{Journal of International Money and
Finance} 94 (June): 81--96.
\url{https://doi.org/10.1016/j.jimonfin.2019.02.006}.

\bibitem[\citeproctext]{ref-Todaro2015}
Todaro, Michael P., and Stephen C. Smith. 2015. \emph{Economic
Development, 12th Edition}. Pearson.

\bibitem[\citeproctext]{ref-Wildauer2023}
Wildauer, Rafael, Karsten Kohler, Adam Aboobaker, and Alexander
Guschanski. 2023. {``{Energy price shocks, conflict inflation, and
income distribution in a three-sector model}.''} \emph{Energy Economics}
127B. \url{https://doi.org/10.1016/j.eneco.2023.106982}.

\end{CSLReferences}



\end{document}
