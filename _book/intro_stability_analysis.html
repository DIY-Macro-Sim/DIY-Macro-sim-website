<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DIY Macroeconomic Model Simulation - 3&nbsp; An Introduction to Stability Analysis of Dynamic Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./static_models.html" rel="next">
<link href="./how_to_simulate.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">An Introduction to Stability Analysis of Dynamic Models</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DIY Macroeconomic Model Simulation</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_use.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">How to Use this Site</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_simulate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to Simulate Economic Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_stability_analysis.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">An Introduction to Stability Analysis of Dynamic Models</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./static_models.html" class="sidebar-item-text sidebar-link">Static models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_macro_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A Neoclassical Macro Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_IS_LM_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">An IS-LM Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_synthesis_model_IS_LM_AS_AD.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Neoclassical Synthesis Model (IS-LM-AS-AD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_keynesian_macro_model_with_endogenous_money.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Post-Keynesian Macro Model with Endogenous Money</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_kaleckian_distribution_and_growth_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">A Post-Kaleckian Distribution and Growth Model</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./dynamic_models.html" class="sidebar-item-text sidebar-link">Dynamic models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_new_keynesian_3_equation_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">A New Keynesian 3-Equation Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_sraffian_supermultiplier_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">A Sraffian Supermultiplier Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_malthusian_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">A Malthusian Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_one_sector_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">A Ricardian One-Sector Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_two_sector_model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Ricardian Two-Sector Model</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#solution-of-a-single-first-order-linear-difference-equation" id="toc-solution-of-a-single-first-order-linear-difference-equation" class="nav-link active" data-scroll-target="#solution-of-a-single-first-order-linear-difference-equation">Solution of a single first-order linear difference equation</a></li>
  <li><a href="#solution-of-linear-system-of-difference-equations" id="toc-solution-of-linear-system-of-difference-equations" class="nav-link" data-scroll-target="#solution-of-linear-system-of-difference-equations">Solution of linear system of difference equations</a></li>
  <li><a href="#complex-numbers-and-cycles" id="toc-complex-numbers-and-cycles" class="nav-link" data-scroll-target="#complex-numbers-and-cycles">Complex numbers and cycles</a></li>
  <li><a href="#nonlinear-systems" id="toc-nonlinear-systems" class="nav-link" data-scroll-target="#nonlinear-systems">Nonlinear systems</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/edit/main/intro_stability_analysis.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">An Introduction to Stability Analysis of Dynamic Models</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="solution-of-a-single-first-order-linear-difference-equation" class="level2"><h2 class="anchored" data-anchor-id="solution-of-a-single-first-order-linear-difference-equation">Solution of a single first-order linear difference equation</h2>
<p>Consider a first-order linear difference equation:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
y_t = a_0 + a_1y_{t-1}.
\]</span></p>
<p>One way to find a solution is through (manual) iteration:</p>
<p><span class="math inline">\(y_0\)</span>, <span class="math inline">\(y_1 = a_0 + a_1 y_0\)</span>, <span class="math inline">\(y_2 = a_0 + a_1(a_0 + a_1 y_0) = a_0^2y_0 + a_0(a_1+1)\)</span>, …, <span class="math inline">\(y_t = a_1^ty_0 + a_0\sum^{t-1}_{i=0} a_1^t\)</span>.</p>
<p>Of course, this is the same approach we have used above to solve economic models via simulation. If <span class="math inline">\(|a_1|&lt;1\)</span>, we can make use of the fact that the second term is a geometric series which approaches <span class="math inline">\(\frac{a_0}{1-a}\)</span> as <span class="math inline">\(t\rightarrow \infty\)</span>. Another way of finding this second term in the solution is to set <span class="math inline">\(y_t=y_{t-1}\)</span> and solving for <span class="math inline">\(y\)</span>. Thus, the solution takes the form:</p>
<p><span class="math display">\[
y_t = a_1^ty_0 + \frac{a_0}{1-a_1}.
\]</span> From iteration, we thus know that the solution to a difference equation has two parts: first, a term that captures the dynamics of <span class="math inline">\(y_t\)</span> (the so-called <em>complementary function</em>) and second, a term that captures the long-run equilibrium <span class="math inline">\(y^*\)</span> (the so-called <em>particular solution</em>). The complementary function tells us about the ‘asymptotic stability’ of the equation: does <span class="math inline">\(y_t\)</span> converge to <span class="math inline">\(y^*\)</span> as <span class="math inline">\(t \rightarrow \infty\)</span>? For the case of a first-order difference equation, we can distinguish the following cases:</p>
<ul>
<li><p>if <span class="math inline">\(|a_1|&lt;1\)</span>, then the complementary function <span class="math inline">\(a_1^ty_0\)</span> will converge to zero and <span class="math inline">\(y_t\)</span> will approach the particular solution <span class="math inline">\(y^*=\frac{a_0}{1-a_1}\)</span></p></li>
<li><p>if <span class="math inline">\(|a_1|&gt;1\)</span>, then the complementary function <span class="math inline">\(a_1^ty_0\)</span> will grow exponentially or decay and <span class="math inline">\(y_t\)</span> will thus never converge to the particular solution</p></li>
<li><p>if <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 \neq\)</span>, then <span class="math inline">\(y_t\)</span> will grow linearly</p></li>
<li><p>if <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 =0\)</span>, then <span class="math inline">\(y_t\)</span> will not grow o fall forever, but it will also not approach the particular solution.</p></li>
</ul>
<p>To better understand the last two cases, note that if <span class="math inline">\(a_1=1\)</span>, a different (more general) approach to finding the particular solution is required: the so-called method of undetermined coefficients. This method consists of substituting a trial solution into the difference equation that contains undetermined coefficients and then attempting to solve for those coefficients. If the trial solution allows to pin down unique values for the coefficients, it constitute a valid particular solution. In the case where <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 \neq 0\)</span>, use the trial solution <span class="math inline">\(y^*=kt\)</span>, i.e.&nbsp;consider a growing equilibrium. This yields <span class="math inline">\(y_t = k(t-1) + a_0\)</span>, which solves for <span class="math inline">\(k=a_0\)</span>, so that we can conclude <span class="math inline">\(y^*=a_0t\)</span>. This explains why we obtain linear growth.</p>
</section><section id="solution-of-linear-system-of-difference-equations" class="level2"><h2 class="anchored" data-anchor-id="solution-of-linear-system-of-difference-equations">Solution of linear system of difference equations</h2>
<p>The solution approach just introduced can be extended to linear systems of difference equations of the form:</p>
<p><span class="math display">\[
\mathbf{y_t}=\mathbf{a_0} + \mathbf{Ay_{t-1}}.  
\]</span></p>
<p>The solution will be of the form:</p>
<p><span class="math display">\[
\mathbf{y_t}=\mathbf{A^t}\mathbf{y_0} + (\mathbf{I}-\mathbf{A})^{-1}\mathbf{a_0}.
\]</span></p>
<p>The problem with this generic solution is that it is difficult to assess what is going on: the dynamics of any variable in <span class="math inline">\(\mathbf{y_t}\)</span> will depend on the initial values of the other variables and a lengthy combination of the parameters in <span class="math inline">\(A\)</span> that result from repeated matrix multiplication. In addition, it is impossible to assess whether the system converges to the particular solution. To address this problem, we can use a tool from linear algebra called matrix diagonalisation. Under certain conditions, a matrix <span class="math inline">\(A\)</span> can be decomposed into the product of three matrices in which the matrix in the middle is diagonal. As we will see, this trick has a useful application for our problem.</p>
<p>A matrix <span class="math inline">\(A\)</span> is diagonalisable if there is a diagonal matrix <span class="math inline">\(D\)</span> and an invertible matrix <span class="math inline">\(P\)</span> such that <span class="math inline">\(A=PDP^{-1}\)</span>. A major advantage of this decomposition is the following property: <span class="math inline">\(A^n = (PDP^{-1})^n = PD^nP^{-1}\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Thus, the <span class="math inline">\(n-th\)</span> power of the matrix <span class="math inline">\(A\)</span>, which typically yields very cumbersome expressions, simplifies to <span class="math inline">\(PD^nP^{-1}\)</span>, where the <span class="math inline">\(n-th\)</span> power of <span class="math inline">\(D\)</span> are simply applied to each individual element on the main diagonal thanks to <span class="math inline">\(D\)</span> being a diagonal matrix. As a result, diagonalisation allows us to write the complementary function in the solution to a system of difference equations as: <span class="math inline">\(PD^tP^{-1}y_0\)</span>. We can further define a vector of arbitrary constants <span class="math inline">\(c=P^{-1}y_0\)</span> so that the complementary function becomes <span class="math inline">\(PD^tc\)</span>. For the first variable in the system, the solution would be of the form: <span class="math inline">\(y_{1t}=v_11c_1\lambda_1^t+v_12c_2\lambda_2^t + ...+ y^*\)</span>. From this representation of the solution, the nature of the dynamics can easily be determined by looking at the eigenvalue <span class="math inline">\(\lambda\)</span> that is largest in absolute terms or ‘dominant’. Only if the dominant eigenvalue is <span class="math inline">\(|\lambda|&lt;1\)</span> will the system converge to <span class="math inline">\(y^*\)</span>. The elements <span class="math inline">\(v_{ij}\)</span> of the eigenvectors act as multipliers on the eigenvalues and can thus switch off certain eigenvalues of they happen to be zero or amplify their dynamics both into the positive and negative domain, depending on their algebraic sign.</p>
<p>How can the diagonal matrix <span class="math inline">\(D\)</span> be found? Notice that <span class="math inline">\(AP=PD\)</span> can also be written as <span class="math inline">\(Av_i=\lambda_iv_i\)</span>, where <span class="math inline">\(v_i\)</span> are the column vectors of <span class="math inline">\(P\)</span> and <span class="math inline">\(\lambda_i\)</span> are the elements on the main diagonal of <span class="math inline">\(D\)</span>. The <span class="math inline">\(v_i\)</span> are called the eigenvectors of the matrix <span class="math inline">\(A\)</span> and the <span class="math inline">\(\lambda_i\)</span> are its eigenvalues.Wen can then write <span class="math inline">\(v_i(A-\lambda_iI)=0\)</span>. We want to find the solutions of this linear system other than <span class="math inline">\(v_i \neq 0\)</span>. This requires the determinant of the matrix <span class="math inline">\(A-\lambda_iI\)</span> to become zero, i.e.&nbsp;<span class="math inline">\(det(A-\lambda_iI)=0\)</span>. Note there will be an infinite number of solutions for the eigenvectors. In fact, any scalar multiple of the eigenvectors (other than zero) is admissible. It is thus common to normalise the eigenvectors by dividing through one of its elements.</p>
<p>Consider the matrix <span class="math inline">\(A=\begin{bmatrix}7 &amp; -15 \\ 2 &amp; -4 \end{bmatrix}\)</span>. For simplicity, let <span class="math inline">\(\mathbf{a_0}=\mathbf{0}\)</span>. Then <span class="math inline">\(A-\lambda_iI =\begin{bmatrix}7 - \lambda &amp; -15 \\ 2 &amp; -4 - \lambda \end{bmatrix}\)</span> and <span class="math inline">\(det(A-\lambda_iI)=(7-\lambda)(-4-\lambda)+30=\lambda^2 - 3\lambda +2=0\)</span>. This second-order polynomial solves for <span class="math inline">\(\lambda_1=2\)</span> and <span class="math inline">\(\lambda_2=1\)</span>, which will be the elements on the diagonal of <span class="math inline">\(D\)</span>. To find <span class="math inline">\(v_i\)</span>, substitute <span class="math inline">\(\lambda_i\)</span> into <span class="math inline">\(A-\lambda_iI=0\)</span>. For <span class="math inline">\(\lambda_1=2\)</span>, we get <span class="math inline">\(5v_{21}- 15v_{22}=0\)</span> and <span class="math inline">\(2v_{21}- 6v_{22}=0\)</span>, yielding the eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 3 \\ 1\end{bmatrix}\)</span>. Dividing through by the first element yields the normalised eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\)</span>. For <span class="math inline">\(\lambda_2=1\)</span>, this yields <span class="math inline">\(6v_{11}- 15v_{12}=0\)</span> and <span class="math inline">\(2v_{11}-5v_{12}=0\)</span> from which we can deduce that <span class="math inline">\(v_2=\begin{bmatrix} 5 \\ 2\end{bmatrix}\)</span>. The normalised eigenvector is <span class="math inline">\(v_2=\begin{bmatrix} 1 \\ 0.4 \end{bmatrix}\)</span>.</p>
<p>Of course, you can also perform these calculations in R:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Clear the environment </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Find eigenvalues and eigenvectors of matrix</span></span>
<span><span class="co"># Define matrix</span></span>
<span><span class="va">J</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">15</span>,</span>
<span>           <span class="fl">2</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain eigenvalues and eigenvectors</span></span>
<span><span class="va">ev</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">evals</span> <span class="op">=</span> <span class="va">ev</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 1</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">evecs</span> <span class="op">=</span> <span class="va">ev</span><span class="op">$</span><span class="va">vector</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 0.9486833 0.9284767
[2,] 0.3162278 0.3713907</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Normalise eigenvectors by dividing through by the first element</span></span>
<span><span class="va">evecs_norm</span><span class="op">=</span><span class="va">evecs</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">evecs_norm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">evecs</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">evecs</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">evecs_norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1] [,2]
[1,] 1.0000000  1.0
[2,] 0.3333333  0.4</code></pre>
</div>
</div>
<p>We can now use this solution for the eigenvectors and eigenvalues to write the solution of the dynamic system as:</p>
<p><span class="math display">\[
\begin{bmatrix} y_{1t} \\ y_{2t} \end{bmatrix}=\begin{bmatrix} 1 &amp; 1 \\ \frac{1}{3} &amp; 0.4 \end{bmatrix} \begin{bmatrix} 2 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}^t \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix}.
\]</span> Multiplying the matrices out yields:</p>
<p><span class="math display">\[
y_{1t} = c_{1}2^t + c_{2}1^t \\
y_{2t} = \frac{1}{3}c_{1}2^t + 0.4c_{2}1^t
\]</span></p>
<p>Before comparing these analytical results with those from a numerical simulation, let’s summarise the information we gain from the eigenvalues, eigenvectors, and arbitrary constants about the dynamics of the system:</p>
<ul>
<li><p>since the dominant eigenvalue <span class="math inline">\(\lambda_1=2\)</span> is larger than one, we know that the system is unstable</p></li>
<li><p>since both elements in the dominant eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\)</span> are non-zero, both variable in the system will be driven by that dominant eigenvalue</p></li>
<li><p>since both elements in the dominant eigenvector are positive but the arbitrary constant <span class="math inline">\(c_1\)</span> is negative, both variables will exhibit negative growth</p></li>
<li><p>since both variables will decay at the same rate, their ratio will be constant as <span class="math inline">\(t \rightarrow \infty\)</span> and will approach a value that is given by the ratio of the elements in the dominant eigenvector</p></li>
</ul>
<p>To see the last point, observe that in <span class="math inline">\(\frac{y_{2t}}{y_{1t}}=\frac{\frac{1}{3}c_{1}2^t + 0.4c_{2}1^t}{c_{1}2^t + c_{2}1^t}\)</span>, the terms first term in the numerator and denominator quickly dominates the second term as <span class="math inline">\(t \rightarrow \infty\)</span>. Thus, <span class="math inline">\(\frac{y_{2t}}{y_{1t}}\)</span> will approach <span class="math inline">\(\frac{1}{3}\)</span> as <span class="math inline">\(t \rightarrow \infty\)</span>.</p>
<p>Let us simulate the system and compare the results for, say, <span class="math inline">\(t=20\)</span> with the analytical solution:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/matlib">matlib</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set number of periods for which you want to simulate</span></span>
<span><span class="cn">T</span><span class="op">=</span><span class="fl">100</span></span>
<span></span>
<span><span class="co"># Construct matrices in which values for different periods will be stored; initialise at 1</span></span>
<span><span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Solve this system recursively based on the initialisation</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y1</span><span class="op">[</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">J</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y1</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">J</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">y2</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">y2</span><span class="op">[</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">J</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y1</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">J</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">y2</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span> <span class="co"># close time loop</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot dynamics of y1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"y1"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/how_to10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find arbitrary constants: c=(P^-1)*y0</span></span>
<span><span class="va">y0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">y2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># create vector with initial conditions y0</span></span>
<span><span class="va">c</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/matlib/man/Inverse.html">inv</a></span><span class="op">(</span><span class="va">evecs_norm</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">y0</span></span>
<span><span class="va">c</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   -9
[2,]   10</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute solution manually for t=20 and compare with simulated solution</span></span>
<span><span class="va">t</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">c</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="va">t</span> <span class="op">+</span> <span class="va">c</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="va">t</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -9206</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y1</span><span class="op">[</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -9206</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">c</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="va">t</span> <span class="op">+</span> <span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">c</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="va">t</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3068.667</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y2</span><span class="op">[</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3068</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot dynamics of y2/y1</span></span>
<span><span class="va">y2_y1</span><span class="op">=</span><span class="va">y2</span><span class="op">/</span><span class="va">y1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y2_y1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"y2/y1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/how_to10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare y2/y1 with normalised dominant eigenvector</span></span>
<span><span class="va">y2_y1</span><span class="op">[</span>,<span class="cn">T</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
</div>
<p>It can be seen that the simulated results are equivalent to the results we obtain mathematically. The key insight is that by deriving information about the eigenvalues (and possibly eigenvectors) of the Jacobian matrix of the system, we are able to deduce knowledge of the dynamic properties of the system even without numerical simulation. However, the more complex the dynamic system, the more difficult this will be, thereby rendering numerical simulation a key tool to supplement formal analysis.</p>
</section><section id="complex-numbers-and-cycles" class="level2"><h2 class="anchored" data-anchor-id="complex-numbers-and-cycles">Complex numbers and cycles</h2>
</section><section id="nonlinear-systems" class="level2"><h2 class="anchored" data-anchor-id="nonlinear-systems">Nonlinear systems</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Anthony2012" class="csl-entry" role="doc-biblioentry">
Anthony, Martin, and Michele Harvey. 2012. <em><span class="nocase">Linear Algebra: Concepts and Methods</span></em>. Cambridge UK: <span>Cambridge University Press</span>.
</div>
<div id="ref-Chiang2005" class="csl-entry" role="doc-biblioentry">
Chiang, Alpha C, and Kevin Wainwright. 2005. <em>Fundamental <span>Methods</span> of <span>Mathematical Economics</span></em>. 4th ed. New York: <span>McGraw-Hill Education</span>.
</div>
<div id="ref-Gandolfo2009" class="csl-entry" role="doc-biblioentry">
Gandolfo, Giancarlo. 2009. <em>Economic Dynamics. Study Edition. 4th Edition.</em> Springer.
</div>
<div id="ref-Sayama2015" class="csl-entry" role="doc-biblioentry">
Sayama, Hiroki. 2015. <em>Introduction to the Modeling and Analysis of Complex Systems</em>. Open SUNY Textbooks, Milne Library.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>We will focus here on difference instead of differential equations, i.e.&nbsp;on dynamics in discrete as opposed to continuous time. Most of the continuous-time counterpart is analogous to the material covered here. <span class="citation" data-cites="Sayama2015">Sayama (<a href="#ref-Sayama2015" role="doc-biblioref">2015</a>)</span> provides a very accessible and applied introduction to dynamic systems with Python code. An introductory treatment of the underlying mathematics is <span class="citation" data-cites="Chiang2005">Chiang and Wainwright (<a href="#ref-Chiang2005" role="doc-biblioref">2005</a>)</span>, chaps. X. <span class="citation" data-cites="Gandolfo2009">Gandolfo (<a href="#ref-Gandolfo2009" role="doc-biblioref">2009</a>)</span> provides a more advanced treatment of the mathematics as well as many economic examples. A great introduction to linear algebra is <span class="citation" data-cites="Anthony2012">Anthony and Harvey (<a href="#ref-Anthony2012" role="doc-biblioref">2012</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is because in the product <span class="math inline">\((PDP^{-1})(PDP^{-1})(PDP^{-1})...\)</span>, each <span class="math inline">\(P\)</span> cancels a <span class="math inline">\(P^{-1}\)</span>, except for the first <span class="math inline">\(P\)</span> and last <span class="math inline">\(P^{-1}\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./how_to_simulate.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to Simulate Economic Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./static_models.html" class="pagination-link">
        <span class="nav-page-text">Static models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">An open-source platform for macroeconomic model simulation.</div>   
    <div class="nav-footer-right"><a>License: …</a><a></a> <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website">Source code</a></div>
  </div>
</footer>


</body></html>