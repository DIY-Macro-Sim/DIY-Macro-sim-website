<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.321">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DIY Macroeconomic Model Simulation - 9&nbsp; An Introduction to the Analysis of Dynamic Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./a_new_keynesian_3_equation_model.html" rel="next">
<link href="./a_post_kaleckian_distribution_and_growth_model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_stability_analysis.html">Dynamic Models</a></li><li class="breadcrumb-item"><a href="./intro_stability_analysis.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to the Analysis of Dynamic Models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DIY Macroeconomic Model Simulation</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_use.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_simulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to Simulate Economic Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Static Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_macro_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Neoclassical Macro Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_IS_LM_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An IS-LM Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_synthesis_model_IS_LM_AS_AD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Neoclassical Synthesis Model (IS-LM-AS-AD)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_keynesian_macro_model_with_endogenous_money.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Post-Keynesian Macro Model with Endogenous Money</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Kaldor-Robinson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Kaldor-Robinson Distribution and Growth Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_kaleckian_distribution_and_growth_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">A Post-Kaleckian Distribution and Growth Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Dynamic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_stability_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to the Analysis of Dynamic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_new_keynesian_3_equation_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">A New Keynesian 3-Equation Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_sraffian_supermultiplier_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">A Sraffian Supermultiplier Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_malthusian_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">A Malthusian Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_one_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Ricardian One-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_two_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Ricardian Two-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Lewis_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Lewis Model of Economic Development</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./additional_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Additional Online Resources</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#solution-of-a-single-first-order-linear-difference-equation" id="toc-solution-of-a-single-first-order-linear-difference-equation" class="nav-link active" data-scroll-target="#solution-of-a-single-first-order-linear-difference-equation">Solution of a single first-order linear difference equation</a></li>
  <li><a href="#solution-of-a-linear-system-of-difference-equations" id="toc-solution-of-a-linear-system-of-difference-equations" class="nav-link" data-scroll-target="#solution-of-a-linear-system-of-difference-equations">Solution of a linear system of difference equations</a></li>
  <li><a href="#complex-eigenvalues-and-cycles" id="toc-complex-eigenvalues-and-cycles" class="nav-link" data-scroll-target="#complex-eigenvalues-and-cycles">Complex eigenvalues and cycles</a></li>
  <li><a href="#nonlinear-systems" id="toc-nonlinear-systems" class="nav-link" data-scroll-target="#nonlinear-systems">Nonlinear systems</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key takeaways</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-stab_analysis" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to the Analysis of Dynamic Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>To build and analyse dynamic models, we need to understand the dynamics of <em>state variables</em>, which are a function of their own previous values: <span class="math inline">\(y_t=h(y_{t-1})\)</span>. The state variables govern the dynamics of the entire model (including the non-state variables). Typically, as model has multiple state variables that interact with each other over time. As briefly shown in <a href="how_to_simulate.html"><span>Chapter&nbsp;2</span></a>, we can simulate dynamic models numerically for a specific parameterisation. However, to study their dynamics in general, we need to mathematically analyse a <em>system of difference (or differential) equations</em>. This chapter provides a basic introduction to the mathematical tools to do this. It will help you understand the analytical discussions in the chapters on dynamic models but can be skipped if you are mostly interested in numerical simulation.</p>
<section id="solution-of-a-single-first-order-linear-difference-equation" class="level2"><h2 class="anchored" data-anchor-id="solution-of-a-single-first-order-linear-difference-equation">Solution of a single first-order linear difference equation</h2>
<p>Consider a first-order linear difference equation:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
y_t = a_0 + a_1y_{t-1}.
\]</span></p>
<p>One way to find a solution is through (manual) iteration:</p>
<p><span class="math display">\[y_0,\]</span> <span class="math display">\[y_1 = a_0 + a_1 y_0,\]</span> <span class="math display">\[y_2 = a_0 + a_1(a_0 + a_1 y_0) = a_0(a_1+1) + a_1^2y_0 ,\]</span> <span class="math display">\[y_3 = a_0 + a_1[a_0 + a_1(a_0 +a_1y_0)]= a_0(a_1^2+a_1+1) + a_1^3y_0\]</span> <span class="math display">\[...,\]</span> <span class="math display">\[y_t = a_0\sum^{t-1}_{i=0} a_1^i + a_1^ty_0 \]</span></p>
<p>Of course, this is effectively the same approach we have used before to solve economic models via simulation.</p>
<p>If <span class="math inline">\(a_1\neq1\)</span>, the term <span class="math inline">\(a_0\sum^{t-1}_{i=0} a_1^i\)</span> is a convergent geometric series:</p>
<p><span class="math display">\[a_0\sum^{t-1}_{i=0} a_1^i= a_0\frac{(1-a_1^t)}{1-a_1}.\]</span></p>
<p>Thus, the solution thus takes the form:</p>
<p><span class="math display">\[
y_t = \frac{a_0(1-a_1^t)}{1-a_1} + a_1^ty_0 =\frac{a_0}{1-a_1} + a_1^t\left(y_0 - \frac{a_0}{1-a_1}\right).
\]</span></p>
<p>From iteration, we thus know that the solution to a difference equation has two parts:</p>
<ol type="1">
<li>a term that captures the long-run equilibrium <span class="math inline">\(y^*\)</span> (the so-called <em>particular solution</em>),</li>
<li>a term that captures the dynamics of <span class="math inline">\(y_t\)</span> (the so-called <em>complementary function</em>).</li>
</ol>
<p><span class="math display">\[
y_t = \underbrace{\frac{a_0}{1-a_1}}_{equilibrium \: y^*} + \underbrace{a_1^t\left(y_0 - \frac{a_0}{1-a_1}\right)}_{dynamics}.
\]</span></p>
<p>The complementary function tells us about the ‘asymptotic stability’ of the equation: does <span class="math inline">\(y_t\)</span> converge to <span class="math inline">\(y^*\)</span> as <span class="math inline">\(t \rightarrow \infty\)</span>?</p>
<p>For the case of a first-order difference equation, we can distinguish the following cases:</p>
<ul>
<li><p>if <span class="math inline">\(|a_1|&lt;1\)</span>, then the complementary function will converge to zero and <span class="math inline">\(y_t\)</span> will approach the particular solution <span class="math inline">\(y^*\)</span></p></li>
<li><p>if <span class="math inline">\(|a_1|&gt;1\)</span>, then the complementary function will grow exponentially or decay, and <span class="math inline">\(y_t\)</span> will thus never converge to the particular solution <span class="math inline">\(y^*\)</span></p></li>
<li><p>if <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 \neq0\)</span>, then <span class="math inline">\(y_t\)</span> will grow linearly</p></li>
<li><p>if <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 =0\)</span>, then <span class="math inline">\(y_t\)</span> will not grow or fall forever, but it will also not approach a unique equilibrium</p></li>
</ul>
<p>To better understand the last two cases, note that if <span class="math inline">\(a_1=1\)</span>, a different (more general) approach to finding the particular solution is required: the so-called <em>method of undetermined coefficients</em>. This method consists of substituting a trial solution that contains undetermined coefficients into the difference equation and then attempting to solve for those coefficients. If the trial solution allows to pin down unique values for the coefficients, it constitute a valid particular solution.</p>
<p>In the case above where <span class="math inline">\(a_1 \neq 1\)</span>, we could have used the trial solution <span class="math inline">\(y_t=y_{t-1}=y^*\)</span> and then solve for <span class="math inline">\(y\)</span> to obtain <span class="math inline">\(\frac{a_0}{1-a}\)</span> as the particular solution. In the case where <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 \neq 0\)</span>, we can use the trial solution <span class="math inline">\(y^*=kt\)</span>, which is a growing equilibrium. This yields <span class="math inline">\(y_t = k(t-1) + a_0\)</span>, which solves for <span class="math inline">\(k=a_0\)</span>, so that we can conclude <span class="math inline">\(y^*=a_0t\)</span>. This explains why we obtain linear growth. If <span class="math inline">\(a_1=1\)</span> and <span class="math inline">\(a_0 =0\)</span>, we have <span class="math inline">\(y_t=y_{t-1}\)</span>, so that the equilibrium is given by the initial condition <span class="math inline">\(y_0\)</span>.</p>
</section><section id="solution-of-a-linear-system-of-difference-equations" class="level2"><h2 class="anchored" data-anchor-id="solution-of-a-linear-system-of-difference-equations">Solution of a linear system of difference equations</h2>
<p>The solution approach just introduced can be extended to <span class="math inline">\(N\)</span>-dimensional systems of linear difference equations of the form:</p>
<p><span class="math display">\[
y_t=a_0 + Ay_{t-1},  
\]</span></p>
<p>where <span class="math inline">\(y_t\)</span> is a <span class="math inline">\(1 \times N\)</span> column vector and <span class="math inline">\(A\)</span> an <span class="math inline">\(N \times N\)</span> square matrix.</p>
<p>If the inverse <span class="math inline">\((I-A)^{-1}\)</span> exists, which requires <span class="math inline">\(det(I-A) \neq 0\)</span>, the solution will be of the form:</p>
<p><span class="math display">\[
y_t= (I-A)^{-1}a_0 + A^t[y_0- (I-A)^{-1}a_0].
\]</span></p>
<p>The problem with this generic solution is that it is difficult to assess what is going on: the dynamics of any variable in <span class="math inline">\(y_t\)</span> will depend on a lengthy combination of the parameters in <span class="math inline">\(A\)</span> that result from repeated matrix multiplication (<span class="math inline">\(A^t=A\times A\times A\times A...\)</span>). This makes it is impossible to assess whether the system converges to the particular solution. To address this problem, we can use a tool from linear algebra called <em>matrix diagonalisation</em>. Under certain conditions, a matrix <span class="math inline">\(A\)</span> can be decomposed into the product of three matrices in which the matrix in the middle is diagonal. As we will see, this trick has a useful application to our problem.</p>
<p>A matrix <span class="math inline">\(A\)</span> is diagonalisable if there is a diagonal matrix <span class="math inline">\(D\)</span> and an invertible matrix <span class="math inline">\(P\)</span> such that <span class="math inline">\(A=PDP^{-1}\)</span>. A major advantage of this decomposition is the following property: <span class="math inline">\(A^n = (PDP^{-1})^n = PD^nP^{-1}\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Thus, the <span class="math inline">\(nth\)</span> power of the matrix <span class="math inline">\(A\)</span>, which typically yields very cumbersome expressions, simplifies to <span class="math inline">\(PD^nP^{-1}\)</span>, where the <span class="math inline">\(nth\)</span> power of <span class="math inline">\(D\)</span> is simply applied to each individual element on the main diagonal thanks to <span class="math inline">\(D\)</span> being a diagonal matrix. As a result, diagonalisation allows us to write the complementary function in the solution to a system of difference equations as: <span class="math inline">\(PD^tP^{-1}y_0\)</span>. We can further define a vector of arbitrary constants <span class="math inline">\(c=P^{-1}y_0\)</span> so that the complementary function becomes <span class="math inline">\(PD^tc\)</span>. For the first variable in the system, the solution would then take the form:</p>
<p><span class="math display">\[
y_{1t}=v_{11}c_1\lambda_1^t+v_{12}c_2\lambda_2^t + ...+ y_1^*,
\]</span></p>
<p>where <span class="math inline">\(v_j\)</span> are the column vectors of <span class="math inline">\(P\)</span> and <span class="math inline">\(\lambda_i\)</span> are the elements on the main diagonal of <span class="math inline">\(D\)</span>. The <span class="math inline">\(v_j\)</span> are called the <em>eigenvectors</em> of the matrix <span class="math inline">\(A\)</span> and the <span class="math inline">\(\lambda_i\)</span> are its <em>eigenvalues</em> (more about them in a second). From this representation of the solution, the nature of the dynamics can easily be determined by looking at the eigenvalue <span class="math inline">\(\lambda\)</span> that is largest in absolute terms. This is also called the ‘dominant eigenvalue’. Only if the dominant eigenvalue is <span class="math inline">\(|\lambda|&lt;1\)</span> will the system converge to <span class="math inline">\(y^*\)</span>. The elements <span class="math inline">\(v_{ij}\)</span> of the eigenvectors act as multipliers on the eigenvalues and can thus switch off certain eigenvalues (if they happen to be zero) or amplify their dynamics both into the positive and negative domain (depending on their algebraic sign).</p>
<p>How can the diagonal matrix <span class="math inline">\(D\)</span> be found? Notice that <span class="math inline">\(AP=PD\)</span> can also be written as <span class="math inline">\(Av=\lambda v\)</span>. We can then write <span class="math inline">\(v(A-\lambda I)=0\)</span>. We want to find the solutions of this linear system other than <span class="math inline">\(v = 0\)</span> (we don’t want the eigenvectors to be zero vectors, otherwise the solution to the dynamic system presented above wouldn’t work). This requires the determinant of the matrix <span class="math inline">\(A-\lambda I\)</span> to become zero, i.e.&nbsp;<span class="math inline">\(det(A-\lambda I)=0\)</span>. Note that then there will be an infinite number of solutions for the eigenvectors.</p>
<p>Let’s consider an example. Let <span class="math inline">\(a_0=0\)</span> for simplicity, so that the dynamic system is <span class="math inline">\(y_t = Ay_{t-1}\)</span>. Let the matrix <span class="math inline">\(A\)</span> be given by: <span class="math display">\[A=\begin{bmatrix}7 &amp; -15 \\ 2 &amp; -4 \end{bmatrix}.\]</span></p>
<p>Then</p>
<p><span class="math display">\[A-\lambda I =\begin{bmatrix}7 - \lambda &amp; -15 \\ 2 &amp; -4 - \lambda \end{bmatrix}\]</span></p>
<p>and</p>
<p><span class="math display">\[det(A-\lambda I)=(7-\lambda)(-4-\lambda)+30=\lambda^2 - 3\lambda +2=0.\]</span></p>
<p>This second-order polynomial solves for <span class="math inline">\(\lambda_1=2\)</span> and <span class="math inline">\(\lambda_2=1\)</span>, which will be the elements on the diagonal of <span class="math inline">\(D\)</span>.</p>
<p>To find <span class="math inline">\(v_j\)</span>, substitute the <span class="math inline">\(\lambda_i\)</span> into <span class="math inline">\(v_j(A-\lambda_iI)=0\)</span>. For <span class="math inline">\(\lambda_1=2\)</span>, we get <span class="math inline">\(5v_{11}- 15v_{21}=0\)</span> and <span class="math inline">\(2v_{11}- 6v_{21}=0\)</span>, yielding the eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 3 \\ 1\end{bmatrix}\)</span>. However, any scalar multiple of this eigenvector (other than zero) is admissible. It is thus common to normalise the eigenvectors by dividing through one of its elements. Dividing through by the first element yields the normalised eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\)</span>.</p>
<p>For <span class="math inline">\(\lambda_2=1\)</span>, this yields <span class="math inline">\(6v_{12}- 15v_{22}=0\)</span> and <span class="math inline">\(2v_{12}-5v_{22}=0\)</span> from which we can deduce that <span class="math inline">\(v_2=\begin{bmatrix} 5 \\ 2\end{bmatrix}\)</span>. The normalised eigenvector is <span class="math inline">\(v_2=\begin{bmatrix} 1 \\ 0.4 \end{bmatrix}\)</span>.</p>
<p>Of course, you can also perform these calculations in <em>R</em> or <em>Python</em>:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Clear the environment </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Find eigenvalues and eigenvectors of matrix</span></span>
<span><span class="co"># Define matrix</span></span>
<span><span class="va">J</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">15</span>,</span>
<span>           <span class="fl">2</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain eigenvalues and eigenvectors</span></span>
<span><span class="va">ev</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">evals</span> <span class="op">=</span> <span class="va">ev</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 1</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">evecs</span> <span class="op">=</span> <span class="va">ev</span><span class="op">$</span><span class="va">vector</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]
[1,] 0.9486833 0.9284767
[2,] 0.3162278 0.3713907</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Normalise eigenvectors by dividing through by the first element</span></span>
<span><span class="va">evecs_norm</span><span class="op">=</span><span class="va">evecs</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">evecs_norm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">evecs</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">evecs</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">evecs_norm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1] [,2]
[1,] 1.0000000  1.0
[2,] 0.3333333  0.4</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define matrix</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>J <span class="op">=</span> np.array([[<span class="dv">7</span>, <span class="op">-</span><span class="dv">15</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">2</span>, <span class="op">-</span><span class="dv">4</span>]])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain eigenvalues and eigenvectors</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>evals, evecs <span class="op">=</span> np.linalg.eig(J)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print eigenvalues and eigenvectors</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(evals)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(evecs)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an array to store the normalized eigenvectors</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>evecs_norm <span class="op">=</span> np.copy(evecs)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the eigenvectors</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    evecs_norm[:, i] <span class="op">=</span> evecs[:, i] <span class="op">/</span> evecs[<span class="dv">0</span>, i]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print normalized eigenvectors</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(evecs_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We can now use this solution for the eigenvectors and eigenvalues to write the solution of the dynamic system as:</p>
<p><span class="math display">\[
\begin{bmatrix} y_{1t} \\ y_{2t} \end{bmatrix}= \begin{bmatrix} 1 &amp; 1 \\ \frac{1}{3} &amp; 0.4 \end{bmatrix} \begin{bmatrix} 2 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}^t \begin{bmatrix} 1 &amp; 1 \\ \frac{1}{3} &amp; 0.4 \end{bmatrix}^{-1} \begin{bmatrix} y_{10} \\ y_{20} \end{bmatrix} = \begin{bmatrix} 1 &amp; 1 \\ \frac{1}{3} &amp; 0.4 \end{bmatrix} \begin{bmatrix} 2 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}^t \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix}.
\]</span></p>
<p>Multiplying the matrices out yields:</p>
<p><span class="math display">\[
y_{1t} = c_{1}2^t + c_{2}1^t
\]</span></p>
<p><span class="math display">\[
y_{2t} = \frac{1}{3}c_{1}2^t + 0.4c_{2}1^t.
\]</span></p>
<p>Before comparing these analytical results with those from a numerical simulation, let’s summarise the information we gain from the eigenvalues, eigenvectors, and arbitrary constants about the dynamics of the system:</p>
<ul>
<li><p>since the dominant eigenvalue <span class="math inline">\(\lambda_1=2\)</span> is larger than one, we know that the system is unstable</p></li>
<li><p>since both elements in the dominant eigenvector <span class="math inline">\(v_1=\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}\)</span> are non-zero, both variables in the system will be driven by that dominant eigenvalue</p></li>
<li><p>since both elements in the dominant eigenvector are positive but the arbitrary constant <span class="math inline">\(c_1\)</span> is negative for positive initial conditions (see below), both variables will decay</p></li>
<li><p>since both variables will decay at the same rate, their ratio will be constant as <span class="math inline">\(t \rightarrow \infty\)</span> and will approach a value that is given by the ratio of the elements in the dominant eigenvector</p></li>
</ul>
<p>To see the last point, observe that in <span class="math inline">\(\frac{y_{2t}}{y_{1t}}=\frac{\frac{1}{3}c_{1}2^t + 0.4c_{2}1^t}{c_{1}2^t + c_{2}1^t}\)</span> the first terms in the numerator and denominator, respectively, quickly dominate the second terms as <span class="math inline">\(t \rightarrow \infty\)</span> (you can show this formally using <a href="https://en.wikipedia.org/wiki/L%27H%C3%B4pital%27s_rule">L’Hopital’s rule</a>). Thus, <span class="math inline">\(\frac{y_{2t}}{y_{1t}}\)</span> will approach <span class="math inline">\(\frac{1}{3}\)</span> as <span class="math inline">\(t \rightarrow \infty\)</span>.</p>
<p>Let us simulate the system and compare the results for, say, <span class="math inline">\(t=10\)</span> with the analytical solution:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set number of periods for which you want to simulate</span></span>
<span><span class="va">Q</span><span class="op">=</span><span class="fl">100</span></span>
<span></span>
<span><span class="co"># Construct matrices in which values for different periods will be stored; initialise at 1</span></span>
<span><span class="va">y1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="va">y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Solve this system recursively based on the initialisation</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">Q</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y1</span><span class="op">[</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">J</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y1</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">J</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">y2</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">y2</span><span class="op">[</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">J</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">y1</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">J</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">y2</span><span class="op">[</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span> <span class="co"># close time loop</span></span>
<span></span>
<span><span class="co"># Plot dynamics of y1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"y1"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/stab_analysis2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find arbitrary constants: c=(P^-1)*y0</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/matlib">matlib</a></span><span class="op">)</span></span>
<span><span class="va">y0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">y2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># create vector with initial conditions y0</span></span>
<span><span class="va">c</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/matlib/man/Inverse.html">inv</a></span><span class="op">(</span><span class="va">evecs_norm</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">y0</span></span>
<span><span class="va">c</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   -9
[2,]   10</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Compute solution manually for y2 at t=10 and compare with simulated solution</span></span>
<span><span class="va">t</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">c</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="va">t</span> <span class="op">+</span> <span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">c</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">evals</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="va">t</span> <span class="co"># analytical solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3068.667</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y2</span><span class="op">[</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="co"># simulated solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3068</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot dynamics of y2/y1</span></span>
<span><span class="va">y2_y1</span><span class="op">=</span><span class="va">y2</span><span class="op">/</span><span class="va">y1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y2_y1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"y2/y1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/stab_analysis2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare y2/y1 with normalised dominant eigenvector</span></span>
<span><span class="va">y2_y1</span><span class="op">[</span>,<span class="va">Q</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">evecs_norm</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of periods for simulation</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize arrays to store values for different periods</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.ones(Q)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> np.ones(Q)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the system recursively based on the initialization</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Q):</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    y1[t] <span class="op">=</span> J[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">*</span> y1[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> J[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">*</span> y2[t <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    y2[t] <span class="op">=</span> J[<span class="dv">1</span>, <span class="dv">0</span>] <span class="op">*</span> y1[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> J[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span> y2[t <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dynamics of y1</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(Q), y1, color<span class="op">=</span><span class="st">'b'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'y1'</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Dynamics of y1'</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the initial conditions y0</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.array([y1[<span class="dv">0</span>], y2[<span class="dv">0</span>]])</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the arbitrary constants c using the normalized eigenvectors</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.linalg.inv(evecs_norm).dot(y0)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>c</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co">## Compute solution manually for y2 at t=10 and compare with simulated solution</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="dv">10</span> <span class="op">+</span><span class="dv">1</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>evecs_norm[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span> c[<span class="dv">0</span>] <span class="op">*</span> evals[<span class="dv">0</span>] <span class="op">**</span> t <span class="op">+</span> evecs_norm[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span> c[<span class="dv">1</span>] <span class="op">*</span> evals[<span class="dv">1</span>] <span class="op">**</span> t</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>y2[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the ratio y2/y1</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>y2_y1 <span class="op">=</span> y2 <span class="op">/</span> y1</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dynamics of y2/y1 for the first 50 periods</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>plt.plot(y2_y1[:<span class="dv">50</span>], color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'y2/y1'</span>)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare y2/y1 with normalised dominant eigenvector</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>y2_y1[Q<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>evecs_norm[<span class="dv">1</span>,<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>It can be seen that the simulated results are equivalent to the results we obtained analytically. The key takeaway is that by deriving information about the eigenvalues (and possibly eigenvectors) of the Jacobian matrix of the system, we are able to deduce knowledge of the dynamic properties of the system even without numerical simulation. However, the more complex the dynamic system, the more difficult this will be, thereby rendering numerical simulation a key tool to supplement formal analysis.</p>
</section><section id="complex-eigenvalues-and-cycles" class="level2"><h2 class="anchored" data-anchor-id="complex-eigenvalues-and-cycles">Complex eigenvalues and cycles</h2>
<p>So far, we have discussed the case where the eigenvalues <span class="math inline">\(\lambda\)</span> are real numbers. However, what if the polynomial <span class="math inline">\(det(A-\lambda I)=0\)</span> does not yield real numbers? Recall that in the case of a second-order polynomial <span class="math inline">\(\lambda^2+b\lambda+c=0\)</span>, the two roots are given by <span class="math inline">\(\lambda_{1,2} = \frac{-b \pm \sqrt{b^2-4c}}{2}\)</span>. If the term under the root <span class="math inline">\(\Delta=b^2-4c\)</span>, also called discriminant, becomes negative, the solution will be a <em>complex number</em>. More specifically, we can write:</p>
<p><span class="math display">\[
\lambda_{1,2} = \frac{-b \pm \sqrt{b^2-4c}}{2}=\frac{-b \pm \sqrt{4c-b^2}\sqrt{-1}}{2} =\frac{-b \pm \sqrt{4c-b^2}i}{2},
\]</span></p>
<p>where <span class="math inline">\(i=\sqrt{-1}\)</span> is the imaginary number. The expression can also be written as:</p>
<p><span class="math display">\[
\lambda_{1,2} = h \pm mi,
\]</span></p>
<p>which is a pair of conjugate complex numbers containing a real part given by <span class="math inline">\(h\)</span> and an imaginary part given by <span class="math inline">\(m\)</span>.</p>
<p>Consider the model by <span class="citation" data-cites="Samuelson1939">Samuelson (<a href="#ref-Samuelson1939" role="doc-biblioref">1939</a>)</span> discussed in <a href="how_to_simulate.html"><span>Chapter&nbsp;2</span></a>: <span class="math display">\[
C_t= c_1(C_{t-1} + I_{t-1} + G_0)
\]</span></p>
<p><span class="math display">\[
I_t= \beta[c_1(C_{t-1} + I_{t-1} + G_0) - C_{t-1}]
\]</span></p>
<p>The Jacobian matrix of this model is given by:</p>
<p><span class="math display">\[
J=\begin{bmatrix} c_1 &amp; c_1 \\ \beta(c_1-1) &amp; \beta c_1 \end{bmatrix}
\]</span></p>
<p>The characteristic polynomial yielding the eigenvalues of the Jacobian is</p>
<p><span class="math display">\[\lambda^2-\lambda c_1(1+\beta)+\beta c_1=0.\]</span></p>
<p>Thus we have</p>
<p><span class="math display">\[
\lambda_{1,2} = \frac{c_1(1+\beta) \pm \sqrt{[c_1(1+\beta)]^2-4\beta c_1}}{2}.
\]</span></p>
<p>Thus, the two eigenvalues will be a pair of complex conjugates if <span class="math inline">\([c_1(1+\beta)]^2+4\beta c_1 &lt;0\)</span>. Suppose we have <span class="math inline">\(c_1=0.4\)</span> and <span class="math inline">\(\beta=2\)</span>. Then the discriminant will be negative and the eigenvalues will be complex:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Clear the environment </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set parameter values</span></span>
<span><span class="va">c1</span><span class="op">=</span><span class="fl">0.4</span></span>
<span><span class="va">beta</span><span class="op">=</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Check if discriminant is negative</span></span>
<span><span class="op">(</span><span class="va">c1</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">-</span><span class="fl">4</span><span class="op">*</span><span class="va">c1</span><span class="op">*</span><span class="va">beta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.76</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Find eigenvalues and eigenvectors of matrix</span></span>
<span><span class="co"># Define matrix</span></span>
<span><span class="va">J</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c1</span>,</span>
<span>           <span class="va">beta</span><span class="op">*</span><span class="op">(</span><span class="va">c1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="va">beta</span><span class="op">*</span><span class="va">c1</span><span class="op">)</span>, </span>
<span>           <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain eigenvalues and eigenvectors</span></span>
<span><span class="va">ev</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">evals</span> <span class="op">=</span> <span class="va">ev</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6+0.663325i 0.6-0.663325i</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter values</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if discriminant is negative</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>(c1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> beta))<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> c1 <span class="op">*</span> beta</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the matrix</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>J <span class="op">=</span> np.array([[c1, c1],</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>              [beta <span class="op">*</span> (c1 <span class="op">-</span> <span class="dv">1</span>), beta <span class="op">*</span> c1]])</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eigenvalues and eigenvectors</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>evals, evecs <span class="op">=</span> np.linalg.eig(J)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(evals)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(evals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Another way of understanding the logic behind complex numbers is through a so-called <em>Argand diagram</em> that plots the real part of the eigenvalue on the horizontal and the imaginary part on the vertical axis. By Pythagoras’ theorem, the distance of the eigenvalue from the origin will then be given by <span class="math inline">\(R=\sqrt{h^2+m^2}\)</span>. The value of <span class="math inline">\(R\)</span> (which is always real-valued and positive) is called the <em>modulus</em> (or absolute value) of the complex eigenvalue and will contain important information about the dynamic stability of economic models that exhibit complex eigenvalues.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Draw Argand diagram</span></span>
<span></span>
<span><span class="co"># Save real and imaginary part of complex eigenvalue</span></span>
<span><span class="va">re</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">im</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Im</a></span><span class="op">(</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot complex eigenvalue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bty<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">re</span>,<span class="va">im</span>, type<span class="op">=</span><span class="st">"o"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"h"</span>, ylab<span class="op">=</span><span class="st">"m"</span>, main<span class="op">=</span><span class="st">"Argand diagram of complex eigenvalue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot unit circle</span></span>
<span><span class="va">X</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">X</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot a ray from the origin to eigenvalue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">re</span>,<span class="va">im</span>, lty<span class="op">=</span><span class="st">'solid'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.025</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">m</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">re</span>, <span class="va">im</span><span class="op">+</span><span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">==</span><span class="va">h</span><span class="op">+</span><span class="va">mi</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/stab_analysis4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Draw Argand diagram</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Save real and imaginary part of complex eigenvalue</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>re <span class="op">=</span> evals[<span class="dv">0</span>].real</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> evals[<span class="dv">0</span>].imag</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'h'</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'m'</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Argand diagram of complex eigenvalue'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot complex eigenvalue</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax.plot(re, im, <span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">8</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot unit circle</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>Y<span class="op">=</span> np.sqrt(<span class="dv">1</span><span class="op">-</span>X<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>ax.plot(X, Y, <span class="st">'k--'</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a ray from the origin to the eigenvalue</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>, re], [<span class="dv">0</span>, im], <span class="st">'k-'</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.1</span>, <span class="fl">0.025</span>, <span class="vs">r'$\theta$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.001</span>, <span class="fl">0.25</span>, <span class="vs">r'$R=\sqrt{h^2+m^2}$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>ax.text(re, im <span class="op">-</span> <span class="fl">0.1</span>, <span class="vs">r'$\lambda=h+mi$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The angle <span class="math inline">\(\theta\)</span> of the line that connects the origin and the complex eigenvalue and the x-axis of the Argand diagram also contains information about the dynamics. To see this, note that the geometry of the complex number represented in the Argand diagram can also be expressed in trigonometric form: <span class="math display">\[
\sin\theta=\frac{m}{R}
\]</span> <span class="math display">\[
\cos\theta=\frac{h}{R},
\]</span></p>
<p>where <span class="math inline">\(\theta=\arcsin (\frac{m}{R}) =\arccos (\frac{h}{R})=\arctan(\frac{m}{h})\)</span></p>
<p>Thus, we can write the complex eigenvalue also as:</p>
<p><span class="math display">\[
\lambda_{1,2}=R(\cos\theta \pm \sin\theta \times i).
\]</span></p>
<p>By De Moivre’s theorem, we have <span class="math inline">\((\cos\theta \pm \sin\theta \times i)^t=(\cos\theta t \pm \sin\theta t \times i)\)</span>. Thus, the solution to a dynamic system that exhibits complex eigenvalues will be of the form:</p>
<p><span class="math display">\[
y_{1t}=v_{11}c_1 R_1^t(\cos\theta_1 t \pm \sin\theta_1 t \times i) +...+ y^*_1.
\]</span></p>
<p>From this solution we can again deduce key information about the dynamics of the system based on the (complex) eigenvalues:</p>
<ul>
<li>stability will depend on the modulus: for <span class="math inline">\(R&lt;\)</span> the system will be stable, for <span class="math inline">\(R&gt;1\)</span> it will be unstable</li>
<li>from the nature of the trigonometric functions <span class="math inline">\(\sin(\theta t)\)</span> and <span class="math inline">\(\cos(\theta t)\)</span>, we know that system will exhibit periodic cyclical dynamics as <span class="math inline">\(t\)</span> increases</li>
<li>the length of the cycles will be given by <span class="math inline">\(L=\frac{2\pi}{\theta}\)</span> and the frequency by <span class="math inline">\(F=1/L=\frac{\theta}{2\pi}\)</span>
</li>
<li>the amplitude of the cycles will depend on the elements of the eigenvectors, the initial conditions, and <span class="math inline">\(R\)</span>.</li>
</ul>
<p>Let us simulate the Samuelson model with the parameterisation that yields complex eigenvalues to illustrate these results:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate modulus</span></span>
<span><span class="va">mod</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="va">evals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mod</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8944272</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate cycle length</span></span>
<span><span class="va">L</span><span class="op">=</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">acos</a></span><span class="op">(</span><span class="va">re</span><span class="op">/</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">L</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.520433</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set number of periods for which you want to simulate</span></span>
<span><span class="va">Q</span><span class="op">=</span><span class="fl">100</span></span>
<span></span>
<span><span class="co"># Set number of parameterisations that will be considered</span></span>
<span><span class="va">S</span><span class="op">=</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># Construct matrices in which values for different periods will be stored; initialise at 1</span></span>
<span><span class="va">C</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">S</span>, ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span></span>
<span><span class="va">I</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">S</span>, ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Construct matrices for exogenous variable</span></span>
<span><span class="va">G0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="va">S</span>, ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Solve this system recursively based on the initialisation</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">Q</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">C</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">c1</span><span class="op">*</span><span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">I</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">G0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">I</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">beta</span><span class="op">*</span><span class="op">(</span><span class="va">c1</span><span class="op">*</span><span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">I</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">G0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">C</span><span class="op">[</span><span class="fl">1</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="co"># close t1me loop</span></span>
<span></span>
<span><span class="co"># Calculate output</span></span>
<span><span class="va">Y</span><span class="op">=</span><span class="va">C</span><span class="op">+</span><span class="va">G0</span><span class="op">+</span><span class="va">I</span></span>
<span></span>
<span><span class="co"># Time series chart of output dynamics in Samuelson (1939) model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"Y"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Figure 1: Output"</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="intro_stability_analysis_files/figure-html/stab_analysis5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate modulus</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> <span class="bu">abs</span>(evals[<span class="dv">0</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mod)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cycle length</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> math.pi) <span class="op">/</span> math.acos(re <span class="op">/</span> mod)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(L)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of periods and parameterizations</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize matrices for consumption, investment, and exogenous government spending</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.ones((S, Q))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.ones((S, Q))</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>G0 <span class="op">=</span> np.full((S, Q), <span class="dv">5</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the system recursively based on the initialization</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Q):</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    C[<span class="dv">0</span>, t] <span class="op">=</span> c1 <span class="op">*</span> (C[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> I[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> G0[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    I[<span class="dv">0</span>, t] <span class="op">=</span> beta <span class="op">*</span> (c1 <span class="op">*</span> (C[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> I[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> G0[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>]) <span class="op">-</span> C[<span class="dv">0</span>, t <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate output</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> C <span class="op">+</span> G0 <span class="op">+</span> I</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the time series chart of output dynamics</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>plt.plot(Y[<span class="dv">0</span>, :<span class="dv">30</span>], color<span class="op">=</span><span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y"</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Figure 1: Output"</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>You can see that the model generates cycles with a length (from peak/trough to peak/trough) of around 7.5 periods. Since the modulus is <span class="math inline">\(R&lt;1\)</span>, the system is stable and eventually converges to the equilibrium.</p>
</section><section id="nonlinear-systems" class="level2"><h2 class="anchored" data-anchor-id="nonlinear-systems">Nonlinear systems</h2>
<p>So far, we have analysed dynamic systems that are linear. However, in the more general case, a dynamic system may be nonlinear and of the form:</p>
<p><span class="math display">\[
y_t=f(y_{t-1}).
\]</span></p>
<p>An <span class="math inline">\(n\)</span>-dimensional nonlinear system may have multiple equilibria <span class="math inline">\(y^*\)</span>. To analyse the dynamic properties of such a system, we normally conduct a linear approximation in the neighbourhood of one of the equilibria. In that sense, the stability analysis of a nonlinear system has only local as opposed to global validity.</p>
<p>Mathematically, linearisation around an equilibrium point can be done by conducting a first-order Taylor expansion around that equilibrium:</p>
<p><span class="math display">\[
y_t=f^i(y^*) + \sum_{j=1}^{n}\frac{\partial f^i(y^*)}{\partial y_{jt-1}}(y_{jt-1}-y_j^*),
\]</span></p>
<p>where <span class="math inline">\(i=1,2,...,n\)</span>.</p>
<p>This yields a linear version of the system that can be written as:</p>
<p><span class="math display">\[
y_{t}=Ay_{t-1}+B,
\]</span></p>
<p>where <span class="math inline">\(A_{11}=\frac{\partial f^1(y^*)}{y_{1t-1}}\)</span> and so forth. Thus, <span class="math inline">\(A\)</span> is simply the Jacobian matrix of <span class="math inline">\(f(y_{t-1})\)</span> evaluated at <span class="math inline">\(y^*\)</span>.</p>
<p>In practice, this means that to analyse the local stability of a nonlinear system, one needs to:</p>
<ul>
<li>find the equilibrium solution <span class="math inline">\(y^*\)</span> whose neighbourhood you want to analyse</li>
<li>compute the Jacobian matrix of <span class="math inline">\(f(y_{t-1})\)</span>
</li>
<li>substitute <span class="math inline">\(y^*\)</span> into <span class="math inline">\(f(y_{t-1})\)</span> and analyse the resulting matrix.</li>
</ul>
<p>An example for the stability analysis of a simple nonlinear system can be found in <a href="a_malthusian_model.html"><span>Chapter&nbsp;12</span></a>.</p>
</section><section id="key-takeaways" class="level2"><h2 class="anchored" data-anchor-id="key-takeaways">Key takeaways</h2>
<ul>
<li>dynamic models are systems of difference (or differential) equations</li>
<li>the stability of a system depends on (a combination of) its coefficients</li>
<li>more generally, the system’s dynamic properties (including stability) are encapsulated in the Jacobian matrix</li>
<li>the (dominant) eigenvalues of the Jacobian matrix indicate whether a system is
<ul>
<li>stable (<span class="math inline">\(\lambda &lt; 1\)</span>) or unstable (<span class="math inline">\(\lambda &gt; 1\)</span>)</li>
<li>acyclical (<span class="math inline">\(\lambda \in \mathbb{R}\)</span>) or cyclical (<span class="math inline">\(\lambda \in \mathbb{C}\)</span>)</li>
</ul>
</li>
<li>the (dominant) eigenvectors mediate the impact of the eigenvalues in the dynamics</li>
<li>nonlinear systems are analysed locally around one of its equilibria</li>
</ul></section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Anthony2012" class="csl-entry" role="listitem">
Anthony, Martin, and Michele Harvey. 2012. <em><span class="nocase">Linear Algebra: Concepts and Methods</span></em>. Cambridge UK: <span>Cambridge University Press</span>.
</div>
<div id="ref-Chiang2005" class="csl-entry" role="listitem">
Chiang, Alpha C, and Kevin Wainwright. 2005. <em>Fundamental <span>Methods</span> of <span>Mathematical Economics</span></em>. 4th ed. New York: <span>McGraw-Hill Education</span>.
</div>
<div id="ref-Gandolfo2009" class="csl-entry" role="listitem">
Gandolfo, Giancarlo. 2009. <em>Economic Dynamics. Study Edition. 4th Edition.</em> Springer.
</div>
<div id="ref-Samuelson1939" class="csl-entry" role="listitem">
Samuelson, Paul A. 1939. <span>“<span class="nocase">Interactions between the Multiplier Analysis and the Principle of Acceleration</span>.”</span> <em>The Review of Economics and Statistics</em> 21 (2): 75–78. <a href="https://doi.org/10.2307/1927758">https://doi.org/10.2307/1927758</a>.
</div>
<div id="ref-Sayama2015" class="csl-entry" role="listitem">
Sayama, Hiroki. 2015. <em>Introduction to the Modeling and Analysis of Complex Systems</em>. Open SUNY Textbooks, Milne Library.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>We will focus here on difference instead of differential equations, i.e.&nbsp;on dynamics in discrete as opposed to continuous time. Most of the continuous-time counterpart is analogous to the material covered here. <span class="citation" data-cites="Sayama2015">Sayama (<a href="#ref-Sayama2015" role="doc-biblioref">2015</a>)</span> provides a very accessible and applied introduction to dynamic systems with Python code. An introductory treatment of the underlying mathematics is <span class="citation" data-cites="Chiang2005">Chiang and Wainwright (<a href="#ref-Chiang2005" role="doc-biblioref">2005</a>)</span>, chaps. 15-19. <span class="citation" data-cites="Gandolfo2009">Gandolfo (<a href="#ref-Gandolfo2009" role="doc-biblioref">2009</a>)</span> provides a more advanced treatment of the mathematics as well as many economic examples. A great introduction to linear algebra is <span class="citation" data-cites="Anthony2012">Anthony and Harvey (<a href="#ref-Anthony2012" role="doc-biblioref">2012</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is because in the product <span class="math inline">\((PDP^{-1})(PDP^{-1})(PDP^{-1})...\)</span>, each <span class="math inline">\(P\)</span> cancels a <span class="math inline">\(P^{-1}\)</span>, except for the first <span class="math inline">\(P\)</span> and last <span class="math inline">\(P^{-1}\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./a_post_kaleckian_distribution_and_growth_model.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">A Post-Kaleckian Distribution and Growth Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./a_new_keynesian_3_equation_model.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">A New Keynesian 3-Equation Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">An open-source platform for macroeconomic model simulation.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right"><a>License: …</a><a></a> <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website">Source code</a></div>
  </div>
</footer>


</body></html>