<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DIY Macroeconomic Model Simulation - 18&nbsp; A Kaldorian Endogenous Business Cycle Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./an_evolutionary_game_theoretic_model.html" rel="next">
<link href="./a_Hicks_model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_stability_analysis.html">Dynamic Models</a></li><li class="breadcrumb-item"><a href="./a_Kaldor_model.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">A Kaldorian Endogenous Business Cycle Model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DIY Macroeconomic Model Simulation</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_use.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_simulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to Simulate Economic Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Static Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_macro_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Neoclassical Macro Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_IS_LM_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An IS-LM Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_synthesis_model_IS_LM_AS_AD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Neoclassical Synthesis Model (IS-LM-AS-AD)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_keynesian_macro_model_with_endogenous_money.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Post-Keynesian Macro Model with Endogenous Money</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Kaldor-Robinson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Kaldor-Robinson Distribution and Growth Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_kaleckian_distribution_and_growth_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">A Post-Kaleckian Distribution and Growth Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Dynamic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_stability_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to the Analysis of Dynamic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_new_keynesian_3_equation_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">A New Keynesian 3-Equation Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_conflict_inflation_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">A Conflict Inflation Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_sraffian_supermultiplier_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">A Sraffian Supermultiplier Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_malthusian_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Malthusian Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_one_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Ricardian One-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_two_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Ricardian Two-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Lewis_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">A Lewis Model of Economic Development</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Hicks_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">A Hicksian Business Cycle Model with Floors and Ceilings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Kaldor_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">A Kaldorian Endogenous Business Cycle Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_evolutionary_game_theoretic_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">An Evolutionary Game Theoretic Model of the Emergence of Property Rights</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_sfc_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">A Stock-Flow Consistent Model of the Monetary Circuit</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./additional_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Additional Online Resources</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The Model</a></li>
  <li>
<a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul>
<li><a href="#parameterisation" id="toc-parameterisation" class="nav-link" data-scroll-target="#parameterisation">Parameterisation</a></li>
  <li><a href="#simulation-code" id="toc-simulation-code" class="nav-link" data-scroll-target="#simulation-code">Simulation code</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots">Plots</a></li>
  <li><a href="#creating-a-bifurcation-diagram" id="toc-creating-a-bifurcation-diagram" class="nav-link" data-scroll-target="#creating-a-bifurcation-diagram">Creating a bifurcation diagram</a></li>
  </ul>
</li>
  <li><a href="#directed-graph" id="toc-directed-graph" class="nav-link" data-scroll-target="#directed-graph">Directed graph</a></li>
  <li><a href="#analytical-discussion" id="toc-analytical-discussion" class="nav-link" data-scroll-target="#analytical-discussion">Analytical discussion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_stability_analysis.html">Dynamic Models</a></li><li class="breadcrumb-item"><a href="./a_Kaldor_model.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">A Kaldorian Endogenous Business Cycle Model</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-kaldor" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">A Kaldorian Endogenous Business Cycle Model</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This model captures some key features of Nicholas <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span>’s nonlinear model of endogenous business cycle fluctuations. Unlike <span class="citation" data-cites="Samuelson1939">Samuelson (<a href="#ref-Samuelson1939" role="doc-biblioref">1939</a>)</span>’s linear multiplier-accelerator model (see <a href="how_to_simulate.html" class="quarto-xref"><span>Chapter 2</span></a> and <a href="intro_stability_analysis.html" class="quarto-xref"><span>Chapter 9</span></a>), which usually requires repeated external shocks to produce sustained cycles, <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> outlined a model that would produces endogenous, i.e.&nbsp;shock-independent, fluctuations.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> assumed that investment and saving were very sensitive to income for normal levels of income, but relatively insensitive for extreme values of income. Graphically, these assumptions give rise to sigmoid-shaped investment and saving functions. As a result, the goods market equilibrium becomes locally unstable due to strong positive feedback effects, but then becomes stable once the economy has sufficiently moved away from equilibrium during booms or busts. Similar to <span class="citation" data-cites="Hicks1950">Hicks (<a href="#ref-Hicks1950" role="doc-biblioref">1950</a>)</span> (see <a href="a_Hicks_model.html" class="quarto-xref"><span>Chapter 17</span></a>), <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> also assumed a locally unstable goods market, but unlike Hicks who postulated discrete bounds that would prevent fluctuations from exploding, <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> considered smooth bounds that stemmed from the investment and saving behaviour of firms and households. For instance, at high levels of output, investment may become insensitive to output due to rising costs of construction or surging financing cost. Similarly, for low levels of output profit opportunities may be missing, thereby rending investment insensitive to changes in output. It is then the interaction between output and the capital stock that turns these bounded output dynamics into a cycle: <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> assumed that the capital stock exerts a negative effect on investment as an increasing capital stock lowers the marginal efficiency of capital, whereas output pushes up the dynamics of the capital stock due to the accelerator effect.</p>
<p><span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span>’s initial paper mostly relied on graphical analysis. A continuous-time version formalisation of his graphical was subsequently presented in <span class="citation" data-cites="Chang1971">Chang and Smyth (<a href="#ref-Chang1971" role="doc-biblioref">1971</a>)</span>. Textbook treatments can be found in <span class="citation" data-cites="Gabisch1989">Gabisch and Lorenz (<a href="#ref-Gabisch1989" role="doc-biblioref">1989</a>)</span>, chapter 4. We present a discrete time version of the Kaldor model due to <span class="citation" data-cites="Bischi2001">Bischi et al. (<a href="#ref-Bischi2001" role="doc-biblioref">2001</a>)</span>.</p>
</section><section id="the-model" class="level2"><h2 class="anchored" data-anchor-id="the-model">The Model</h2>
<p><span id="eq-kaldor_Y"><span class="math display">\[
  Y_{t}=Y_{t-1} + \alpha(I_{t} - S_{t}),  \quad \alpha &gt; 0
\tag{18.1}\]</span></span></p>
<p><span id="eq-kaldor_K"><span class="math display">\[
K_{t} = (1-\delta)K_{t-1} + I_{t-1},  \quad \delta \in (0,1)
\tag{18.2}\]</span></span></p>
<p><span id="eq-kaldor_S"><span class="math display">\[
S_{t} = \sigma Y_t,  \quad \sigma \in (0,1)
\tag{18.3}\]</span></span></p>
<p><span id="eq-kaldor_I"><span class="math display">\[
I_{t} = \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right) + \arctan(Y_{t}- Y^E),  \quad \gamma, Y^E &gt; 0
\tag{18.4}\]</span></span></p>
<p>where <span class="math inline">\(Y_t\)</span>, <span class="math inline">\(K_t\)</span>, <span class="math inline">\(S_t\)</span>, and <span class="math inline">\(I_t\)</span> represent aggregate output, the capital stock, saving, and investment, respectively.</p>
<p><a href="#eq-kaldor_Y" class="quarto-xref">Equation&nbsp;<span>18.1</span></a> specifies that output reacts slugglishly to excess demand <span class="math inline">\((I_t &gt; S_t)\)</span> and excess supply <span class="math inline">\((I_t &lt; S_t)\)</span>, with the speed of adjustment given by <span class="math inline">\(\alpha\)</span>. A high value of <span class="math inline">\(\alpha\)</span> means that firms respond strongly to disequilibria in the goods market. <a href="#eq-kaldor_K" class="quarto-xref">Equation&nbsp;<span>18.2</span></a> is the law of motion of the capital stock, with <span class="math inline">\(\delta\)</span> representing the rate of depreciation. <a href="#eq-kaldor_S" class="quarto-xref">Equation&nbsp;<span>18.3</span></a> is th saving function. While <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> assumed a non-linear (sigmoid-shaped) Keynesian saving function, <span class="citation" data-cites="Bischi2001">Bischi et al. (<a href="#ref-Bischi2001" role="doc-biblioref">2001</a>)</span> (for simplicity) use a linear saving function with a constant marginal propensity to save out of income <span class="math inline">\((\sigma)\)</span>. The key nonlinearity in this version of the Kaldor model lies in the investment function <a href="#eq-kaldor_I" class="quarto-xref">Equation&nbsp;<span>18.4</span></a>. The first term in the investment function, <span class="math inline">\(\sigma Y^E\)</span>, is a normal level of saving that prevails for a normal or expected level of output, <span class="math inline">\(Y^E\)</span>. The second term, <span class="math inline">\(\gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right)\)</span>, incorporates a negative feedback effect of the level of the capital stock on investment, where <span class="math inline">\(\frac{\sigma Y^E}{\delta}\)</span> is the normal level of the capital stock. The third term, <span class="math inline">\(\arctan(Y_{t}- Y^E)\)</span>, introduces the sigmoid relationship between investment and output, modelled by means of the arctangent function. Investment is increasing in aggregate output; and this effect is stronger for smaller deviations of actual investment from normal output. <a href="#fig-inv" class="quarto-xref">Figure&nbsp;<span>18.1</span></a> plots an example of this sigmoid-shaped investment function for a normal level of output of <span class="math inline">\(Y^E=10\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Plot investment function </span></span>
<span><span class="co"># Set  parameter values</span></span>
<span><span class="va">alpha</span><span class="op">=</span><span class="fl">1.2</span> <span class="co"># adjustment speed of output</span></span>
<span><span class="va">delta</span><span class="op">=</span><span class="fl">0.2</span> <span class="co"># depreciation rate</span></span>
<span><span class="va">sigma</span><span class="op">=</span><span class="fl">0.4</span> <span class="co"># propensity to save</span></span>
<span><span class="va">Y_E</span><span class="op">=</span><span class="fl">10</span>    <span class="co"># normal level of output</span></span>
<span><span class="va">gamma</span><span class="op">=</span><span class="fl">0.6</span> <span class="co"># sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span><span class="va">K</span><span class="op">=</span><span class="va">sigma</span><span class="op">*</span><span class="va">Y_E</span><span class="op">/</span><span class="va">delta</span> <span class="co"># set capital stock to normal level</span></span>
<span></span>
<span><span class="co"># Create investment function using Y as argument</span></span>
<span><span class="va">inv</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sigma</span><span class="op">*</span><span class="va">Y_E</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">*</span><span class="op">(</span><span class="va">sigma</span><span class="op">*</span><span class="va">Y_E</span><span class="op">/</span><span class="va">delta</span> <span class="op">-</span> <span class="va">K</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot the function in (I,Y) space</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">inv</span>, from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Y"</span>, ylab<span class="op">=</span><span class="st">"I"</span> , main<span class="op">=</span><span class="st">""</span>,</span>
<span>      lwd<span class="op">=</span><span class="fl">1.5</span>, n<span class="op">=</span><span class="fl">10000</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Y_E</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">^</span><span class="va">E</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-inv" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-inv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-inv-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.1: Kaldor’s sigmoid investment function
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Plot investment function </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter values</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">1.2</span>  <span class="co"># adjustment speed of output</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># depreciation rate</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.4</span>  <span class="co"># propensity to save</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Y_E <span class="op">=</span> <span class="dv">10</span>     <span class="co"># normal level of output</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> sigma <span class="op">*</span> Y_E <span class="op">/</span> delta  <span class="co"># set capital stock to normal level</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the investment function using Y as argument</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> inv(Y):</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sigma <span class="op">*</span> Y_E <span class="op">+</span> gamma <span class="op">*</span> (sigma <span class="op">*</span> Y_E <span class="op">/</span> delta <span class="op">-</span> K) <span class="op">+</span> np.arctan(Y <span class="op">-</span> Y_E)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the function in (I,Y) space</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>Y_values <span class="op">=</span> np.linspace(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">10000</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>I_values <span class="op">=</span> inv(Y_values)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>plt.plot(Y_values, I_values, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'I'</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>Y_E, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'$Y^E$'</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Y"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"I"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Investment Function"</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">2</span>, <span class="dv">6</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="simulation" class="level2"><h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<section id="parameterisation" class="level3"><h3 class="anchored" data-anchor-id="parameterisation">Parameterisation</h3>
<p>Table 1 reports the parameterisation used in the simulation. We will analyse below how the model’s dynamic properties change as <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> vary.</p>
<p><strong>Table 1: Parameterisation</strong></p>
<table class="table">
<thead><tr class="header">
<th><span class="math inline">\(\alpha\)</span></th>
<th><span class="math inline">\(\delta\)</span></th>
<th><span class="math inline">\(\sigma\)</span></th>
<th><span class="math inline">\(Y^E\)</span></th>
<th><span class="math inline">\(\gamma\)</span></th>
</tr></thead>
<tbody><tr class="odd">
<td>1.2</td>
<td>0.2</td>
<td>0.4</td>
<td>10</td>
<td>0.6</td>
</tr></tbody>
</table></section><section id="simulation-code" class="level3"><h3 class="anchored" data-anchor-id="simulation-code">Simulation code</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Clear the environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set number of periods</span></span>
<span><span class="va">Q</span><span class="op">=</span><span class="fl">200</span></span>
<span></span>
<span><span class="co"># Set number of scenarios </span></span>
<span><span class="va">Scen</span><span class="op">=</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># Create (Scen x Q)-matrices that will contain the simulated data</span></span>
<span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">Scen</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># Income/output</span></span>
<span><span class="va">K</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">Scen</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># capital stock</span></span>
<span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">Scen</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># saving</span></span>
<span><span class="va">I</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">Scen</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># Investment</span></span>
<span></span>
<span><span class="co"># Set fixed parameter values</span></span>
<span><span class="va">alpha</span><span class="op">=</span><span class="fl">1.2</span> <span class="co"># adjustment speed of output</span></span>
<span><span class="va">delta</span><span class="op">=</span><span class="fl">0.2</span> <span class="co"># depreciation rate</span></span>
<span><span class="va">sigma</span><span class="op">=</span><span class="fl">0.4</span> <span class="co"># propensity to save</span></span>
<span><span class="va">Y_E</span><span class="op">=</span><span class="fl">10</span>    <span class="co"># normal level of output</span></span>
<span><span class="va">gamma</span><span class="op">=</span><span class="fl">0.6</span> <span class="co"># sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span></span>
<span><span class="co"># Simulate the model by looping over Q time periods for Scen different scenarios</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Scen</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">Q</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">iterations</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">{</span> <span class="co"># run the model 500-times in each period</span></span>
<span>      </span>
<span>    <span class="co">#Model equations</span></span>
<span>    </span>
<span>    <span class="co">#(1) Output</span></span>
<span>    <span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">S</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#(2) Capital stock</span></span>
<span>    <span class="va">K</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span><span class="op">*</span><span class="va">K</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">I</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co">#(3) Saving</span></span>
<span>    <span class="va">S</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">sigma</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> </span>
<span>    </span>
<span>    <span class="co">#(4) Investment</span></span>
<span>    <span class="va">I</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">sigma</span><span class="op">*</span><span class="va">Y_E</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">*</span><span class="op">(</span><span class="va">sigma</span><span class="op">*</span><span class="va">Y_E</span><span class="op">/</span><span class="va">delta</span> <span class="op">-</span> <span class="va">K</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="op">}</span> <span class="co"># close iterations loop</span></span>
<span>  <span class="op">}</span>   <span class="co"># close time loop</span></span>
<span><span class="op">}</span>     <span class="co"># close scenario loop</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of periods</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of scenarios</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Scen <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create (Scen x Q)-matrices to contain the simulated data</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.ones((Scen, Q))  <span class="co"># Income/output</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> np.ones((Scen, Q))  <span class="co"># Capital stock</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> np.ones((Scen, Q))  <span class="co"># Saving</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.ones((Scen, Q))  <span class="co"># Investment</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set fixed parameter values</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">1.2</span>  <span class="co"># Adjustment speed of output</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># Depreciation rate</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.4</span>  <span class="co"># Propensity to save</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>Y_E <span class="op">=</span> <span class="dv">10</span>     <span class="co"># Normal level of output</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># Sensitivity of investment to deviations of actual from normal capital stock</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the model by looping over Q time periods for Scen different scenarios</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(Scen):</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Q):</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> iterations <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):  <span class="co"># Run the model 500 times in each period</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Model equations</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (1) Output</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>            Y[i, t] <span class="op">=</span> Y[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> alpha <span class="op">*</span> (I[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> S[i, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (2) Capital stock</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            K[i, t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> delta) <span class="op">*</span> K[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> I[i, t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (3) Saving</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>            S[i, t] <span class="op">=</span> sigma <span class="op">*</span> Y[i, t]</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (4) Investment</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>            I[i, t] <span class="op">=</span> sigma <span class="op">*</span> Y_E <span class="op">+</span> gamma <span class="op">*</span> (sigma <span class="op">*</span> Y_E <span class="op">/</span> delta <span class="op">-</span> K[i, t]) <span class="op">+</span> np.arctan(Y[i, t] <span class="op">-</span> Y_E)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="plots" class="level3"><h3 class="anchored" data-anchor-id="plots">Plots</h3>
<p><a href="#fig-output" class="quarto-xref">Figure&nbsp;<span>18.2</span></a> displays the dynamics of aggregate output. The model generates endogenous cycles in output that are permanent, i.e.&nbsp;they don’t require any external shocks, and they are (roughly) periodic with a cycle length from peak (trough) to peak (trough) of around 17 periods. What generates the turning points? Suppose income is close to its normal level of <span class="math inline">\(Y^E = 10\)</span>, but on an increasing trajectory. The accelerator effect on investment will amplify this process as firms will increase their investment, which raises aggregate demand and increases income further. As aggregate output increases, this positive feedback effect gradually becomes weaker, possibly because firms face tighter supply constraints. The rise in the capital stock exerts a negative feedback effect on investment and will eventually dominate the accelerator effect. Firms then start reducing investment and the boom turns into a bust. The accelerator effect again amplifies this downward trajectory until the capital stock has sufficiently fallen to make investment attractive again. This allows the cycle to repeat itself.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set start and end periods for plots</span></span>
<span><span class="va">Tmax</span><span class="op">=</span><span class="fl">100</span></span>
<span><span class="va">Tmin</span> <span class="op">=</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Plot aggregate output and capital stock</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"Y"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Aggregate output and capital stock"</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span>, font.main<span class="op">=</span><span class="fl">1</span>, cex.main<span class="op">=</span><span class="fl">1</span>,ylab <span class="op">=</span> <span class="st">''</span>, axes<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">''</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">4</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"K"</span>, side <span class="op">=</span> <span class="fl">4</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"K"</span><span class="op">)</span>,</span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-output" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-output-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-output-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-output-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.2: Output and capital stock
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set start and end periods for plots</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Tmax <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Tmin <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot aggregate output and capital stock</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Y (aggregate output)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>ax1.plot(<span class="bu">range</span>(Tmin, Tmax), Y[<span class="dv">0</span>, Tmin:Tmax], color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Y'</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">"Time"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">"Y"</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">"Aggregate Output and Capital Stock"</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a twin axis for the capital stock</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot K (capital stock)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax2.plot(<span class="bu">range</span>(Tmin, Tmax), K[<span class="dv">0</span>, Tmin:Tmax], color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'K'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">"K"</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span><span class="st">'black'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><a href="#fig-saving" class="quarto-xref">Figure&nbsp;<span>18.3</span></a> displays the endogenous fluctuations in saving and investment. The horizontal lines represent the average level of saving and investment computed from the simulated data.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> It can be seen that these are virtually identical, reflecting the fact that that the model generates cycles around the goods market equilibrium but never reaches it.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calculate average saving and investment ignoring the first 10 periods</span></span>
<span><span class="va">S_avr</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span>,<span class="fl">10</span><span class="op">:</span><span class="va">Q</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">I_avr</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span>,<span class="fl">10</span><span class="op">:</span><span class="va">Q</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot saving and investment along with their long-run average values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="op">(</span><span class="va">Tmax</span><span class="op">)</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">"S, I"</span>, </span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span>,<span class="va">S</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="op">(</span><span class="va">Tmax</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Saving and investment"</span>, xlab <span class="op">=</span> <span class="st">'Time'</span>,cex<span class="op">=</span><span class="fl">0.8</span>,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="fl">1</span>, <span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">S_avr</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">I_avr</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-saving" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-saving-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-saving-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-saving-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.3: Saving and investment
</figcaption></figure>
</div>
</div>
</div>
</section><section id="creating-a-bifurcation-diagram" class="level3"><h3 class="anchored" data-anchor-id="creating-a-bifurcation-diagram">Creating a bifurcation diagram</h3>
<p>Next, we explore numerically under which conditions the model generates endogenous cycles. To do so, we need to introduce some terminology. First, a <em>limit cycle</em> is defined as a closed orbit of the state variables of a dynamic system around a locally unstable equilibrium (see <span class="citation" data-cites="Gandolfo2009">Gandolfo (<a href="#ref-Gandolfo2009" role="doc-biblioref">2009</a>)</span>, chap.&nbsp;23). In the neighbourhood of the equilibrium, the system is unstable and gets pushed away from it. However, rather than exhibiting explosive behaviour, the system eventually reaches a periodic cycle as it is bounded by nonlinearities. The fluctuations in <a href="#fig-output" class="quarto-xref">Figure&nbsp;<span>18.2</span></a> indeed constitute a limit cycle. Second, a <em>bifurcation</em> is defined as a qualitative change of the behaviour of a dynamic system that occurs as a parameter of the system crosses a critical value (see <span class="citation" data-cites="Gandolfo2009">Gandolfo (<a href="#ref-Gandolfo2009" role="doc-biblioref">2009</a>)</span>, chap.&nbsp;24). Third, a <em>Hopf bifurcation</em> is a bifurcation that gives rise to a limit cycle.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>We can analyse the emergence of Hopf bifurcations in this model by means of so-called bifurcation diagrams that plot the dynamics of a representative endogenous variable variable from the model against different values of a parameter of interest. This is accomplished by fixing a parameterisation, simulating the model for a specific value of the parameter of interest, saving the last <span class="math inline">\(T_0\)</span> values of the chosen endogenous variable, and repeating the process for a marginally different value of the parameter of interest. The <span class="math inline">\(T_0\)</span> data points from each run are then placed on the bifurcation diagram.</p>
<p>The following code first creates a function called <em>kaldor</em> that simulates the Kaldor model,<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> taking values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> as arguments, and returns the last <span class="math inline">\(T_0=50\)</span> values of output.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Clear the environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a function called "kaldor" that simulates a reduced-form version of the model</span></span>
<span><span class="co"># and returns the last 50 values of Y; use alpha and sigma as arguments that </span></span>
<span><span class="co"># need to be supplied when the function is called</span></span>
<span><span class="va">kaldor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">sigma</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Set how many last values of output you want to save</span></span>
<span>  <span class="va">T_0</span> <span class="op">=</span> <span class="fl">50</span></span>
<span>  </span>
<span>  <span class="co"># Set number of periods</span></span>
<span>  <span class="va">Q</span> <span class="op">=</span> <span class="fl">200</span></span>
<span>  </span>
<span>  <span class="co"># Create matrices for simulated data</span></span>
<span>  <span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>  <span class="co"># Income/output</span></span>
<span>  <span class="va">K</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>  <span class="co"># Capital stock</span></span>
<span>  </span>
<span>  <span class="co"># Set fixed parameter values</span></span>
<span>  <span class="va">gamma</span> <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># Sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span>  <span class="va">delta</span> <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># Depreciation rate</span></span>
<span>  <span class="va">Y_E</span> <span class="op">=</span> <span class="fl">10</span>     <span class="co"># Normal level of output</span></span>
<span></span>
<span>  <span class="co"># Simulate the model by looping over time periods</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">Q</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>        <span class="co">## Model equations</span></span>
<span>        <span class="co"># Output</span></span>
<span>        <span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> </span>
<span>          <span class="va">alpha</span> <span class="op">*</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">*</span> <span class="va">Y_E</span> <span class="op">+</span> <span class="va">gamma</span> <span class="op">*</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">*</span> <span class="va">Y_E</span> <span class="op">/</span> <span class="va">delta</span> <span class="op">-</span> <span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span> <span class="op">-</span> <span class="va">sigma</span> <span class="op">*</span> <span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="co">#  Capital stock</span></span>
<span>        <span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span> <span class="op">*</span> <span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> </span>
<span>          <span class="va">sigma</span> <span class="op">*</span> <span class="va">Y_E</span> <span class="op">+</span> <span class="va">gamma</span> <span class="op">*</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">*</span> <span class="va">Y_E</span> <span class="op">/</span> <span class="va">delta</span> <span class="op">-</span> <span class="va">K</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span> <span class="co"># Close time loop</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">T_0</span><span class="op">)</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Return last 50 periods of output</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we prepare an initially empty bifurcation diagram and then loop over the <em>kaldor</em> function, increasing the parameter <span class="math inline">\(\alpha\)</span> from 0.5 to 2 in successive steps of 0.01 (while keeping <span class="math inline">\(\sigma\)</span> fixed at 0.4), and place the resulting data points on the bifurcation diagram. From <a href="#fig-bif-alpha" class="quarto-xref">Figure&nbsp;<span>18.4</span></a>, it can be seen that there indeed appears to be a critical value <span class="math inline">\(\alpha_0 \approx 1.15\)</span> below which the model does not generate a limit cycle because the equilibrium is stable. By contrast, for values of <span class="math inline">\(\alpha\)</span> above that critical value, the model generates a limit cycle whose amplitude appears to be increasing in <span class="math inline">\(\alpha\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Prepare the bifurcation diagram in alpha</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.0</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.5</span>, <span class="fl">12.5</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     pch <span class="op">=</span> <span class="st">"."</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, col <span class="op">=</span> <span class="st">"blue"</span>, main <span class="op">=</span> </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Bifurcation diagram in "</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run kaldor function for different values of alpha (keeping sigma at 0.4) </span></span>
<span><span class="co"># and place data points on bifurcation diagram </span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.5</span>  <span class="co"># initialise alpha</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span> <span class="co"># run kaldor model until alpha assumes value of 2</span></span>
<span>  <span class="va">output</span> <span class="op">=</span> <span class="fu">kaldor</span><span class="op">(</span>alpha<span class="op">=</span><span class="va">alpha</span>, sigma<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="co"># obtain values of Y for given value of alpha</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span>, <span class="va">output</span>, pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># add data points to diagram</span></span>
<span>  <span class="va">alpha</span> <span class="op">=</span> <span class="va">alpha</span> <span class="op">+</span> <span class="fl">0.01</span>  <span class="co"># increase alpha stepwise</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bif-alpha" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bif-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-bif-alpha-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bif-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.4: Bifurcation diagram for different sensitivities of output to saving-investment gap
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Generate kaldor function</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function called "kaldor" that simulates a reduced-form version of the model</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and returns the last 50 values of Y</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> kaldor(alpha, sigma):</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set how many last values of output you want to save</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    T_0 <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set number of periods</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create matrices for simulated data</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> np.ones((<span class="dv">1</span>, Q))  <span class="co"># Income/output</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> np.ones((<span class="dv">1</span>, Q))  <span class="co"># Capital stock</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set fixed parameter values</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># Sensitivity of investment to deviations of actual from normal capital stock</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># Depreciation rate</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    Y_E <span class="op">=</span> <span class="dv">10</span>     <span class="co"># Normal level of output</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate the model by looping over time periods</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Q):</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Model equations</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (1) Output</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        Y[<span class="dv">0</span>, t] <span class="op">=</span> Y[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> alpha <span class="op">*</span> (</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>            sigma <span class="op">*</span> Y_E <span class="op">+</span> gamma <span class="op">*</span> (sigma <span class="op">*</span> Y_E <span class="op">/</span> delta <span class="op">-</span> K[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>            np.arctan(Y[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> Y_E) <span class="op">-</span> sigma <span class="op">*</span> Y[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (2) Capital stock</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        K[<span class="dv">0</span>, t] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> delta) <span class="op">*</span> K[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>            sigma <span class="op">*</span> Y_E <span class="op">+</span> gamma <span class="op">*</span> (sigma <span class="op">*</span> Y_E <span class="op">/</span> delta <span class="op">-</span> K[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>            np.arctan(Y[<span class="dv">0</span>, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> Y_E))</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return last 50 periods of output</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Y[<span class="dv">0</span>, (Q<span class="op">-</span>T_0):Q]</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#### Generate bifurcation diagram</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the bifurcation diagram in alpha</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r'Bifurcation Diagram in $\alpha$'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$\alpha$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$Y_t$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="fl">0.5</span>, <span class="fl">2.0</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="fl">7.5</span>, <span class="fl">12.5</span>)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Run kaldor function for different values of alpha (keeping sigma at 0.4)</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co"># and place data points on bifurcation diagram</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.5</span>  <span class="co"># Initialize alpha</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> alpha <span class="op">&lt;=</span> <span class="fl">2.0</span>:</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obtain values of Y for the given value of alpha</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> kaldor(alpha<span class="op">=</span>alpha, sigma<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add data points to the diagram</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    plt.scatter([alpha] <span class="op">*</span> <span class="bu">len</span>(output), output, color<span class="op">=</span><span class="st">'blue'</span>, s<span class="op">=</span><span class="dv">4</span>, marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Increase alpha stepwise</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">+=</span> <span class="fl">0.01</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the bifurcation diagram</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><a href="#fig-bif-sigma" class="quarto-xref">Figure&nbsp;<span>18.5</span></a> does the same for the parameter <span class="math inline">\(\sigma\)</span>, starting from <span class="math inline">\(\sigma=0.1\)</span> and raising it to 0.5 in steps of 0.001 (while keeping a fixed <span class="math inline">\(\alpha\)</span> of 1.2). The parameter <span class="math inline">\(\sigma\)</span> appears to exhibit a critical value <span class="math inline">\(\sigma_0 \approx 0.25\)</span> above which a limit cycle occurs.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Prepare the bifurcation diagram in sigma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">11.5</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     pch <span class="op">=</span> <span class="st">"."</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Bifurcation diagram in "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run kaldor function for different values of sigma (keeping alpha at 1.2)</span></span>
<span><span class="co"># and place data points on bifurcation diagram </span></span>
<span><span class="va">sigma</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># initialise alpha</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">&lt;=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span> <span class="co"># run kaldor model until sigma assumes value of 0.5</span></span>
<span>  <span class="va">output</span> <span class="op">=</span> <span class="fu">kaldor</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">1.2</span>, sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span> <span class="co"># obtain the values of Y for given value of sigma</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span>, <span class="va">output</span>, pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># add data points to diagram</span></span>
<span>  <span class="va">sigma</span> <span class="op">=</span> <span class="va">sigma</span> <span class="op">+</span> <span class="fl">0.001</span>  <span class="co"># increase sigma stepwise</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bif-sigma" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bif-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-bif-sigma-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bif-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.5: Bifurcation diagram for different saving propensities
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="directed-graph" class="level2"><h2 class="anchored" data-anchor-id="directed-graph">Directed graph</h2>
<p>Another perspective on the model’s properties is provided by its directed graph. A directed graph consists of a set of nodes that represent the variables of the model. Nodes are connected by directed edges. An edge directed from a node <span class="math inline">\(x_1\)</span> to node <span class="math inline">\(x_2\)</span> indicates a causal impact of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(x_2\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Create directed graph</span></span>
<span><span class="co"># Construct auxiliary Jacobian matrix for 5 variables: </span></span>
<span>  <span class="co"># endogenous: (1) Y, (2) K, (3) S, (4) I</span></span>
<span>  <span class="co"># exogenous: (5) YE</span></span>
<span></span>
<span>              <span class="co">#Y K S I YE</span></span>
<span><span class="va">M_mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="co"># Y</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="co"># K</span></span>
<span>               <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># S</span></span>
<span>               <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="co"># I</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,<span class="co"># YE</span></span>
<span>               <span class="fl">5</span>, <span class="fl">5</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create adjacency matrix from transpose of auxiliary Jacobian</span></span>
<span><span class="va">A_mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">M_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create directed graph from adjacency matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/">igraph</a></span><span class="op">)</span></span>
<span><span class="va">dg</span><span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">A_mat</span>, mode<span class="op">=</span><span class="st">"directed"</span>, weighted<span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define node labels</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">dg</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"K"</span>, <span class="st">"S"</span>, <span class="st">"I"</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">^</span><span class="va">E</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot directed graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dg</span>, main<span class="op">=</span><span class="st">"Directed graph of Kaldor model"</span>, vertex.size<span class="op">=</span><span class="fl">40</span>, vertex.color<span class="op">=</span><span class="st">"lightblue"</span>, </span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>, edge.arrow.size<span class="op">=</span><span class="fl">0.3</span>, edge.width<span class="op">=</span><span class="fl">1.1</span>, edge.size<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>     edge.arrow.width<span class="op">=</span><span class="fl">1.2</span>, edge.color<span class="op">=</span><span class="st">"black"</span>, vertex.label.cex<span class="op">=</span><span class="fl">1.2</span>, </span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"NA"</span>, margin<span class="op">=</span><span class="op">-</span><span class="fl">0.08</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dag" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-dag-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.6: Directed graph of Kaldor model
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">##### Generate directed graph</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct auxiliary Jacobian matrix for 5 variables:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Endogenous: (1) Y, (2) K, (3) S, (4) I</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exogenous: (5) YE</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>M_mat <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],  <span class="co"># Y</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],  <span class="co"># K</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],  <span class="co"># S</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],  <span class="co"># I</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]]) <span class="co"># YE</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create adjacency matrix from transpose of auxiliary Jacobian</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>A_mat <span class="op">=</span> M_mat.T</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create directed graph from adjacency matrix</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.DiGraph(A_mat)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Define node labels</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>nodelabs <span class="op">=</span> {<span class="dv">0</span>: <span class="st">"Y"</span>, <span class="dv">1</span>: <span class="st">"K"</span>, <span class="dv">2</span>: <span class="st">"S"</span>, <span class="dv">3</span>: <span class="st">"I"</span>, <span class="dv">4</span>: <span class="vs">r"$Y^E$"</span>}</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the graph using the specified approach</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, k<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(G, pos, node_size<span class="op">=</span><span class="dv">200</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>, </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                 edge_color<span class="op">=</span><span class="st">"black"</span>, width<span class="op">=</span><span class="fl">1.2</span>, arrowsize<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                 arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, font_size<span class="op">=</span><span class="dv">8</span>, font_color<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                 with_labels<span class="op">=</span><span class="va">True</span>, labels<span class="op">=</span>nodelabs)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Directed Graph of Kaldor Model"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><a href="#fig-dag" class="quarto-xref">Figure&nbsp;<span>18.6</span></a> illustrates the endogenous cycle generated by the interaction between income <span class="math inline">\(Y\)</span>, investment <span class="math inline">\(I\)</span>, saving <span class="math inline">\(S\)</span>, and the capital stock. An important exogenous variable depicted here is the normal income level <span class="math inline">\(Y^E\)</span>, which sets the equilibrium around which output fluctuates.</p>
</section><section id="analytical-discussion" class="level2"><h2 class="anchored" data-anchor-id="analytical-discussion">Analytical discussion</h2>
<p>To analyse the dynamic properties of this discrete-time version of the <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span> model, we first reduce it to a two-dimensional system in <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(K_t\)</span>. Substitution of <a href="#eq-kaldor_S" class="quarto-xref">Equation&nbsp;<span>18.3</span></a> and <a href="#eq-kaldor_S" class="quarto-xref">Equation&nbsp;<span>18.3</span></a> into <a href="#eq-kaldor_Y" class="quarto-xref">Equation&nbsp;<span>18.1</span></a> and <a href="#eq-kaldor_K" class="quarto-xref">Equation&nbsp;<span>18.2</span></a> yields:</p>
<p><span id="eq-kaldor_Y_reduc"><span class="math display">\[
Y_{t}=Y_{t-1} + \alpha \left[\sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_{t-1} \right) + \arctan(Y_{t-1}- Y^E)  -  \sigma Y_{t-1} \right]
\tag{18.5}\]</span></span></p>
<p><span id="eq-kaldor_K_reduc"><span class="math display">\[
K_{t} = (1-\delta)K_{t-1} + \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K_t \right) + \arctan(Y_{t-1}- Y^E).
\tag{18.6}\]</span></span></p>
<p>Using the fact that <span class="math inline">\(\frac{\partial \arctan(a+bx)}{\partial x}=\frac{1}{1+(a+bx)^2}\)</span>, we can write the system’s Jacobian matrix as:</p>
<p><span class="math display">\[
J=\begin{bmatrix} 1 + \frac{\alpha}{1+(Y-Y^E)^2} - \alpha\sigma &amp; -\alpha \gamma \\ \frac{1}{1+(Y-Y^E)^2} &amp; 1-\delta - \gamma\  \end{bmatrix}.
\]</span></p>
<p>Next, we determine the steady states of the model by setting <span class="math inline">\(Y_t = Y_{t-1}\)</span> and <span class="math inline">\(K_t = K_{t-1}\)</span>, which yields:</p>
<p><span id="eq-kaldor_Y_eq"><span class="math display">\[
0=\sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K \right) + \arctan(Y- Y^E)  -  \sigma Y
\tag{18.7}\]</span></span></p>
<p><span id="eq-kaldor_K_eq"><span class="math display">\[
0 = -\delta K + \sigma Y^E + \gamma \left(\frac{\sigma Y^E}{\delta} - K \right) + \arctan(Y- Y^E).
\tag{18.8}\]</span></span></p>
<p>From this, we can readily obtain:</p>
<p><span class="math display">\[
K=\frac{\sigma}{\delta}Y,
\]</span> and using this equation to eliminate <span class="math inline">\(K\)</span> in <a href="#eq-kaldor_K_eq" class="quarto-xref">Equation&nbsp;<span>18.8</span></a>, we get:</p>
<p><span id="eq-kaldor_eq"><span class="math display">\[
\sigma \left(1+\frac{\gamma}{\delta}\right)(Y- Y^E)=\arctan(Y-Y^E).
\tag{18.9}\]</span></span></p>
<p>Let <span class="math inline">\(\sigma \left(1+\frac{\gamma}{\delta}\right)=\theta\)</span>. <a href="#fig-eq" class="quarto-xref">Figure&nbsp;<span>18.7</span></a> plots the left-hand side and right-hand side of <a href="#eq-kaldor_eq" class="quarto-xref">Equation&nbsp;<span>18.9</span></a>, for two different parameterisations of <span class="math inline">\(\theta\)</span>. It can be seen that for <span class="math inline">\(\theta_1 &gt;1\)</span>, there is a unique equilibrium at <span class="math inline">\(Y^*=Y^E\)</span>, which implies <span class="math inline">\(K^*=\frac{\sigma}{\delta}Y^E\)</span>. However, for <span class="math inline">\(\theta_2 &lt; 1\)</span>, two further equilibria emerge, which are located symmetrically around the <span class="math inline">\(Y^*=Y^E\)</span> equilibrium.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Plot equilibria </span></span>
<span><span class="co"># Set  parameter values</span></span>
<span><span class="va">parm_1</span><span class="op">=</span><span class="fl">1.2</span></span>
<span><span class="va">parm_2</span><span class="op">=</span><span class="fl">0.8</span></span>
<span><span class="va">Y_E</span><span class="op">=</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Create functions using Y as argument</span></span>
<span><span class="va">f1a</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">parm_1</span><span class="op">*</span><span class="op">(</span><span class="va">Y</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">f1b</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">parm_2</span><span class="op">*</span><span class="op">(</span><span class="va">Y</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">f2</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">-</span> <span class="va">Y_E</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot the functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">f1a</span>, from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Y"</span>, ylab<span class="op">=</span><span class="st">""</span> , main<span class="op">=</span><span class="st">""</span>,</span>
<span>      lwd<span class="op">=</span><span class="fl">1.5</span>, n<span class="op">=</span><span class="fl">10000</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">f1b</span>, from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="fl">2</span>, add<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>      lwd<span class="op">=</span><span class="fl">1.5</span>,<span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="va">f2</span>, from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="fl">3</span>, add<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>      lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">(</span><span class="va">Y</span><span class="op">-</span><span class="va">Y</span><span class="op">^</span><span class="va">E</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">(</span><span class="va">Y</span><span class="op">-</span><span class="va">Y</span><span class="op">^</span><span class="va">E</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">arctan</span><span class="op">(</span><span class="va">Y</span><span class="op">-</span><span class="va">Y</span><span class="op">^</span><span class="va">E</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-eq" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-eq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-eq-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.7: Equilibria
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Plot equilibria</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter values</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>parm_1 <span class="op">=</span> <span class="fl">1.2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>parm_2 <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Y_E <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define functions</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f1a(Y):</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parm_1 <span class="op">*</span> (Y <span class="op">-</span> Y_E)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f1b(Y):</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parm_2 <span class="op">*</span> (Y <span class="op">-</span> Y_E)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f2(Y):</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.arctan(Y <span class="op">-</span> Y_E)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Y values for plotting</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>Y_vals1 <span class="op">=</span> np.linspace(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">1000</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>Y_vals2 <span class="op">=</span> np.linspace(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">1000</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the functions</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>plt.plot(Y_vals1, f1a(Y_vals1), color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="vs">r'$\theta_1(Y - Y^E)$'</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>plt.plot(Y_vals1, f1b(Y_vals1), color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="vs">r'$\theta_2(Y - Y^E)$'</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>plt.plot(Y_vals2, f2(Y_vals2), color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="vs">r'$\arctan(Y - Y^E)$'</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Y"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">""</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let us focus on the <span class="math inline">\(\theta &gt;1\)</span> case yielding the unique <span class="math inline">\(Y^*= Y^E\)</span> equilibrium, which is the one corresponding to the parameterisation used in the simulations above.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> The Jacobian matrix evaluated at this equilibrium is given by:</p>
<p><span class="math display">\[
J^*=\begin{bmatrix} 1 + \alpha(1-\sigma) &amp; -\alpha \gamma \\ 1 &amp; 1-\delta - \gamma\  \end{bmatrix}.
\]</span> The characteristic polynomial yielding the eigenvalues of the Jacobian is:</p>
<p><span class="math display">\[\lambda^2-\lambda[2+\alpha(1-\sigma)-\delta-\gamma]+(1-\delta -\gamma)(1-\alpha\sigma) +\alpha(1-\delta)=0,\]</span></p>
<p>where <span class="math inline">\(2+\alpha(1-\sigma)-\delta-\gamma =tr(J)\)</span> and <span class="math inline">\((1-\delta -\gamma)(1-\alpha\sigma) +\alpha(1-\delta) = det(J)\)</span>.</p>
<p>First, let us derive the condition under which the model produces cycles thanks to the eigenvalues being a pair of complex conjugates. The roots of the polynomial are:</p>
<p><span class="math display">\[
\lambda_{1,2} = \frac{tr(J) \pm \sqrt{tr(J)^2-4det(J)}}{2},
\]</span></p>
<p>so that the eigenvalues will be complex if <span class="math inline">\(tr(J)^2-4 det(J)&lt;0\)</span>, which can also be written as <span class="math inline">\((J_{11}-J_{22})^2 + J_{12}J_{21}&lt;0\)</span>, where <span class="math inline">\(J_{ii}\)</span> are the elements of the Jacobian matrix.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> Thus, the condition for cycles becomes:</p>
<p><span class="math display">\[
[\alpha(1-\sigma) + \delta + \gamma]^2 - 4\alpha \gamma &lt; 0.  
\]</span> Next, the stability conditions for two-dimensional systems in discrete time are:</p>
<p><span class="math display">\[
1+tr(J)+det(J)&gt;0,
\]</span> <span class="math display">\[
1-tr(J)+det(J)&gt;0,
\]</span> <span class="math display">\[
1-det(J)&gt;0,
\]</span></p>
<p>where <span class="math inline">\(tr(J)\)</span> is the trace and <span class="math inline">\(det(J)\)</span> is the determinant of the Jacobian.</p>
<p>Let us focus on the last condition, which gives:</p>
<p><span class="math display">\[
(1-\delta -\gamma)(1-\alpha \sigma) +\alpha(1-\delta)&lt; 1.
\]</span></p>
<p>We now generate a plot that displays the cycle and the stability condition in the <span class="math inline">\((\alpha, \sigma)\)</span>-space. We further add a horizontal line at <span class="math inline">\(\sigma \left(1+\frac{\gamma}{\delta}\right)=\theta=1\)</span>, demarcating values of <span class="math inline">\(\sigma\)</span> for which there is a unique equilibrium (above the line) and for which there are three equilibria (below the line).<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Plot cycle and stability condition </span></span>
<span></span>
<span><span class="co"># Set fixed parameter values</span></span>
<span><span class="va">delta</span><span class="op">=</span><span class="fl">0.2</span> <span class="co"># depreciation rate</span></span>
<span><span class="va">gamma</span><span class="op">=</span><span class="fl">0.6</span> <span class="co"># sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span></span>
<span><span class="co"># Create function for cycle condition</span></span>
<span><span class="va">cyc</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sigma</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="va">alpha</span><span class="op">*</span><span class="va">gamma</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create function for stability condition</span></span>
<span><span class="va">stab</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">delta</span> <span class="op">-</span><span class="va">gamma</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">sigma</span><span class="op">)</span> <span class="op">+</span><span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create a grid of alpha and sigma values</span></span>
<span><span class="va">alpha_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">sigma_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">grid</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha_vals</span>, sigma <span class="op">=</span> <span class="va">sigma_vals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate the functions on the grid</span></span>
<span><span class="va">cyc_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu">cyc</span><span class="op">(</span><span class="va">grid</span><span class="op">$</span><span class="va">alpha</span>, <span class="va">grid</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">stab_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu">stab</span><span class="op">(</span><span class="va">grid</span><span class="op">$</span><span class="va">alpha</span>, <span class="va">grid</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the curves</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">alpha_vals</span>, <span class="va">sigma_vals</span>, <span class="va">cyc_vals</span>, levels <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, </span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">alpha_vals</span>, <span class="va">sigma_vals</span>, <span class="va">stab_vals</span>, levels <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">gamma</span><span class="op">/</span><span class="va">delta</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cycle condition"</span>,</span>
<span>       <span class="st">"stability condition"</span>, <span class="st">"unique equilibrium condition"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bif" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a_Kaldor_model_files/figure-html/fig-bif-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.8: Cycle and stability conditions
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Plot cycle and stability condition</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set fixed parameter values</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># Depreciation rate</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># Sensitivity of investment to deviations from normal capital stock</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define functions for cycle and stability conditions</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyc(alpha, sigma):</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (alpha <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sigma) <span class="op">+</span> delta <span class="op">+</span> gamma)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> alpha <span class="op">*</span> gamma</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stab(alpha, sigma):</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">-</span> delta <span class="op">-</span> gamma) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha <span class="op">*</span> sigma) <span class="op">+</span> alpha <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> delta) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of alpha and sigma values</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>alpha_vals <span class="op">=</span> np.linspace(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>sigma_vals <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>alpha_grid, sigma_grid <span class="op">=</span> np.meshgrid(alpha_vals, sigma_vals)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the functions on the grid</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>cyc_vals <span class="op">=</span> cyc(alpha_grid, sigma_grid)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>stab_vals <span class="op">=</span> stab(alpha_grid, sigma_grid)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the curves</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cycle condition contour</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>cyc_contour <span class="op">=</span> plt.contour(alpha_vals, sigma_vals, cyc_vals, levels<span class="op">=</span>[<span class="dv">0</span>], colors<span class="op">=</span><span class="st">'black'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot stability condition contour</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>stab_contour <span class="op">=</span> plt.contour(alpha_vals, sigma_vals, stab_vals, levels<span class="op">=</span>[<span class="dv">0</span>], colors<span class="op">=</span><span class="st">'red'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot unique equilibrium condition</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>unique_eq_line <span class="op">=</span> plt.axhline(y<span class="op">=</span><span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> gamma <span class="op">/</span> delta), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the plot</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'$\alpha$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="vs">r'$\sigma$'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom legend symbols</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Cycle condition"</span>),</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Stability condition"</span>),</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'green'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">"Unique equilibrium condition"</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend with symbols</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>plt.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">"upper left"</span>, frameon<span class="op">=</span><span class="va">False</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>According to <a href="#fig-bif" class="quarto-xref">Figure&nbsp;<span>18.8</span></a>, combinations of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> above the cycle and to the right of the stability condition yield eigenvalues of the model that are a pair of complex conjugates with a modulus greater than one. The model will then generate a limit cycle. For combinations of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> to the left of the stability and above the cycle condition, the model yields damped oscillations that will converge to a stable equilibrium. For combinations of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span> to the left of the stability and below the cycle condition, the model yields monotonic converges to a stable equilibrium.</p>
<p>These analytically derived conditions correspond to and illuminate further the numerical results in the bifurcation diagrams above. In <a href="#fig-bif-alpha" class="quarto-xref">Figure&nbsp;<span>18.4</span></a>, it could be seen that for a fixed <span class="math inline">\(\sigma=0.4\)</span>, limit cycles appear to occur for <span class="math inline">\(\alpha \gtrapprox 1.15\)</span>. With the analytical results plotted in <a href="#fig-bif" class="quarto-xref">Figure&nbsp;<span>18.8</span></a> we can confirm that this indeed constitutes a Hopf bifurcation, where the equilibrium loses its stability while the eigenvalues are complex. Similarly, in <a href="#fig-bif-sigma" class="quarto-xref">Figure&nbsp;<span>18.5</span></a>, it could be seen that for a fixed <span class="math inline">\(\alpha=1.2\)</span>, a limit cycle appears to occur for <span class="math inline">\(\sigma \gtrapprox 0.25\)</span>. <a href="#fig-bif" class="quarto-xref">Figure&nbsp;<span>18.8</span></a> suggests that for values of <span class="math inline">\(\sigma\)</span> below that critical value, the <span class="math inline">\(Y^*=Y^E\)</span> equilibrium ceases to be unique, and the system is apparently attracted to one of the other two equilibria, which appear to be stable.</p>
<p>Finally, we can also compute the eigenvalues and check the analytical stability and cycle conditions numerically.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Stability analysis</span></span>
<span></span>
<span><span class="co"># Set parameter values</span></span>
<span><span class="va">alpha</span><span class="op">=</span><span class="fl">1.2</span> <span class="co"># adjustment speed of output</span></span>
<span><span class="va">delta</span><span class="op">=</span><span class="fl">0.2</span> <span class="co"># depreciation rate</span></span>
<span><span class="va">sigma</span><span class="op">=</span><span class="fl">0.4</span> <span class="co"># propensity to save</span></span>
<span><span class="va">gamma</span><span class="op">=</span><span class="fl">0.6</span> <span class="co"># sensitivity of investment to deviations of actual from normal cap stock</span></span>
<span></span>
<span><span class="co"># Construct Jacobian matrix evaluated at the Y*=Y_E steady state</span></span>
<span><span class="va">J_base</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sigma</span><span class="op">)</span>, <span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">gamma</span>,</span>
<span>                <span class="fl">1</span>, <span class="fl">1</span><span class="op">-</span><span class="va">delta</span><span class="op">-</span><span class="va">gamma</span><span class="op">)</span>,</span>
<span>                 <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain eigenvalues</span></span>
<span><span class="va">ev_base</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">J_base</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">evals_base</span> <span class="op">=</span> <span class="va">ev_base</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.96+0.3773592i 0.96-0.3773592i</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Obtain determinant and trace</span></span>
<span><span class="va">tr</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">J_base</span><span class="op">)</span><span class="op">)</span> <span class="co"># trace</span></span>
<span><span class="op">(</span><span class="va">det</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/det.html">det</a></span><span class="op">(</span><span class="va">J_base</span><span class="op">)</span><span class="op">)</span>      <span class="co"># determinant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.064</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate modulus</span></span>
<span><span class="op">(</span><span class="va">mod_base</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Mod</a></span><span class="op">(</span><span class="va">evals_base</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.031504</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Check general stability conditions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">tr</span><span class="op">+</span><span class="va">det</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">tr</span><span class="op">+</span><span class="va">det</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">det</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check analytical stability condition</span></span>
<span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">delta</span> <span class="op">-</span><span class="va">gamma</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">*</span><span class="va">sigma</span><span class="op">)</span> <span class="op">+</span><span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>These results confirm that the modulus of the complex eigenvalue is indeed larger than unity and the system thus unstable.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Check cycle condition and compute cycle length </span></span>
<span></span>
<span><span class="co"># Check analytical cycle condition</span></span>
<span><span class="op">(</span><span class="op">(</span><span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sigma</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="va">alpha</span><span class="op">*</span><span class="va">gamma</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Save real and imaginary part of complex eigenvalue</span></span>
<span><span class="va">re</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">evals_base</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">im</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Im</a></span><span class="op">(</span><span class="va">evals_base</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate cycle length</span></span>
<span><span class="va">L</span><span class="op">=</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">acos</a></span><span class="op">(</span><span class="va">re</span><span class="op">/</span><span class="va">mod_base</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">L</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.77624</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">###### Stability analysis</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter values</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">1.2</span>  <span class="co"># Adjustment speed of output</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># Depreciation rate</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.4</span>  <span class="co"># Propensity to save</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># Sensitivity of investment to deviations from normal capital stock</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct Jacobian matrix evaluated at the Y* = Y_E steady state</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>J_base <span class="op">=</span> np.array([</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span> <span class="op">+</span> alpha <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sigma), <span class="op">-</span>alpha <span class="op">*</span> gamma],</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span> <span class="op">-</span> delta <span class="op">-</span> gamma]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain eigenvalues</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>evals_base, _ <span class="op">=</span> np.linalg.eig(J_base)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print eigenvalues</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eigenvalues:"</span>, evals_base)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain determinant and trace</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>tr <span class="op">=</span> np.trace(J_base)   <span class="co"># Trace</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>det <span class="op">=</span> np.linalg.det(J_base)  <span class="co"># Determinant</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Print determinant</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Determinant: </span><span class="sc">{</span>det<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print modulus of the first eigenvalue</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>mod_base <span class="op">=</span> <span class="bu">abs</span>(evals_base[<span class="dv">0</span>])</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Modulus of first eigenvalue: </span><span class="sc">{</span>mod_base<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Check general stability conditions</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1 + tr + det &gt; 0: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">+</span> tr <span class="op">+</span> det <span class="op">&gt;</span> <span class="dv">0</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1 - tr + det &gt; 0: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> tr <span class="op">+</span> det <span class="op">&gt;</span> <span class="dv">0</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1 - det &gt; 0: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> det <span class="op">&gt;</span> <span class="dv">0</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Check analytical stability condition</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((<span class="dv">1</span> <span class="op">-</span> delta <span class="op">-</span> gamma) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha <span class="op">*</span> sigma) <span class="op">+</span> alpha <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> delta)) <span class="op">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="co">### Check cycle condition and compute cycle length </span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Check analytical cycle condition</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((alpha <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sigma) <span class="op">+</span> delta <span class="op">+</span> gamma)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> alpha <span class="op">*</span> gamma) <span class="op">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Save real and imaginary parts of complex eigenvalue</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>re <span class="op">=</span> np.real(evals_base[<span class="dv">0</span>])</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> np.imag(evals_base[<span class="dv">0</span>])</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cycle length</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> np.pi) <span class="op">/</span> np.arccos(re <span class="op">/</span> mod_base)</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Cycle length: </span><span class="sc">{</span>L<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The analytical cycle condition confirms that the eigenvalues of the system will be complex and thus generate cycles. The implied cycle length is around 17 periods.</p>
</section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bischi2001" class="csl-entry" role="listitem">
Bischi, Gian Italo, Roberto Dieci, Giorgio Rodano, and Enrico Saltari. 2001. <span>“Multiple Attractors and Global Bifurcations in a Kaldor-Type Business Cycle Model.”</span> <em>Journal of Evolutionary Economics</em> 11 (5): 527–54. <a href="https://doi.org/10.1007/s191-001-8320-9">https://doi.org/10.1007/s191-001-8320-9</a>.
</div>
<div id="ref-Chang1971" class="csl-entry" role="listitem">
Chang, W. W., and D. J. Smyth. 1971. <span>“The Existence and Persistence of Cycles in a Non-Linear Model: Kaldor’s 1940 Model Re-Examined.”</span> <em>The Review of Economic Studies</em> 38 (1): 37. <a href="https://doi.org/10.2307/2296620">https://doi.org/10.2307/2296620</a>.
</div>
<div id="ref-Gabisch1989" class="csl-entry" role="listitem">
Gabisch, Günter, and Hans-Walter Lorenz. 1989. <em>Business Cycle Theory. A Survey of Methods and Concepts, 2nd Edition</em>. Springer-Verlag.
</div>
<div id="ref-Gandolfo2009" class="csl-entry" role="listitem">
Gandolfo, Giancarlo. 2009. <em>Economic Dynamics. Study Edition. 4th Edition.</em> Springer.
</div>
<div id="ref-Hicks1950" class="csl-entry" role="listitem">
Hicks, John R. 1950. <em>A Contribution to the Theory of the Trade Cycle</em>. Clarendon Press.
</div>
<div id="ref-Kaldor1940" class="csl-entry" role="listitem">
Kaldor, Nicholas. 1940. <span>“A Model of the Trade Cycle.”</span> <em>The Economic Journal</em> 50 (197): 78–92.
</div>
<div id="ref-Samuelson1939" class="csl-entry" role="listitem">
Samuelson, Paul A. 1939. <span>“<span class="nocase">Interactions between the Multiplier Analysis and the Principle of Acceleration</span>.”</span> <em>The Review of Economics and Statistics</em> 21 (2): 75–78. <a href="https://doi.org/10.2307/1927758">https://doi.org/10.2307/1927758</a>.
</div>
<div id="ref-Stockhammer2019" class="csl-entry" role="listitem">
Stockhammer, Engelbert, Robert Calvert Jump, Karsten Kohler, and Julian Cavallero. 2019. <span>“Short and Medium Term Financial-Real Cycles: An Empirical Assessment.”</span> <em>Journal of International Money and Finance</em> 94 (June): 81–96. <a href="https://doi.org/10.1016/j.jimonfin.2019.02.006">https://doi.org/10.1016/j.jimonfin.2019.02.006</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>More precisely, <span class="citation" data-cites="Samuelson1939">Samuelson (<a href="#ref-Samuelson1939" role="doc-biblioref">1939</a>)</span>’s model generates shock-independent cycles only for a very specific parameter combination, whereas <span class="citation" data-cites="Kaldor1940">Kaldor (<a href="#ref-Kaldor1940" role="doc-biblioref">1940</a>)</span>’s model generates endogenous cycles for a much broader set of parameters.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The first 10 periods were excluded from the computation as these are driven by the adjustment from the arbitrary initialisation.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>In discrete-time dynamic systems, the Hopf bifurcation is also called <em>Neimark-Sacker bifurcation</em>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>To increase computational efficiency, we simulate a reduced-form version of the model in <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(K_t\)</span> only that is derived in the analytical discussion below.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>See <span class="citation" data-cites="Bischi2001">Bischi et al. (<a href="#ref-Bischi2001" role="doc-biblioref">2001</a>)</span> for a comprehensive mathematical analysis of all possible equilibria of the model.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>See also <span class="citation" data-cites="Stockhammer2019">Stockhammer et al. (<a href="#ref-Stockhammer2019" role="doc-biblioref">2019</a>)</span> on this condition for cycles.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>To plot the conditions, we replace the inequalities by equality signs and solve for 0.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./a_Hicks_model.html" class="pagination-link" aria-label="A Hicksian Business Cycle Model with Floors and Ceilings">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">A Hicksian Business Cycle Model with Floors and Ceilings</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./an_evolutionary_game_theoretic_model.html" class="pagination-link" aria-label="An Evolutionary Game Theoretic Model of the Emergence of Property Rights">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">An Evolutionary Game Theoretic Model of the Emergence of Property Rights</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>An open-source platform for macroeconomic model simulation.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a>License: …</a><a></a> <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website">Source code</a></p>
</div>
  </div>
</footer>


</body></html>