<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DIY Macroeconomic Model Simulation - 20&nbsp; A Stock-Flow Consistent Model of the Monetary Circuit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./additional_resources.html" rel="next">
<link href="./an_evolutionary_game_theoretic_model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_stability_analysis.html">Dynamic Models</a></li><li class="breadcrumb-item"><a href="./an_sfc_model.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">A Stock-Flow Consistent Model of the Monetary Circuit</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DIY Macroeconomic Model Simulation</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_use.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_to_simulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How to Simulate Economic Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Static Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_macro_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Neoclassical Macro Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_IS_LM_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An IS-LM Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_neoclassical_synthesis_model_IS_LM_AS_AD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Neoclassical Synthesis Model (IS-LM-AS-AD)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_keynesian_macro_model_with_endogenous_money.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Post-Keynesian Macro Model with Endogenous Money</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Kaldor-Robinson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">A Kaldor-Robinson Distribution and Growth Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_post_kaleckian_distribution_and_growth_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">A Post-Kaleckian Distribution and Growth Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Dynamic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_stability_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">An Introduction to the Analysis of Dynamic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_new_keynesian_3_equation_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">A New Keynesian 3-Equation Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_conflict_inflation_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">A Conflict Inflation Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_sraffian_supermultiplier_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">A Sraffian Supermultiplier Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_malthusian_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">A Malthusian Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_one_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">A Ricardian One-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_ricardian_two_sector_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Ricardian Two-Sector Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Lewis_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">A Lewis Model of Economic Development</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Hicks_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">A Hicksian Business Cycle Model with Floors and Ceilings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_Kaldor_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">A Kaldorian Endogenous Business Cycle Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_evolutionary_game_theoretic_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">An Evolutionary Game Theoretic Model of the Emergence of Property Rights</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./an_sfc_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">A Stock-Flow Consistent Model of the Monetary Circuit</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./additional_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Additional Online Resources</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#the-balance-sheet-and-transaction-flows-matrices" id="toc-the-balance-sheet-and-transaction-flows-matrices" class="nav-link" data-scroll-target="#the-balance-sheet-and-transaction-flows-matrices">The balance sheet and transaction flows matrices</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The model</a></li>
  <li>
<a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a>
  <ul>
<li><a href="#parameterisation" id="toc-parameterisation" class="nav-link" data-scroll-target="#parameterisation">Parameterisation</a></li>
  <li><a href="#simulation-code" id="toc-simulation-code" class="nav-link" data-scroll-target="#simulation-code">Simulation code</a></li>
  <li><a href="#checking-stock-flow-consistency" id="toc-checking-stock-flow-consistency" class="nav-link" data-scroll-target="#checking-stock-flow-consistency">Checking stock-flow consistency</a></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots">Plots</a></li>
  </ul>
</li>
  <li><a href="#directed-graph" id="toc-directed-graph" class="nav-link" data-scroll-target="#directed-graph">Directed graph</a></li>
  <li><a href="#analytical-discussion" id="toc-analytical-discussion" class="nav-link" data-scroll-target="#analytical-discussion">Analytical discussion</a></li>
  <li><a href="#a-simplified-recipe-for-constructing-sfc-models" id="toc-a-simplified-recipe-for-constructing-sfc-models" class="nav-link" data-scroll-target="#a-simplified-recipe-for-constructing-sfc-models">A simplified recipe for constructing SFC models</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_stability_analysis.html">Dynamic Models</a></li><li class="breadcrumb-item"><a href="./an_sfc_model.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">A Stock-Flow Consistent Model of the Monetary Circuit</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-sfc" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">A Stock-Flow Consistent Model of the Monetary Circuit</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p><a href="https://en.wikipedia.org/wiki/Stock-flow_consistent_model">The stock-flow consistent (SFC) approach</a> to macroeconomic modelling has become increasingly prominent since the 2006 publication of the foundational book <em>Monetary Economics</em> by Wynne Godley and Marc Lavoie.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The SFC approach integrates the real and financial side of the economy, i.e.&nbsp;the physical production and consumption of goods and services, and the financial flows that arise in the course of production, consumption, and investment. As the name suggests, an SFC model covers both flows (over a certain period of time) and stocks (at a particular point in time), which are embedded in a consistent and fully coherent accounting framework. SFC models typically comprise multiple aggregate sectors, such as a household sector, a firm sector, a banking sector, a central bank, and a government. Each of these sectors makes spending and financing decisions subject to budget constraints, giving rise to physical and financial flows across sectors, which lead to changes in physical and financial stocks over time. To ensure consistent accounting, four key principles are applied (see <span class="citation" data-cites="Nikiforos2017">Nikiforos and Zezza (<a href="#ref-Nikiforos2017" role="doc-biblioref">2017</a>)</span>):</p>
<ol type="1">
<li>Flow consistency: every transaction comes from somewhere and goes somewhere,</li>
<li>Stock consistency: every financial asset is also a financial liability,</li>
<li>Stock-flow consistency: flows accumulate into stocks,</li>
<li>Quadruple entry book-keeping: every transaction involves a quadruple entry in accounting – two for each party of the transaction.</li>
</ol>
<p>To illustrate these principles by means of a simple example, consider an economy with only two aggregate sectors – firms and households. Households earn wages by working for firms and spend a part of their wage income on goods, creating revenues for firms (flow consistency). If households do not spend all their wage income on consumption, firms will not receive back all the wages they paid and thus need to borrow to fill the gap. They could sell bonds to households (a liability for firms), thereby offering them a financial asset to save in (stock consistency). If households save some of their wage income in the form of bonds in every peiod, they will gradually increase their (net) wealth (stock-flow consistency). Finally, suppose households sell back some of their bonds to firms to pay for additional consumption. This will be recorded as a reduction of bond assets and an increase in consumption expenses for households, and a reduction in bond liabilities for firms coupled with an increase in revenues (quadruple entry book-keeping).</p>
<p>These principles are usually applied by means of two matrices that summarise the accounting structure of an SFC model: a balance sheet matrix (for stocks) and a transactions flow matrix (for flows and changes in stocks). These matrices provide a first set of equations that enter an SFC model to ensure accounting consistency. Accounting equations are then complemented by behavioural equations and equilibrium conditions that add causal assumptions to the accounting structure. Most SFC models draw on (post-)Keynesian macroeconomic theory when it comes to the behavioural assumptions. Correspondingly, most SFC models assume that economic activity is demand-determined, that households follow simple behavioural rules when making consumption decision (such as a constant marginal propensity to consume out of income), that firms operate in oligopolistic markets where they set prices based on a markup on unit cost, and that actors in financial markets make financial investment decisions based on relative rates of return. Another key feature is money endogeneity: money is created when commercial banks make loans to accommodate the demand for credit by (creditworthy) borrowers (see also <a href="a_post_keynesian_macro_model_with_endogenous_money.html" class="quarto-xref"><span>Chapter 6</span></a>). Like aggregate output, the stock of money is thus an endogenous variable that responds to the spending decisions of economic actors (both private and public).</p>
<!--
As SFC models typically do not assume optimising behaviour, there is scope for different behavioural assumptions. Similarly, with both output and the money stock endogenous, a wide range of equilibria are in principle possible. However, the systematic treatment of stocks and flows leads to stability requirements that constrain the range of (economically plausible) equilibria. Stock-flow ratios such as debt-to-income ratios are typically required to be stable over longer periods, which imposes constraints on behavioural assumptions. 
-->
<p>The SFC approach shares a strong affinity with <a href="https://en.wikipedia.org/wiki/Monetary_circuit_theory">monetary circuit theory</a>, which featured prominently in the work of the Italian economist Augusto <span class="citation" data-cites="Graziani2003">Graziani (<a href="#ref-Graziani2003" role="doc-biblioref">2003</a>)</span> and has inspired a ‘circuitist’ school within monetary economics. The key idea of the theory of the monetary circuit, following chapter 1 of <span class="citation" data-cites="Graziani2003">Graziani (<a href="#ref-Graziani2003" role="doc-biblioref">2003</a>)</span>, is that money is <em>credit</em> money, which is created whenever an agent spends money granted by a bank and is destroyed when bank credit is repaid. The stock of money is thus an endogenous variable. The monetary circuit starts by the creation of new credit money to finance production (called ‘initial finance’). Credit money is then used to hire workers and pay wages. Production and sale take place, firms make revenues. Firms may additionally raise funds from households by selling securities (called ‘final finance’). Lastly, firms repay their debts whereby credit money is destroyed. Thus, according to the theory of the monetary circuit, a key role of credit money is to bridge the gap between production (which involves expenses for firms) and sales (which generate income for firms). Money must be a flexible, endogenous variable to fulfil this role. While the SFC approach and the theory of the monetary circuit were largely developed independently, <span class="citation" data-cites="Godley2006">Godley and Lavoie (<a href="#ref-Godley2006" role="doc-biblioref">2006</a>)</span>, chapter 2.6, note a strong overlap between the two approaches.</p>
<p>In this section, we present a modified version of the model in <span class="citation" data-cites="Godley2012">Godley (<a href="#ref-Godley2012" role="doc-biblioref">2012</a>)</span>, which aims to provide a formalisation of the monetary circuit.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The <span class="citation" data-cites="Godley2012">Godley (<a href="#ref-Godley2012" role="doc-biblioref">2012</a>)</span> model features a household, firm, and banking sector (central bank and government are omitted for simplicity). Firms can take out loans from banks to finance production. Households receive income from labour and distributed profits, which they can spend on consumption or save in the form of bank deposits. For simplicity, there is no investment in physical capital, but firms maintain a stock of inventories to be able to accommodate demand.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Taken together, the model highlights the process by which production is financed, the idea of endogenous expenditure-driven money creation, and price determination in financial markets.</p>
</section><section id="the-balance-sheet-and-transaction-flows-matrices" class="level2"><h2 class="anchored" data-anchor-id="the-balance-sheet-and-transaction-flows-matrices">The balance sheet and transaction flows matrices</h2>
<p>The balance sheet matrix (BSM) records the distribution of physical and financial stocks across sectors. Assets carry a positive and liabilities a negative sign. The present model has three financial stocks: deposits, loans, and (corporate) bonds. The only physical asset are firms’ inventories. Stock consistency requires each row containing financial stocks to sum to zero. The columns of the BSM constitute the wealth constraints of the sectors, with the last row of each column representing the sector’s net wealth (assets minus liabilities). Since net financial wealth cancels out in the aggregate, the total net wealth is equal to the value of physical assets (inventories in this case).</p>
<p>In this model, households can save either in the form of deposits or corporate bonds. Firms can borrow either in the form of loans or bonds. Banks make loans to firms and issue deposits. From the BSM, it follows that <span class="math inline">\(M=L\)</span>, i.e.&nbsp;the stock of loans is equal to the stock of money. This illustrates at an elementary level, before having made any behavioural assumptions, the tight relationship between money and credit emphasised in both the SFC and monetary circuit approaches.</p>
<p><strong>Table 1: Balance Sheet Matrix</strong></p>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Households</th>
<th>Firms</th>
<th>Banks</th>
<th>∑</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Inventories</td>
<td></td>
<td><span class="math inline">\(+IN\)</span></td>
<td></td>
<td><span class="math inline">\(+IN\)</span></td>
</tr>
<tr class="even">
<td>Deposits</td>
<td><span class="math inline">\(+M\)</span></td>
<td></td>
<td><span class="math inline">\(–M\)</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Loans</td>
<td></td>
<td><span class="math inline">\(–L\)</span></td>
<td><span class="math inline">\(+L\)</span></td>
<td>0</td>
</tr>
<tr class="even">
<td>Bonds</td>
<td><span class="math inline">\(+p^B B\)</span></td>
<td><span class="math inline">\(–p^B B\)</span></td>
<td></td>
<td>0</td>
</tr>
<tr class="odd">
<td>∑ (Net wealth)</td>
<td><span class="math inline">\(V_H\)</span></td>
<td><span class="math inline">\(V_F = IN – L – p^B B\)</span></td>
<td>0</td>
<td><span class="math inline">\(+IN\)</span></td>
</tr>
</tbody>
</table>
<p>The transactions flow matrix (TFM) records flows across sectors. Sources of funds are denoted with a plus sign, and uses of funds with a minus sign. The TFM’s rows can be categorised into three groups. The first set of rows captures expenditures flows that make up total production (GDP): consumption and inventory investment. The second set of rows captures the corresponding income flows: wages and net profits plus financial income streams (interest payments/income on the three financial stocks in our case). The third set of rows reports changes in financial stocks that result from the difference between income and expenditure for each sector. Flow consistency across sectors requires each row to sum to zero. In addition, each sector needs to respect its budget constraint given by its column, which must also sum to zero. In our model, prices of corporate bonds may change endogenously; thus, there is a separate row at the bottom of the TFM reporting capital gains. The account of the corporate sector is split into a current and a capital account. This division makes explicit transactions taking place within the corporate sector. For example, inventory accumulation is an income for the firm sector (reported in the current account), but also an expenditure (reported in the capital account).</p>
<p><strong>Table 2: Transactions Flow Matrix</strong></p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 15%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Households</th>
<th>Firms (Current)</th>
<th>Firms (Capital)</th>
<th>Banks</th>
<th>∑</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Consumption</td>
<td><span class="math inline">\(–C\)</span></td>
<td><span class="math inline">\(+C\)</span></td>
<td></td>
<td></td>
<td>0</td>
</tr>
<tr class="even">
<td>Inventory investment</td>
<td></td>
<td><span class="math inline">\(+\Delta IN\)</span></td>
<td><span class="math inline">\(– \Delta IN\)</span></td>
<td></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Wages</td>
<td><span class="math inline">\(+W\)</span></td>
<td><span class="math inline">\(–W\)</span></td>
<td></td>
<td></td>
<td>0</td>
</tr>
<tr class="even">
<td>Net profits</td>
<td><span class="math inline">\(+\Pi\)</span></td>
<td><span class="math inline">\(–\Pi\)</span></td>
<td></td>
<td></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Interest on deposits</td>
<td><span class="math inline">\(+i_M M\)</span></td>
<td></td>
<td></td>
<td><span class="math inline">\(–i_M M\)</span></td>
<td>0</td>
</tr>
<tr class="even">
<td>Interest on loans</td>
<td></td>
<td><span class="math inline">\(–i_L L\)</span></td>
<td></td>
<td><span class="math inline">\(+i_L L\)</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Interest on bonds</td>
<td><span class="math inline">\(+i_B B\)</span></td>
<td><span class="math inline">\(–i_B B\)</span></td>
<td></td>
<td></td>
<td>0</td>
</tr>
<tr class="even">
<td>Change in deposits</td>
<td><span class="math inline">\(–\Delta M\)</span></td>
<td></td>
<td></td>
<td><span class="math inline">\(+ \Delta M\)</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Change in loans</td>
<td></td>
<td><span class="math inline">\(+\Delta L\)</span></td>
<td></td>
<td><span class="math inline">\(– \Delta L\)</span></td>
<td>0</td>
</tr>
<tr class="even">
<td>Change in bonds</td>
<td><span class="math inline">\(–\Delta B p^B\)</span></td>
<td></td>
<td><span class="math inline">\(+ \Delta B p^B\)</span></td>
<td></td>
<td>0</td>
</tr>
<tr class="odd">
<td>∑</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Capital gains</td>
<td><span class="math inline">\(–\Delta p^B B\)</span></td>
<td></td>
<td><span class="math inline">\(+ \Delta p^B B\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>In this model, total output/income <span class="math inline">\(Y\)</span> is composed of expenditures on consumption and inventories, which is equal to wages plus gross profits:</p>
<p><span class="math display">\[
  Y=C +\Delta IN = W + \Pi + i_LL + i_bB.
\]</span> The sectoral budget constraints are key to understand the financing decisions of each sectors. Starting with households, we know from the BSM that their net wealth consists of deposits and bonds: <span class="math inline">\(V_H=M+p^BB\)</span>. Thus, the change in their net wealth is given by <span class="math inline">\(\Delta V_H=\Delta M +\Delta Bp + \Delta pB\)</span>, where <span class="math inline">\(\Delta p^B B\)</span> represents capital gains on bonds. Using the output equation and the first column of the BSM, we have:</p>
<p><span class="math display">\[
\Delta V_H = Y - C + \Delta pB,
\]</span></p>
<p>where <span class="math inline">\(Y-C=\Delta M + \Delta B\)</span>, meaning that households can save either in the form of money or bonds, and that their total change in wealth is given by saving in those assets plus capital gains. Note that we assume that all net profits are distributed to the household sector.</p>
<p>From the capital account column of the TFM, we obtain the budget constraint of the firm sector:</p>
<p><span class="math display">\[
\Delta L + p^B \Delta B = \Delta IN,
\]</span> which tells us that expenditures on inventories can be covered either by taking out loans or by issuing corporate bonds.</p>
<p>We will use these fundamental accounting relationships in the model equations below to ensure stock-flow consistency.</p>
</section><section id="the-model" class="level2"><h2 class="anchored" data-anchor-id="the-model">The model</h2>
<p><strong>Households</strong> <span id="eq-sfc_C"><span class="math display">\[
C_t = \alpha_0 + \alpha_1 Y_t + \alpha_2 V_{Ht-1}
\tag{20.1}\]</span></span></p>
<p><span id="eq-sfc_W"><span class="math display">\[
W_t = \frac{wY_t}{\delta}
\tag{20.2}\]</span></span></p>
<p><span id="eq-sfc_Pi"><span class="math display">\[
\Pi_t=C_t - W_t - i_L L_{t-1} - i_B B_{t-1} + IN_t - IN_{t-1}
\tag{20.3}\]</span></span></p>
<p><span id="eq-sfc_V"><span class="math display">\[
V_{Ht} = V_{Ht-1} + Y_t - C_t + (p^B_t - p^B_{t-1})B_t
\tag{20.4}\]</span></span> <span id="eq-sfc_M"><span class="math display">\[
M_t= V_{Ht} - p^BB_t
\tag{20.5}\]</span></span></p>
<p><strong>Firms</strong> <span id="eq-sfc_Y"><span class="math display">\[
Y_t = C_t^e + IN^T_t - IN_{t-1}
\tag{20.6}\]</span></span></p>
<p><span id="eq-sfc_INT"><span class="math display">\[
IN^T_t = \sigma C_t^e
\tag{20.7}\]</span></span></p>
<p><span id="eq-sfc_Ce"><span class="math display">\[
C^e_t = C^e_{t-1} + \gamma(IN^T_{t-1} - IN_{t-1})
\tag{20.8}\]</span></span></p>
<p><span id="eq-sfc_IN"><span class="math display">\[
IN_t = IN_{t-1} + Y_t - C_t
\tag{20.9}\]</span></span></p>
<p><span id="eq-sfc_B"><span class="math display">\[
B_t = \frac{\beta IN_{t-1}}{p^B_t}
\tag{20.10}\]</span></span></p>
<p><span id="eq-sfc_iB"><span class="math display">\[
i_B = \rho + i_L
\tag{20.11}\]</span></span></p>
<p><span id="eq-sfc_L"><span class="math display">\[
L_t = L_{t-1} + IN_t - IN_{t-1} - p^B_t(B_t - B_{t-1})
\tag{20.12}\]</span></span></p>
<p><strong>Banks</strong> <span id="eq-sfc_iL"><span class="math display">\[
i_L = i_M
\tag{20.13}\]</span></span></p>
<p><strong>Bond market</strong> <span id="eq-sfc_pB"><span class="math display">\[
p^B_t = \frac{i_B \lambda_2}{\beta \frac{IN_{t-1}}{V_{Ht-1}} - \lambda_0 + \lambda_1 i_M + \lambda_3 \frac{Y_{t-1}}{V_{Ht-1}}}
\tag{20.14}\]</span></span></p>
<p>where stocks, flows, interest rates, and bond prices are defined as in Tables 1 and 2 above, and <span class="math inline">\(C^e_t\)</span> and <span class="math inline">\(IN^T_t\)</span> represent expected consumption (= expected sales) and the target stock of inventories, respectively.</p>
<p><a href="#eq-sfc_C" class="quarto-xref">Equation&nbsp;<span>20.1</span></a> is the consumption function – one of the model’s key behavioural equations. It assumes that consumption is a function of current income <span class="math inline">\(Y_t\)</span>, previous period’s household wealth <span class="math inline">\(V_{Ht-1}\)</span>, and an autonomous component <span class="math inline">\(\alpha_0\)</span>, with fixed marginal propensities, <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span>, to consume out of income and wealth. <a href="#eq-sfc_W" class="quarto-xref">Equation&nbsp;<span>20.2</span></a> specifies the determination of the aggregate wage bill, a component of household income. The nominal wage rate <span class="math inline">\(w\)</span> is assumed to be fixed, while total employment <span class="math inline">\(N\)</span> is determined in a Keynesian fashion by total output in conjunction with a given level of labour productivity <span class="math inline">\(\delta=\frac{Y}{N}\)</span>, i.e.&nbsp;<span class="math inline">\(N=\frac{Y}{\delta}\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <a href="#eq-sfc_Pi" class="quarto-xref">Equation&nbsp;<span>20.3</span></a> defines profits (derived from the firms’ current account column of the TFM), which are fully distributed to the household sector. Note that in the definition of profits, inventory investment is recorded as a source of income for firms, i.e.&nbsp;they are treated as if they had been sold. <a href="#eq-sfc_V" class="quarto-xref">Equation&nbsp;<span>20.4</span></a> specifies wealth dynamics of households as derived in the previous section from the first column of the TFM. <a href="#eq-sfc_M" class="quarto-xref">Equation&nbsp;<span>20.5</span></a> represents the wealth constraint of households (the first column of the BSM), where it is assumed that deposits <span class="math inline">\(M\)</span> act as the residual: households allocate their wealth they don’t want to hold in the form of bonds into deposits.</p>
<p>Moving on to firms, <a href="#eq-sfc_Y" class="quarto-xref">Equation&nbsp;<span>20.6</span></a> specifies their production decisions. Firms produce output to meet expected sales (= expected consumption <span class="math inline">\(C_t^e\)</span>) and to hit their target stock of inventories <span class="math inline">\(IN^T_t\)</span>. By <a href="#eq-sfc_INT" class="quarto-xref">Equation&nbsp;<span>20.7</span></a>, they aim to maintain a fixed ratio <span class="math inline">\(\sigma\)</span> of inventories to expected sales – a simple heuristic to deal with the intrinsic uncertainty over realised sales. In the same vein, <a href="#eq-sfc_Ce" class="quarto-xref">Equation&nbsp;<span>20.8</span></a> constitutes a simple adaptive rule to update sales expectations based on past deviations of actual inventories from target. If, for example, actual inventories exceeded target inventories due to a slump in sales, the term in brackets in <a href="#eq-sfc_Ce" class="quarto-xref">Equation&nbsp;<span>20.8</span></a> will be negative. Firms take this as a sign of weak demand, which they extrapolate into the future and thus reduce their sales expectations. <a href="#eq-sfc_IN" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> is an accounting identity derived from TFM in the previous section and states that inventories accumulate whenever production exceeds sales. Observe that <a href="#eq-sfc_Y" class="quarto-xref">Equation&nbsp;<span>20.6</span></a> and <a href="#eq-sfc_IN" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> can be combined to give <span class="math inline">\(IN_t - IN_t^T = C_t^E - C_t\)</span>, showing that expectational errors on the side of firms give rise to deviations of the actual stock of inventories from target.</p>
<p>The next three equations specify the financial decisions of firms. By <a href="#eq-sfc_B" class="quarto-xref">Equation&nbsp;<span>20.10</span></a>, firms finance a fixed share <span class="math inline">\(\beta\)</span> of their inventories through bond issuance (where bonds are measured at market value). The parameter <span class="math inline">\(\beta\)</span> thus captures the liability management of firms. Firms also set a fixed interest rate (or ‘coupon rate’) on bonds <span class="math inline">\(i_B\)</span> (<a href="#eq-sfc_iB" class="quarto-xref">Equation&nbsp;<span>20.11</span></a>), using a fixed markup or premium <span class="math inline">\(\rho\)</span> on the lending rate <span class="math inline">\(i_L\)</span>. <a href="#eq-sfc_L" class="quarto-xref">Equation&nbsp;<span>20.12</span></a> represents firms’ budget constraint as derived from the TFM. With bond issuance pinned down behaviourally by <a href="#eq-sfc_B" class="quarto-xref">Equation&nbsp;<span>20.10</span></a>, loan issuance becomes the residual item of the firm sector’s budget constraint, ensuring that any expenditures on inventories that are not financed by bond issuance are covered by loans.</p>
<p>The banking sector in this model is kept very simple. Banks make loans and issue deposits. They charge the same rate on loans <span class="math inline">\(i_L\)</span> as they pay on deposits <span class="math inline">\(i_M\)</span> (<a href="#eq-sfc_iL" class="quarto-xref">Equation&nbsp;<span>20.13</span></a>), implying that they don’t make any profits.</p>
<p>Finally, equation <a href="#eq-sfc_pB" class="quarto-xref">Equation&nbsp;<span>20.14</span></a> represents the determination of corporate bond prices on financial markets. This equation is derived from the portfolio choice decisions of households, where it is assumed that households’ desired share of bonds (at market value) in their total wealth is a function of rates of return as well as household income. Specifically, the underlying portfolio equation is:</p>
<p><span class="math display">\[
\frac{p^B_tB^D_t}{V_{Ht-1}} = \lambda_0 - \lambda_1 i_M + \lambda_2 \frac{i_B}{p^B_t} - \lambda_3 \frac{Y_t}{V_{Ht-1}}.
\]</span> The term <span class="math inline">\(\lambda_0\)</span> represents autonomous demand for bonds (which is inversely related to liquidity preference, i.e.&nbsp;the autonomous demand for deposits) and the negative term <span class="math inline">\(\lambda_1 i_M\)</span> captures the foregone returns from holding deposits instead of bonds. The term <span class="math inline">\(\lambda_2 \frac{i_B}{p^B_t}\)</span> captures the positive effect of bond yields on bond demand. Note that we assume a fixed face value (or ‘par value’) of bonds of unity, so that the coupon rate coincides with the interest payments on the bond. Thus, <span class="math inline">\(\frac{i_B}{p^B_t}\)</span> is the <em>yield</em> on corporate bonds, which is inversely related to bond prices. The last term in the bond demand equation represents the negative effect of income (relative to wealth) on bond demand, which stems from the transactions demand for deposit money. Using this equation for the bond demand of households with the bond supply of firms given by <a href="#eq-sfc_B" class="quarto-xref">Equation&nbsp;<span>20.10</span></a>, imposing equilibrium, and solving for <span class="math inline">\(p^B_t\)</span> gives <a href="#eq-sfc_pB" class="quarto-xref">Equation&nbsp;<span>20.14</span></a>.</p>
<p>With 14 equations, this comparatively simple model illustrates a common feature of SFC models: the number of equations is typically large. Two points are worth noting in this regard. First, our representation of the model is already relatively parsimonious in that it focuses on the equations that are used in the simulation. For example, <a href="#eq-sfc_pB" class="quarto-xref">Equation&nbsp;<span>20.14</span></a> has been derived from underlying equations about portfolio choice and an equilibrium condition that we did not list above. Similarly, we did not add to the list of equations some relatively trivial facts, e.g.&nbsp;that sales are equal to consumption expenditures, or chose not to track certain variables such as total employment, prices, and the wage share. One could add these equations if one wanted to make some of these assumptions or implied results more explicit. Second, and more importantly, several of the model’s accounting equations are actually irrelevant for its results. Specifically, out of the five accounting equations (<a href="#eq-sfc_Pi" class="quarto-xref">Equation&nbsp;<span>20.3</span></a>, <a href="#eq-sfc_V" class="quarto-xref">Equation&nbsp;<span>20.4</span></a>, <a href="#eq-sfc_M" class="quarto-xref">Equation&nbsp;<span>20.5</span></a>, <a href="#eq-sfc_IN" class="quarto-xref">Equation&nbsp;<span>20.9</span></a>, <a href="#eq-sfc_L" class="quarto-xref">Equation&nbsp;<span>20.12</span></a>) only two, the equations for household wealth and inventory accumulation (<a href="#eq-sfc_V" class="quarto-xref">Equation&nbsp;<span>20.4</span></a> and <a href="#eq-sfc_IN" class="quarto-xref">Equation&nbsp;<span>20.9</span></a>) feed into the model’s dynamics via their impact on consumption and production, respectively. By contrast, the equations for profits (<a href="#eq-sfc_Pi" class="quarto-xref">Equation&nbsp;<span>20.3</span></a>), household deposits (<a href="#eq-sfc_M" class="quarto-xref">Equation&nbsp;<span>20.5</span></a>), and loans (<a href="#eq-sfc_L" class="quarto-xref">Equation&nbsp;<span>20.12</span></a>) are residuals that ensure accounting consistency, but do not impact the other variables of the model, and can therefore be dropped. Thus, while SFC models often appear very large, this is partly a presentational feature stemming from the ambition to make all assumptions (both structural and accounting) explicit. It is useful to bear in mind that the actual core of a model generating its results might be much smaller.</p>
</section><section id="simulation" class="level2"><h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<section id="parameterisation" class="level3"><h3 class="anchored" data-anchor-id="parameterisation">Parameterisation</h3>
<p>Tables 3a and 3b report the parameterisation used in the simulation. In each scenario, we initialise the model in the steady state and assess the effect of (permanent) shifts in a parameter from a certain period onwards. The first scenario is an increase in autonomous consumption demand (<span class="math inline">\(\alpha_0\)</span>). The second scenario is a rise in the share of inventories <span class="math inline">\(\beta\)</span> that is financed by bonds. Scenario 3 is a rise in the autonomous demand for bonds by households (<span class="math inline">\(\lambda_0\)</span>). Finally, scenario 4 considers a rise in the corporate bond premium <span class="math inline">\(\rho\)</span> offered by firms.</p>
<p><strong>Table 3a: Parameterisation</strong></p>
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th><span class="math inline">\(\alpha_0\)</span></th>
<th><span class="math inline">\(\alpha_1\)</span></th>
<th><span class="math inline">\(\alpha_2\)</span></th>
<th><span class="math inline">\(w\)</span></th>
<th><span class="math inline">\(\delta\)</span></th>
<th><span class="math inline">\(\sigma\)</span></th>
<th><span class="math inline">\(\gamma\)</span></th>
<th><span class="math inline">\(\beta\)</span></th>
<th><span class="math inline">\(\rho\)</span></th>
<th><span class="math inline">\(i_M\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1: aggregate demand boost (<span class="math inline">\(\alpha_0\)</span>)</td>
<td>1.1</td>
<td>0.8</td>
<td>0.2</td>
<td>1</td>
<td>2</td>
<td>0.3</td>
<td>1</td>
<td>0.05</td>
<td>0.03</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>2: rise in share bond-financed inventories (<span class="math inline">\(\beta\)</span>)</td>
<td>1</td>
<td>0.8</td>
<td>0.2</td>
<td>1</td>
<td>2</td>
<td>0.3</td>
<td>1</td>
<td>0.1</td>
<td>0.03</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td>3: rise in autonomous demand for bonds (<span class="math inline">\(\lambda_0\)</span>)</td>
<td>1</td>
<td>0.8</td>
<td>0.2</td>
<td>1</td>
<td>2</td>
<td>0.3</td>
<td>1</td>
<td>0.05</td>
<td>0.03</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>4: rise in corporate bond premium (<span class="math inline">\(\rho\)</span>)</td>
<td>1</td>
<td>0.8</td>
<td>0.2</td>
<td>1</td>
<td>2</td>
<td>0.3</td>
<td>1</td>
<td>0.05</td>
<td>0.04</td>
<td>0.01</td>
</tr>
</tbody>
</table>
<p><strong>Table 3b: Parameterisation (continued)</strong></p>
<table class="table">
<colgroup>
<col style="width: 49%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th><span class="math inline">\(\lambda_0\)</span></th>
<th><span class="math inline">\(\lambda_1\)</span></th>
<th><span class="math inline">\(\lambda_2\)</span></th>
<th><span class="math inline">\(\lambda_3\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1: aggregate demand boost (<span class="math inline">\(\alpha_0\)</span>)</td>
<td>0.2</td>
<td>0.9</td>
<td>0.3</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>2: rise in share bond-financed inventories (<span class="math inline">\(\beta\)</span>)</td>
<td>0.2</td>
<td>0.9</td>
<td>0.3</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td>3: rise in autonomous demand for bonds (<span class="math inline">\(\lambda_0\)</span>)</td>
<td>0.3</td>
<td>0.9</td>
<td>0.3</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>4: rise in corporate bond premium (<span class="math inline">\(\rho\)</span>)</td>
<td>0.2</td>
<td>0.9</td>
<td>0.3</td>
<td>0.1</td>
</tr>
</tbody>
</table></section><section id="simulation-code" class="level3"><h3 class="anchored" data-anchor-id="simulation-code">Simulation code</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Clear the environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set number of periods</span></span>
<span><span class="va">Q</span><span class="op">=</span><span class="fl">300</span></span>
<span></span>
<span><span class="co"># Set number of scenarios</span></span>
<span><span class="va">S</span><span class="op">=</span><span class="fl">4</span></span>
<span></span>
<span><span class="co"># Set period in which shock/shift will occur</span></span>
<span><span class="va">s</span><span class="op">=</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Create (S x Q)-matrices that will contain the simulated data</span></span>
<span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># income/output</span></span>
<span><span class="va">IN</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>   <span class="co"># inventories </span></span>
<span><span class="va">IN_T</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># target inventories </span></span>
<span><span class="va">C</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># consumption (= sales)</span></span>
<span><span class="va">W</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>   <span class="co"># wage bill </span></span>
<span><span class="va">C_E</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>  <span class="co"># expected consumption (= expected sales)</span></span>
<span><span class="va">Pi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>   <span class="co"># net profits</span></span>
<span><span class="va">B</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># bonds</span></span>
<span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># deposits</span></span>
<span><span class="va">L</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># loans</span></span>
<span><span class="va">YD</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>   <span class="co"># disposable income</span></span>
<span><span class="va">V_H</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>  <span class="co"># household wealth         </span></span>
<span><span class="va">p_B</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>  <span class="co"># prices of bonds                    </span></span>
<span><span class="va">i_B</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">0.1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span><span class="co"># interest rate on bonds</span></span>
<span></span>
<span><span class="co"># Set constant parameter values</span></span>
<span><span class="va">sigma</span><span class="op">=</span><span class="fl">0.3</span>   <span class="co"># inventories to sales ratio</span></span>
<span><span class="va">gamma</span><span class="op">=</span><span class="fl">1</span>     <span class="co"># adjustment speed of sales expectations</span></span>
<span><span class="va">i_L</span><span class="op">=</span><span class="va">i_M</span><span class="op">=</span><span class="fl">0.01</span><span class="co"># loan rate = deposit rate</span></span>
<span><span class="va">alpha_1</span><span class="op">=</span><span class="fl">0.8</span> <span class="co"># propensity to consume out of income</span></span>
<span><span class="va">alpha_2</span><span class="op">=</span><span class="fl">0.2</span> <span class="co"># propensity to consume out of wealth</span></span>
<span><span class="va">lambda_1</span><span class="op">=</span><span class="fl">0.9</span><span class="co"># sensitivity of bond demand to deposit rate</span></span>
<span><span class="va">lambda_2</span><span class="op">=</span><span class="fl">0.3</span><span class="co"># sensitivity of bond demand to return on bonds</span></span>
<span><span class="va">lambda_3</span><span class="op">=</span><span class="fl">0.1</span><span class="co"># sensitivity of bond demand to disposable income </span></span>
<span><span class="va">w</span><span class="op">=</span><span class="fl">1</span>         <span class="co"># nominal wage rate</span></span>
<span><span class="va">delta</span><span class="op">=</span><span class="fl">2</span>     <span class="co"># productivity</span></span>
<span></span>
<span><span class="co"># Create matrices for parameters that will change in scenarios</span></span>
<span><span class="va">alpha_0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># autonomous consumption</span></span>
<span><span class="va">lambda_0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">0.2</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span> <span class="co"># autonomous demand for bonds</span></span>
<span><span class="va">rho</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">0.03</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>     <span class="co"># premium on corporate bond rate </span></span>
<span><span class="va">beta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">0.05</span>,nrow<span class="op">=</span><span class="va">S</span>,ncol<span class="op">=</span><span class="va">Q</span><span class="op">)</span>    <span class="co"># share of inventories financed by bonds</span></span>
<span></span>
<span><span class="co"># Create scenarios</span></span>
<span><span class="va">alpha_0</span><span class="op">[</span><span class="fl">1</span>, <span class="va">s</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span><span class="op">=</span><span class="fl">1.1</span>    <span class="co"># scenario 1: aggregate demand boost</span></span>
<span><span class="va">beta</span><span class="op">[</span><span class="fl">2</span>, <span class="va">s</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span><span class="op">=</span><span class="fl">0.1</span>       <span class="co"># scenario 2: rise in share of inventories financed by bonds</span></span>
<span><span class="va">lambda_0</span><span class="op">[</span><span class="fl">3</span>, <span class="va">s</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span><span class="op">=</span><span class="fl">0.3</span>   <span class="co"># scenario 3: rise in autonomous demand for bonds</span></span>
<span><span class="va">rho</span><span class="op">[</span><span class="fl">4</span>, <span class="va">s</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span><span class="op">=</span><span class="fl">0.04</span>       <span class="co"># scenario 4: rise in corporate bond premium</span></span>
<span></span>
<span><span class="co"># Initialise variables in equilibrium</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">iteration</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">i_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">rho</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">i_M</span></span>
<span><span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">w</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">delta</span></span>
<span><span class="va">M</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">L</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> </span>
<span><span class="va">V_H</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">M</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">p_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">YD</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">alpha_0</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_2</span><span class="op">*</span><span class="va">V_H</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">)</span></span>
<span><span class="va">IN</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">IN_T</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">sigma</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">C</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">C_E</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">p_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">i_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">lambda_2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">beta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">+</span><span class="va">lambda_3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">alpha_0</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">alpha_2</span><span class="op">*</span><span class="va">V_H</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">lambda_0</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">lambda_1</span><span class="op">*</span><span class="va">i_M</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Pi</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">C</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">W</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">i_L</span><span class="op">*</span><span class="va">L</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">i_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">beta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">IN</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">p_B</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate the model by looping over Q time periods for S different scenarios</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">S</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">Q</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">iterations</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># (1) Consumption</span></span>
<span>    <span class="va">C</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">alpha_0</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_1</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_2</span><span class="op">*</span><span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (2) Wage bill</span></span>
<span>    <span class="va">W</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">w</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">/</span><span class="va">delta</span></span>
<span>    </span>
<span>    <span class="co"># (3) Profits</span></span>
<span>    <span class="va">Pi</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">C</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">W</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">i_L</span><span class="op">*</span><span class="va">L</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">i_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (4) Household wealth</span></span>
<span>    <span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">C</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (5) Household deposits</span></span>
<span>    <span class="va">M</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (6) Production</span></span>
<span>    <span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">C_E</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">IN_T</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (7) Target inventories</span></span>
<span>    <span class="va">IN_T</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">sigma</span><span class="op">*</span><span class="va">C_E</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (8) Expected consumption (= expected sales)</span></span>
<span>    <span class="va">C_E</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">C_E</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">*</span><span class="op">(</span><span class="va">IN_T</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># (9) Inventories</span></span>
<span>    <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span> <span class="va">C</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (10) Bond supply </span></span>
<span>    <span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span>  <span class="va">beta</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># (11) Rate on corporate bonds</span></span>
<span>    <span class="va">i_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">=</span><span class="va">rho</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">i_L</span></span>
<span>    </span>
<span>    <span class="co"># (12) Loans</span></span>
<span>    <span class="va">L</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">L</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># (13) i_L = i_M (omitted from simulation because fixed)</span></span>
<span>    </span>
<span>    <span class="co"># (14) Bond prices</span></span>
<span>    <span class="va">p_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="va">i_B</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">lambda_2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">IN</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">-</span><span class="va">lambda_0</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">+</span><span class="va">lambda_1</span><span class="op">*</span><span class="va">i_M</span><span class="op">+</span><span class="va">lambda_3</span><span class="op">*</span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">V_H</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="op">}</span> <span class="co"># close iterations loop</span></span>
<span>  <span class="op">}</span> <span class="co"># close time loop</span></span>
<span><span class="op">}</span>   <span class="co"># close scenarios loop</span></span>
<span></span>
<span><span class="co"># Compute business wealth</span></span>
<span><span class="va">V_F</span> <span class="op">=</span> <span class="va">IN</span> <span class="op">-</span> <span class="va">L</span> <span class="op">-</span> <span class="va">p_B</span><span class="op">*</span><span class="va">B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of periods</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of scenarios</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set period in which shock/shift will occur</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create (S x Q)-matrices that will contain the simulated data</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.ones((S, Q))       <span class="co"># income/output</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>IN <span class="op">=</span> np.ones((S, Q))      <span class="co"># inventories </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>IN_T <span class="op">=</span> np.ones((S, Q))    <span class="co"># target inventories </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.ones((S, Q))       <span class="co"># consumption (= sales)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.ones((S, Q))       <span class="co"># wage bill </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>C_E <span class="op">=</span> np.ones((S, Q))     <span class="co"># expected consumption (= expected sales)</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>Pi <span class="op">=</span> np.ones((S, Q))      <span class="co"># net profits</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.ones((S, Q))       <span class="co"># bonds</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> np.ones((S, Q))       <span class="co"># deposits</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> np.ones((S, Q))       <span class="co"># loans</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>YD <span class="op">=</span> np.ones((S, Q))      <span class="co"># disposable income</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>V_H <span class="op">=</span> np.ones((S, Q))     <span class="co"># household wealth         </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>p_B <span class="op">=</span> np.ones((S, Q))     <span class="co"># prices of bonds                    </span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>i_B <span class="op">=</span> np.full((S, Q), <span class="fl">0.1</span>)  <span class="co"># interest rate on bonds</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Set constant parameter values</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.3</span>       <span class="co"># inventories to sales ratio</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> <span class="dv">1</span>         <span class="co"># adjustment speed of sales expectations</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>i_L <span class="op">=</span> i_M <span class="op">=</span> <span class="fl">0.01</span>  <span class="co"># loan rate = deposit rate</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>alpha_1 <span class="op">=</span> <span class="fl">0.8</span>     <span class="co"># propensity to consume out of income</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>alpha_2 <span class="op">=</span> <span class="fl">0.2</span>     <span class="co"># propensity to consume out of wealth</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>lambda_1 <span class="op">=</span> <span class="fl">0.9</span>    <span class="co"># sensitivity of bond demand to deposit rate</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>lambda_2 <span class="op">=</span> <span class="fl">0.3</span>    <span class="co"># sensitivity of bond demand to return on bonds</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>lambda_3 <span class="op">=</span> <span class="fl">0.1</span>    <span class="co"># sensitivity of bond demand to disposable income </span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> <span class="dv">1</span>             <span class="co"># nominal wage rate</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="dv">2</span>         <span class="co"># productivity</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrices for parameters that will change in scenarios</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>alpha_0 <span class="op">=</span> np.ones((S, Q))       <span class="co"># autonomous consumption</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>lambda_0 <span class="op">=</span> np.full((S, Q), <span class="fl">0.2</span>) <span class="co"># autonomous demand for bonds</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>rho <span class="op">=</span> np.full((S, Q), <span class="fl">0.03</span>)     <span class="co"># premium on corporate bond rate </span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.full((S, Q), <span class="fl">0.05</span>)    <span class="co"># share of inventories financed by bonds</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scenarios</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>alpha_0[<span class="dv">0</span>, s:] <span class="op">=</span> <span class="fl">1.1</span>     <span class="co"># scenario 1: aggregate demand boost</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">1</span>, s:] <span class="op">=</span> <span class="fl">0.1</span>        <span class="co"># scenario 2: rise in share of inventories financed by bonds</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>lambda_0[<span class="dv">2</span>, s:] <span class="op">=</span> <span class="fl">0.3</span>    <span class="co"># scenario 3: rise in autonomous demand for bonds</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>rho[<span class="dv">3</span>, s:] <span class="op">=</span> <span class="fl">0.04</span>        <span class="co"># scenario 4: rise in corporate bond premium</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialise variables in equilibrium</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    i_B[:, <span class="dv">0</span>] <span class="op">=</span> rho[:, <span class="dv">0</span>] <span class="op">+</span> i_M</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    W[:, <span class="dv">0</span>] <span class="op">=</span> w <span class="op">*</span> Y[:, <span class="dv">0</span>] <span class="op">/</span> delta</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    M[:, <span class="dv">0</span>] <span class="op">=</span> L[:, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    V_H[:, <span class="dv">0</span>] <span class="op">=</span> M[:, <span class="dv">0</span>] <span class="op">+</span> p_B[:, <span class="dv">0</span>] <span class="op">*</span> B[:, <span class="dv">0</span>]</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    Y[:, <span class="dv">0</span>] <span class="op">=</span> YD[:, <span class="dv">0</span>] <span class="op">=</span> (alpha_0[:, <span class="dv">0</span>] <span class="op">+</span> alpha_2 <span class="op">*</span> V_H[:, <span class="dv">0</span>]) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    IN[:, <span class="dv">0</span>] <span class="op">=</span> IN_T[:, <span class="dv">0</span>] <span class="op">=</span> sigma <span class="op">*</span> Y[:, <span class="dv">0</span>]</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    C[:, <span class="dv">0</span>] <span class="op">=</span> C_E[:, <span class="dv">0</span>] <span class="op">=</span> Y[:, <span class="dv">0</span>]</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    p_B[:, <span class="dv">0</span>] <span class="op">=</span> (i_B[:, <span class="dv">0</span>] <span class="op">*</span> lambda_2) <span class="op">/</span> (</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        (beta[:, <span class="dv">0</span>] <span class="op">*</span> sigma <span class="op">+</span> lambda_3) <span class="op">*</span> </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>        (alpha_0[:, <span class="dv">0</span>] <span class="op">+</span> alpha_2 <span class="op">*</span> V_H[:, <span class="dv">0</span>]) <span class="op">/</span> </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        (V_H[:, <span class="dv">0</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1)) <span class="op">-</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        (lambda_0[:, <span class="dv">0</span>] <span class="op">-</span> lambda_1 <span class="op">*</span> i_M)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    Pi[:, <span class="dv">0</span>] <span class="op">=</span> C[:, <span class="dv">0</span>] <span class="op">-</span> W[:, <span class="dv">0</span>] <span class="op">-</span> i_L <span class="op">*</span> L[:, <span class="dv">0</span>] <span class="op">-</span> i_B[:, <span class="dv">0</span>] <span class="op">*</span> B[:, <span class="dv">0</span>]</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    B[:, <span class="dv">0</span>] <span class="op">=</span> beta[:, <span class="dv">0</span>] <span class="op">*</span> IN[:, <span class="dv">0</span>] <span class="op">/</span> p_B[:, <span class="dv">0</span>]</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the model by looping over Q time periods for S different scenarios</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(S):</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Q):</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (1) Consumption</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>            C[i, t] <span class="op">=</span> alpha_0[i, t] <span class="op">+</span> alpha_1 <span class="op">*</span> Y[i, t] <span class="op">+</span> alpha_2 <span class="op">*</span> V_H[i, t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (2) Wage bill</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>            W[i, t] <span class="op">=</span> w <span class="op">*</span> Y[i, t] <span class="op">/</span> delta</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (3) Profits</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>            Pi[i, t] <span class="op">=</span> (C[i, t] <span class="op">-</span> W[i, t] <span class="op">-</span> i_L <span class="op">*</span> L[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                        i_B[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> B[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>                        IN[i, t] <span class="op">-</span> IN[i, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (4) Household wealth</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>            V_H[i, t] <span class="op">=</span> (V_H[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> Y[i, t] <span class="op">-</span> C[i, t] <span class="op">+</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>                         (p_B[i, t] <span class="op">-</span> p_B[i, t<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> B[i, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (5) Household deposits</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>            M[i, t] <span class="op">=</span> V_H[i, t] <span class="op">-</span> p_B[i, t] <span class="op">*</span> B[i, t]</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (6) Production</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            Y[i, t] <span class="op">=</span> C_E[i, t] <span class="op">+</span> IN_T[i, t] <span class="op">-</span> IN[i, t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (7) Target inventories</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>            IN_T[i, t] <span class="op">=</span> sigma <span class="op">*</span> C_E[i, t]</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (8) Expected consumption (= expected sales)</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>            C_E[i, t] <span class="op">=</span> C_E[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> gamma <span class="op">*</span> (IN_T[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> IN[i, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (9) Inventories</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>            IN[i, t] <span class="op">=</span> IN[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> Y[i, t] <span class="op">-</span> C[i, t]</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (10) Bond supply </span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>            B[i, t] <span class="op">=</span> beta[i, t] <span class="op">*</span> IN[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> p_B[i, t]</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (11) Rate on corporate bonds</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>            i_B[i, t] <span class="op">=</span> rho[i, t] <span class="op">+</span> i_L</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (12) Loans</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>            L[i, t] <span class="op">=</span> (L[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> IN[i, t] <span class="op">-</span> IN[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>                       p_B[i, t] <span class="op">*</span> (B[i, t] <span class="op">-</span> B[i, t<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (13) i_L = i_M (omitted from simulation because fixed)</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>            <span class="co"># (14) Bond prices</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>            p_B[i, t] <span class="op">=</span> (i_B[i, t] <span class="op">*</span> lambda_2) <span class="op">/</span> (</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>                beta[i, t] <span class="op">*</span> (IN[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> V_H[i, t<span class="op">-</span><span class="dv">1</span>]) <span class="op">-</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>                lambda_0[i, t] <span class="op">+</span> lambda_1 <span class="op">*</span> i_M <span class="op">+</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>                lambda_3 <span class="op">*</span> (Y[i, t<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> V_H[i, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute business wealth</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>V_F <span class="op">=</span> IN <span class="op">-</span> L <span class="op">-</span> p_B <span class="op">*</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="checking-stock-flow-consistency" class="level3"><h3 class="anchored" data-anchor-id="checking-stock-flow-consistency">Checking stock-flow consistency</h3>
<p>Before plotting the simulation results for the different scenarios, we perform a stock-flow consistency check by computing the BSM and TFM from the simulated data. To this end, we construct two functions that compute the corresponding matrices for any chosen period and scenario. Let’s start with the BSM and print the results for the first and last period of the first scenario.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Define function to create balance sheet matrices (BSM)</span></span>
<span><span class="va">bsm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">scen</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>    <span class="co"># Pull data from selected period and scenario</span></span>
<span>    <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>     M    <span class="op">=</span> <span class="va">M</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     B    <span class="op">=</span> <span class="va">B</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     L    <span class="op">=</span> <span class="va">L</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     IN   <span class="op">=</span> <span class="va">IN</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     p_B  <span class="op">=</span> <span class="va">p_B</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     V_H  <span class="op">=</span> <span class="va">V_H</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span>,</span>
<span>     V_F  <span class="op">=</span> <span class="va">V_F</span><span class="op">[</span><span class="va">scen</span>, <span class="va">t</span><span class="op">]</span></span>
<span>   <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Households column</span></span>
<span>  <span class="va">households</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">""</span>,                                <span class="co"># inventories </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>,<span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>,           <span class="co"># deposits</span></span>
<span>    <span class="st">""</span>,                                <span class="co"># loans</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>,<span class="va">data</span><span class="op">$</span><span class="va">p_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span>,  <span class="co"># bonds</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>,<span class="va">data</span><span class="op">$</span><span class="va">V_H</span><span class="op">)</span>          <span class="co"># net worth</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Firms column</span></span>
<span>  <span class="va">firms</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">IN</span><span class="op">)</span>,         <span class="co"># inventories </span></span>
<span>    <span class="st">""</span>,                                <span class="co"># deposits</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">)</span>,          <span class="co"># loans</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">p_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span>, <span class="co"># bonds</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">V_F</span><span class="op">)</span>          <span class="co"># net worth </span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Banks column</span></span>
<span>  <span class="va">banks</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">""</span>,                                <span class="co"># inventories </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>,          <span class="co"># deposits</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">)</span>,          <span class="co"># loans</span></span>
<span>    <span class="st">""</span>,                                <span class="co"># loans</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">M</span> <span class="op">-</span> <span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">)</span>   <span class="co"># net worth</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Summation column</span></span>
<span>  <span class="va">sum_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">IN</span><span class="op">)</span>,</span>
<span>    <span class="st">"0"</span>, <span class="st">"0"</span>, <span class="st">"0"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">V_H</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">V_F</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Combine columns to a matrix</span></span>
<span>  <span class="va">bsm</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    Households <span class="op">=</span> <span class="va">households</span>,</span>
<span>    Firms <span class="op">=</span> <span class="va">firms</span>,</span>
<span>    Banks <span class="op">=</span> <span class="va">banks</span>,</span>
<span>    `∑` <span class="op">=</span> <span class="va">sum_col</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Assign rownames</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">bsm</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Inventories"</span>, <span class="st">"Deposits"</span>, <span class="st">"Loans"</span>, <span class="st">"Bonds"</span>, <span class="st">"∑"</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bsm</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print BSM of first scenario for first period </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">bsm</span><span class="op">(</span>t<span class="op">=</span><span class="fl">1</span>, scen<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Households Firms Banks     ∑
Inventories            +1.83       +1.83
Deposits         +1.00       -1.00     0
Loans                  -1.00 +1.00     0
Bonds            +0.09 -0.09           0
∑                +1.09  0.74  0.00 +1.83</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print BSM of first scenario for last period</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">bsm</span><span class="op">(</span>t<span class="op">=</span><span class="va">Q</span>, scen<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Households Firms Banks     ∑
Inventories            +2.05       +2.05
Deposits         +1.23       -1.23     0
Loans                  -1.23 +1.23     0
Bonds            +0.10 -0.10           0
∑                +1.33  0.72 -0.00 +2.05</code></pre>
</div>
</div>
<p>It can be seen that the last row and last column sum to the same value, i.e.&nbsp;<span class="math inline">\(V_H+V_F=IN\)</span>, reflecting stock consistency.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>Now we do the same thing for the TFM (note that we need to use the second period instead of the first, as the TFM contains flows).</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Define function to create transactions flow matrices (TFM)</span></span>
<span><span class="va">tfm</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">scen</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Pull data from selected period and scenario</span></span>
<span>  <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>   C <span class="op">=</span> <span class="va">C</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span>,</span>
<span>   W <span class="op">=</span> <span class="va">W</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span>,</span>
<span>   Pi <span class="op">=</span> <span class="va">Pi</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span>,</span>
<span>   M <span class="op">=</span> <span class="va">M</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>   L <span class="op">=</span> <span class="va">L</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>   B <span class="op">=</span> <span class="va">B</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>   i_B <span class="op">=</span> <span class="va">i_B</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>   dM <span class="op">=</span> <span class="va">M</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">M</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>   dL <span class="op">=</span> <span class="va">L</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">L</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>   dB <span class="op">=</span> <span class="va">p_B</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">B</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">B</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>   dIN <span class="op">=</span> <span class="va">IN</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">IN</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,</span>
<span>   dp_B <span class="op">=</span> <span class="va">B</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="va">scen</span>,<span class="va">t</span><span class="op">]</span><span class="op">-</span><span class="va">p_B</span><span class="op">[</span><span class="va">scen</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Households column</span></span>
<span> <span class="va">households</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">C</span><span class="op">)</span>,         <span class="co"># consumption</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># change in inventories</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">W</span><span class="op">)</span>,         <span class="co"># wages</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">Pi</span><span class="op">)</span>,        <span class="co"># net profits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">i_M</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>,     <span class="co"># interest on deposits</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># interest on loans</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">i_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span>,<span class="co"># interest on bonds</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dM</span><span class="op">)</span>,        <span class="co"># change in deposits</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># change in loans</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dB</span><span class="op">)</span>,        <span class="co"># change in bonds</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>,<span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">C</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">W</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">Pi</span><span class="op">+</span><span class="va">i_M</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">i_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">dM</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">dB</span><span class="op">)</span>, <span class="co"># sum </span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dp_B</span><span class="op">)</span>       <span class="co"># capital gains</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Firms current account column</span></span>
<span> <span class="va">firms_current</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">C</span><span class="op">)</span>,         <span class="co"># consumption</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dIN</span><span class="op">)</span>,       <span class="co"># change in inventories</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">W</span><span class="op">)</span>,         <span class="co"># wages</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">Pi</span><span class="op">)</span>,        <span class="co"># net profits</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># interest on deposits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">i_L</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">)</span>,     <span class="co"># interest on loans</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">i_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span>,<span class="co"># interest on bonds</span></span>
<span>   <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,                       <span class="co"># change in deposits/loans/bonds</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">C</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">dIN</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">W</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">Pi</span><span class="op">-</span><span class="va">i_L</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">i_B</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span>, <span class="co"># sum</span></span>
<span>   <span class="st">""</span>                                <span class="co"># capital gains</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Firms capital account column</span></span>
<span> <span class="va">firms_capital</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>   <span class="st">""</span>,                            <span class="co"># consumption</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dIN</span><span class="op">)</span>,    <span class="co"># change in inventories</span></span>
<span>   <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,        <span class="co"># wages/profits/interest payments/change in deposits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dL</span><span class="op">)</span>,     <span class="co"># change in loans</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dB</span><span class="op">)</span>,     <span class="co"># change in bonds</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">dIN</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">dL</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">dB</span><span class="op">)</span>,<span class="co"># sum</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dp_B</span><span class="op">)</span>    <span class="co"># capital gains</span></span>
<span> <span class="op">)</span> </span>
<span> </span>
<span> <span class="co"># Banks column</span></span>
<span> <span class="va">banks</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> </span>
<span>   <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,                   <span class="co"># consumption/inventories/wages/profits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">i_M</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>,     <span class="co"># interest on deposits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">i_L</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">)</span>,     <span class="co"># interest on loans</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># interest on bonds</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"+%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dM</span><span class="op">)</span>,        <span class="co"># change in deposits</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"-%.2f"</span>, <span class="va">data</span><span class="op">$</span><span class="va">dL</span><span class="op">)</span>,        <span class="co"># change in loans</span></span>
<span>   <span class="st">""</span>,                               <span class="co"># change in bonds </span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="op">-</span><span class="va">i_M</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">M</span><span class="op">+</span><span class="va">i_L</span><span class="op">*</span><span class="va">data</span><span class="op">$</span><span class="va">L</span><span class="op">+</span><span class="va">data</span><span class="op">$</span><span class="va">dM</span><span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">dL</span><span class="op">)</span>, <span class="co"># sum</span></span>
<span>   <span class="st">""</span>                                <span class="co"># capital gains</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Summation column</span></span>
<span> <span class="va">sum_col</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Combine columns to a matrix</span></span>
<span> <span class="va">tfm</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>   Households     <span class="op">=</span> <span class="va">households</span>,</span>
<span>   `Firms (Cur)` <span class="op">=</span> <span class="va">firms_current</span>,</span>
<span>   `Firms (Cap)` <span class="op">=</span> <span class="va">firms_capital</span>,</span>
<span>   Banks          <span class="op">=</span> <span class="va">banks</span>,</span>
<span>   `∑`            <span class="op">=</span> <span class="va">sum_col</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Assign rownames</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tfm</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>   <span class="st">"Consumption"</span>, <span class="st">"Change in inventories"</span>, <span class="st">"Wages"</span>, <span class="st">"Net profits"</span>,</span>
<span>   <span class="st">"Interest on deposits"</span>, <span class="st">"Interest on loans"</span>, <span class="st">"Interest on bonds"</span>,</span>
<span>   <span class="st">"Change in deposits"</span>, <span class="st">"Change in loans"</span>, <span class="st">"Change in bonds"</span>,</span>
<span>   <span class="st">"∑"</span>, <span class="st">"Capital gains"</span></span>
<span> <span class="op">)</span></span>
<span> </span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">tfm</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print TFM of first scenario for second period</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">tfm</span><span class="op">(</span>t<span class="op">=</span><span class="fl">2</span>, scen<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Households Firms (Cur) Firms (Cap) Banks ∑
Consumption                -6.09       +6.09                   0
Change in inventories                  +0.00       -0.00       0
Wages                      +3.05       -3.05                   0
Net profits                +2.90       -2.90                   0
Interest on deposits       +0.01                         -0.01 0
Interest on loans                      -0.01             +0.01 0
Interest on bonds          +0.14       -0.14                   0
Change in deposits         -0.00                         +0.00 0
Change in loans                                    +0.00 -0.00 0
Change in bonds            -0.00                   +0.00       0
∑                          -0.00       -0.00        0.00  0.00 0
Capital gains             --0.00                  +-0.00       0</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print TFM of first scenario for last period</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">tfm</span><span class="op">(</span>t<span class="op">=</span><span class="va">Q</span>, scen<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Households Firms (Cur) Firms (Cap) Banks ∑
Consumption                -6.83       +6.83                   0
Change in inventories                  +0.00       -0.00       0
Wages                      +3.41       -3.41                   0
Net profits                +3.27       -3.27                   0
Interest on deposits       +0.01                         -0.01 0
Interest on loans                      -0.01             +0.01 0
Interest on bonds          +0.14       -0.14                   0
Change in deposits         -0.00                         +0.00 0
Change in loans                                    +0.00 -0.00 0
Change in bonds            -0.00                   +0.00       0
∑                           0.00       -0.00        0.00  0.00 0
Capital gains              -0.00                   +0.00       0</code></pre>
</div>
</div>
<p>The fact that all column sum to zero affirms flow consistency.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">### SFC check</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to create balance sheet matrices (BSM)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bsm(t, scen):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pull data from selected period and scenario</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"M"</span>:    M[scen, t],</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"B"</span>:    B[scen, t],</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"L"</span>:    L[scen, t],</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"IN"</span>:   IN[scen, t],</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p_B"</span>:  p_B[scen, t],</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"V_H"</span>:  V_H[scen, t],</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"V_F"</span>:  V_F[scen, t]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Households column</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    households <span class="op">=</span> [</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,  <span class="co"># inventories </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'M'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># deposits</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,  <span class="co"># loans</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'p_B'</span>] <span class="op">*</span> data[<span class="st">'B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># bonds</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'V_H'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>  <span class="co"># net worth</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Firms column</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    firms <span class="op">=</span> [</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'IN'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># inventories </span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,  <span class="co"># deposits</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'L'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># loans</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'p_B'</span>] <span class="op">*</span> data[<span class="st">'B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># bonds</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>data[<span class="st">'V_F'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>  <span class="co"># net worth </span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banks column</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    banks <span class="op">=</span> [</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,  <span class="co"># inventories </span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'M'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># deposits</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'L'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># loans</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,  <span class="co"># bonds</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>data[<span class="st">'M'</span>] <span class="op">-</span> data[<span class="st">'L'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>  <span class="co"># net worth</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summation column</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    sum_col <span class="op">=</span> [</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'IN'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"0"</span>, <span class="st">"0"</span>, <span class="st">"0"</span>,</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'V_H'</span>] <span class="op">+</span> data[<span class="st">'V_F'</span>]<span class="sc">:.2f}</span><span class="ss">"</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine into a DataFrame</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    bsm_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Households"</span>: households,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Firms"</span>: firms,</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Banks"</span>: banks,</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"∑"</span>: sum_col</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    }, index<span class="op">=</span>[<span class="st">"Inventories"</span>, <span class="st">"Deposits"</span>, <span class="st">"Loans"</span>, <span class="st">"Bonds"</span>, <span class="st">"∑"</span>])</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bsm_df</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Print BSM of first scenario for first period</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co"># (Note: Python uses 0-based indexing, so t=0, scen=0)</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bsm(t<span class="op">=</span><span class="dv">0</span>, scen<span class="op">=</span><span class="dv">0</span>).to_string(index<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print BSM of first scenario for last period</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bsm(t<span class="op">=</span>Q<span class="op">-</span><span class="dv">1</span>, scen<span class="op">=</span><span class="dv">0</span>).to_string(index<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="co">#### Define function to create transactions flow matrices (TFM)</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tfm(t, scen):</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pull data from selected period and scenario</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"C"</span>: C[scen, t],</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"W"</span>: W[scen, t],</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Pi"</span>: Pi[scen, t],</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"M"</span>: M[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>        <span class="st">"L"</span>: L[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>        <span class="st">"B"</span>: B[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">"i_B"</span>: i_B[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dM"</span>: M[scen, t] <span class="op">-</span> M[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dL"</span>: L[scen, t] <span class="op">-</span> L[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dB"</span>: p_B[scen, t] <span class="op">*</span> (B[scen, t] <span class="op">-</span> B[scen, t<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dIN"</span>: IN[scen, t] <span class="op">-</span> IN[scen, t<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dp_B"</span>: B[scen, t<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> (p_B[scen, t] <span class="op">-</span> p_B[scen, t<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Households column</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    households <span class="op">=</span> [</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'C'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                      <span class="co"># consumption</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># change in inventories</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'W'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                      <span class="co"># wages</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'Pi'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># net profits</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>i_M <span class="op">*</span> data[<span class="st">'M'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                <span class="co"># interest on deposits</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># interest on loans</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'i_B'</span>] <span class="op">*</span> data[<span class="st">'B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,        <span class="co"># interest on bonds</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'dM'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in deposits</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># change in loans</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'dB'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in bonds</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span><span class="op">-</span>data[<span class="st">'C'</span>] <span class="op">+</span> data[<span class="st">'W'</span>] <span class="op">+</span> data[<span class="st">'Pi'</span>] <span class="op">+</span> i_M<span class="op">*</span>data[<span class="st">'M'</span>] <span class="op">+</span> data[<span class="st">'i_B'</span>]<span class="op">*</span>data[<span class="st">'B'</span>] <span class="op">-</span> data[<span class="st">'dM'</span>] <span class="op">-</span> data[<span class="st">'dB'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># sum</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'dp_B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>                    <span class="co"># capital gains</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Firms current account column</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    firms_current <span class="op">=</span> [</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'C'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                      <span class="co"># consumption</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'dIN'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                    <span class="co"># change in inventories</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'W'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                      <span class="co"># wages</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'Pi'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># net profits</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># interest on deposits</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>i_L <span class="op">*</span> data[<span class="st">'L'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                <span class="co"># interest on loans</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'i_B'</span>] <span class="op">*</span> data[<span class="st">'B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,        <span class="co"># interest on bonds</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,                               <span class="co"># change in deposits/loans/bonds</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>data[<span class="st">'C'</span>] <span class="op">+</span> data[<span class="st">'dIN'</span>] <span class="op">-</span> data[<span class="st">'W'</span>] <span class="op">-</span> data[<span class="st">'Pi'</span>] <span class="op">-</span> i_L<span class="op">*</span>data[<span class="st">'L'</span>] <span class="op">-</span> data[<span class="st">'i_B'</span>]<span class="op">*</span>data[<span class="st">'B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># sum</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>                                        <span class="co"># capital gains</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Firms capital account column</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    firms_capital <span class="op">=</span> [</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># consumption</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'dIN'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                    <span class="co"># change in inventories</span></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,                       <span class="co"># wages/profits/interest payments</span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># change in deposits</span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'dL'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in loans</span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'dB'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in bonds</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span><span class="op">-</span>data[<span class="st">'dIN'</span>] <span class="op">+</span> data[<span class="st">'dL'</span>] <span class="op">+</span> data[<span class="st">'dB'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># sum</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'dp_B'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>                    <span class="co"># capital gains</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banks column</span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>    banks <span class="op">=</span> [</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,                           <span class="co"># consumption/inventories/wages/profits</span></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>i_M <span class="op">*</span> data[<span class="st">'M'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                <span class="co"># interest on deposits</span></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>i_L <span class="op">*</span> data[<span class="st">'L'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                <span class="co"># interest on loans</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># interest on bonds</span></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"+</span><span class="sc">{</span>data[<span class="st">'dM'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in deposits</span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"-</span><span class="sc">{</span>data[<span class="st">'dL'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,                     <span class="co"># change in loans</span></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>,                                       <span class="co"># change in bonds </span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span><span class="op">-</span>i_M<span class="op">*</span>data[<span class="st">'M'</span>] <span class="op">+</span> i_L<span class="op">*</span>data[<span class="st">'L'</span>] <span class="op">+</span> data[<span class="st">'dM'</span>] <span class="op">-</span> data[<span class="st">'dL'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>,  <span class="co"># sum</span></span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>                                        <span class="co"># capital gains</span></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summation column</span></span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>    sum_col <span class="op">=</span> [<span class="st">"0"</span>] <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine into a DataFrame</span></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>    tfm_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Households"</span>: households,</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Firms (Cur)"</span>: firms_current,</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Firms (Cap)"</span>: firms_capital,</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Banks"</span>: banks,</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">"∑"</span>: sum_col</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>    }, index<span class="op">=</span>[</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Consumption"</span>, <span class="st">"Change in inventories"</span>, <span class="st">"Wages"</span>, <span class="st">"Net profits"</span>,</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Interest on deposits"</span>, <span class="st">"Interest on loans"</span>, <span class="st">"Interest on bonds"</span>,</span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Change in deposits"</span>, <span class="st">"Change in loans"</span>, <span class="st">"Change in bonds"</span>,</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>        <span class="st">"∑"</span>, <span class="st">"Capital gains"</span></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tfm_df</span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Print TFM of first scenario for second period</span></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tfm(t<span class="op">=</span><span class="dv">1</span>, scen<span class="op">=</span><span class="dv">0</span>).to_string(index<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Print TFM of first scenario for last period</span></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tfm(t<span class="op">=</span>Q <span class="op">-</span> <span class="dv">1</span>, scen<span class="op">=</span><span class="dv">0</span>).to_string(index<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="plots" class="level3"><h3 class="anchored" data-anchor-id="plots">Plots</h3>
<p><a href="#fig-sfc-output" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> to <a href="#fig-bprice" class="quarto-xref">Figure&nbsp;<span>20.5</span></a> display the behaviour of several of the model’s key variables during the four scenarios listed in Table 3. The first scenario represents a boost to aggregate demand stemming from an increase in autonomous consumption demand (<span class="math inline">\(\alpha_0\)</span>). Due to the Keynesian nature of the model, the increase in aggregate demand translates into an increase in aggregate output. The adjustment to the new equilibrium is cyclical: with uncertainty over future sales, firms use the information embodied in past deviations of actual investments from target to form expectations about future sales (see <a href="#eq-sfc_Ce" class="quarto-xref">Equation&nbsp;<span>20.8</span></a>). This (imperfect) approach leads to a (temporary) over- and then undershooting of production along the adjustment path. The increase in production leads to a greater demand for loans (to finance inventories), which directly translates into an increase in the money stock – reflecting the principle of endogenous money. The effects of the aggregate-demand boost on the corporate bond market are slightly less intuitive. The price of bonds increases, which through further inspection can be attributed to a fall in the household income-to-wealth ratio, which reduces the transactions demand for deposit money and increases the demand for bonds.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Set maximum period for plots</span></span>
<span><span class="va">Tmin</span><span class="op">=</span><span class="fl">1</span></span>
<span><span class="va">Tmax</span><span class="op">=</span><span class="fl">100</span></span>
<span></span>
<span><span class="co"># Output under different scenarios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>,<span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="va">Tmax</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"Y"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,cex<span class="op">=</span><span class="fl">0.8</span> ,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1: AD boost"</span>, <span class="st">"2: rise in bond finance"</span>, <span class="st">"3: rise bond demand"</span>, <span class="st">"4: rise bond premium"</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sfc-output" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sfc-output-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="an_sfc_model_files/figure-html/fig-sfc-output-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sfc-output-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: Output
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Money (=loans) under different scenarios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span>,<span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="va">Tmax</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"M=L"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,cex<span class="op">=</span><span class="fl">0.8</span> ,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1: AD boost"</span>, <span class="st">"2: rise in bond finance"</span>, <span class="st">"3: rise bond demand"</span>, <span class="st">"4: rise bond premium"</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-deposits" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-deposits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="an_sfc_model_files/figure-html/fig-deposits-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-deposits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: Deposits (= Loans)
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Household wealth under different scenarios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span>,<span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="va">Tmax</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="va">H</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,cex<span class="op">=</span><span class="fl">0.8</span> ,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1: AD boost"</span>, <span class="st">"2: rise in bond finance"</span>, <span class="st">"3: rise bond demand"</span>, <span class="st">"4: rise bond premium"</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-wealth" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-wealth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="an_sfc_model_files/figure-html/fig-wealth-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wealth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Household wealth
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Share of bonds in firms' liabilities</span></span>
<span><span class="va">bshare</span><span class="op">=</span><span class="va">p_B</span><span class="op">*</span><span class="va">B</span><span class="op">/</span><span class="op">(</span><span class="va">p_B</span><span class="op">*</span><span class="va">B</span><span class="op">+</span><span class="va">L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bshare</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">bshare</span><span class="op">[</span>,<span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="va">Tmax</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,cex<span class="op">=</span><span class="fl">0.8</span> ,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">bshare</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">bshare</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">bshare</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1: AD boost"</span>, <span class="st">"2: rise in bond finance"</span>, <span class="st">"3: rise bond demand"</span>, <span class="st">"4: rise bond premium"</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-share" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-share-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="an_sfc_model_files/figure-html/fig-share-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-share-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Share of bonds in firms’ liabilities
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Bond prices under different scenarios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span>,<span class="va">Tmin</span><span class="op">:</span><span class="va">Tmax</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Tmin</span>,<span class="va">Tmax</span><span class="op">)</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="va">B</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>,cex<span class="op">=</span><span class="fl">0.8</span> ,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">p_B</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="va">Q</span><span class="op">]</span>,lty<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1: AD boost"</span>, <span class="st">"2: rise in bond finance"</span>, <span class="st">"3: rise bond demand"</span>, <span class="st">"4: rise bond premium"</span><span class="op">)</span>, </span>
<span>       lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span>, y.intersp<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bprice" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bprice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="an_sfc_model_files/figure-html/fig-bprice-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bprice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.5: Bond price
</figcaption></figure>
</div>
</div>
</div>
<p>The second scenario, a rise in the share of inventories financed by bonds (<span class="math inline">\(\beta\)</span>), as expected leads to a higher share of bonds in firms’ liabilities. This affirms <span class="math inline">\(\beta\)</span>’s role as a liability management parameter reflecting firms preferences for bonds as opposed to loans as a source of external funds. The corresponding increase in the supply of bonds leads to a fall in bond prices and a rise in yields. The money stock falls as loans are partially replaced by bonds. The effect on output is contractionary, which is likely due to the fall in nominal household wealth.</p>
<p>The last two scenarios, a rise in autonomous demand for bonds by households (<span class="math inline">\(\lambda_0\)</span>)) and a rise in the premium on corporate bonds offered by firms (<span class="math inline">\(\rho\)</span>), produce quite similar effects. In both cases, bond demand increases, driving up bond prices. The resulting wealth effect on consumption has a (small) positive effect on output. This illustrates that both households as buyers of bonds and firms as suppliers of bonds can impact bond prices. Shifts in households’ demand for demand, e.g.&nbsp;due to changes in liquidity preference, can alter bond prices. Similarly, firms can manipulate the bond premium to impact demand for bonds and thereby change bond prices. For a given supply of bonds, a rise in the corporate bond premium will drive up bond prices.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Plots (here only for output)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set maximum period for plots</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Tmin <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Tmax <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Output under different scenarios</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(Tmin, Tmax <span class="op">+</span> <span class="dv">1</span>), Y[<span class="dv">0</span>, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax], label<span class="op">=</span><span class="st">"1: AD boost"</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(Tmin, Tmax <span class="op">+</span> <span class="dv">1</span>), Y[<span class="dv">1</span>, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax], label<span class="op">=</span><span class="st">"2: rise in bond finance"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(Tmin, Tmax <span class="op">+</span> <span class="dv">1</span>), Y[<span class="dv">2</span>, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax], label<span class="op">=</span><span class="st">"3: rise bond demand"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'-.'</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(Tmin, Tmax <span class="op">+</span> <span class="dv">1</span>), Y[<span class="dv">3</span>, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax], label<span class="op">=</span><span class="st">"4: rise bond premium"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">':'</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Axis labels and limits</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>plt.xlim(Tmin, Tmax)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>plt.ylim(np.<span class="bu">min</span>(Y[:, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax]), np.<span class="bu">max</span>(Y[:, Tmin<span class="op">-</span><span class="dv">1</span>:Tmax]))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Title (empty as in R)</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">""</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper right'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="directed-graph" class="level2"><h2 class="anchored" data-anchor-id="directed-graph">Directed graph</h2>
<p>Another perspective on the model’s properties is provided by its directed graph. A directed graph consists of a set of nodes that represent the variables of the model. Nodes are connected by directed edges. An edge directed from a node <span class="math inline">\(x_1\)</span> to node <span class="math inline">\(x_2\)</span> indicates a causal impact of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(x_2\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Create directed graph</span></span>
<span><span class="co"># Construct auxiliary Jacobian matrix for 16 variables: </span></span>
<span>  <span class="co"># endogenous: (1) C, (2) dVH, (3) M, (4) Y, (5) INT, (6) dCE, (7) IN, (8) B, (9) iB, (10) dL, (11) pB</span></span>
<span>  <span class="co"># exogenous: (12) alpha0, (13) beta, (14) lambda0, (15) rho, (16) iL=iM</span></span>
<span></span>
<span>            <span class="co"># C W VH M Y INT CE IN  B iB L pB a0 b l0 rho iM</span></span>
<span><span class="va">M_mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># C</span></span>
<span>               <span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># VH</span></span>
<span>               <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># M</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># Y</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># INT</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># CE</span></span>
<span>               <span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># IN</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># B</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="co"># iB</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># dL</span></span>
<span>               <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="co"># pB</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># alpha0</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># beta</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># lambda0</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># rho</span></span>
<span>               <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># il=iM</span></span>
<span>               <span class="fl">16</span>, <span class="fl">16</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create adjacency matrix from transpose of auxiliary Jacobian and add column names</span></span>
<span><span class="va">A_mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">M_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create directed graph from adjacency matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/">igraph</a></span><span class="op">)</span></span>
<span><span class="va">dg</span><span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">A_mat</span>, mode<span class="op">=</span><span class="st">"directed"</span>, weighted<span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define node labels</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html">V</a></span><span class="op">(</span><span class="va">dg</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span>,<span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="va">H</span><span class="op">]</span><span class="op">)</span>, <span class="st">"M"</span>, <span class="st">"Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">IN</span><span class="op">^</span><span class="cn">T</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Delta</span><span class="op">*</span><span class="va">C</span><span class="op">^</span><span class="va">E</span><span class="op">)</span>, <span class="st">"IN"</span>, <span class="st">"B"</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">i</span><span class="op">[</span><span class="va">B</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Delta</span><span class="op">*</span><span class="va">L</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">^</span><span class="va">B</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">i</span><span class="op">[</span><span class="va">M</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot directed graph matrix, use tree-like layout </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dg</span>, layout <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/layout_as_tree.html">layout_as_tree</a></span><span class="op">(</span><span class="va">dg</span><span class="op">)</span>, main<span class="op">=</span><span class="st">""</span>, vertex.size<span class="op">=</span><span class="fl">24</span>, vertex.color<span class="op">=</span><span class="st">"lightblue"</span>, </span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>, edge.arrow.size<span class="op">=</span><span class="fl">0.3</span>, edge.width<span class="op">=</span><span class="fl">1</span>, edge.size<span class="op">=</span><span class="fl">1</span>,</span>
<span>     edge.arrow.width<span class="op">=</span><span class="fl">1.2</span>, edge.color<span class="op">=</span><span class="st">"black"</span>, vertex.label.cex<span class="op">=</span><span class="fl">1</span>, </span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"NA"</span>, margin<span class="op">=</span><span class="op">-</span><span class="fl">0.08</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="an_sfc_model_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Directed graph</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define adjacency matrix (transpose of your M_mat)</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>M_mat <span class="op">=</span> np.array([</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># C</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># VH</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># M</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># Y</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># INT</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># CE</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># IN</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># B</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>],  <span class="co"># iB</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># dL</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>],  <span class="co"># pB</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># alpha0</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># beta</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># lambda0</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],  <span class="co"># rho</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]   <span class="co"># iM</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose to get adjacency matrix</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>A_mat <span class="op">=</span> M_mat.T</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create directed graph</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.from_numpy_array(A_mat, create_using<span class="op">=</span>nx.DiGraph)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Node labels</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>node_labels <span class="op">=</span> {</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="vs">r"$C$"</span>,</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="vs">r"$V_</span><span class="sc">{H}</span><span class="vs">$"</span>,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="vs">r"$M$"</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="vs">r"$Y$"</span>,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="vs">r"$INT$"</span>,</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="vs">r"$\Delta C^</span><span class="sc">{E}</span><span class="vs">$"</span>,</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="vs">r"$IN$"</span>,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="vs">r"$B$"</span>,</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="vs">r"$i_</span><span class="sc">{B}</span><span class="vs">$"</span>,</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>: <span class="vs">r"$\Delta L$"</span>,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>: <span class="vs">r"$p^</span><span class="sc">{B}</span><span class="vs">$"</span>,</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>: <span class="vs">r"$\alpha_0$"</span>,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>: <span class="vs">r"$\beta$"</span>,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="dv">13</span>: <span class="vs">r"$\lambda_0$"</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    <span class="dv">14</span>: <span class="vs">r"$\rho$"</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>: <span class="vs">r"$i_</span><span class="sc">{M}</span><span class="vs">$"</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Use spring layout (networkx does not offer a tree-like layout)</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, seed<span class="op">=</span><span class="dv">42</span>)  <span class="co"># fixed seed for reproducibility</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>nx.draw(</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    G, pos,</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>node_labels,</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>    node_size<span class="op">=</span><span class="dv">1500</span>,</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    node_color<span class="op">=</span><span class="st">'lightblue'</span>,</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>    font_size<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>    font_weight<span class="op">=</span><span class="st">'bold'</span>,</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    arrows<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    edge_color<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="fl">1.2</span>,</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>    arrowsize<span class="op">=</span><span class="dv">12</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">""</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Given the comparatively large number of variables, the directed graph is somewhat busy. We used the tree-like layout to impose some structure. The four exogenous variables considered in the scenarios are grouped at the top. Only autonomous consumption <span class="math inline">\((\alpha_0)\)</span> has a direct impact on the real part of the model. The other exogenous variables <span class="math inline">\((\beta, \lambda_0, \rho, i_M)\)</span> directly impact bond prices <span class="math inline">\(p_B\)</span> (or the bond rate <span class="math inline">\(i_B\)</span>), which then feeds into the real part of the model via the effect on household wealth. The real and financial parts of the model are connected through the interplay of demand-determined output, the accumulation of saving into wealth, and the effects of wealth on consumption.</p>
</section><section id="analytical-discussion" class="level2"><h2 class="anchored" data-anchor-id="analytical-discussion">Analytical discussion</h2>
<p>Despite having 14 equations, the model admits some analytical solutions for its steady state. In a steady state, there are no changes in expectations, which requires inventories to be on target, so that <span class="math inline">\(C^{E*} = C^*\)</span>, <span class="math inline">\(IN^*=IN^{T*}\)</span>, and <span class="math inline">\(C^*=Y^*\)</span>.</p>
<p>Using these conditions for the steady state and <a href="#eq-sfc_C" class="quarto-xref">Equation&nbsp;<span>20.1</span></a>, <a href="#eq-sfc_INT" class="quarto-xref">Equation&nbsp;<span>20.7</span></a>, <a href="#eq-sfc_pB" class="quarto-xref">Equation&nbsp;<span>20.14</span></a> and <a href="#eq-sfc_iB" class="quarto-xref">Equation&nbsp;<span>20.11</span></a>, as well as <a href="#eq-sfc_B" class="quarto-xref">Equation&nbsp;<span>20.10</span></a> and <a href="#eq-sfc_M" class="quarto-xref">Equation&nbsp;<span>20.5</span></a>, respectively, the following implications can be derived:</p>
<p><span class="math display">\[
Y^*=\frac{\alpha_0+\alpha_2 V_H^*}{1-\alpha_1}
\]</span></p>
<p><span class="math display">\[
IN^*=\sigma Y^*
\]</span> <span class="math display">\[
p_t^{B*} = \frac{(\rho + i_M) \lambda_2}{\left( \beta \sigma + \lambda_3 \right) \left( \frac{\alpha_0 + \alpha_2 V_H^*}{V_H^*(1 - a_1)} \right) - (\lambda_0 - \lambda_1 i_M)}.
\]</span></p>
<p><span class="math display">\[
V_H^* = M^* +\beta \sigma Y^*
\]</span> Using the solution for <span class="math inline">\(Y^*\)</span>, the last result can further be written as:</p>
<p><span id="eq-sfc_Veq"><span class="math display">\[
V_H^* = \frac{M^*(1-\alpha_1) +\beta \sigma \alpha_0}{1-\alpha_1-\beta \sigma \alpha_2}.  
\tag{20.15}\]</span></span></p>
<p>We can confirm these analytical solutions numerically:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">### Check analytical solutions (here for the baseline only)</span></span>
<span></span>
<span><span class="co"># Equilibrium output</span></span>
<span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                                         <span class="co"># numerical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.828243</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">alpha_0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">+</span><span class="va">alpha_2</span><span class="op">*</span><span class="va">V_H</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">)</span>    <span class="co"># analytical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.828243</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Equilibrium inventories</span></span>
<span><span class="va">IN</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                                        <span class="co"># numerical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.048473</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sigma</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                                   <span class="co"># analytical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.048473</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Equilibrium wealth</span></span>
<span><span class="va">V_H</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                                       <span class="co"># numerical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.328243</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">M</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                <span class="co"># analytical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.328243</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">)</span><span class="op">+</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">*</span><span class="va">alpha_0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">-</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">*</span><span class="va">alpha_2</span><span class="op">)</span>  <span class="co"># analytical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.328243</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Equilibrium bond price</span></span>
<span><span class="va">p_B</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span>                                      <span class="co"># numerical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02998552</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="op">(</span><span class="va">rho</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">+</span><span class="va">i_M</span><span class="op">)</span><span class="op">*</span><span class="va">lambda_2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">+</span><span class="va">lambda_3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">alpha_0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_2</span><span class="op">*</span><span class="va">V_H</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">V_H</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">lambda_0</span><span class="op">[</span><span class="fl">1</span>,<span class="va">Q</span><span class="op">]</span><span class="op">-</span><span class="va">lambda_1</span><span class="op">*</span><span class="va">i_M</span><span class="op">)</span><span class="op">)</span>                 <span class="co"># analytical </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02998552</code></pre>
</div>
</div>
<p>By contrast, a derivation of equilibrium solutions for stocks (e.g.&nbsp;<span class="math inline">\(V_H^*\)</span> and <span class="math inline">\(M^*\)</span>) is difficult as they depend on the initialisation and are thus not unique in this model. Similarly, a formal stability analysis is practically infeasible as inventory and consumption dynamics, expectations adjustment, wealth accumulation, and capital gains constitute a comparatively high dimensional dynamic system that does not permit clear-cut stability conditions.</p>
<p>However, from the denominator of the equilibrium solution for household wealth (<a href="#eq-sfc_Veq" class="quarto-xref">Equation&nbsp;<span>20.15</span></a>), we can at least derive a necessary (but not sufficient) condition for stability, which is:</p>
<p><span class="math display">\[
1-\alpha_1-\beta \sigma \alpha_2 &gt; 0,
\]</span> ensuring that equilibrium wealth is positive.</p>
<p>For the parameterisations we consider, this condition is indeed satisfied:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Check necessary equilibrium condition (for all scenarios)</span></span>
<span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha_1</span><span class="op">-</span><span class="va">beta</span><span class="op">[</span>,<span class="va">Q</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">*</span><span class="va">alpha_2</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Python code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Python code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Check analytical solutions (here for the baseline only)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Equilibrium output</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># numerical</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((alpha_0[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> alpha_2 <span class="op">*</span> V_H[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1))  <span class="co"># analytical</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Equilibrium inventories</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(IN[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># numerical</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sigma <span class="op">*</span> Y[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># analytical</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Equilibrium wealth</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(V_H[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># numerical</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(M[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> beta[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> sigma <span class="op">*</span> Y[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># analytical (simple)</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((M[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1) <span class="op">+</span> beta[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> sigma <span class="op">*</span> alpha_0[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1 <span class="op">-</span> beta[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> sigma <span class="op">*</span> alpha_2))  <span class="co"># analytical (complex)</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Equilibrium bond price</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_B[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>])  <span class="co"># numerical</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    ((rho[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> i_M) <span class="op">*</span> lambda_2) <span class="op">/</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    ((beta[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> sigma <span class="op">+</span> lambda_3) <span class="op">*</span> (alpha_0[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> alpha_2 <span class="op">*</span> V_H[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>]) <span class="op">/</span> (V_H[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha_1)) <span class="op">-</span> (lambda_0[<span class="dv">0</span>, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> lambda_1 <span class="op">*</span> i_M))</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Check necessary equilibrium condition (for all scenarios)</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((<span class="dv">1</span> <span class="op">-</span> alpha_1 <span class="op">-</span> beta[:, Q<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> sigma <span class="op">*</span> alpha_2) <span class="op">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="a-simplified-recipe-for-constructing-sfc-models" class="level2"><h2 class="anchored" data-anchor-id="a-simplified-recipe-for-constructing-sfc-models">A simplified recipe for constructing SFC models</h2>
<ol type="1">
<li>Decide how many sectors and assets/liabilities you want to include, and how the assets/liabilities will be distributed over the sectors</li>
<li>Write down the balance sheet matrix (BSM)</li>
<li>Write down the transactions flow matrix (TFM)</li>
<li>For each sector, decide on the residual item ensuring that the sector’s budget constraint (column of TFM) is always met</li>
<li>Decide which accounting relationships to include in the model equations and which will be satisfied by implication (confirm the latter through a consistency check once you have simulated the model)</li>
<li>Add the relevant behavioural equations and equilibrium conditions to complete the model (remember that you need exactly one equation per endogenous variable)</li>
<li>Simulate the model</li>
<li>Perform a consistency check</li>
<li>Decide on the scenarios you want to consider (i.e.&nbsp;shocks or shifts to exogenous variables/parameters and how they impact endogenous variables of interest)</li>
<li>Try to find analytical solutions for the steady state of the model</li>
</ol></section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Caverzasi2014" class="csl-entry" role="listitem">
Caverzasi, E., and A. Godin. 2014. <span>“Post-Keynesian Stock-Flow-Consistent Modelling: A Survey.”</span> <em>Cambridge Journal of Economics</em> 39 (1): 157–87. <a href="https://doi.org/10.1093/cje/beu021">https://doi.org/10.1093/cje/beu021</a>.
</div>
<div id="ref-Godley2012" class="csl-entry" role="listitem">
Godley, Wynne. 2012. <span>“Weaving Cloth from Graziani’s Thread: Endogenous Money in a Simple (but Complete) Keynesian Model.”</span> In <em>The Stock–Flow Consistent Approach. Selected Writings of Wynne Godley</em>, edited by Marc Lavoie and Gennaro Zezza. Palgrave Macmillan.
</div>
<div id="ref-Godley2006" class="csl-entry" role="listitem">
Godley, Wynne, and Marc Lavoie. 2006. <em>Monetary Economics. An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.
</div>
<div id="ref-Graziani2003" class="csl-entry" role="listitem">
Graziani, Augusto. 2003. <em>The Monetary Theory of Production</em>. Cambridge University Press.
</div>
<div id="ref-Lavoie2022" class="csl-entry" role="listitem">
Lavoie, Marc. 2022. <em>Post-Keynesian Economics. New Foundations</em>. 2nd ed. Edward Elgar.
</div>
<div id="ref-Nikiforos2017" class="csl-entry" role="listitem">
Nikiforos, Michalis, and Gennaro Zezza. 2017. <span>“STOCK‐FLOW CONSISTENT MACROECONOMIC MODELS: A SURVEY.”</span> <em>Journal of Economic Surveys</em> 31 (5): 1204–39. <a href="https://doi.org/10.1111/joes.12221">https://doi.org/10.1111/joes.12221</a>.
</div>
<div id="ref-Passarella2024" class="csl-entry" role="listitem">
Passarella, Marco Veronese. 2024. <span>“It Is Not La Vie En Rose: New Insights from Graziani’s Theory of the Monetary Circuit.”</span> <em>European Journal of Economics and Economic Policies: Intervention</em> 21 (3): 461–85. <a href="https://doi.org/10.4337/ejeep.2022.0084">https://doi.org/10.4337/ejeep.2022.0084</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>See <span class="citation" data-cites="Godley2006">Godley and Lavoie (<a href="#ref-Godley2006" role="doc-biblioref">2006</a>)</span>. <span class="citation" data-cites="Lavoie2022">Lavoie (<a href="#ref-Lavoie2022" role="doc-biblioref">2022</a>)</span>, chapter 4.6 provides an introduction, while <span class="citation" data-cites="Caverzasi2014">Caverzasi and Godin (<a href="#ref-Caverzasi2014" role="doc-biblioref">2014</a>)</span> and <span class="citation" data-cites="Nikiforos2017">Nikiforos and Zezza (<a href="#ref-Nikiforos2017" role="doc-biblioref">2017</a>)</span> survey research in the field. Some online resources can be found in <a href="additional_resources.html" class="quarto-xref"><span>Chapter 21</span></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>A more complex version of this model can be found in <span class="citation" data-cites="Godley2006">Godley and Lavoie (<a href="#ref-Godley2006" role="doc-biblioref">2006</a>)</span>, chapter 9. Another formalisation of the monetary circuit by means of an SFC model is <span class="citation" data-cites="Passarella2024">Passarella (<a href="#ref-Passarella2024" role="doc-biblioref">2024</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The model in this section exhibits a number of differences to the model in <span class="citation" data-cites="Godley2012">Godley (<a href="#ref-Godley2012" role="doc-biblioref">2012</a>)</span>: first, for simplicity, prices are assumed to be fixed (firms charge a fixed markup on fixed nominal unit labour cost); second, to capture the Keynesian idea of fundamental uncertainty, we assume that firms do not know future sales and instead form expectations based on an adaptive heuristic;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> third, we introduce a corporate bond market with endogenous prices to capture the idea of ‘final finance’ providing a source of funds for firms beyond revenues from sales for the repayment of credit.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>As a result, the aggregate wage share <span class="math inline">\(\frac{W}{pY}=\frac{w}{p\delta}\)</span> is constant in this model.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Note that <span class="math inline">\(V_H+V_F=IN\)</span> is not an equation used in the simulation of the model, but follows logically from the other accounting equations used in the model.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./an_evolutionary_game_theoretic_model.html" class="pagination-link" aria-label="An Evolutionary Game Theoretic Model of the Emergence of Property Rights">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">An Evolutionary Game Theoretic Model of the Emergence of Property Rights</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./additional_resources.html" class="pagination-link" aria-label="Additional Online Resources">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Additional Online Resources</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>An open-source platform for macroeconomic model simulation.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><a>License: …</a><a></a> <a href="https://github.com/DIY-Macro-Sim/DIY-Macro-sim-website">Source code</a></p>
</div>
  </div>
</footer>


</body></html>